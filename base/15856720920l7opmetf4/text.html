<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Метод Recordset.Update (DAO)</p><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    18.09.2015</p><h3>    Время чтения: 4 мин</h3><h3></h3><h3>Область применения: Access 2013, Office 2013</h3><h3>Синтаксис</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">expression .Update(UpdateType, Force)</p><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">expression: переменная, представляющая объект Recordset.</p><h3>Параметры</h3><h3>Table 1</h3><h3></h3><h3>Имя</h3><h3>	</h3><h3></h3><h3>Обязательный/необязательный</h3><h3>	</h3><h3></h3><h3>Тип данных</h3><h3>	</h3><h3></h3><h3>Описание</h3><h3></h3><h3>UpdateType</h3><h3>	</h3><h3></h3><h3>Необязательный</h3><h3>	</h3><h3></h3><h3>Long</h3><h3>	</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Константа UpdateTypeEnum, обозначающая тип обновления, заданный в параметрах (только для рабочих областей ODBCDirect).</p><h3></h3><h3>Сила</h3><h3>	</h3><h3></h3><h3>Необязательный</h3><h3>	</h3><h3></h3><h3>Логический</h3><h3>	</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Логическое значение, указывающее, следует ли принудительно вносить изменения в базу данных независимо от того, были ли базовые данные изменены другим пользователем с момента вызова метода AddNew, Delete или Edit. Если задано значение True, то ваши изменения принудительно применяются, а изменения, внесенные другими пользователями, просто перезаписываются. Если задано значение False (по умолчанию), то изменения, внесенные другими пользователями, пока обновление ожидает обработки, приведут к сбоям обновления в конфликтных участках. Ошибка не возникает, но в свойствах BatchCollisionCount и BatchCollisions указывается количество конфликтов и затронутых ими строк, соответственно (только для рабочих областей ODBCDirect).</p><h3>Примечания</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используйте метод Update, чтобы сохранить текущую запись и все внесенные в нее изменения.</p><h3></h3><h3>Важно!</h3><h3></h3><h3>Изменения текущей записи теряются, если:</h3><h3></h3><h3>    вызвать метод Edit или AddNew, а затем перейти к другой записи, не используя перед этим метод Update;</h3><h3>    вызвать метод Edit или AddNew, а затем снова применить метод Edit или AddNew, не используя перед этим метод Update;</h3><h3>    указать в свойстве Bookmark другую запись;</h3><h3>    закрыть объект Recordset, не используя перед этим метод Update;</h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    отменить операцию Edit с помощью метода CancelUpdate.</p><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы изменить запись, используйте метод Edit для копирования содержимого текущей записи в буфер обмена. Если сначала не вызвать метод Edit, то при использовании метода Update или попытке изменить значение поля возникнет ошибка.</p><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В рабочей области ODBCDirect можно выполнять пакетное обновление, при условии что библиотека курсоров поддерживает его, а объект Recordset был открыт с использованием оптимистичной блокировки пакетных операций.</p><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если в рабочей области Microsoft Access для свойства LockEdits объекта Recordset задано значение True (пессимистичная блокировка) в многопользовательской среде, то запись останется заблокированной с момента вызова метода Edit до завершения выполнения метода Update или отмены изменения. Если для свойства LockEdits задано значение False (оптимистичная блокировка), то запись блокируется и сравнивается с ее вариантом непосредственно перед обновлением в базе данных.</p><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если запись изменилась с момента использования метода Edit, происходит сбой операции Update. В базах данных ODBC, подключенных к ядру СУБД Microsoft Access, и устанавливаемых базах данных ISAM всегда используется оптимистичная блокировка. Чтобы продолжить выполнение операции Update с вашими изменениями, снова вызовите метод Update. Чтобы вернуть запись в состояние, оставленное другим пользователем, обновите текущую запись с помощью команды Move 0.</p><h3></h3><h3>Примечание</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы запись можно было добавить, изменить или удалить, в базовом источнике данных должен быть указан ее уникальный индекс. В противном случае возникнет ошибка &quot;Отказано в разрешении&quot; (при вызове метода AddNew, Delete или Edit в рабочей области Microsoft Access) или ошибка &quot;Недопустимый аргумент&quot; (при вызове метода Update в рабочей области ODBCDirect).</p><h3>Пример</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом примере показано использование метода Update вместе с методом Edit.</p><h3>VB</h3><h3></h3><h3>    Sub UpdateX() </h3><h3>     </h3><h3>     Dim dbsNorthwind As Database </h3><h3>     Dim rstEmployees As Recordset </h3><h3>     Dim strOldFirst As String </h3><h3>     Dim strOldLast As String </h3><h3>     Dim strMessage As String </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     Set dbsNorthwind = OpenDatabase(&quot;Northwind.mdb&quot;) </p><h3>     Set rstEmployees = _ </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     dbsNorthwind.OpenRecordset(&quot;Employees&quot;) </p><h3>     </h3><h3>     With rstEmployees </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Edit </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Store original data. </p><h3>     strOldFirst = !FirstName </h3><h3>     strOldLast = !LastName </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Change data in edit buffer. </p><h3>     !FirstName = &quot;Linda&quot; </h3><h3>     !LastName = &quot;Kobara&quot; </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Show contents of buffer and get user input. </p><h3>     strMessage = &quot;Edit in progress:&quot; &amp; vbCr &amp; _ </h3><h3>     &quot; Original data = &quot; &amp; strOldFirst &amp; &quot; &quot; &amp; _ </h3><h3>     strOldLast &amp; vbCr &amp; &quot; Data in buffer = &quot; &amp; _ </h3><h3>     !FirstName &amp; &quot; &quot; &amp; !LastName &amp; vbCr &amp; vbCr &amp; _ </h3><h3>     &quot;Use Update to replace the original data with &quot; &amp; _ </h3><h3>     &quot;the buffered data in the Recordset?&quot; </h3><h3>     </h3><h3>     If MsgBox(strMessage, vbYesNo) = vbYes Then </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Update </p><h3>     Else </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .CancelUpdate </p><h3>     End If </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Show the resulting data. </p><h3>     MsgBox &quot;Data in recordset = &quot; &amp; !FirstName &amp; &quot; &quot; &amp; _ </h3><h3>     !LastName </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Restore original data because this is a demonstration. </p><h3>     If Not (strOldFirst = !FirstName And _ </h3><h3>     strOldLast = !LastName) Then </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Edit </p><h3>     !FirstName = strOldFirst </h3><h3>     !LastName = strOldLast </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Update </p><h3>     End If </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Close </p><h3>     End With </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     dbsNorthwind.Close </p><h3>     </h3><h3>    End Sub </h3><h3></h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом примере показано использование метода Update вместе с методом AddNew.</p><h3>VB</h3><h3></h3><h3>    Sub UpdateX2() </h3><h3>     </h3><h3>     Dim dbsNorthwind As Database </h3><h3>     Dim rstEmployees As Recordset </h3><h3>     Dim strOldFirst As String </h3><h3>     Dim strOldLast As String </h3><h3>     Dim strMessage As String </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     Set dbsNorthwind = OpenDatabase(&quot;Northwind.mdb&quot;) </p><h3>     Set rstEmployees = _ </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     dbsNorthwind.OpenRecordset(&quot;Employees&quot;) </p><h3>     </h3><h3>     With rstEmployees </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .AddNew </p><h3>     !FirstName = &quot;Bill&quot; </h3><h3>     !LastName = &quot;Sornsin&quot; </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Show contents of buffer and get user input. </p><h3>     strMessage = &quot;AddNew in progress:&quot; &amp; vbCr &amp; _ </h3><h3>     &quot; Data in buffer = &quot; &amp; !FirstName &amp; &quot; &quot; &amp; _ </h3><h3>     !LastName &amp; vbCr &amp; vbCr &amp; _ </h3><h3>     &quot;Use Update to save buffer to recordset?&quot; </h3><h3>     </h3><h3>     If MsgBox(strMessage, vbYesNoCancel) = vbYes Then </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Update </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Go to the new record and show the resulting data. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Bookmark = .LastModified </p><h3>     MsgBox &quot;Data in recordset = &quot; &amp; !FirstName &amp; _ </h3><h3>     &quot; &quot; &amp; !LastName </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Delete new data because this is a demonstration. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Delete </p><h3>     Else </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .CancelUpdate </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     MsgBox &quot;No new record added.&quot; </p><h3>     End If </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Close </p><h3>     End With </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     dbsNorthwind.Close </p><h3>     </h3><h3>    End Sub </h3><h3></h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом примере используются свойство BatchCollisionCount и метод Update, чтобы продемонстрировать пакетное обновление с разрешением всех конфликтов путем принудительного пакетного обновления.</p><h3>VB</h3><h3></h3><h3>Sub BatchX() </h3><h3> </h3><h3> Dim wrkMain As Workspace </h3><h3> Dim conMain As Connection </h3><h3> Dim rstTemp As Recordset </h3><h3> Dim intLoop As Integer </h3><h3> Dim strPrompt As String </h3><h3> </h3><h3> Set wrkMain = CreateWorkspace(&quot;ODBCWorkspace&quot;, _ </h3><h3> &quot;admin&quot;, &quot;&quot;, dbUseODBC) </h3><h3> ' This DefaultCursorDriver setting is required for </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> ' batch updating. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> wrkMain.DefaultCursorDriver = dbUseClientBatchCursor </p><h3> </h3><h3> ' Note: The DSN referenced below must be configured to </h3><h3> ' use Microsoft Windows NT Authentication Mode to </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> ' authorize user access to the Microsoft SQL Server. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Set conMain = wrkMain.OpenConnection(&quot;Publishers&quot;, _ </p><h3> dbDriverNoPrompt, False, _ </h3><h3> &quot;ODBC;DATABASE=pubs;DSN=Publishers&quot;) </h3><h3> </h3><h3> ' The following locking argument is required for </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> ' batch updating. It is also required that a table </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> ' with a primary key is used. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Set rstTemp = conMain.OpenRecordset( _ </p><h3> &quot;SELECT * FROM roysched&quot;, dbOpenDynaset, 0, _ </h3><h3> dbOptimisticBatch) </h3><h3> </h3><h3> With rstTemp </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> ' Modify data in local recordset. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Do While Not .EOF </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> .Edit </p><h3> If !royalty &lt;= 20 Then </h3><h3> !royalty = !royalty - 4 </h3><h3> Else </h3><h3> !royalty = !royalty + 2 </h3><h3> End If </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> .Update </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> .MoveNext </p><h3> Loop </h3><h3> </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> ' Attempt a batch update. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> .Update dbUpdateBatch </p><h3> </h3><h3> ' If there are collisions, give the user the option </h3><h3> ' of forcing the changes or resolving them </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> ' individually. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> If .BatchCollisionCount &gt; 0 Then </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> strPrompt = &quot;There are collisions. &quot; &amp; vbCr &amp; _ </p><h3> &quot;Do you want the program to force &quot; &amp; _ </h3><h3> vbCr &amp; &quot;an update using the local data?&quot; </h3><h3> If MsgBox(strPrompt, vbYesNo) = vbYes Then _ </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> .Update dbUpdateBatch, True </p><h3> End If </h3><h3> </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> .Close </p><h3> End With </h3><h3> </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> conMain.Close </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> wrkMain.Close </p><h3> </h3><h3>End Sub </h3><h3> </h3><h3></h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом примере используется метод AddNew, чтобы создать запись с указанным именем. Функция AddName необходима для запуска этой процедуры.</p><h3>VB</h3><h3></h3><h3>    Sub AddNewX() </h3><h3>     </h3><h3>     Dim dbsNorthwind As Database </h3><h3>     Dim rstEmployees As Recordset </h3><h3>     Dim strFirstName As String </h3><h3>     Dim strLastName As String </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     Set dbsNorthwind = OpenDatabase(&quot;Northwind.mdb&quot;) </p><h3>     Set rstEmployees = _ </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     dbsNorthwind.OpenRecordset(&quot;Employees&quot;, dbOpenDynaset) </p><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Get data from the user. </p><h3>     strFirstName = Trim(InputBox( _ </h3><h3>     &quot;Enter first name:&quot;)) </h3><h3>     strLastName = Trim(InputBox( _ </h3><h3>     &quot;Enter last name:&quot;)) </h3><h3>     </h3><h3>     ' Proceed only if the user actually entered something </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' for both the first and last names. </p><h3>     If strFirstName &lt;&gt; &quot;&quot; and strLastName &lt;&gt; &quot;&quot; Then </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Call the function that adds the record. </p><h3>     AddName rstEmployees, strFirstName, strLastName </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Show the newly added data. </p><h3>     With rstEmployees </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     Debug.Print &quot;New record: &quot; &amp; !FirstName &amp; _ </p><h3>     &quot; &quot; &amp; !LastName </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' Delete new record because this is a demonstration. </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Delete </p><h3>     End With </h3><h3>     </h3><h3>     Else </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     Debug.Print _ </p><h3>     &quot;You must input a string for first and last name!&quot; </h3><h3>     End If </h3><h3>     </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     rstEmployees.Close </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     dbsNorthwind.Close </p><h3>     </h3><h3>    End Sub </h3><h3>     </h3><h3>    Function AddName(rstTemp As Recordset, _ </h3><h3>     strFirst As String, strLast As String) </h3><h3>     </h3><h3>     ' Adds a new record to a Recordset using the data passed </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' by the calling procedure. The new record is then made </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     ' the current record. </p><h3>     With rstTemp </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .AddNew </p><h3>     !FirstName = strFirst </h3><h3>     !LastName = strLast </h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Update </p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     .Bookmark = .LastModified </p><h3>     End With </h3><h3>     </h3><h3>    End Function</h3><h3></h3></p></body></html>