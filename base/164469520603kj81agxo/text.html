<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//=============================================================================</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//замена значений null-&gt;0 по списку столбцов</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    Replace_Null_CU </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.ReplaceValue</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Vol_Date_in_data_array_CC</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">null</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">0</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Replacer.ReplaceValue</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">List_Columns_Date</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">)</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Record_ToList = Table.AddColumn(Replace_Null_CU, &quot;Lists_Records&quot;, each Record.ToList(Replace_Null_CU{[Индекс]}))</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Создайте список столбцов для суммирования (отрезаем первые столбцы)</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//colToSum = List.RemoveFirstN(Table.ColumnNames(Replace_Null_CU),6),</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Buffer</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">List_Columns_Date</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//colToSum = List.Buffer( </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//                        List.RemoveFirstN(Table.ColumnNames(Replace_Null_CU),6)</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//                        ),</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Add Index Column</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    IDX </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddIndexColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Replace_Null_CU</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Index&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">0</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">1</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Result Sum/Count each row of &quot;colToSum&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//totals</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//= Table.AddColumn(IDX, &quot;Res&quot;, each List.Sum(Record.ToList(Table.SelectColumns(IDX, colToSum){[Index]})) / List.Count(Record.ToList(Table.SelectColumns(IDX, colToSum){[Index]}))=[Vol_CC])</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    totals</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Res&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Vol_CC</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]=</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Sum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]}))</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">/</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> 			            	  </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Count</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]})))</span><span style=" font-family:'Consolas'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt;">  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:9pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//=============================================================================</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//замена значений null-&gt;0 по списку столбцов</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    Replace_Null_CU </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.ReplaceValue</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Vol_Date_in_data_array_CC</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">null</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">0</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Replacer.ReplaceValue</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">List_Columns_Date</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Record_ToList = Table.AddColumn(Replace_Null_CU, &quot;Lists_Records&quot;, each Record.ToList(Replace_Null_CU{[Индекс]}))</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Создайте список столбцов для суммирования (отрезаем первые столбцы)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//colToSum = List.RemoveFirstN(Table.ColumnNames(Replace_Null_CU),6),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Buffer</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">List_Columns_Date</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//colToSum = List.Buffer( </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//                        List.RemoveFirstN(Table.ColumnNames(Replace_Null_CU),6)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//                        ),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Add Index Column</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    IDX </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddIndexColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Replace_Null_CU</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Index&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">0</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">1</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Result Sum/Count each row of &quot;colToSum&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//totals</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//= Table.AddColumn(IDX, &quot;Res&quot;, each List.Sum(Record.ToList(Table.SelectColumns(IDX, colToSum){[Index]})) / List.Count(Record.ToList(Table.SelectColumns(IDX, colToSum){[Index]}))=[Vol_CC])</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    totals</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Res&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Vol_CC</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]=</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Sum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]}))</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">/</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Count</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]})))</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//=============================================================================</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Создайте список столбцов для суммирования (отрезаем первые столбцы)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    colToSum </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Buffer</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">                            </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.RemoveFirstN</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.ColumnNames</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Replace_Null_CU</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">6</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">                            </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Add Index Column</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    IDX </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddIndexColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Replace_Null_CU</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Index&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">0</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">1</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Sum each row of &quot;colToSum&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    totals_Sum</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Sum&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Sum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]})),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Number.Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Count each row of &quot;colToSum&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    totals_Count</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        totals_Sum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Count&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Count</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]})),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Number.Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Result Sum/Count each row of &quot;colToSum&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    totals</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        totals_Count</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Res&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Sum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]}))</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">/</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Count</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]})),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Currency.Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    Compare_CC_CU </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">totals</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Сдвиг версий&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Vol_CC</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]=[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Res</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">])</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//=============================================================================</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">После поворота:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Создание списка столбцов для суммирования</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Добавление столбца Индекс для ограничения каждой строкой</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Добавление столбца</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> который суммирует столбцы только для этой строки</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Удалить индекс колум</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#004080; background-color:#eeeeee;">let</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    Source </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Excel.CurrentWorkbook</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Name</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Table3&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]}[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Content</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">],</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    #</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Changed Type&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.TransformColumnTypes</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Source</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,{{</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Month Yr&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Date.Type</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Attribute&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">type</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000080;">text</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Value&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Currency.Type</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">}}),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    #</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Added Custom&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">#</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Changed Type&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;MonthYear&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Date.ToText</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">([</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Month Yr</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">],</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;MMMM yyyy&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">)),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    #</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Removed Columns&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.RemoveColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">#</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Added Custom&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,{</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Month Yr&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">}),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    #</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Pivoted Column&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.Pivot</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">#</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Removed Columns&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Distinct</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">#</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Removed Columns&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">MonthYear</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;MonthYear&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Value&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Sum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//NEW code added after your Pivoted Column line </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Get List of columns to sum </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//  Assumes this list all columns **except the first** in the Pivot table </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//  There are other methods of generating this list if this assumption is incorrect </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">colToSum </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.RemoveFirstN</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.ColumnNames</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">#</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Pivoted Column&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">1</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Add Index Column </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddIndexColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">#</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Pivoted Column&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Index&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">0</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#800080;">1</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-style:italic; color:#008000;">//Sum each row of &quot;colToSum&quot; </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">totals </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Sum&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">List.Sum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Record.ToList</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">            </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">IDX</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">colToSum</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">){[</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">Index</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">]})</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Currency.Type</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">    #</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Removed Columns1&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080c0;">Table.RemoveColumns</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">totals</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">,{</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Index&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#0080ff;">})</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#004080; background-color:#eeeeee;">in</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">#</span><span style=" font-family:'Consolas'; font-size:12pt; color:#800000;">&quot;Removed Columns1&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:10pt;"><br /></p></body></html>