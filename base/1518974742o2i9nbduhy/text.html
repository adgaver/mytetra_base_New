<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Как удалить скрытые столбцы? Программное удаление скрытых столбцов макросом VBA.</span><span style=" font-family:'DejaVu Sans'; font-weight:600;">		</span></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">									Подробности							</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">																		Категория: </span><a href="http://macros-vba.ru/makrosy/excel"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">Макросы Excel</span></a><span style=" font-family:'DejaVu Sans';">	</span></p>
<p style=" margin-top:0px; margin-bottom:8px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">					Опубликовано: 08 апреля 2012				</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Ранее уже рассматривался вопрос об удалении скрытых строк и хотя необходимость в удалении скрытых столбцов встречается гораздо реже, тем не менее необходимость в таких действиях все-таки встречается. Макрос для удаления скрытых строк, написанный на языке VBA у нас уже есть, остается внести в него изменения, для того, чтобы вместо строк он стал удалять столбцы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Как уже отчечалось ранее, отобразить скрытые объекты (в нашем случае столбцы) довольно просто, выделяется весь лист, нажатием нулевой ячейки (пересечение номеров строк и наименований солбцов) после чего из контекстного меню выбирается пункт &quot;Отобразить&quot;. Если же требуется скрытые столбцы удалить, то стандартными средствами придется столбцы сначала отображать и только после этого удалять. Попробуем обойтись без промежуточных действий. Запускаем редактор Visual Basic и переносим туда программный код готового макроса, удаляющего скрытые столбцы в используемом диапазоне активного рабочего листа.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">Sub Udalenie_Skrytyh_Stolbtsov()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">      Dim c As Long, FirstColumn As Long, LastColumn As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">      FirstColumn = ActiveSheet.UsedRange.Column</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">      LastColumn = ActiveSheet.UsedRange.Columns.Count - 1 + ActiveSheet.UsedRange.Column</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">            For c = LastColumn To FirstColumn Step -1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">                  If Columns(c).Hidden = True Then Columns(c).Delete</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">            Next c</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">End Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Для того, чтобы перенести этот программный код на свой компьютер, наведите курсор мыши на поле с программным кодом , нажмите на одну из двух кнопкок  в правом верхнем углу этого поля, скопируйте программный код и вставьте его в модуль проекта на своем компьютере (подробнее о том, </span><a href="http://macros-vba.ru/knigi/vba/62-kak-sohranit-kod-macrosa"><span style=" font-family:'DejaVu Sans'; font-style:italic; text-decoration: underline; color:#0000ff;">как сохранить программный код макроса</span></a><span style=" font-family:'DejaVu Sans';">).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">	</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-weight:600;">Другие материалы по теме:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/office/55-sostav-ms-office"><span style=" text-decoration: underline; color:#0000ff;">				Состав MS Office</span></a></li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/53-chto-takoe-makrosy"><span style=" text-decoration: underline; color:#0000ff;">				Что такое VBA? Что такое макросы VBA? Что такое надстройки?</span></a></li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/61-sposobyi-ustanovki-macrosov"><span style=" text-decoration: underline; color:#0000ff;">				Создание и написание макросов. Как установить макрос на свой компьютер?</span></a></li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/60-macros-recorderom"><span style=" text-decoration: underline; color:#0000ff;">				Как записать макрос макрорекордером? Как запустить макрос в Word и Excel?</span></a></li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/62-kak-sohranit-kod-macrosa"><span style=" text-decoration: underline; color:#0000ff;">				Как сохранить программный код макроса? Что такое модули?</span></a></li></ul></body></html>