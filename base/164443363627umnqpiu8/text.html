<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-weight:600; text-decoration: underline; color:#393939; background-color:#ffffff;">Аналог функции Excel ИЛИ() в Power Query – List.AnyTrue()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff;">=if &lt;logical test&gt; then &lt;result&gt; else &lt;alternate result&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:16px; color:#393939; background-color:#ffffff;">К сожалению, в Power Query нет функции ИЛИ(). Напомню, чтобы обратиться к списку функций, кликните на ссылку</span><span style=" font-size:16px; color:#393939;"> </span><a href="https://docs.microsoft.com/ru-ru/powerquery-m/power-query-m-function-reference"><span style=" font-size:16px; text-decoration: underline; color:#000000;">Сведения о формулах Power Query</span></a><span style=" font-size:16px; color:#393939;"> в нижней части диалогового окна </span><span style=" font-size:16px; font-style:italic; color:#393939;">Настраиваемый столбец</span><span style=" font-size:16px; color:#393939;">. Вы окажитесь на странице сайта Microsoft с обзором всех функций Power Query. В категории </span><a href="https://docs.microsoft.com/ru-ru/powerquery-m/list-functions"><span style=" font-size:16px; text-decoration: underline; color:#000000;">List functions</span></a><span style=" font-size:16px; color:#393939;"> можно найти функцию </span><a href="https://docs.microsoft.com/ru-ru/powerquery-m/list-anytrue"><span style=" font-size:16px; text-decoration: underline; color:#000000;">List.AnyTrue</span></a><span style=" font-size:16px; color:#393939;">, которая возвращает ИСТИНА, если хоть одно выражение списка истинно. В документации по функции приведено два примера:</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:16px; color:#393939; background-color:#ffffff;">Определяет, является ли хотя бы одно из выражений в списке {true, false, 2 &gt; 0} истинным…</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#ffffff;">List.AnyTrue({true, false, 2&gt;0})</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:16px; color:#393939; background-color:#ffffff;">… и возвращает true.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:16px; color:#393939; background-color:#ffffff;">Определяет, является ли хотя бы одно из выражений в списке </span><span style=" font-family:'Courier New'; font-size:16px; color:#0000ff; background-color:#ffffff;">{2 = 0, false, 2 &lt; 0}</span><span style=" font-size:16px; color:#393939; background-color:#ffffff;"> истинным…</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#ffffff;">List.AnyTrue({2 = 0, false, 2 &lt; 0})</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:16px; color:#393939; background-color:#ffffff;">… и возвращает false.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:16px; color:#393939; background-color:#ffffff;">Попробуем использовать эту функцию в качестве теста в пользовательском столбце:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">if List.AnyTrue(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">  {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">    [Column1] = &quot;TRUE&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">    [Sold By] = &quot;FALSE&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">  }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">  &quot;TRUE&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">  &quot;FALSE&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Monaco,MonacoRegular,Courier New,monospace'; font-size:12px; font-weight:496; color:#393939; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a0c245527792"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a0c245527792-1"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">if</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">List</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">AnyTrue</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a0c245527792-2"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a0c245527792-3"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{[</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Inventory </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Item</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">]</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Talkative Parrot&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,[</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Sold </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">By</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">]</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Fred&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a0c245527792-4"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a0c245527792-5"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">then</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Meets Criteria!&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a0c245527792-6"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">else</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;No Match&quot;</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Не забудьте разделить критерии запятыми, а список критериев окружить фигурными скобками, потому что функция List.AnyTrue() в качестве параметра требует список.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#393939; background-color:#ffffff;">Репликация функции Excel И()</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Для этих целей в Power Query есть функция </span><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#ffffff;">List.AllTrue()</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">. Эта функция возвращает истинное значение только в том случае, если каждый логический тест возвращает истинное значение. В Excel щелкните правой кнопкой мыши запрос </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939; background-color:#ffffff;">pqOR</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939; background-color:#ffffff;">Дублировать</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">. Переименуйте запрос – </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939; background-color:#ffffff;">pqAND</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">. Если вы удалили столбец </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939; background-color:#ffffff;">Match</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">, удалите этот шаг, чтобы вернуть столбец </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939; background-color:#ffffff;">Match</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"> в запрос. Щелкните значок шестеренки рядом с шагом </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939; background-color:#ffffff;">Добавлен пользовательский столбец</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"> (для редактирования формулы). Заменить </span><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#ffffff;">List.AnyTrue</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"> на </span><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#ffffff;">List.AllTrue</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">. Выберите шаг Строки с примененным фильтром.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Хотя в этих примерах мы явно отфильтровали данные на основе столбца </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939; background-color:#ffffff;">Match</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">, самое замечательное в функциях </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:12pt; font-style:italic; color:#393939; background-color:#ffffff;">List.AnyTrue</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"> и </span><span style=" font-family:'Courier New'; font-size:12pt; color:#0000ff; background-color:#ffffff;">List.AllTrue</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"> заключается в том, что вы можете помечать записи без фильтрации. Это добавит вам гибкости при построении более сложной логики, с возможностью сохранения всех исходных данных (чего нельзя получить просто фильтруя столбцы).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#393939; background-color:#ffffff;">Репликация функции SWITCH() Power Pivot</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Power Pivot имеет функцию SWITCH(), которая позволяет выполнять логику с несколькими условиями. Функция ищет указанное значение индекса и возвращает соответствующий результат. Эта функция проще, чем несколько уровней вложенных операторов ЕСЛИ(), поэтому полезно реплицировать функцию SWITCH() в Power Query.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Синтаксис этой функции в PowerPivot выглядит следующим образом:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">=SWITCH(expression,value_1,result_1,[value_2,result_2],…,[Else])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:12pt; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Допустим, вы выставляете счета клиентам на основе кодированного шаблона, где каждый символ что-то значит. Например, в счете MP010450</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-weight:600; font-style:italic; color:#393939;">S</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;">P девятый символ может принимать следующие значения:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">E = Employee, S = Yacht Club, N = Non-Taxable, R = Restricted, I = Inactive, L = Social, M = Medical, U = Regular</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:12pt; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">В Excel вы можете построить формулу с многократными вложениями оператора ЕСЛИ или использовать ВПР(). В Power Pivot, это намного проще с функцией SWITCH():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">=SWITCH(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  [Column], </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;E&quot;, &quot;Employee&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;S&quot;, &quot;Yacht Club&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;N&quot;, &quot;Non-Taxable&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;R&quot;, &quot;Restricted&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;I&quot;, &quot;Inactive&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;L&quot;, &quot;Social&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;M&quot;, &quot;Medical&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;U&quot;, &quot;Regular&quot;, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">  &quot;Undefined&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#ffffff;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:12pt; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:large; font-weight:600; color:#393939; background-color:#ffffff;">Построение функции Power Query SWITCH()</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Откройте файл</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Emulating</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">SWITCH.xIsx</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;">. </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Данные</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Получить данные</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Из других источников</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Пустой запрос</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;">. Назовите запрос – </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">fnSWITCH</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;">. </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Главная</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Расширенный редактор</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;">. Введите код:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Monaco,MonacoRegular,Courier New,monospace'; font-size:12px; font-weight:496; color:#393939; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">9</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-1"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">input</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> =&gt;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-2"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">l</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">et</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-3"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">values</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-4"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">result_1</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">return_value_1</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-5"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">input</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Undefined&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-6"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-7"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Result</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">List</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">First</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">List</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Select</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">values</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">each</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">_</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#ce0000;">0</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">}</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">input</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)){</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#ce0000;">1</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-8"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">i</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">n</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a29021701641-9"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Result</span></pre></td></tr></table>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Ключевые части этого кода:</span></p>
<ul type="circle" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;" style=" margin-top:20px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; font-style:italic;">result_1</span><span style=" font-size:16px;"> – это первая из возможностей, которую вы можете передать в функцию</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; font-style:italic;">return_value_1</span><span style=" font-size:16px;"> – это значение, которое вернет функция, если первое значение = </span><span style=" font-size:16px; font-style:italic;">result_1</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Если вам нужно больше значений, вы добавляете запятую после строки {result_1, return_value_1} и вставляете строки {result_2, return_value_2}, {result_3, return_value_3} и т.д.</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Вы можете добавить столько значений, сколько вам нужно</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;" style=" margin-top:10px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Если в предоставленном списке нет переданного значения функция вернет текст </span><span style=" font-size:16px; font-style:italic;">Undefined</span><span style=" font-size:16px;"> (это часть Else конструкции SWITCH).</span></li></ul>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Используя эту структуру, вы можете изменить функцию</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">fnSWITCH</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> для нашего сценария:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff; background-color:#fdfdfd;">=fnSWITCH(Text.Range([Column1],8,1))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Помните, что вам нужно начать извлечение текста с символа 8, чтобы получить девятый символ, потому что Power Query начинает отсчет с нуля</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:12pt; color:#0000ff;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">9</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">10</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">11</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">12</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">13</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">14</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">15</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">16</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-1"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">input</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> =&gt;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-2"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">l</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">et</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-3"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">values</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-4"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;E&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Employee&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-5"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;S&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;SCYC&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-6"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;N&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Non-Taxable&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-7"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;R&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Restricted&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-8"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;I&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Inactive&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-9"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;L&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Social&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-10"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;M&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Medical&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-11"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;U&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Regular&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-12"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">input</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Undefined&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-13"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">},</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-14"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Result</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">List</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">First</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">List</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Select</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">values</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">each</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">_</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#ce0000;">0</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">}</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">input</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)){</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#ce0000;">1</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-15"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">i</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">n</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a31300816699-16"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Result</span></pre></td></tr></table>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Вы не ограничены поиском отдельных символов. Вы можете также искать значения (числа) или более длинные текстовые строки. Просто убедитесь, что ваши параметры всегда вводятся парами между фигурными скобками и имеют запятую в конце строки.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;">Когда вы закончите вносить изменения в</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Расширенном редакторе</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;">, нажмите кнопку </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Готово.</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Главная</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">Закрыть и загрузить</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;">. Теперь вы можете использовать функцию </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; font-style:italic; color:#393939;">fnSWITCH</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939;"> для извлечения типа выставленного счета из каждой записи.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:16px; color:#393939; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#393939; background-color:#ffffff;">Репликация функции Excel ВПР()</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Репликация зависит от того, какая версия ВПР/VLOOKUP вам нужна. При поиске точного совпадения репликация может быть получена простым объединением двух таблиц (см.</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><a href="https://baguzin.ru/wp/?p=21076"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#000000;">главу 9</span></a><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">). Репликация приблизительного соответствия ВПР() требует довольно сложной логики (подробнее о функции ВПР в Excel см. </span><a href="https://baguzin.ru/wp/?p=12467"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#000000;">Билл Джелен. Всё о ВПР: от первого применения до экспертного уровня</span></a><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">). В примере вы не будете создавать сценарий Power Query с нуля но увидите как он работает. Откройте файл </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Emulating</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">VLOOKUP.xlsx</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. В нем есть две таблицы:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Столбцы B:D таблицы данных содержат функции VLOOKUP() соответствующие заголовкам столбцов. Каждый столбец ищет значение, из столбца A для этой строки в таблице подстановки. Столбцы B и D возвращают значение из столбца 2 (G) таблицы подстановки, а столбец C – из столбца 3 (Н). Также обратите внимание, что столбцы B и C возвращают приблизительные совпадения, поскольку четвертый параметр функции VLOOKUP = True или опущен. Столбец D запрашивает точное совпадение (четвертый параметр = False), в результате чего все записи возвращают #N/A, за исключением последней строки.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Давайте поместим сценарий Power Query в файл, а затем посмотрим, как он реплицирует функцию VLOOKUP() Excel. В проводнике Windows кликните на файл</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">pqVLOOKUP.txt</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> Он откроется в Блокноте. Выделите и скопируйте в буфер все содержимое файла. Вернитесь в Excel. </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Данные</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Получить данные</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Из других источников</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Пустой запрос</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Расширенный редактор</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. Выделите всю заготовку кода в окне. Ctrl+V (вставив из буфера ранее скопированный код). Нажмите кнопку </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Готово. </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">Переименуйте функцию </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">pqVLOOKUP. Главная</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Закрыть и загрузить</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> (функции сохраняются только в режиме подключения).</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">При работе с функцией вам понадобится указатель на таблицу подстановки BandingLevels. Выберите любую ячейку в ней –&gt;</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Данные</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Из таблицы/диапазона</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Главная</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Закрыть и загрузить…</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Только создать подключение.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Теперь всё готово, чтобы посмотреть, как это работает. Удалите из таблицы данных (DataTable) все формулы Excel (ячейки В3:D10). Выберите любую ячейку в таблице</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">DataTable</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Данные</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Из таблицы/диапазона. </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">Щелкните правой кнопкой мыши столбец </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Values</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Удалить другие столбцы</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Рис. 22.8. Запрос готов к использованию функции</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">pqVLOOKUP</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Чтобы проверить, работает ли функция PQ VLOOKUP для вас, вы можете попробовать повторить следующую формулу: =VLOOKUP ([Values], BandingLevels, 2, true)</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Для этого можно выполнить следующие действия:</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Добавление столбца</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Настраиваемый столбец</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. Назовите столбец </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">2,True</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. Используйте формулу:</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">=pqVLOOKUP([Values],BandingLevels,2,true)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Рис. 22.9. Репликация VLOOKUP() с четвертым параметром равным true</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Снова перейдите на вкладку</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Добавление столбца</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Настраиваемый столбец</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. Назовите столбец </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">3,default</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. Используйте формулу:</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">=pqVLOOKUP([Values],BandingLevels,3)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Рис. 22.10. Репликация VLOOKUP() с опущенным четвертым параметром (по умолчанию = true, приблизительное совпадение)</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Теперь определите точное совпадение со вторым столбцом таблицы подстановки.</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Добавление столбца</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Настраиваемый столбец</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. Назовите его </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">2,false</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">. Используйте формулу:</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">=pqVLOOKUP([Values],BandingLevels,2,false)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Рис. 22.11 Репликация VLOOKUP() с точным совпадением</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Несмотря на то, что вы можете использовать эту функцию для эмуляции точного соответствия VLOOKUP(), лучше этого не делать, а воспользоваться объединением таблиц. Завершите запрос.</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Главная</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;"> –&gt; </span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-style:italic; color:#393939;">Закрыть и загрузить</span><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;">.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Вы должны знать об одном незначительном отличии между функцией VLOOKUP() Excel и pqVLOOKUP Power Query: значение #N/A, возвращаемое pqVLOOKUP, на самом деле является текстом, а не значением ошибки. Поскольку истинную ошибку #N/A в Power Query вернуть нельзя.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.68421%; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:600; color:#393939; background-color:#ffffff;">Понимание функции pqVLOOKUP</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Взгляните на код:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Monaco,MonacoRegular,Courier New,monospace'; font-size:8.25pt; font-weight:496; color:#393939; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">9</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">10</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">11</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">12</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">13</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">14</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">15</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">16</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">17</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">18</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">19</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">20</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">21</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">22</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">23</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">24</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">25</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">26</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">27</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">28</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">29</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">30</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">31</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">32</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">33</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">34</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">35</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">36</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">37</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">38</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">39</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">40</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">41</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">42</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">43</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">44</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#5499de;">45</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-1"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">lookup_value </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">as</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">any</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">table_array </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">as</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">col_index_number </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">as</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">number</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-2"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">o</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">ptional approximate_match </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">as</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#000000;">logical</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">)</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">as</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">any</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> =&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-3"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">l</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">et</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-4"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ff8000;">/*Provide optional match if user didn’t */</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-5"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">matchtype</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> =</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-6"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">if</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">approximate_match</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">null</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-7"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">then</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">true</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-8"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">else</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">approximate_match</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-9"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-10"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ff8000;">/*Get name of return column */</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-11"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Cols</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">ColumnNames</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">table_array</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-12"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ColTable</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">FromList</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Cols</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Splitter</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">SplitByNothing</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(),</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">null</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-13"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">null</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ExtraValues</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Error</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-14"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ColName_match</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Record</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">Field</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">ColTable</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ce0000;">0</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">},</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#008000;">&quot;Column1&quot;</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-15"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ColName_return</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Record</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">Field</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">ColTable</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">col_index_number</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> - </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ce0000;">1</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">},</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-16"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#008000;">&quot;Column1&quot;</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-17"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-18"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ff8000;">/*Find closest match */</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-19"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">SortData</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">Sort</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">table_array</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-20"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">{{</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ColName_match</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Order</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Descending</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">}}),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-21"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">RenameLookupCol</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> =</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-22"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">RenameColumns</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">SortData</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,{{</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ColName_match</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#008000;">&quot;Lookup&quot;</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">}}),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-23"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">RemoveExcess</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">SelectRows</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-24"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">RenameLookupCol</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">each</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">[</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Lookup</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">]</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> &lt;= </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">lookup_value</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-25"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ClosestMatch</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">=</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-26"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">if</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">IsEmpty</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">RemoveExcess</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">)</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">true</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-27"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">then</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#008000;">&quot;#N/A&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-28"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">else</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Record</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">Field</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">RemoveExcess</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ce0000;">0</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">},</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#008000;">&quot;Lookup&quot;</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-29"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-30"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ff8000;">/*What should be returned in case of approximate match? */</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-31"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ClosestReturn</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">=</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-32"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">if</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Table</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">IsEmpty</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">RemoveExcess</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">)</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">true</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-33"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">then</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#008000;">&quot;#N/A&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-34"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">else</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">Record</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">Field</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">RemoveExcess</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">{</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ce0000;">0</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">},</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">ColName_return</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#333333;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-35"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-36"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#ff8000;">/*Modify result if we need an exact match */</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-37"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">Return</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> =</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-38"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">if</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">matchtype</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">=</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">true</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-39"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">then</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">ClosestReturn</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-40"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">     </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-41"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">        </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">if</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#002d7a;">lookup_value</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">ClosestMatch</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-42"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">        </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">then</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">ClosestReturn</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-43"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#004ed0;">        </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">else</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#008000;">&quot;#N/A&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-44"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">i</span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">n</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-620410b1a8a14608873084-45"></a><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#006fe0;">  </span><span style=" font-family:'inherit'; font-size:8.25pt; font-weight:496; color:#800080;">Return</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Код довольно длинный и сложный, и он использует множество трюков, но основная методология следующая:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;" style=" margin-top:20px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Втяните таблицу подстановки в Power Query.</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Отсортируйте ее по убыванию по первому столбцу.</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Удалите все записи, превышающие искомое значение.</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Верните значение в запрошенном столбце таблицы данных для первой оставшейся записи, если не указано точное соответствие.</span></li>
<li style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939;" style=" margin-top:10px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Если было указано точное соответствие, проверьте, соответствует ли возврат. Если это так, верните значение. Если это не так, верните #N/A.</span></li></ol>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Для каждого параметра функции в первой строке кода объявлен тип данных. Это делается для предотвращения проблем, если случайно в таблице подстановки заголовки будут числами.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Переменная approximate_match определена как необязательная (optional); пользователь может игнорировать ее.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Переменная matchtype проверяет, был ли указан тип соответствия. Если он был указан, именно он присваивается переменной matchtype, если не был указан (approximate_match равен null), то присваивается значение true.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Имя возвращаемого столбца извлекается путем просмотра заголовков столбцов таблицы, разбиения их на список записей и извлечения записи, индекс которой соответствует запрошенному столбцу (на 1 меньше, так как отсчет начинается с 0).</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Данные сортируются в порядке убывания, в зависимости от столбца для поиска. Все записи, превышающие запрошенное значение, удаляются (путем выбора всех строк, где значение меньше или равно искомому значению).</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Если строк не осталось, возвращается #N/А, если есть хотя бы одна строка, возвращается первая запись в столбце поиска. Этот результат может быть позже проверен, чтобы увидеть, соответствует ли он искомой записи (что важно для точного соответствия).</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Затем вычисляется приблизительное значение соответствия, даже если было запрошено точное соответствие. Если в наборе данных нет строк, сохраняется результат #N/A; в противном случае из возвращаемого столбца извлекается ближайшее значение.</span></p>
<p style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Graphik,-apple-system,BlinkMacSystemFont,Segoe UI,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#393939; background-color:#ffffff;">Последний тест проверяет тип запрошенного соответствия. Если это приблизительное совпадение, то возвращается самое близкое совпадение (которое может быть #N/A). Если тип соответствия был точным, код вернет #N/A вместо ближайшего соответствия, если значение столбца подстановки не соответствует точно искомому значению.</span></p></body></html>