<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; color:#000000; background-color:#ffffff;">Импорт данных в Python – чтение и запись файлов Excel</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Всем привет! Уверен, что подавляющее большинство читателей этой статьи интересует анализ данных. Иначе вас бы здесь не было! Но для начала данные необходимо импортировать в Python. Помимо баз данных, средством решения этой задачи являются файлы. В сфере науки о данных чаще всего используются файлы в формате csv (значения, разделённые запятыми), но нередко можно встретить и формат xlsx, потому что почти во всех компаниях Excel по-прежнему является самой популярной программой для редактирования таблиц.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Я покажу вам, как читать файлы Excel с помощью Python. При правильном выборе библиотек это совсем не сложно.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">Python: чтение файлов Excel</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Вариантов довольно много. То есть, добавить файлы xlsx в Python можно несколькими способами. Если вам нужно просто и быстро достать данные из файла Excel, то лучше всего подойдёт библиотека </span><span style=" font-family:'inherit'; font-size:18px; font-weight:600; color:#333333;">pandas</span><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">. Если требуется более высокий уровень контроля, или вы собираетесь считывать формулы, стоит воспользоваться пакетами </span><span style=" font-family:'inherit'; font-size:18px; font-weight:600; color:#333333;">xlrd</span><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;"> или </span><span style=" font-family:'inherit'; font-size:18px; font-weight:600; color:#333333;">openpyxl</span><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">. Фактически, для доступа к данным Excel библиотека pandas использует xlrd в фоновом режиме.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Файл Jupyter Notebook с кодом для всех трёх вариантов можно найти </span><a href="https://databraineo.com/wp-content/uploads/2019/10/Excel-einlesen.ipynb"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">по этой ссылке</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">.</span></p>
<p style=" margin-top:24px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="импорт-файлов-xlsx-с-помощью-pandas"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">И</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">мпорт файлов xlsx с помощью Pandas</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Одним из популярных способов чтения файлов Excel в Python является функция read_excel из pandas. Если вы занимаетесь “наукой о данных” и работаете с Python, библиотека pandas в любом случае незаменима. Функция read_excel способна обрабатывать файлы xls (старый формат) и xlsx, а также записывать содержимое в DataFrame.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">import</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pandas</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">as</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pd</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">df</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pd.read_excel(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;Имя файла&quot;</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">У этой функции есть целый ряд параметров, наиболее важные из которых перечислены ниже:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">sheet_name</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Здесь можно ввести числовое значение (начиная с 0) или название электронной таблицы. По умолчанию считывается первая таблица в файле. Если в качестве значения указать список, то будет возвращён словарь датафреймов (см. ниже).</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">skiprows</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Если вам требуется пропустить первые строки (обычное дело с таблицами Excel, поскольку очень часто сверху в них находится заголовок и описание), сделать это можно с помощью данного параметра, просто указав, сколько строк вы хотите пропустить. Как обычно в Python, отсчёт начинается с нуля, т.е. если вам нужно начать с 4-й строки, используйте skiprows=3.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">header</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Строка, содержащая “хедер”, т.е. заголовки столбцов. При установленном значении “0” используется первая строка. Если у столбцов не должно быть заголовков, установите значение “None”.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">names</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Этот параметр позволяет передать в функцию список с именами столбцов</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">usecols</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Если вы хотите вывести только конкретные столбцы, их нужно указать здесь. Лучший вариант в этом случае – передать список с номерами или названиями столбцов.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">dtype</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Если вам надо использовать типы данных, которые могут отличаться от автоматически распознанных, подставьте к этому параметру словарь, где указаны конкретные типы данных для конкретных столбцов.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">nrows</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Если не хотите считывать все строки, можете ограничить их число с помощью параметра nrows.</span></li></ul>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Перечисленные параметры должны охватить большинство возможных сценариев использования. Если вам потребуется более специализированная информация, посмотрите </span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">справочные материалы по API read_excel</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">.</span></p>
<p style=" margin-top:21px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="импорт-одновременно-нескольких-листов-файла-excel"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:medium; font-weight:600; color:#666666;">И</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:medium; font-weight:600; color:#666666;">мпорт одновременно нескольких листов файла Excel</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Как указано в описании параметра sheet_name, он позволяет указать список номеров или названий рабочих листов. В этом случае вы получите не датафрейм, а словарь датафреймов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">Map</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pd.read_excel(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;Example-Excel.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">sheet_name</span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Таблица1'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Таблица2'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Таблица3'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">],</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">skiprows</span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">3</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">print</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">(</span><span style=" font-family:'Consolas'; font-size:18px; color:#b58900;">type</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">(Map))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">print</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">(Map.keys())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">print</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">(Map[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Таблица3'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">].head())</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:24px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="импорт-данных-excel-с-помощью-пакета-xlrd"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">И</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">мпорт данных Excel с помощью пакета XLRD</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">При использовании пакета </span><a href="https://xlrd.readthedocs.io/en/latest/"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">xlrd</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;"> вы получаете гораздо больше контроля над таблицами Excel, но и разобраться с ним немного сложнее. Однако в настоящее время разработка прекращена. На его </span><a href="https://github.com/python-excel/xlrd"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">странице в GitHub</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;"> говорится, что лучше использовать openpyxl.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Помимо xlrd, предназначенной для чтения, есть ещё библиотеки xlwt для записи файлов xls (Excel 97 – 2003) и xlutils для редактирования современных файлов Excel.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Первым делом надо открыть файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">xlrd.open_workbook(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;Example-Excel.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">С помощью функции sheet_names вы получаете названия таблиц</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">sheet_names</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb.sheet_names()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">После этого к таблице можно обратиться по её названию, например:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">Tab1</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb.sheet_by_name(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Таблица1'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://xlrd.readthedocs.io/en/latest/api.html"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">API xlrd</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;"> имеет очень логичную структуру и людям, обладающим некоторым опытом взаимодействия с API, несложно будет в нём разобраться.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">В модуль </span><span style=" font-family:'inherit'; font-size:18px; font-weight:600;">book</span><span style=" font-size:18px;"> входят все инструменты, которые нужны для работы со всей книгой. Класс xlrd.book.Book хранит её содержимое.</span></li>
<li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">В модуль </span><span style=" font-family:'inherit'; font-size:18px; font-weight:600;">sheet</span><span style=" font-size:18px;"> входят все инструменты для работы с отдельными рабочими листами. И соответствующий класс xlrd.sheet.Sheet хранит содержимое рабочего листа</span></li>
<li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Стоит также упомянуть модуль </span><span style=" font-family:'inherit'; font-size:18px; font-weight:600;">formatting</span><span style=" font-size:18px;">, который позволяет считать форматирование файла</span></li>
<li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Модуль </span><span style=" font-family:'inherit'; font-size:18px; font-weight:600;">formula</span><span style=" font-size:18px;"> (обратите внимание) работает не с формулами каждой ячейки, а с менеджером имен. Если вы хотите прочитать формулы из отдельных ячеек, это делается с помощью openpyxl, а</span></li>
<li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:18px; font-weight:600;">xldate</span><span style=" font-size:18px;"> помогает разобраться с датой и временем</span></li></ul>
<p style=" margin-top:24px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="пакет-openpyxl-чтение-файлов-excel"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">П</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">акет Openpyxl: чтение файлов Excel</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Если вам нужно не просто прочитать данные, а сделать что-то ещё, можете воспользоваться пакетом openpyxl. Хотя лично мне больше по душе pandas.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Здесь открыть и просмотреть книгу Excel тоже очень легко.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">from</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">openpyxl</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">import</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">load_workbook</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb2</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">load_workbook(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;Example-Excel.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Флаг </span><span style=" font-family:'inherit'; font-size:18px; font-style:italic; color:#333333;">data_only</span><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;"> позволяет указать, что будет считываться – формулы или вычисляемые значения. По умолчанию стоит data_only = False, поэтому считываются формулы.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">К сожалению, пакет не поддерживает изображения и диаграммы, поэтому с помощью openpyxl не получится модифицировать шаблоны или вставлять данные в существующие дэшборды на основе Excel. Подходящим инструментом для этого является </span><a href="https://www.xlwings.org/"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">xlwings</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">, разговор о котором будет чуть позже.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Но давайте вернёмся к openpyxl. Каждая книга Excel содержит рабочие листы, к которым можно легко обращаться по имени</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">print</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">(wb2.sheetnames)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb2[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Таблица1'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">for</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">i</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">in</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws.values:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">print</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">(i)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Если надо преобразовать данные в датафрейм pandas, это делается следующим образом. В приведённом примере таблица начинается с четвёртой строки.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">import</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pandas</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">as</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pd</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">df</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pd.DataFrame(ws.values)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">df.columns</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">df.iloc[[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">3</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">]].values.tolist()[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">df</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">df[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">4</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">:]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">df.head()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Опять же, вот ещё ссылка на </span><a href="https://openpyxl.readthedocs.io/en/stable/"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">документацию openpyxl</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">. Также вас может заинтересовать глава 12 в бесплатной книге </span><a href="https://automatetheboringstuff.com/chapter12/"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">Automate the boring stuff</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">, там речь идёт как раз о применении пакета openpyxl.</span></p>
<p style=" margin-top:29px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="python-сохранение-файлов-excel"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:x-large; font-weight:600; color:#222222;">P</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:x-large; font-weight:600; color:#222222;">ython: сохранение файлов Excel</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Логично предположить, что помимо чтения файлов Excel нам в какой-то момент понадобится возможность их сохранять. Файл Jupyter Notebook с кодом для всех трёх вариантов можно найти </span><a href="https://databraineo.com/wp-content/uploads/2019/10/Excel-speichern.ipynb"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#4183c4;">по этой ссылке</span></a><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">.</span></p>
<p style=" margin-top:24px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="запись-датафрейма-в-файл-xlsx-с-помощью-pandas"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">З</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">апись датафрейма в файл XLSX с помощью Pandas</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Опять же, с помощью pandas записать датафрейм в файл Excel очень легко. За это отвечает функция to_excel, как в следующем примере</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">diamonds.to_excel(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;Diamonds.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">sheet_name</span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Diamonds'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Для индивидуализации можно использовать следующие параметры. На самом деле их больше, но остальные нам пока не нужны.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">na_rep</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Как должны отображаться отсутствующие значения. По умолчанию стоит пустая строка.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">float_format</span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Здесь можно задать формат для количества знаков после запятой.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">columns</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Если вы хотите вывести не все столбцы, это можно указать здесь.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">header</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">True</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Определяет, будут ли выводиться названия столбцов. В качестве значения также можно указать список названий.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">index</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">True</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Этот флаг позволяет указать, нужно записывать индекс строки или нет.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">index_label</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#268bd2;">None</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Название индексного столбца.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">startrow</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Строка в файле Excel, начиная с которой будет записываться таблица.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">startcol</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;" style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Столбец в файле Excel, начиная с которого будет записываться таблица.</span></li></ul>
<p style=" margin-top:21px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="запись-нескольких-таблиц-в-один-файл-excel"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:medium; font-weight:600; color:#666666;">З</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:medium; font-weight:600; color:#666666;">апись нескольких таблиц в один файл Excel</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Для pandas и это не является проблемой. Нужно только вооружиться функцией ExcelWriter. Вот как это работает:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">with</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">pd.ExcelWriter(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'test.xlsx'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">as</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">writer:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">iris.to_excel(writer,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">sheet_name</span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'iris'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">tips.to_excel(writer,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">sheet_name</span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'tips'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:24px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="запись-файлов-excel-с-помощью-xlwt"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">З</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">апись файлов Excel с помощью XLWT</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Запись файла xls (обратите внимание, что модуль xlwt не поддерживает новый формат xlsx, который используется в Excel начиная с версии 2007).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">import</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">xlwt</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">from</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">datetime</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">import</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">datetime</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">xlwt.Workbook()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb.add_sheet(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Таблица1'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">datumStyle</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">xlwt.easyxf(num_format_str</span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'DD.MM.YYYY'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws.write(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">1</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws.write(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">1</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">1</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws.write(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">2</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">xlwt.Formula(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;A1+B1&quot;</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws.write(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">1</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">0</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">datetime.now(),datumStyle)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws.write(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">1</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">2</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">3.1415</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb.save(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'Example-xlwt.xls'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:24px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.7%;"><a name="запись-файлов-excel-с-помощью-openpyxl"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">З</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:large; font-weight:600; color:#222222;">апись файлов Excel с помощью Openpyxl</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Запись файла тоже не вызывает никаких проблем:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">from</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">openpyxl</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">import</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">Workbook</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">Workbook()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#586e75;"># ...Заполнение книги…</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb.save(</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">&quot;Example-openpyxl.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Помимо прочего, вы можете делать, например, следующее:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#586e75;"># Активировать первую таблицу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">wb.active</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#586e75;"># Писать можно прямо в ячейках</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'C1'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">]</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">3.1415</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#586e75;"># Также можно прикреплять целые строки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws.append([</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">1</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">2</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">,</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">3</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#586e75;"># Ячейки с датами тоже работают</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">import</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">datetime</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">ws[</span><span style=" font-family:'Consolas'; font-size:18px; color:#2aa198;">'E2'</span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">]</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#859900;">=</span><span style=" font-family:'Consolas'; font-size:18px; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:18px; color:#93a1a1;">datetime.datetime.now()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Helvetica,Arial,sans-serif'; font-size:10px; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">Заключение по теме работы с файлами Excel с использованием Python</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Подводя итог, можно сказать следующее:</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Если вам требуется только читать таблицы или записывать их в файлы Excel, ваш вариант – pandas. В нём простая в использовании функция импорта/экспорта, да и фирменный тип данных DataFrame от pandas является идеальным для дальнейшей обработки данных.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Если вам нужен более высокий уровень контроля, и вы хотите считывать или редактировать отдельные ячейки, а также форматировать их и т.д., вам подойдёт openpyxl. Если по какой-то неведомой причине вам всё ещё приходится использовать формат xls (некоторые компании до сих пор от него не отказались), возьмите xlrt/xlwt/xlutils.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Надеюсь, вы почерпнули из этой статьи что-то полезное. Напишите в комментариях, какой из пакетов вы предпочитаете использовать. А если вы хотите помочь распространению знаний из области Data Science и поддержать меня в этом начинании, то поделитесь данным постом у себя в Twitter или Facebook.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">Удачи в работе с Excel!</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; color:#333333;">https://databraineo.com/ki-training-resources/python/datenimport-in-python-excel-dateien-einlesen-und-schreiben/</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Helvetica,Arial,sans-serif'; font-size:18px; font-style:italic; color:#666666; background-color:#ffffff;">Written on December 31, 2022</span></p></body></html>