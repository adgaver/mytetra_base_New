<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Шаг 122 - Метод GetRows</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_0_expand"></a>Описание<br />Загружает строки объекта <span style=" font-weight:600;">Recordset</span> в массив.<br /></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Set имяМассива = наборЗаписей.GetRows (числоСтрок)</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Параметры<br /><span style=" font-weight:600;">имяМассива</span><br />Имя переменной типа <span style=" font-weight:600;">Variant</span>, в которой сохраняются возвращаемые данные.<br /><span style=" font-weight:600;">наборЗаписей</span><br />Объектная переменная, представляющая объект <span style=" font-weight:600;">Recordset</span>.<br /><span style=" font-weight:600;">числоСтрок</span><br />Выражение или переменная типа <span style=" font-weight:600;">Variant</span>, задающая число возвращаемых строк.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Замечания<br />Метод <span style=" font-weight:600;">GetRows</span> используется для копирования записей из объекта <span style=" font-weight:600;">Recordset</span> в двумерный массив. Первый индекс массива определяет поле, а второй номер строки, как в следующей примере, где <span style=" font-weight:600;">intField</span> представляет поле, а <span style=" font-weight:600;">intRecord</span> задает номер строки:<br /></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">avarRecords(intField, intRecord)</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Для того чтобы возвратить значение первого поля во второй записи, следует использовать такие значения индексов: </p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">field1 = avarRecords(0,1)</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Значение второго поля в первой записи возвращается с помощью следующей инструкции: </p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">field2 = avarRecords(1,0)</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">При возвращении данных методом <span style=" font-weight:600;">GetRows</span> переменная <span style=" font-weight:600;">avarRecords</span> автоматически превращается в двумерный массив.<br />Если число затребованных строк превышает действительное число строк, возвращаются только имеющиеся строки. Для определения реально возвращенного методом <span style=" font-weight:600;">GetRows</span> числа строк следует вызвать функцию языка <span style=" font-weight:600;">Visual Basic</span> для приложений <span style=" font-weight:600;">UBound</span>, поскольку массив переменного размера позволяет уместить столько строк, сколько было возвращено. Например, если результаты возвращаются в переменную тип <span style=" font-weight:600;">Variant</span> с именем <span style=" font-weight:600;">varA</span>, определить число возвращенных строк позволяет следующая инструкция:<br /></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">numReturned = UBound(varA,2) + 1</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Единицу следует добавить, поскольку нумерация элементов массива начинается с нуля. Число возвращаемых строк ограничивается только доступной памятью и должно выбираться в соответствии с реальными потребностями. Не рекомендуется копировать всю таблицу в массив с помощью метода <span style=" font-weight:600;">GetRows</span>, особенно, если это большая таблица.<br />Поскольку в массив записывается содержимое всех полей объекта <span style=" font-weight:600;">Recordset</span>, в том числе содержимое полей типа <span style=" font-weight:600;">Memo</span> и <span style=" font-weight:600;">Long Binary</span>, полезно сначала выполнить запрос, ограничивающий число возвращаемых полей.<br />После вызова метода <span style=" font-weight:600;">GetRows</span> указатель текущей записи переводится на следующую несчитанную строку. Это означает, что в смысле размещения записи вызов <span style=" font-weight:600;">GetRows</span> эквивалентен выполнению метода <span style=" font-weight:600;">Move</span> на указанное числоСтрок.<br />Если делается попытка загрузить все строки с помощью многократных вызовов метода <span style=" font-weight:600;">GetRows</span>, следует с помощью свойства <span style=" font-weight:600;">EOF</span> убедиться, что достигнут конец объекта <span style=" font-weight:600;">Recordset</span>. Метод <span style=" font-weight:600;">GetRows</span> возвращает меньше строк, чем запрашивалось, либо в конце набора записей, либо при невозможности загрузить какую-либо строку из запрашиваемого диапазона. Например, если не удалось загрузить пятую запись из запрашиваемых десяти записей, <span style=" font-weight:600;">GetRows</span> возвратит четыре записи и оставит текущей запись, с которой возникли проблемы. Ошибка выполнения при этом не генерируется. Такая ситуация может возникнуть, если запись удалена другим пользователем из объекта <span style=" font-weight:600;">Recordset</span> типа динамического набора записей. Такая ситуация иллюстрируется в примере.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Пример<br />Следующая программа использует метод <span style=" font-weight:600;">GetRows</span> для загрузки указанного числа строк из объекта <span style=" font-weight:600;">Recordset</span> и заполнения массива полученными данными. Метод <span style=" font-weight:600;">GetRows</span> возвращает менее указанного числа строк в двух случаях: при обнаружения метки конца файла <span style=" font-weight:600;">EOF</span> или при попытке загрузки записи, удаленной другим пользователем. Функция возвращает <span style=" font-weight:600;">False</span> только в последнем случае. Для выполнения этой процедуры требуется функция <span style=" font-weight:600;">GetRowsOK</span>.<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Sub GetRowsX()</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Dim dbsNorthwind As Database</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Dim rstEmployees As Recordset</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Dim strMessage As String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Dim intRows As Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Dim avarRecords As Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Dim intRecord As Integer</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Set dbsNorthwind = OpenDatabase(&quot;Борей.mdb&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Set rstEmployees = dbsNorthwind.OpenRecordset( 	&quot;SELECT Имя, Фамилия, Должность &quot; &amp; 	&quot;FROM Сотрудники ORDER BY Фамилия&quot;, dbOpenSnapshot)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	With rstEmployees</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">		Do While True</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			</span><span style=" font-family:'Courier New'; font-style:italic;">' Принимает от пользователя число строк.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			strMessage = &quot;Введите число загружаемых строк.&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			intRows = Val(InputBox(strMessage))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			If intRows &lt;= 0 Then Exit Do</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			</span><span style=" font-family:'Courier New'; font-style:italic;">' При успешном выполнении GetRowsOK печатает результаты;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">			' при обнаружении конца файла ничего не делается.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			If GetRowsOK(rstEmployees, intRows, avarRecords) Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				If intRows &gt; UBound(avarRecords, 2) + 1 Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">					Debug.Print &quot;(Недостаточно записей в объекте &quot; &amp; &quot;Recordset для загрузки &quot; &amp; intRows &amp; &quot; строк.)&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				Debug.Print UBound(avarRecords, 2) + 1 &amp; &quot; записей обнаружено.&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				</span><span style=" font-family:'Courier New'; font-style:italic;">' Печатает загруженные данные.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				For intRecord = 0 To UBound(avarRecords, 2)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">					Debug.Print &quot;    &quot; &amp; 	avarRecords(0, intRecord) &amp; &quot; &quot; &amp; _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">						avarRecords(1, intRecord) &amp; &quot;, &quot; &amp; avarRecords(2, intRecord)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				Next intRecord</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				</span><span style=" font-family:'Courier New'; font-style:italic;">' В предположении, что GetRows возвращает ошибку </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">				' из-за изменения данных другим пользователем, </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">				' вызывает метод Requery для обновления </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">				' объекта Recordset и возобновления операции.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				If .Restartable Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">					If MsgBox(&quot;Ошибка в методе GetRows. Повторить?&quot;, vbYesNo) = vbYes Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">						.Requery</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">					Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">						Debug.Print &quot;Ошибка в методе GetRows!&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">						Exit Do</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">					End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">					Debug.Print &quot;Ошибка в методе GetRows! &quot; &amp; &quot;Неверное значение свойства Restartable!&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">					Exit Do</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">				End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			End If</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			</span><span style=" font-family:'Courier New'; font-style:italic;">' Так как после вызова GetRows указатель текущей записи</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">			' остается на последней проверенной записи, переводит</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">			' указатель в начало объекта Recordset перед</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">			' выполнением нового цикла поиска.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">			.MoveFirst</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">		Loop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	End With</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	rstEmployees.Close</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	dbsNorthwind.Close</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">End Sub</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Function GetRowsOK(rstTemp As Recordset, intNumber As Integer, avarData As Variant) As Boolean</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	</span><span style=" font-family:'Courier New'; font-style:italic;">' Сохраняет результаты вызова GetRows в массиве.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	avarData = rstTemp.GetRows(intNumber)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	</span><span style=" font-family:'Courier New'; font-style:italic;">' Возвращает False, только если возвращено менее указанного</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">	' количества строк, но не при достижении конца объекта </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-style:italic;">	' Recordset.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	If intNumber &gt; UBound(avarData, 2) + 1 And 	Not rstTemp.EOF Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">		GetRowsOK = False</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">		GetRowsOK = True</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">	End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">End Function</span></pre></body></html>