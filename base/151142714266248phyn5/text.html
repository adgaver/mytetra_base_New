<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Шаг 159 - Метод CreateField</span></p>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_1_expand"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">О</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">писание<br />Создает новый объект </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (только в рабочей области ядра </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Microsoft Jet</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">).<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">Set поле = объект.CreateField (имя, тип, размер)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Параметры<br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">поле</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Объектная переменная, задающая создаваемый объект </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.<br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">объект</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Объектная переменная, задающая объект </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Index</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Relation</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> или </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">TableDef</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, в котором создается новый объект </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.<br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">имя</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Необязательный. Выражение или переменная типа </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Variant</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (подтип </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">String</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">), содержащая уникальное имя нового объекта </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Сведения о допустимых именах полей приведены в разделе о свойстве Name.<br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">тип</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Необязательный. Константа, определяющая тип данных нового объекта </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Сведения о допустимых константах определения типа данных приведены в разделе о свойстве </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Type</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.<br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">размер</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Необязательный. Выражение или переменная типа </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Variant</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (подтип </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Integer</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">), определяющая в байтах максимальный размер объекта </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, содержащего текстовые значения. Сведения о допустимых значениях аргумента размер приведены в разделе о свойстве </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Size</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Для числовых полей и текстовых полей постоянной длины данный аргумент игнорируется.<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Замечания<br />Метод </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">CreateField</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> используется для создания нового поля и для указания имени, типа данных и размера поля. Если опустить какие-либо элементы синтаксиса при вызове метода </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">CreateField</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, то можно задать или изменить значения соответствующего свойства с помощью инструкции присваивания перед добавлением нового объекта в семейство. После добавления нового объекта в семейство допускается изменение значений некоторых (но не всех) свойств поля. Дополнительные сведения приведены в разделах, посвященных отдельным свойствам.<br />Аргументы тип и размер применимы только к объектам </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, описывающим поля объектов </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">TableDef</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Для объектов </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, описывающих поля объектов </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Index</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Relation</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, эти аргументы игнорируются.<br />Если аргумент имя указывает на объект, который уже добавлен в семейство, то при вызове метода </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Append</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> возникает ошибка выполнения.<br />Для удаления объекта </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> из семейства </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Fields</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> следует применить к семейству метод </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Delete</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Не допускается удаление объекта </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> из семейства </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Fields</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> объекта TableDef после создания индекса, включающего данное поле.<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Пример<br />Следующая программа использует метод </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">CreateField</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> для создания трех объектов </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> в новом объекте </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">TableDef</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Далее отображаются свойства объектов </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, которые автоматически задаются в методе </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">CreateField</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. (Свойства, значения которых остаются пустыми при создании объектов </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Field</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, не отображаются).<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub CreateFieldX()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Dim dbsNorthwind As Database</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Dim tdfNew      As TableDef</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Dim fldLoop     As Field</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Dim prpLoop     As Property</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Set dbsNorthwind = OpenDatabase(&quot;Борей.mdb&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Set tdfNew = dbsNorthwind.CreateTableDef(&quot;NewTableDef&quot;)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    ' Создает и добавляет новый объект Field</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    ' в новый объект TableDef.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    With tdfNew</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        ' Метод CreateField задает стандартный размер для нового</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        ' объекта Field, если размер не указан.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        .Fields.Append .CreateField(&quot;ТекстовоеПоле&quot;, dbText)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        .Fields.Append .CreateField(&quot;ЦелоеПоле&quot;, dbInteger)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        .Fields.Append .CreateField(&quot;ПолеДаты&quot;, dbDate)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    End With</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    dbsNorthwind.TableDefs.Append tdfNew</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Debug.Print &quot;Свойства новых полей в &quot; &amp; tdfNew.Name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    ' Отображает семейство Fields, чтобы показать свойства</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    ' новых объектов Field.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    For Each fldLoop In tdfNew.Fields</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        Debug.Print &quot;    &quot; &amp; fldLoop.Name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        For Each prpLoop In fldLoop.Properties</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">            ' Свойства, недопустимые в контексте семейства</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">            ' TableDefs вызовут ошибку при попытке</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">            ' прочитать их значения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">            On Error Resume Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">            Debug.Print &quot;        &quot; &amp; prpLoop.Name &amp; &quot; - &quot; &amp; IIf(prpLoop = &quot;&quot;, &quot;[empty]&quot;, prpLoop)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">            On Error GoTo 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">        Next prpLoop</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    Next fldLoop</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    ' Удаляет объект TableDef, созданный только для демонстрации.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    dbsNorthwind.TableDefs.Delete tdfNew.Name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">    dbsNorthwind.Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<hr />
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.firststeps.ru/vba/vbahelp/daohelp/r.php?158"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Предыдущий Шаг</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> | </span><a href="http://www.firststeps.ru/vba/vbahelp/daohelp/r.php?160"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Следующий Шаг</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> | </span><a href="http://www.firststeps.ru/vba/vbahelp/daohelp/daohelp4.html"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Оглавление</span></a></p></body></html>