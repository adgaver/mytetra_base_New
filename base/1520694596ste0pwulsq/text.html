<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">InputBox - оператор VBA для получения входных данных от пользователя процедуры</span><span style=" font-family:'DejaVu Sans'; font-weight:600;">			</span><span style=" font-family:'DejaVu Sans';">			</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">В предыдущей статье &quot;</span><a href="http://macros-vba.ru/knigi/vba/121-literalnye-imenovannye-i-vnutrennie-konstanty-vba"><span style=" font-family:'DejaVu Sans'; font-style:italic; text-decoration: underline; color:#0000ff;">Литеральные, именованные и внутренние константы VBA</span></a><span style=" font-family:'DejaVu Sans';">&quot; рассматривались процедуры для вычисления длины окружности и площади круга. Значение радиуса, принимающего участие в расчетах, задавалось непосредственно в исходном коде процедуры. Изменим этот код таким образом, чтобы процедура стала интерактивной. Интерактивная процедура - это процедура, которая обменивается с пользователем информацией, получая от него входные данные и отображая различные сообщения. Получение данных от пользователя, сохранение этих данных в переменных, выполнение над ними различных действий и отображение результатов этих действий являются основными элементами, которые необходимы для написания интерактивных процедур. Данные, получаемые от пользователя, принято называть входными данными (input). Для получения входных данных используется функция InputBox либо пользовательская форма (об этом позднее).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Функцией называется специальный тип процедуры VBA, возвращающей некоторое значение. Функция InputBox выводит на дисплей диалоговое окно, которое содержит командные кнопки OK и Cancel, текстовое поле для ввода входных данных и некоторый текст, который запрашивает у пользователя ввод этих данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Ниже приведен программный код процедуры, которая вычисляет площадь круга, при этом радиус круга запрашивает у пользователя процедуры.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">01.Const Pi As Single = 3.1415</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">02.Dim CircleArea As Single</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">03.Sub Circle_Area_04()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">04.Const Title As String = &quot;Площадь круга&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">05.Dim Radius As Single, Temp As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">06.Temp = InputBox(&quot;Введите радиус круга&quot;, Title)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">07.If Temp &lt;&gt; &quot;&quot; Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">08.Radius = CSng(Temp)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">09.CircleArea = Pi * (Radius * Radius)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">10.MsgBox CircleArea, , Title</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">11.Else: MsgBox &quot;Вы отказались от ввода данных!&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">12.End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00007f;">13.End Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">В общем случае функция InputBox имеет следующий синтаксис:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">stringvar=InputBox (Prompt [, Title] [, Default] [, XPos] [, YPos] [, HelpFile] [, Context])</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">где </span><span style=" font-family:'DejaVu Sans'; font-style:italic;">stringvar</span><span style=" font-family:'DejaVu Sans';"> - любая переменная, сохраняющая строку;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">Prompt -</span><span style=" font-family:'DejaVu Sans';"> любое строковое выражение, содержащее информацию, выводимую в диалоговом окне (единственный обязательный аргумент этой функции);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">Title</span><span style=" font-family:'DejaVu Sans';"> - строка для заголовка диалогового окна;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">Default</span><span style=" font-family:'DejaVu Sans';"> - строковое выражение, использующееся как значение по умолчанию для пользовательского ввода;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">XPos</span><span style=" font-family:'DejaVu Sans';"> - горизонтальное расстояние от левого края окна;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">YPos</span><span style=" font-family:'DejaVu Sans';"> - вертикальное расстояние от верхнего края окна;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">HelpFile</span><span style=" font-family:'DejaVu Sans';"> - строковое выражение, содержащее имя справочного файла Windows;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-style:italic;">Context</span><span style=" font-family:'DejaVu Sans';"> - численное выражение, указывающее раздел в справочном файле, относящийся к отображаемому диалоговому окну.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">	</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-weight:600;">Другие материалы по теме:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/109-procedura-vba-dlya-vyvoda-soobscheniya-operatorom-msgbox"><span style=" text-decoration: underline; color:#0000ff;">				MsgBox - оператор VBA для вывода сообщений пользователю процедуры</span></a></li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/133-operator-vba-like-sravnenie-stroki-s-shablonom-nechetkij-poisk"><span style=" text-decoration: underline; color:#0000ff;">				Like - оператор VBA для сравнения строки с шаблоном. Нечеткий поиск</span></a></li></ul></body></html>