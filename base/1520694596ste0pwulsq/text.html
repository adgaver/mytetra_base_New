<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">InputBox - оператор VBA для получения входных данных от пользователя процедуры</span><span style=" font-weight:600;">			</span>			</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В предыдущей статье &quot;<a href="http://macros-vba.ru/knigi/vba/121-literalnye-imenovannye-i-vnutrennie-konstanty-vba"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Литеральные, именованные и внутренние константы VBA</span></a>&quot; рассматривались процедуры для вычисления длины окружности и площади круга. Значение радиуса, принимающего участие в расчетах, задавалось непосредственно в исходном коде процедуры. Изменим этот код таким образом, чтобы процедура стала интерактивной. Интерактивная процедура - это процедура, которая обменивается с пользователем информацией, получая от него входные данные и отображая различные сообщения. Получение данных от пользователя, сохранение этих данных в переменных, выполнение над ними различных действий и отображение результатов этих действий являются основными элементами, которые необходимы для написания интерактивных процедур. Данные, получаемые от пользователя, принято называть входными данными (input). Для получения входных данных используется функция InputBox либо пользовательская форма (об этом позднее).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функцией называется специальный тип процедуры VBA, возвращающей некоторое значение. Функция InputBox выводит на дисплей диалоговое окно, которое содержит командные кнопки OK и Cancel, текстовое поле для ввода входных данных и некоторый текст, который запрашивает у пользователя ввод этих данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ниже приведен программный код процедуры, которая вычисляет площадь круга, при этом радиус круга запрашивает у пользователя процедуры.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">Const Pi                      As Single = 3.1415</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">Dim CircleArea                As Single</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">Sub Circle_Area_04()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">    Const Title               As String = &quot;Площадь круга&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">    Dim Radius As Single, Temp As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">    Temp = InputBox(&quot;Введите радиус круга&quot;, Title)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">    If Temp &lt;&gt; &quot;&quot; Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">        Radius = CSng(Temp)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">        CircleArea = Pi * (Radius * Radius)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">        MsgBox CircleArea, , Title</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">    Else: MsgBox &quot;Вы отказались от ввода данных!&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">    End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; color:#00007f;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; color:#00007f;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В общем случае функция InputBox имеет следующий синтаксис:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">stringvar=InputBox (Prompt [, Title] [, Default] [, XPos] [, YPos] [, HelpFile] [, Context])</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">где <span style=" font-style:italic;">stringvar</span> - любая переменная, сохраняющая строку;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Prompt -</span> любое строковое выражение, содержащее информацию, выводимую в диалоговом окне (единственный обязательный аргумент этой функции);</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Title</span> - строка для заголовка диалогового окна;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Default</span> - строковое выражение, использующееся как значение по умолчанию для пользовательского ввода;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">XPos</span> - горизонтальное расстояние от левого края окна;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">YPos</span> - вертикальное расстояние от верхнего края окна;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">HelpFile</span> - строковое выражение, содержащее имя справочного файла Windows;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Context</span> - численное выражение, указывающее раздел в справочном файле, относящийся к отображаемому диалоговому окну.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">	</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Другие материалы по теме:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/109-procedura-vba-dlya-vyvoda-soobscheniya-operatorom-msgbox"><span style=" text-decoration: underline; color:#0000ff;">				MsgBox - оператор VBA для вывода сообщений пользователю процедуры</span></a></li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/133-operator-vba-like-sravnenie-stroki-s-shablonom-nechetkij-poisk"><span style=" text-decoration: underline; color:#0000ff;">				Like - оператор VBA для сравнения строки с шаблоном. Нечеткий поиск</span></a></li></ul></body></html>