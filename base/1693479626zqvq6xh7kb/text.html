<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:xx-large; color:#1a5130;">Код VBA для копирования, перемещения, удаления и управления файлами</span> </p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:11.5pt; color:#58585a;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; color:#222222; background-color:#ffffff;">Автоматизация процессов с помощью VBA может включать копирование, перемещение, удаление и управление большим количеством файлов. К счастью, в VBA имеется множество встроенных функций, которые помогут нам выполнить эти задачи. Эти файлы не обязательно должны быть книгами Excel; они могут быть файлами любого типа</span><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;"><br />Download the file: </span><a href="https://exceloffthegrid.com/wp-content/uploads/2022/10/0041-VBA-copy-move-delete-and-manage-files.zip"><span style=" font-family:'inherit,serif'; font-size:12pt; text-decoration: underline; color:#661e5b;">0041 VBA copy, move, delete and manage files.zip</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:13.5pt; font-weight:600; color:#1a5130; vertical-align:middle;">Contents</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Symbol'; color:#58585a;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#58585a;">         </span><a href="https://exceloffthegrid.com/vba-code-to-copy-move-delete-and-manage-files/#Check_if_a_file_exists"><span style=" font-family:'inherit,serif'; font-size:11.5pt; text-decoration: underline; color:#661e5b;">Check if a file exists</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Symbol'; color:#58585a;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#58585a;">         </span><a href="https://exceloffthegrid.com/vba-code-to-copy-move-delete-and-manage-files/#Rename_a_file"><span style=" font-family:'inherit,serif'; font-size:11.5pt; text-decoration: underline; color:#661e5b;">Rename a file</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Symbol'; color:#58585a;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#58585a;">         </span><a href="https://exceloffthegrid.com/vba-code-to-copy-move-delete-and-manage-files/#Moving_a_file"><span style=" font-family:'inherit,serif'; font-size:11.5pt; text-decoration: underline; color:#661e5b;">Moving a file</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Symbol'; color:#58585a;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#58585a;">         </span><a href="https://exceloffthegrid.com/vba-code-to-copy-move-delete-and-manage-files/#Copying_a_file"><span style=" font-family:'inherit,serif'; font-size:11.5pt; text-decoration: underline; color:#661e5b;">Copying a file</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Symbol'; color:#58585a;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#58585a;">         </span><a href="https://exceloffthegrid.com/vba-code-to-copy-move-delete-and-manage-files/#Delete_files"><span style=" font-family:'inherit,serif'; font-size:11.5pt; text-decoration: underline; color:#661e5b;">Delete files</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Symbol'; color:#58585a;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#58585a;">         </span><a href="https://exceloffthegrid.com/vba-code-to-copy-move-delete-and-manage-files/#Get_file_attributes"><span style=" font-family:'inherit,serif'; font-size:11.5pt; text-decoration: underline; color:#661e5b;">Get file attributes</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:21pt; color:#1a5130;">Проверьте, существует ли файл</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; color:#222222;">Если какие-либо действия выполняются с несуществующим файлом, код VBA выдаст ошибку. В результате проверка существования файла может стать одним из наиболее распространенных действий, которые мы выполняем.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; color:#222222;">Код ниже отобразит True или False в окне сообщения, чтобы указать, существует ли файл.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> CheckIfFileExists()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Check if a file exists</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">MsgBox Dir(&quot;C:\Users\marks\Documents\Folder\Text.xlsx&quot;) &lt;&gt; &quot;&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Arial,sans-serif'; color:#222222; background-color:#ffffff;">В приведенном ниже коде используется оператор If для выполнения различных действий в зависимости от того, существует файл или нет.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> PerformActionIfFileExists()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier'; color:#58585a;"> filePath </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">As String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">filePath = &quot;C:\Users\marks\Documents\Folder\FileName.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">If</span><span style=" font-family:'Courier'; color:#58585a;"> Dir(filePath) &lt;&gt; &quot;&quot; </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">    'Insert action for if the file exists</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">    'This example displays a message box</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">    MsgBox filePath &amp; &quot; exists.&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Else</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">    'Insert actions if the file does not exist</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">    'This example displays a message box</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">    MsgBox filePath &amp; &quot; does not exist.&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><br /></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Arial,sans-serif'; color:#222222; background-color:#ffffff;">При регулярной проверке наличия файлов может быть проще иметь в модуле функцию многократного использования, которую можно будет вызывать при необходимости.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Многократно используемая функция для проверки существования файла</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Function</span><span style=" font-family:'Courier'; color:#58585a;"> DoesFileExist(filePath) </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">As Boolean</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">DoesFileExist = Dir(filePath) &lt;&gt; &quot;&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Function</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Arial,sans-serif'; color:#222222; background-color:#ffffff;">В приведенном ниже коде показано, как вызвать функцию многократного использования как часть оператора If.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> UseTheFunction()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier'; color:#58585a;"> myFile </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">As String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">myFile = &quot;C:\Users\marks\Documents\Folder\FileName.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Вызов функции многократного использования для проверки существования файла</span><span style=" font-family:'Courier New';"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">If DoesFileExist(myFile) = True Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">    'Вставьте действие, если file существует    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">    'В этом примере отображается окно сообщения </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">    MsgBox &quot;The file exists.&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:21pt; color:#1a5130;">Rename a file</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">The code below renames a file.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> RenameAFile()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Rename a file</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Name</span><span style=" font-family:'Courier'; color:#58585a;"> &quot;C:\Users\marks\Documents\Folder\CurrentFileName.xlsx&quot; _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">    </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">As</span><span style=" font-family:'Courier'; color:#58585a;"> &quot;C:\Users\marks\Documents\Folder\NewFileName.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">If the target filename is already an existing file, the code will error.  Therefore, it is good practice to check if the source and target file names are already in use.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">Check out this post for more examples of using </span><a href="https://exceloffthegrid.com/vba-rename-file-5-code-examples/"><span style=" font-family:'inherit,serif'; font-size:12pt; text-decoration: underline; color:#661e5b;">VBA to rename files</span></a><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:21pt; color:#1a5130;">Moving a file</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">The code to move a file is the same syntax as the code to rename a file.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> MoveAFile()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Move a file</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Name</span><span style=" font-family:'Courier'; color:#58585a;"> &quot;C:\Users\marks\Documents\FileName.xlsx&quot; </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">As</span><span style=" font-family:'Courier'; color:#58585a;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">    &quot;C:\Users\marks\Documents\New Folder\FileName.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:21pt; color:#1a5130;">Copying a file</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">Copying a file retains the existing file, but creates a duplicate version of it in a new location.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> CopyAFile()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Copy a file</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">FileCopy &quot;C:\Users\marks\Documents\Folder\Original File.xlsx&quot;, _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">    &quot;C:\Users\marks\Documents\New Folder\Copied File.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">If the target filename is already an existing file, the code will error.  Therefore, it is good practice to check if the source and target file names are already in use.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:21pt; color:#1a5130;">Delete files</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">Deleting files removes them completely.  Files deleted using VBA are not sent to the recycle bin, and since there is no undo functionality it can be quite dangerous.  Take extra care to ensure the code does what you expect it to.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">The following code deletes a specific file.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> DeleteSpecificFile()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Delete a specific file</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">Kill &quot;C:\Users\marks\Documents\Folder\DeleteMe.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">The code below deletes files using a wildcard.  In this circumstance, it deletes all files with a .xlsx file extension.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> DeleteFilesWithWildcards()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Delete all .xlsx files using the * wildcard character</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">Kill &quot;C:\Users\marks\Documents\Folder\*.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">The example below deletes all the files in a folder by using wildcard characters.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> DeleteAllFilesInFolder()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Delete all files from a folder using two * wildcard characters</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">Kill &quot;C:\Users\marks\Documents\Folder\*.*&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">Common wildcard characters are:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="424" cellspacing="2" cellpadding="0">
<tr>
<td width="127" style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit,serif'; font-size:11.5pt;">Character</span> </p></td>
<td width="293" style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit,serif'; font-size:11.5pt;">Description</span> </p></td></tr>
<tr>
<td style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit,serif'; font-size:11.5pt;">* (asterisk)</span> </p></td>
<td style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit,serif'; font-size:11.5pt;">Any number of characters</span> </p></td></tr>
<tr>
<td style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit,serif'; font-size:11.5pt;">? (question mark)</span> </p></td>
<td style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit,serif'; font-size:11.5pt;">Any individual characters</span> </p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">The example below applies the * (asterisk) and ? (question mark) wildcard characters</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'Delete all .xlsx or .xlsm files from a folder, but not .xls files</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'as the ? wildcard must be atleast on character in length</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;"> Kill &quot;C:\Users\marks\Documents\Folder\*.xls?&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:21pt; color:#1a5130;">Get file attributes</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">Each files has specific attributes, for example, they can be read-only, hidden or system files etc..</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:12pt; color:#222222;">The code below checks if a file is read-only.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier'; color:#58585a;"> GetFileAttributes()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier'; color:#58585a;"> myFile </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">As String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">myFile = &quot;C:\Users\marks\Documents\Folder\ReadOnlyFile.xlsx&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#008000;">'If the file is Read-Only, display message box</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">If</span><span style=" font-family:'Courier'; color:#58585a;"> (GetAttr(myFile) </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">And</span><span style=" font-family:'Courier'; color:#58585a;"> vbReadOnly) &lt;&gt; 0 </span><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'Courier'; color:#58585a;">    MsgBox &quot;The file is Read only&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'inherit,serif'; font-size:11.5pt; color:#0000ff;">End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>