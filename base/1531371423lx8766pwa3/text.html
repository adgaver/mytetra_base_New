<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.leadersoft.ru/Rus/Market/Db/Products/60/help/914.html"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#ff0000;">012. Диалог открытия файлов Microsoft Office</span></a></p>
<p style=" margin-top:12px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:11pt;">                У Microsoft Office есть специальный диалог открытия файлов, который имеет много интересных свойств. Он лучше диалога Windows. В этом примере показано как можно его использовать.                </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">                                </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">  </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="1" cellpadding="5" bgcolor="#89bbcb">
<tr>
<td bgcolor="#ffffff" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#ffffff;">										</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">								</span><a href="http://www.leadersoft.ru/Rus/Market/db/Default.aspx?go=product&amp;pid=60"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Все примеры Microsoft Access</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">												</span></p></td></tr>
<tr>
<td bgcolor="#ffffff" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Private Sub </span><span style=" font-family:'Arial'; font-size:12pt;">butSelectFile_Click()<br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">' Включите библитеку libDialogFiles</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    Me.strFilePath = fOfficeGetFile(</span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;Выберите файл&quot;</span><span style=" font-family:'Arial'; font-size:12pt;">, </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;C:&quot;</span><span style=" font-family:'Arial'; font-size:12pt;">, </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;*.txt&quot;</span><span style=" font-family:'Arial'; font-size:12pt;">)<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End Sub</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'#Const constOffice2000 = 0 ' Для Microsoft Office 97</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">#Const </span><span style=" font-family:'Arial'; font-size:12pt;">constOffice2000 = 1 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">' Для Microsoft Office 2000</span><span style=" font-family:'Arial'; font-size:12pt;"><br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Private Declare Function </span><span style=" font-family:'Arial'; font-size:12pt;">funOfficeGetFile _<br /> </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Lib </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;msaccess.exe&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"> Alias </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;#56&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"> _<br /> (gfni </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As </span><span style=" font-family:'Arial'; font-size:12pt;">accOfficeGetFileNameInfo, fOpen </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Integer</span><span style=" font-family:'Arial'; font-size:12pt;">) </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">' OfficeGetFileName flags</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Public Const </span><span style=" font-family:'Arial'; font-size:12pt;">flagNoChangeDir = &amp;H2    </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">' Не меняет каталог пользователя</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Public Const </span><span style=" font-family:'Arial'; font-size:12pt;">flagDirectoryOnly = &amp;H20 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">' Открывает только папку</span><span style=" font-family:'Arial'; font-size:12pt;"><br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Public </span><span style=" font-family:'Arial'; font-size:12pt;">Type accOfficeGetFileNameInfo<br />    hwndOwner </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    strAppName </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String </span><span style=" font-family:'Arial'; font-size:12pt;">* 255<br />    strDlgTitle </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String </span><span style=" font-family:'Arial'; font-size:12pt;">* 255<br />    strOpenTitle </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String </span><span style=" font-family:'Arial'; font-size:12pt;">* 255<br />    strFile </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String </span><span style=" font-family:'Arial'; font-size:12pt;">* 4096<br />    strInitialDir </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String </span><span style=" font-family:'Arial'; font-size:12pt;">* 255<br />    strFilter </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String </span><span style=" font-family:'Arial'; font-size:12pt;">* 255<br />    lngFilterIndex </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lngView </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lngFlags </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End </span><span style=" font-family:'Arial'; font-size:12pt;">Type<br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Функция открытия файла</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Declare Function </span><span style=" font-family:'Arial'; font-size:12pt;">GetOpenFileName </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Lib </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;comdlg32.dll&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"> Alias </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;GetOpenFileNameA&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"> ( _<br />        FILENAME </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As </span><span style=" font-family:'Arial'; font-size:12pt;">OPENFILENAME) </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Boolean</span><span style=" font-family:'Arial'; font-size:12pt;"><br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Функция сохранения файла</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Declare Function </span><span style=" font-family:'Arial'; font-size:12pt;">apiGetSaveFileName </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Lib </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;comdlg32.dll&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"> Alias </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;GetSaveFileNameA&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"> ( _<br />        FILENAME </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As </span><span style=" font-family:'Arial'; font-size:12pt;">OPENFILENAME) </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Boolean</span><span style=" font-family:'Arial'; font-size:12pt;"><br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Структура файла, описание дано ниже</span><span style=" font-family:'Arial'; font-size:12pt;"><br />Type OPENFILENAME<br />    lStructSize </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    hwndOwner </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    hInstance </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpstrFilter </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpstrCustomFilter </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    nMaxCustFilter </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    nFilterIndex </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpstrFile </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    nMaxFile </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpstrFileTitle </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    nMaxFileTitle </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpstrInitialDir </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpstrTitle </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    flags </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    nFileOffset </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Integer</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    nFileExtension </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Integer</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpstrDefExt </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lCustData </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpfnHook </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lpTemplateName </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End </span><span style=" font-family:'Arial'; font-size:12pt;">Type<br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Флажки для параметра OPENFILENAME.Flags</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'  (например, OFN_FILEMUSTEXIST Or OFN_READONLY)</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_READONLY = &amp;H1<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_OVERWRITEPROMPT = &amp;H2<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_HIDEREADONLY = &amp;H4<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_NOCHANGEDIR = &amp;H8<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_SHOWHELP = &amp;H10<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_ENABLEHOOK = &amp;H20<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_ENABLETEMPLATE = &amp;H40<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_ENABLETEMPLATEHANDLE = &amp;H80<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_NOVALIDATE = &amp;H100<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_ALLOWMULTISELECT = &amp;H200<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_EXTENSIONDIFFERENT = &amp;H400<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_PATHMUSTEXIST = &amp;H800<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_FILEMUSTEXIST = &amp;H1000<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_CREATEPROMPT = &amp;H2000<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_SHAREAWARE = &amp;H4000<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_NOREADONLYRETURN = &amp;H8000<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_NOTESTFILECREATE = &amp;H10000<br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_SHAREFALLTHROUGH = 2<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_SHARENOWARN = 1<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Const </span><span style=" font-family:'Arial'; font-size:12pt;">OFN_SHAREWARN = 0<br /><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">' Получение папки для программы</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Public Function </span><span style=" font-family:'Arial'; font-size:12pt;">fOfficeGetFileName( _<br /> gfni </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As </span><span style=" font-family:'Arial'; font-size:12pt;">accOfficeGetFileNameInfo, _<br /> </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">ByVal </span><span style=" font-family:'Arial'; font-size:12pt;">fOpen </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Integer</span><span style=" font-family:'Arial'; font-size:12pt;">) </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Dim </span><span style=" font-family:'Arial'; font-size:12pt;">lngReturn </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">With </span><span style=" font-family:'Arial'; font-size:12pt;">gfni<br />        .strAppName = RTrim$(.strAppName) &amp; vbNullChar<br />        .strDlgTitle = RTrim$(.strDlgTitle) &amp; vbNullChar<br />        .strOpenTitle = RTrim$(.strOpenTitle) &amp; vbNullChar<br />        .strFile = RTrim$(.strFile) &amp; vbNullChar<br />        .strInitialDir = RTrim$(.strInitialDir) &amp; vbNullChar<br />        .lngFilterIndex = 1<br />        .strFilter = RTrim$(.strFilter) &amp; vbNullChar </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'&quot;Все файлы (*.*)&quot; &amp; vbNullChar</span><span style=" font-family:'Arial'; font-size:12pt;"><br />        lngReturn = funOfficeGetFile(gfni, fOpen)<br />        <br />        .strAppName = fTrimNull(.strAppName)<br />        .strDlgTitle = fTrimNull(.strDlgTitle)<br />        .strOpenTitle = fTrimNull(.strOpenTitle)<br />        .strFile = fTrimNull(.strFile)<br />        .strInitialDir = fTrimNull(.strInitialDir)<br />        .strFilter = fTrimNull(.strFilter)<br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End With</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    fOfficeGetFileName = lngReturn<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End Function</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Обрезка данных</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Private Function </span><span style=" font-family:'Arial'; font-size:12pt;">fTrimNull(strVal </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">) </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Dim </span><span style=" font-family:'Arial'; font-size:12pt;">lngPos </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    lngPos = InStr(1, strVal, vbNullChar)<br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Select Case </span><span style=" font-family:'Arial'; font-size:12pt;">lngPos<br />        </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Case Is </span><span style=" font-family:'Arial'; font-size:12pt;">&gt; 1:  fTrimNull = Left$(strVal, lngPos - 1)<br />        </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Case </span><span style=" font-family:'Arial'; font-size:12pt;">0:       fTrimNull = strVal<br />        </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Case </span><span style=" font-family:'Arial'; font-size:12pt;">1:       fTrimNull = vbNullString<br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End Select</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End Function</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'==============================================================</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'   Назначение</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'        Открытие окна диалога файлов</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'   Параметры:</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'        strFilter - строка фильтра</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'        strIniFile - файл инициализации</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'        strTitleDlg - заголовок окна</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'        strDefExt - расширение по умолчанию</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'        strCurDir - текущая папка</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Public Function </span><span style=" font-family:'Arial'; font-size:12pt;">fGetSaveFileName( _<br />    hwnd </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;">, _<br />    strFilter </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">, _<br />    strIniFile </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">, _<br />    strTitleDlg </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">, _<br />    strDefExt </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">, _<br />    strCurDir </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">) </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Dim </span><span style=" font-family:'Arial'; font-size:12pt;">OFNAME </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As </span><span style=" font-family:'Arial'; font-size:12pt;">OPENFILENAME </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Назначаем переменную для файла</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Dim </span><span style=" font-family:'Arial'; font-size:12pt;">flag </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Boolean</span><span style=" font-family:'Arial'; font-size:12pt;"><br /><br />     </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Заполним структуру перед вызовом GetOpenFileName</span><span style=" font-family:'Arial'; font-size:12pt;"><br />     </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">With </span><span style=" font-family:'Arial'; font-size:12pt;">OFNAME<br />         .lStructSize = Len(OFNAME) </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Размер структуры в байтах</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .hwndOwner = hwnd </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Указатель окна</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpstrFilter = strFilter </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Фильтр отбора</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .nFilterIndex = 1 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Индекс первой пары строк фильтра</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpstrFile = strIniFile &amp; String$(512 - Len(strIniFile), 0) </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Полное имя файла</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .nMaxFile = 511 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Размер буфера файла</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpstrFileTitle = String$(512, 0) </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Только имя файла окна</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .nMaxFileTitle = 511 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Размер буфера заголовка</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpstrTitle = strTitleDlg </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Заголовок окна диалога</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .flags = OFN_FILEMUSTEXIST </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Типы читаемых файлов</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpstrDefExt = strDefExt </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Расширение файла по умолчанию</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpstrInitialDir = strCurDir </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Каталог файлов по умолчанию</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .hInstance = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Идентификатор блока данных для OFN_ENABLETEMPLATE</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpstrCustomFilter = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Дополнительные фильтры, см. ниже</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .nMaxCustFilter = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'не менее 40, 0 - игнорируется</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .nFileOffset = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Определяет смещение имени</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .nFileExtension = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Определяет расширение</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lCustData = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Для собственных окон</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpfnHook = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Указатель на функцию фильтра</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         .lpTemplateName = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Собственный диалог</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'*** Старт</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         flag = apiGetSaveFileName(OFNAME) </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Общий случай</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">If </span><span style=" font-family:'Arial'; font-size:12pt;">flag </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Then </span><span style=" font-family:'Arial'; font-size:12pt;"> </span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'Открываем диалог и находим имя файла</span><span style=" font-family:'Arial'; font-size:12pt;"><br />              fGetSaveFileName = Left(.lpstrFile, InStr(.lpstrFile, Chr(0)) - 1)<br />         </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Else</span><span style=" font-family:'Arial'; font-size:12pt;"><br />              fGetSaveFileName = </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"><br />         </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End If</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End With</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End Function</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'==============================================================</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#007700;">'    Выполнение действий</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Public Function </span><span style=" font-family:'Arial'; font-size:12pt;">fOfficeGetFile(strTitle </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">, strInitDir </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">, strFilter </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;">, </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Optional </span><span style=" font-family:'Arial'; font-size:12pt;">officeFlags </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;">) </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As String</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Dim </span><span style=" font-family:'Arial'; font-size:12pt;">lngFlags </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As Long</span><span style=" font-family:'Arial'; font-size:12pt;"><br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Dim </span><span style=" font-family:'Arial'; font-size:12pt;">gfni </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">As </span><span style=" font-family:'Arial'; font-size:12pt;">accOfficeGetFileNameInfo<br />    <br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">On Error GoTo </span><span style=" font-family:'Arial'; font-size:12pt;">999<br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">With </span><span style=" font-family:'Arial'; font-size:12pt;">gfni<br />        </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">If </span><span style=" font-family:'Arial'; font-size:12pt;">officeFlags &lt;&gt; 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Then </span><span style=" font-family:'Arial'; font-size:12pt;">.lngFlags = officeFlags<br />        .strFilter = strFilter<br />        .strFile = </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"><br />        .strDlgTitle = </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;Выберите файл&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"><br />        .strOpenTitle = </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"><br />        .strInitialDir = strInitDir<br />        .hwndOwner = Application.hWndAccessApp<br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End With</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">If </span><span style=" font-family:'Arial'; font-size:12pt;">fOfficeGetFileName(gfni, -1) = 0 </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Then</span><span style=" font-family:'Arial'; font-size:12pt;"><br />        fOfficeGetFile = Trim(gfni.strFile)<br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Else</span><span style=" font-family:'Arial'; font-size:12pt;"><br />        fOfficeGetFile = </span><span style=" font-family:'Arial'; font-size:12pt; color:#660000;">&quot;&quot;</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End If</span><span style=" font-family:'Arial'; font-size:12pt;"><br />    </span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">Exit Function</span><span style=" font-family:'Arial'; font-size:12pt;"><br />999:<br />    MsgBox Err.Description<br />    Err.Clear<br /></span><span style=" font-family:'Arial'; font-size:12pt; color:#0000aa;">End Function</span></p></td></tr></table></td></tr></table></body></html>