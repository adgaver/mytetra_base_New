<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.2%; background-color:#ffffff;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:xx-large; font-weight:496; color:#212529; background-color:#ffffff;">Python, Pandas, OpenPyXl = Запись и изменения Excel таблиц</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">2021-10-21</span><a href="https://azzrael.ru/category/dev"><span style=" text-decoration: underline; color:#0d6efd;">Разработка</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="post-2670"></a><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;">В</span><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;"> Pandas есть встроенная функция для сохранения датафрейма в электронную таблицу Excel. Все очень просто:</span><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#626262;">Python</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,ConsolasRegular,Courier New,monospace'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#222222" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">1</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f7b073682184-1"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">d</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">f</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">to_excel</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">path</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; font-style:italic; color:#75715e;"># где path это путь до файла, куда будем сохранять</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">Как записать в лист с заданным именем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;">В этом случае будет создан xls / xlsx файл, а данные сохранятся на лист с именем Sheet1. Если хочется сохранить на лист с заданным именем, то можно использовать конструкцию:<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#626262;">Python</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,ConsolasRegular,Courier New,monospace'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#222222" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">1</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f87404201071-1"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">d</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">f</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">to_excel</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">path,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">sheet_name</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;Лист 1&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; font-style:italic; color:#75715e;"># где sheet_name название листа</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">Как записать в один файл сразу два листа</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;">Но что делать, если хочется записать в файл сразу два листа? Логично было бы использовать две команды </span><a name="crayon-6659c16834f8b848213750"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2; background-color:#272822;">d</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2; background-color:#272822;">f</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2; background-color:#272822;">.to_excel</span><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;">  друг за другом, но с одним путем до файла и разными </span><a name="crayon-6659c16834f8d009750572"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2; background-color:#272822;">s</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2; background-color:#272822;">heet_name</span><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;"> , однако в Pandas это так не работает. Для решения этой задачи придется использовать конструкцию посложнее:<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#626262;">Python</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,ConsolasRegular,Courier New,monospace'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#222222" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">4</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f90968294530-1"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">f</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">rom</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">pandas.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">io</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">excel </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">import</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">ExcelWriter</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f90968294530-2"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">w</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">ith</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">ExcelWriter</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(path)</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">as</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">writer:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f90968294530-3"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">df.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">sample</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e7a37a;">10</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">).</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">to_excel</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(writer,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">sheet_name</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;Лист 1&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f90968294530-4"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">df.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">sample</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e7a37a;">10</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">).</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">to_excel</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(writer,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">sheet_name</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;Лист 2&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;"><br />В результате будет создан файл Excel, где будет два листа с именами Лист 1 и Лист 2.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">Как добавить ещё один лист у уже существующему файлу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;">Если использовать предыдущий код, то текущий файл будет перезаписан и в него будет записан новый лист. Старые данные при этом, ожидаемо, будут утеряны. Выход есть, достаточно лишь добавить модификатор «a» (append):<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#626262;">Python</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,ConsolasRegular,Courier New,monospace'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#222222" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">2</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f93070157843-1"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">w</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">ith</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">ExcelWriter</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(path,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">mode</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;a&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">as</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">writer:</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f93070157843-2"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">df.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">sample</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e7a37a;">10</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">).</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">to_excel</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(writer,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">sheet_name</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;Лист 3&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;"><br />Но что, если оставить этот код, удалить существующий файл Excel и попробовать выполнить код? Получим ошибку Файл не найден. В Python существует модификатор «a+», который создает файл, если его нет, и открывает его на редактирование, если файл существует. Но в Pandas такого модификатора не существует, поэтому мы должны выбрать модификатор для ExcelWriter в зависимости от наличия или отсутствия файла. Но это не сложно:<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#626262;">Python</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,ConsolasRegular,Courier New,monospace'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#222222" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">2</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f96859557391-1"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">w</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">ith</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">ExcelWriter</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(path,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">mode</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;a&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">if</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">os.path</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">exists</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(path)</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">else</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;w&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">as</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">writer:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f96859557391-2"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">df.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">sample</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">().</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">to_excel</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(writer,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">sheet_name</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;Лист 4&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.2%;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:x-large; font-weight:496; color:#212529;">Как записать данные на лист Excel в Pandas, сохранив форматирование</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;">К сожалению в Pandas, на момент написания поста, такого функционала нет. Но это можно реализовать с помощью пакета openpyxl. Вот пример такой функции:<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#626262;">Python</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,ConsolasRegular,Courier New,monospace'; font-size:13px; font-weight:496; color:#212529;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#222222" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">9</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">10</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">11</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">12</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">13</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282828;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#979797; background-color:#282828;">14</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#898989;">15</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-1"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">d</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">ef</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">update_spreadsheet</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(path</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">:</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">str</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">_df,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">starcol</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">:</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">int</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e7a37a;">1</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">startrow</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">:</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">int</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e7a37a;">1</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">sheet_name</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">:</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">str</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">&quot;ToUpdate&quot;</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f98123358572-2"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">'''</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-3"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f98123358572-4"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   :param path: Путь до файла Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-5"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   :param _df: Датафрейм Pandas для записи</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f98123358572-6"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   :param starcol: Стартовая колонка в таблице листа Excel, куда буду писать данные</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-7"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   :param startrow: Стартовая строка в таблице листа Excel, куда буду писать данные</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f98123358572-8"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   :param sheet_name: Имя листа в таблице Excel, куда буду писать данные</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-9"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   :return: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f98123358572-10"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e6db74;">   '''</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-11"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">wb</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">ox.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">load_workbook</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(path)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f98123358572-12"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">for</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">ir </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">in</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">range</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e7a37a;">0</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">len</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(_df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-13"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">for</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">ic</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f92672;">in</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">range</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#e7a37a;">0</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">len</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(_df.iloc[ir])):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#363636;"><a name="crayon-6659c16834f98123358572-14"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">           </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">wb[sheet_name].</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">cell</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(startrow</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">+</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">ir,</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">starcol</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">+</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">ic</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">).value</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#000000;">=</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">_df.iloc[ir][</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#75d1f2;">ic</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-6659c16834f98123358572-15"></a><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">wb.</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#66d9ef;">save</span><span style=" font-family:'inherit'; font-size:13px; font-weight:496; color:#f8f8f2;">(path)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;"><br />Как работает код и пояснения смотри в видео</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'; font-size:16px; color:#212529;">Если у тебя есть вопросы, что-то не получается или ты знаешь как решить задачи в посте лучше и эффективнее (такое вполне возможно) то смело пиши в комментариях к видео.</span></p></body></html>