<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#6a9955;">#----------------------------------------------------------------------------------------</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#6a9955;"># # https://stackoverflow.com/questions/538666/format-timedelta-to-string</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">def</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">td2HHMMSSstr</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">td</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">):</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'''Convert timedelta objects to a HH:MM string with (+/-) sign'''</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">if</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">td</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">&lt;</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">datetime</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">.</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">timedelta</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">seconds</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#b5cea8;">0</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">):</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">        </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">sign</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'-'</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">        </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">td</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">-</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">td</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">else</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">        </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">sign</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">''</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">tdhours</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">, </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">rem</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">divmod</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">td</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">.total_seconds(), </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#b5cea8;">3600</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">tdminutes</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">, </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">rem</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">divmod</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">rem</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">, </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#b5cea8;">60</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">tdstr</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">{}{:}</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">:</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">{:02d}</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">:</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">{:02d}</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">.</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">format</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">sign</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">, </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">int</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">tdhours</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">), </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">int</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">tdminutes</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">), </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">int</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">rem</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">return</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">tdstr</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#6a9955;">#----------------------------------------------------------------------------------------</span></pre>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">У меня была похожая проблема с выводом расчета сверхурочной работы на работе. Значение всегда должно отображаться в формате ЧЧ:ММ, даже если оно превышает один день и значение может стать отрицательным. Я объединил некоторые из показанных решений, и, возможно, кто-то найдет это решение полезным. Я понял, что если значение timedelta отрицательное, большинство показанных решений с помощью метода divmod не работают «из коробки»:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">def td2HHMMstr(td):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas';">'''Convert timedelta objects to a HH:MM string with (+/-) sign'''</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas';">if td &lt; datetime.timedelta(seconds=0):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">    sign=</span><span style=" font-family:'Consolas';">'-'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">    td = -td</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas';">else:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">    sign = </span><span style=" font-family:'Consolas';">''</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">  tdhours, rem = </span><span style=" font-family:'Consolas';">divmod(td.total_seconds(), 3600)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">  tdminutes, rem = </span><span style=" font-family:'Consolas';">divmod(rem, 60)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">  tdstr = </span><span style=" font-family:'Consolas';">'{}{:}:{:02d}'.format(sign, int(tdhours), int(tdminutes))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas';">return tdstr</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">дельта времени в строку ЧЧ:ММ:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">td2HHMMstr(datetime.timedelta(hours=</span><span style=" font-family:'Consolas';">1, minutes=45))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'1:54'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">td2HHMMstr(datetime.timedelta(days=</span><span style=" font-family:'Consolas';">2, hours=3, minutes=2))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'51:02'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">td2HHMMstr(datetime.timedelta(hours=-</span><span style=" font-family:'Consolas';">3, minutes=-2))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'-3:02'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">td2HHMMstr(datetime.timedelta(days=-</span><span style=" font-family:'Consolas';">35, hours=-3, minutes=-2))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'-843:02'</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10px;"><br /></p></body></html>