<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-weight:400; font-style:normal; "  bgcolor="#ffffff">
Version:0.9
StartHTML:0000000157
EndHTML:0000030433
StartFragment:0000000193
EndFragment:0000030397
SourceURL:https://tokmakov.msk.ru/articles/item/15
<html>
<body>
<!--StartFragment--><h1 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 25px; font-family: Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Урок 1. Знакомство с регулярными выражениями</h1><div id="article-item" style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(50, 50, 50); font-family: Arial, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><div style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; overflow: hidden;"><p style="margin: 0px; padding: 0px; max-height: 1e+06px; font-size: 12px; color: rgb(150, 150, 150); width: 485px; float: left;">20.03.2018</p><p style="margin: 0px; padding: 0px; max-height: 1e+06px; font-size: 12px; color: rgb(150, 150, 150); width: 485px; float: right; text-align: right;">Категория:<span> </span><a href="https://tokmakov.msk.ru/articles/category/15" style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); text-decoration: none; font-size: 12px;">Регулярные выражения</a></p></div><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">В этом уроке вы узнаете, что такое регулярные выражения и что они могут делать.</p><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Назначение регулярных выражений</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Регулярные выражения (regular expressions), или сокращенно regex — инструментальные средства, и подобно всем инструментальным средствам, регулярные выражения предназначены для решения очень конкретных проблем. Чтобы узнать, что такое регулярные выражения и что они делают, лучше всего познакомиться с проблемами, которые решаются с их помощью.</p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Рассмотрим следующие сценарии.</p><ul style="margin: 15px 0px 15px 35px; padding: 0px; max-height: 1e+06px;"><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Вы ищете файл, содержащий текст<span> </span><strong style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 0); font-weight: 500; text-shadow: rgb(204, 204, 204) 1px 1px 1px;">car</strong><span> </span>(независимо от регистра), но не хотите указать местонахождение текста<span> </span><strong style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 0); font-weight: 500; text-shadow: rgb(204, 204, 204) 1px 1px 1px;">car</strong><span> </span>— в середине, в начале или в конце слова (например,<span> </span><em style="margin: 0px; padding: 0px; max-height: 1e+06px;">s<strong style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 0); font-weight: 500; text-shadow: rgb(204, 204, 204) 1px 1px 1px;">car</strong></em>,<span> </span><em style="margin: 0px; padding: 0px; max-height: 1e+06px;"><strong style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 0); font-weight: 500; text-shadow: rgb(204, 204, 204) 1px 1px 1px;">car</strong>ry</em><span> </span>и<span> </span><em style="margin: 0px; padding: 0px; max-height: 1e+06px;">in<strong style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 0); font-weight: 500; text-shadow: rgb(204, 204, 204) 1px 1px 1px;">car</strong>cerate</em>).</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Вы динамически генерируете Web-страницу (используя сервер приложений) и должны отобразить текст, найденный в базе данных. Текст может содержать URL, и вы хотите, чтобы на сгенерированной странице URL можно было активизировать щелчком (так что вместо того, чтобы генерировать только текст, вы хотите сгенерировать правильный HTML-тег<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">&lt;a href="..."&gt;...&lt;/a&gt;</code>.</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Вы создаете Web-страницу, содержащую форму. Форма запрашивает у пользователя разную информацию, включая и адрес электронной почты. Вы должны проверить, что указанные адреса имеют правильный формат (т.е. что они являются синтаксически правильными (допустимыми)).</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Вы редактируете исходный текст и должны заменить все вхождения слова size на iSize, но замену хотите выполнять только для слова size и не хотите заменять вхождения size там, где они выступают как часть другого слова.</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Вы отображаете список всех файлов в файловой системе компьютера и хотите отфильтровать этот список так, чтобы определить местонахождение только тех файлов, которые содержат текст Application.</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Вы импортируете данные в приложение. Данные разграничены знаками табуляции, и ваше приложение поддерживает файлы формата CSV (одна строка данных в строке текста, значения разделены запятыми, каждое значение можно заключить в кавычки).</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Вы должны найти в файле определенный текст, но только в определенном местоположении (например, в начале строки или в конце предложения).</li></ul><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Все эти сценарии представляют собой обычные программистские задачи. И все они могут быть решены почти на любом языке, в котором есть условные выражения и операции над строками. Но насколько сложно решить эти задачи? Вам понадобится в цикле перебирать слова или символы по одному, выполнять все типы условных операторов, отслеживать массу флажков, чтобы убедиться, что вы нашли то, что искали, или чтобы быть уверенными, что вы не нашли искомый текст, проверять всевозможные пробельные и специальные символы, и по ходу дела решить еще много подобных задач. И вы должны были бы сделать это все вручную.</p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Но вы можете использовать регулярные выражения. Каждая из предыдущих задач может быть решена с помощью подходящих инструкций, записанных в кратких строках, содержащих текст и специальные инструкции-команды, которые могут выглядеть следующим образом:</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">\b[Сс][Aa][Rr]\b<span class="copy" style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(150, 150, 150); font-size: 8px; background: rgb(255, 255, 255); border: 0.5px solid rgb(209, 209, 209); border-radius: 5px; position: absolute; z-index: 1000; right: 1px; top: 1px; cursor: pointer; width: 60px; text-align: center;">Копировать</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><div class="note" style="margin: 25px 0px; padding: 17px 10px 10px; max-height: 1e+06px; font-size: 13px; color: rgb(100, 100, 100); border: 0.5px solid rgb(209, 209, 209); background: rgb(245, 245, 245); position: relative;">Не волнуйтесь, если не понимаете смысл предыдущей строки, — все это будет вскоре объясняться.</div><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Как используются регулярные выражения</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Просмотрите сценарии еще раз и обратите внимание, что все они относятся к одному из двух типов: либо отыскивается местонахождение информации (поиск текста), либо информация найдена и редактируется (выполняются замены). Фактически это и есть то, для чего используются регулярные выражения: поиск и замена. Каждое регулярное выражение либо ищет текст (выполняет операцию поиска) или ищет и заменяет текст (выполняет операцию замены).</p><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Поиск с помощью регулярных выражений</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Регулярные выражения используются для поиска тек¬ста, причем разыскиваемый текст может иметь разный вид, как при поиске саг в описанном ранее сценарии. Для начинающих отмечу, что задача может состоять в том, чтобы найти<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">car</code><span> </span>или<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">CAR</code><span> </span>или<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">CaR</code>; это совсем простая часть (многие средства поиска способны выполнять поиск независимо от регистра). Более сложная часть состоит в том, чтобы гарантировать, что найденное вхождение<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">car</code><span> </span>не входит в<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">scar</code>,<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">carry</code><span> </span>или<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">incarcerate</code>. Некоторые более сложные редакторы имеют опции<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">Match Only Whole Word</code><span> </span>(Найти только слово целиком), но во многих эта опция отсутствует, и вы не можете делать такие замены в редактируемом документе. Решает проблему поиска использование регулярного выражения, а не просто текста<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">car</code>.</p><div class="note" style="margin: 25px 0px; padding: 17px 10px 10px; max-height: 1e+06px; font-size: 13px; color: rgb(100, 100, 100); border: 0.5px solid rgb(209, 209, 209); background: rgb(245, 245, 245); position: relative;">Хотите знать, как решается эта задача? Вы фактически уже видели ее решение. Это пример инструкции, приведенный выше:<span> </span><code style="margin: 1px 0px 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">\b[Cc][Aa][Rr]\b</code>.</div><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Стоит заметить, что проверка на равенство (т.е. решение задачи вроде:<span> </span><em style="margin: 0px; padding: 0px; max-height: 1e+06px;">соответствует ли указанный пользователем адрес электронной почты данному регулярному выражению?</em>) и есть операция поиска. Выполняется операция поиска во всей введенной пользователем строке (а не операция поиска подстроки).</p><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Замены с помощью регулярных выражений</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Поиск с помощью регулярных выражений — очень мощное и очень полезное средство, причем совсем не трудно научиться применять его. Поэтому во многих уроках приводятся примеры выполнения операций поиска. Однако реальная польза регулярных выражений состоит именно в операциях замены, типа тех, что встречались в более раннем сценарии, в котором текстовый URL заменялся настоящим URL, активизирующимся щелчком мыши. Для начинающих отмечу, что для этого требуется определить местонахождение URL в тексте (возможно, для этого нужно выполнить поиск строк, которые начинаются с<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">http://</code><span> </span>или<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">https://</code><span> </span>и заканчиваются точкой, запятой или пробельным символом). Затем потребуется заменить найденный URL с двумя вхождениями найденной строки встроенным HTML-кодом так, чтобы</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">http://www.forta.com/<span class="copy" style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(150, 150, 150); font-size: 8px; background: rgb(255, 255, 255); border: 0.5px solid rgb(209, 209, 209); border-radius: 5px; position: absolute; z-index: 1000; right: 1px; top: 1px; cursor: pointer; width: 60px; text-align: center;">Копировать</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">заменить на</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;a href="http://www.forta.com/"&gt;http://www.forta.com/&lt;/a&gt;<span class="copy" style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(150, 150, 150); font-size: 8px; background: rgb(255, 255, 255); border: 0.5px solid rgb(209, 209, 209); border-radius: 5px; position: absolute; z-index: 1000; right: 1px; top: 1px; cursor: pointer; width: 60px; text-align: center;">Копировать</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Опция<span> </span><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">Search and Replace</code><span> </span>(Найти и заменить) в большинстве приложений не может выполнять операции замены такого типа, но решение этой задачи — невероятно простое регулярное выражение.</p><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Так что же такое регулярное выражение?</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Теперь, когда вы знаете, для чего используются регулярные выражения, дадим их определение. Попросту говоря, регулярные выражения — это строки, которые используются для поиска и обработки текста. Регулярные выражения записываются на языке регулярных выражений, т.е. на специализированном языке, разработанном и предназначенном для решения задач: поиска и замены текста. Подобно любому языку, язык регулярных выражений имеет специальный синтаксис и команды, которые вам предстоит освоить, и именно их вы будете изучать по данной книге.</p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Язык регулярных выражений — не полноценный язык программирования. Это обычно даже не программа или утилита, которую можно установить и использовать. Чаще всего регулярные выражения представляют собой миния-зыки, которые встроены в другие языки или программы. Хорошая новость состоит в том, что практически любой современный приличный язык или инструмент поддерживает регулярные выражения. Плохая новость в том, что сам по себе язык регулярных выражений не собирается искать что-нибудь подобно другим применяемым вами языкам или инструментам. Язык регулярных выражений — язык в себе, а совсем не интуитивно понятный язык для выполнения каких-либо очевидных операций.</p><div class="note" style="margin: 25px 0px; padding: 17px 10px 10px; max-height: 1e+06px; font-size: 13px; color: rgb(100, 100, 100); border: 0.5px solid rgb(209, 209, 209); background: rgb(245, 245, 245); position: relative;">Регулярные выражения возникли в научной работе по математике в 1950-х годах. Спустя годы принципы и идеи, заложенные в этой работе, пробились в мир Unix в язык Perl и в утилиты типа<span> </span><code style="margin: 1px 0px 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">grep</code>. Много лет регулярные выражения (в предварительно подготовленных сценариях) использовались исключительно в семействе Unix, однако теперь регулярные выражения поддерживаются в самых разных формах почти на каждой вычислительной платформе.</div><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Приведем примеры правильных (допустимых) регулярных выражений (их смысл вы вскоре поймете):</p><ul style="margin: 15px 0px 15px 35px; padding: 0px; max-height: 1e+06px;"><li style="margin: 0px; padding: 0px; max-height: 1e+06px;"><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">Ben</code></li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;"><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">.</code></li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;"><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">www\.forta\.com</code></li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;"><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">[a-zA-Z0-9_.]*</code></li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;"><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">\r\n\r\n</code></li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;"><code style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(0, 0, 187);">\d{3,3}-\d{3,3}-\d{4,4}</code></li></ul><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Важно уяснить, что синтаксис — самая простая часть в освоении регулярных выражений. Что действительно трудно, так это научиться применять этот синтаксис и разбивать задачи на подзадачи, решения которых находятся с помощью регулярных выражений. Этому нельзя научиться, просто читая книгу; подобно любому языку, вы овладеете языком регулярных выражений, выполняя разнообразные упражнения, а мастерство придет с практикой.</p><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Использование регулярных выражений</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Как уже отмечалось, для регулярных выражений нет никакой особой программы; это не приложение, которое вы выполняете, и не программное обеспечение, которое вы можете купить или загрузить. Совсем наоборот, язык регулярных выражений реализован в большом количестве программных изделий, языков, утилит и сред разработки.</p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">То, как используются регулярные выражения и какие функциональные возможности регулярных выражений экспортируются, зависит от используемого вами приложения. Иногда в приложениях для применения регулярных выражений используются меню и диалоговые окна, а в некоторых языках программирования имеются функции или классы объектов, которые экспортируют функциональные возможности регулярных выражений.</p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Кроме того, не все реализации регулярных выражений одинаковы. Часто есть очень тонкие (а иногда и не очень тонкие) различия в синтаксисе и возможностях регулярных выражений.</p><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Чтобы вам было легче освоить материал, вы можете загрузить приложение Regular Expression Tester (испытатель регулярных выражений) с Web-страницы этой книги (<a href="http://www.forta.com/books/0672325667/" style="margin: 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); text-decoration: none;">http://www.forta.com/books/0672325667/</a>). Данное приложение имеет версии для использования в популярных серверах приложений и языках, а также прямо в JavaScript.</p><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Перед началом</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Прежде чем приступить к применению регулярных выражений, примите во внимание следующее.</p><ul style="margin: 15px 0px 15px 35px; padding: 0px; max-height: 1e+06px;"><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">При использовании регулярных выражений почти всегда есть несколько решений любой задачи. Некоторые решения более просты, некоторые более быстрые, некоторые более удобны для переноса, а некоторые более удобны для обобщения. Редко есть один единственно правильный способ записи регулярного выражения (подразумевается, конечно, что при всех формах записи поставленная задача решается правильно).</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Как уже указывалось, существуют различия в реализации регулярных выражений. Насколько возможно, примеры и информация в уроках этой книги применимы ко всем главным реализациям, причем различия и несовместимости отмечаются особо.</li><li style="margin: 0px; padding: 0px; max-height: 1e+06px;">Как и для любого языка, ключ к освоению регулярных выражений — практика, практика и еще раз практика.</li></ul><h2 style="margin: 15px 0px; padding: 0px; max-height: 1e+06px; color: rgb(83, 144, 204); font-weight: normal; font-size: 21px;">Резюме</h2><p style="margin: 15px 0px; padding: 0px; max-height: 1e+06px;">Регулярные выражения — одно из самых мощных инструментальных средств обработки текстов. Язык регулярных выражений применяется для записи регулярных выражений (фактически, записанную строку и называют регулярным выражением), причем регулярные выражения используются для выполнения операций замены и поиска.</p></div><!--EndFragment-->
</body>
</html></body></html>