<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Написал программу для выбора файла, работает отлично. Но не могу заставить ее открывать нужную папку. Помогите кто чем может. Заранее спасибо. <br /><span style=" font-family:'Courier New'; color:#0000ff;">sub searchfile() <br />ActWbk = ActiveWorkbook.Name <br />    ChDir Sheets(&quot;Set&quot;).Cells(13, 2).Value 'Эта команда не работает, что только не делал - открывает Мои документы <br />    While Msg &lt;&gt; 6 <br />        If Application.FindFile = False Then Exit Sub <br />        OpenFileName = ActiveWorkbook.Name <br />        Msg = MsgBox(&quot;Этот файл подойдет?&quot;, vbYesNoCancel, &quot;Выбор файла&quot;) <br />        If Msg = 2 Then <br />            ActiveWorkbook.Close <br />            Exit Sub <br />        End If <br />        If Msg = 7 Then ActiveWorkbook.Close <br />    Wend <br />end sub</span><br />В ячейке B13 сетевой адрес: \\192.168.0.200\s1\ЗАКАЗЫ\Заказы\Пробная\ </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Располагаю следющей информацией.<br />Свойства ChDrive, ChDir не умеют работать с сетевыми адресами в формате UNC. Они работают только с локальными адресами папок и с теми сетевыми адресами, в которых фигурируют буквы дисков, нпр. X:\...\...<br /><br />Для работы с сетевыми папками можно: <br />а) создать соединение с нужной/корневой папкой в эксплорере (присвоить ему диск). Недостаток - на каждом комрьютере, на котором работает макрос, должно быть создано это соединение вручную.<br />б) Воспользоваться API функциями. Ниже приведен пример из учебника для этого случая. Вместо СhDir будет использоваться ChDirUNC - процедура из макроса.<br /><br />' **************************************************************<br />' Declarations for the ChDirUNC example function<br />' **************************************************************<br />'Set the current directory to a UNC path<br />Private Declare Function SetCurDir Lib &quot;kernel32&quot; Alias &quot;SetCurrentDirectoryA&quot; (ByVal lpPathName As String) As Long<br /><br />''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''<br />' Comments: Change to a UNC Directory<br />'<br />' Arguments:    sPath       The path to change to.<br />'                           Can be either standard or UNC form:<br />'                           &lt;Drive Letter&gt;:\Path<br />'                           \\server\share\path<br />'<br />' Date          Developer       Action<br />' --------------------------------------------------------------<br />' 02 Jun 04     Stephen Bullen  Created<br />'<br />Sub test_ChDirUNC()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim strPath As String</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">strPath = &quot;путь&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ChDirUNC strPath</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub ChDirUNC(ByVal sPath As String)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim lReturn As Long</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    lReturn = SetCurDir(sPath)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    If lReturn = 0 Then</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'        Err.Description vbObjectError + 1, &quot;Error setting path.&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Debug.Print Err.Number</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    End If</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p></body></html>