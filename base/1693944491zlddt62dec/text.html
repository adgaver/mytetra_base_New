<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:-61px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:xx-large; font-weight:600; color:#000000;">SHELL invoked from VBA</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Location: http://www.mvps.org/dmcritchie/excel/shell.htm      </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Home page: </span><a href="http://dmcritchie.mvps.org/excel/excel.htm"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">http://www.mvps.org/dmcritchie/excel/excel.htm</span></a></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="No_Frames"></a><a href="http://dmcritchie.mvps.org/excel/shell.htm#No_Frames"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">[</span></a><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">View without Frames]</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">OneRowPerCell -- SHELL to Notepad or IExplore   </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#----)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">This should work, it will output one line per selected cell cells are numbered left to right and down, so selecting a single column should work.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">In Excel 2000 you can have multiple selection ranges if you have multiple selection ranges each range will be processed independently in the order that it each was selected: <br />  i.e.  A1:A5, A3:C3, C2:D5</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">If you do not want to incude cells that are blank or only include spaces you can include your own test.<br />    IF cell.text &lt;&gt; &quot;&quot; THEN ...</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Option Explicit</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Sub OneRowPerCell()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Dim newrange As Range</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Dim cell As Range</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Dim filename As Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Dim retVal As Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Dim suffix As String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    suffix = &quot;&quot;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#a52a2a;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;"> ' Range(&quot;B:B&quot;).Select   'for testing, normally manually select a column/cells</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#a52a2a;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Set newrange = Intersect(Selection, ActiveSheet.UsedRange)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">                filename = &quot;c:\temp\myfile.txt&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    filename = InputBox(&quot;Supply filename for HTML generated from &quot; _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">       &amp; &quot;selected range&quot;, &quot;Filename for myfile&quot;, filename)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    If UCase(Right(filename, 4)) = &quot;.HTM&quot; Then suffix = &quot;&lt;br&gt;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Close #1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Open filename For Output As 1</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#a52a2a;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    For Each cell In newrange</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">       Print #1, cell.Text &amp; suffix</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Next cell</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Close #1</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#a52a2a;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    '------------------ view results --------------------------.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    If UCase(Right(filename, 4)) = &quot;.HTM&quot; Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      retVal = </span><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Shell</span><span style=" font-family:'Courier New'; color:#a52a2a;">(&quot;C:\Program Files\Internet Explorer&quot; _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        &amp; &quot;\IEXPLORE.EXE &quot; &amp; filename, vbNormalFocus)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">          retVal = </span><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Shell</span><span style=" font-family:'Courier New'; color:#a52a2a;">(&quot;NOTEPAD.EXE &quot; &amp; filename, vbNormalFocus)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">End Sub</span></pre>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">One Row Per Cell Per Column   </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#----)</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Sub OneRowPerCellPerColumn()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim newrange As Range</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim cell As Range</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim filename As Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim retVal As Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim suffix As String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  suffix = &quot;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim iCol As Long</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim Col_id As String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim colRange As Range</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  For iCol = 1 To ActiveSheet.UsedRange.Columns.Count</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">       Set newrange = Intersect(Cells.Columns(iCol), ActiveSheet.UsedRange)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      Col_id = Left(Cells(1, iCol).Address(0, 0), _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">           Len(Cells(1, iCol).Address(0, 0)) - 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      filename = &quot;c:\temp\myfile_&quot; &amp; Col_id &amp; &quot;.txt&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      If UCase(Right(filename, 4)) = &quot;.HTM&quot; Then suffix = &quot;&lt;br&gt;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      Close #1   'standard practice, close before opening</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      Open filename For Output As 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      For Each cell In newrange     'newrange</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        If Trim(cell.Text) &lt;&gt; &quot;&quot; Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">           Print #1, cell.Text &amp; suffix</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      Next cell</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      Close #1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Next iCol</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">End Sub</span></pre>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="read"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">S</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">imple Read with Input Statements </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#read)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">Simple example provided by Dermot Balson in programming </span><a href="http://groups.google.com/groups?as_umsgid=dbf601c11cd9%244c9097f0%249be62ecf@tkmsftngxa03"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">2001-08-04</span></a></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">'Code to read file until finished</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Open &quot;c:\temp\outdoor.csv&quot; for input as #1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">do while not eof(1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  input #1,x</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">loop</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">close</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">uses the Line Input # statement to read a line from a sequential file and assign it to a variable.</span><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">    Line Input #1, MyString</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="write"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">S</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">imple Write to a variable or list of variables  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#write)</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#0000ff;">HELP, answer wizard, line write, &quot;Write # Statement&quot;</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Open &quot;TESTFILE&quot; For Output As #1    ' Open file for output.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Write #1, &quot;Hello World&quot;, 234    ' Write comma-delimited data.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Write #1,    ' Write blank line.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">MyDate = #February 12, 1969# : MyNull = Null</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Write #1, MyDate ; &quot; is a date&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Close #1    ' Close file.</span></pre>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="stream"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">W</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">rite to a TextStream object  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#stream)</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#0000ff;">HELP, ans.wiz, line write, WriteLine Method, &quot;TextStream Object&quot;</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Set fs = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Set a = fs.CreateTextFile(&quot;c:\testfile.txt&quot;, True)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">a.WriteLine(&quot;This is a test.&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">a.Close</span></pre>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="concatenate"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">S</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">imple .BAT file to concatenate files (merge files) to new file  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#concatenate)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">A simple .BAT file to copy 3 files into one output.</span></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">     copy part1.html +passlist.html +part3.html  composite.html</span></pre>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="import"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">I</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">mporting a text file into Active Sheet  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#import)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">This worked with worked with a CSV file with no end of line returns in the file, 6 fields per row and field 4 is a date.  </span><span style=" font-family:'Times New Roman'; font-size:medium; font-style:italic; color:#000000;">Tom Ogilvy, </span><a href="http://groups.google.com/groups?as_umsgid=%3COleOFRFGBHA.1448@tkmsftngp04"><span style=" font-family:'Times New Roman'; font-size:medium; font-style:italic; text-decoration: underline; color:#0000ff;">2001-07-29</span></a><span style=" font-family:'Times New Roman'; font-size:medium; font-style:italic; color:#000000;">, programming</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Sub ReadCommaSepFile_NoReturns()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Dim myVar As Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Dim i As Long</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Dim rw As Long</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">'Open the file for Input</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Open &quot;C:\Test1.TXT&quot; For Input As #1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">'Read each line of the text file into the list of variables</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    'until the end of the file is reached</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    i = 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    rw = 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Do While Not (EOF(1))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        Input #1, myVar</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        i = i + 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        If i = 4 Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">         Cells(rw, i).Value = CDate(myVar)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">         Cells(rw, i).Value = myVar</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        If i = 6 Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">         rw = rw + 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">         i = 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">        End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Loop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">'Close the file</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">    Close 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">End Sub</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">For more information on Importing and Exporting Text files with your own delimiters see Chip Pearson's </span><a href="http://www.cpearson.com/excel/topic.htm"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">web pages</span></a><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;"> on export and import.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="type"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">S</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">ave As Text type file, .csv, .txt, .htm, .html  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#type)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">The followinjg will create a text file for the printer, without any double quotes added. </span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">Sub Macro23()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">   dim retval as variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">   ActiveWorkbook.SaveAs filename:=&quot;C:\temp\text.txt&quot;, _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      FileFormat:=xlTextPrinter, CreateBackup:=False</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">   '--- show results ----</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">   retval = </span><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Shell</span><span style=" font-family:'Courier New'; color:#a52a2a;">(&quot;NOTEPAD.EXE &quot; &amp; _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">      &quot;c:\temp\text.txt&quot;, vbNormalFocus)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">End Sub</span></pre>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:large; font-weight:600; color:#000000;">&quot;FileFormat Property&quot; in Help</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">Some if not all of the text file choices include the following, interestingly they did not include xlText (seems odd).</span></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlCSV</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Generates commas between cells, quotes around cells with commas.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlCSVMac</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlCSVMSDOS&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlCSVWindows</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlHTML</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Generates horrid large HTML files.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlText</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">(wasn't on properties) Generates print text with quotes around cells with commas.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlTextMac</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlTextMSDOS</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlTextPrinter</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Generates tabbed text for printer without added doublequotes.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlTextWindows</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">xlUnicodeText</span></p>
<p style=" margin-top:0px; margin-bottom:8px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Looks same as xlTextPrinter</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="filetype"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">S</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">tarting an application based on Filetype  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#filetype)</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:large; font-weight:600; color:#000000;">filetypes -- AutoCad (.cad), notepad (.txt), HTML (.htm, .html), Adobe (.pdf), etc.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">The file extensions that you have set up for you (or by you) in My Computer, View, Folder Options, File Types, can be used with </span><span style=" font-family:'Times New Roman'; font-size:medium; font-weight:600; color:#000000;">SHELL</span><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;"> so you do not have to specify the program in your code.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">If the filename contains spaces, you will have to include it within double quotes.  (start Runs a Windows program or an MS-DOS program.) E.g.,</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">From DOS:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  start c:\copiedsite\dmcritchie\excel\excel.htm</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  start &quot;c:\copiedsite\dmcritchie\excel\excel.htm&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  start http://www.mvps.org/dmcritchie/excel/excel.htm</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">From DOS starting Excel with switches: (</span><a href="http://support.microsoft.com/default.aspx?kbid=291288"><span style=" font-family:'Courier New'; text-decoration: underline; color:#0000ff;">291288 - Startup Switches for Microsoft Excel</span></a><span style=" font-family:'Courier New'; color:#a52a2a;"> (2002: 291288, 2000: 211481; 97: 159474)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">(SAFE Mode, Re-register/Reregister Excel extensions)  )</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Excel.exe /r &quot;C:\test\file.xls&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">From VBA:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  </span><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Shell</span><span style=" font-family:'Courier New'; color:#a52a2a;"> &quot;start &quot;&quot;s:\new projects\drawing.dwg&quot;&quot; &quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  </span><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Shell</span><span style=" font-family:'Courier New'; color:#a52a2a;"> &quot;start c:\copiedsite\dmcritchie\excel\excel.htm&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  </span><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Shell</span><span style=" font-family:'Courier New'; color:#a52a2a;"> &quot;start &quot;&quot;c:\copiedsite\dmcritchie\excel\excel.htm&quot;&quot;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">also</span><span style=" font-family:'Courier New'; color:#a52a2a;"> look at  GetObject in VBA help.</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#a52a2a;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">More VBA:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  Dim pblnHelp As Boolean</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">  pblnHelp = </span><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Shell</span><span style=" font-family:'Courier New'; color:#a52a2a;">(&quot;start &quot; &amp; &quot; &quot;&quot;&quot; &amp; _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">     ActiveWorkbook.path &amp; &quot;\help.pdf&quot;&quot; &quot;, vbMaximizedFocus)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#a52a2a;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#a52a2a;">Worksheet Solution</span><span style=" font-family:'Courier New'; color:#a52a2a;">, thanks to Scott Rubin</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#a52a2a;">                =HYPERLINK(&quot;help.pdf&quot;,&quot;Help and usage information&quot;)</span></pre>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:large; font-weight:600; color:#000000;">Shell vs use of the API ShellExecuteA</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Shell requires you to choose an application such as Notepad, or a browser.  You can use “Run” though as the application and application associated with the file type will be used.</span></li>
<li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">ShellExecuteA, uses the application associated with the file type, but your VBA will need extra coding.</span></li>
<li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Examples of both uses in </span><a href="http://dmcritchie.mvps.org/excel/code/xl2htmlx.txt"><span style=" font-size:medium; text-decoration: underline; color:#0000ff;">code</span></a><span style=" font-size:medium;"> for XL2HTML macros.</span></li></ul>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="dos"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">D</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">OS commands that have VBA equivalents  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#dos)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">YOu do not have to use a DOS command for such things as</span></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">DIR Function,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Dir[(pathname[, attributes])]<br />see </span><a href="http://dmcritchie.mvps.org/excel/dirlist.txt"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">dirlist</span></a><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;"> Example.  Also see HELP for CurDir. http://www.microsoft.com/office/techinfo/productdoc/2002/en/excel/default.asp?URL=/office/techinfo/productdoc/2002/en/excel/vblr6/vafctdir.htm</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">ChDrive Statement -- Change drive, ChDrive uses only the first letter, Example:  ChDrive &quot;d&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">ChDir Statement -- Change Directory</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">ChDir &quot;D:\WINDOWS\SYSTEM&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">CurDir</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Current Directory   MyPath = CurDir   ' Returns &quot;C:\WINDOWS\SYSTEM&quot;.<br />  MyPath = CurDir(&quot;C&quot;)   ' Returns &quot;C:\WINDOWS\SYSTEM&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Kill Statementt -- Delete File(s), used like Del,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Example: Kill &quot;*.TXT&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">MkDir Directory Statement -- Make Directory</span></p>
<p style=" margin-top:0px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">RmDir Directory Statement -- Remove Directory</span></p>
<pre style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#a52a2a;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Change directory or folder. ChDir</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Change the drive. ChDrive</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Copy a file. FileCopy</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Make directory or folder. MkDir</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Remove directory or folder. RmDir</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Rename a file, directory, or folder. Name</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Return current path. CurDir</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Return file date/time stamp. FileDateTime</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Return file, directory, label attributes. GetAttr</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Return file length. FileLen</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Return file name or volume label. Dir</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'helvetica'; color:#a52a2a;">Set attribute information for a file. SetAttr</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'helvetica'; color:#a52a2a;"><br /></pre>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:-40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="related"></a><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">R</span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;">elated  </span><span style=" font-family:'Times New Roman'; font-size:x-large; font-weight:600; color:#000000;"> </span><span style=" font-family:'Times New Roman'; font-size:small; font-weight:600; color:#000000;">(#related)</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://dmcritchie.mvps.org/excel/xl2html.htm"><span style=" font-size:medium; text-decoration: underline; color:#0000ff;">Excel to HTML</span></a><span style=" font-size:medium;"> uses </span><span style=" font-size:medium; font-weight:600;">Shell</span><span style=" font-size:medium;"> to view results after creating HTML code.  [</span><a href="http://dmcritchie.mvps.org/excel/code/xl2htmlx.txt"><span style=" font-size:medium; text-decoration: underline; color:#0000ff;">code</span></a><span style=" font-size:medium;">]</span></li>
<li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://groups.google.com/groups?threadm=70sodvs3n7932uu0hkuivds6ul2kd337tg@4ax.com"><span style=" font-size:medium; text-decoration: underline; color:#0000ff;">Starting a MS Word document</span></a><span style=" font-size:medium;"> (.doc) with a </span><span style=" font-size:medium; font-weight:600;">Shell</span><span style=" font-size:medium;">, replies by Hank Scorpio and Graham S.</span></li>
<li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.exceltip.com/show_tip/Import_and_Export_in_VBA/Replace_text_in_a_text_file_using_VBA_in_Microsoft_Excel/468.html"><span style=" font-size:medium; text-decoration: underline; color:#0000ff;">Replace text in a text file using VBA in Microsoft Excel</span></a><span style=" font-size:medium;">, exceltip.com, shell not involved, you specify the file to change.</span></li>
<li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.xcelfiles.com/ShellExecuteA.html"><span style=" font-size:medium; text-decoration: underline; color:#0000ff;">Shell invoked from VBA</span></a><span style=" font-size:medium;"> (ShellExecuteA), Ivan Moala, explains the ShellExecuteA API function but use of constants may make it more complicated for some people, and easier for others. (viewable in IE, otherwise try a reduced font size)</span></li>
<li style=" font-family:'Times New Roman'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.cpearson.com/excel/BrowseFolder.htm"><span style=" font-size:medium; text-decoration: underline; color:#0000ff;">Browse for Folder</span></a><span style=" font-size:medium;">, Chip Pearson, ability to specify a starting folder requires using a Windows API to select a folder, and you will also need to set a VBA reference as indicated within.</span></li></ul>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000; background-color:#fffef4;">You are one of many distinguished visitors who have visited my site here or in a previous location  since this page was created on July 27, 2001.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">Visit </span><a href="http://dmcritchie.mvps.org/excel/excel.htm"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">[my Excel home page]</span></a><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">   </span><a href="http://dmcritchie.mvps.org/excel/xlindex.htm"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">[Index page]</span></a><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">   </span><a href="http://dmcritchie.mvps.org/excel/search.htm"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">[Excel Onsite Search]</span></a><span style=" font-family:'Times New Roman'; font-size:medium; color:#000000;">   </span><a href="http://dmcritchie.mvps.org/excel/shell.htm#top"><span style=" font-family:'Times New Roman'; font-size:medium; text-decoration: underline; color:#0000ff;">[top of this page]</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; font-size:small; color:#000000;">Please send your comments concerning this web page to: David McRitchie </span><a href="mailto:David%20McRitchie%3C%44%4D%63%52%69%74%63%68%69%65%40%76%65%72%69%7A%6F%6E%2E%6E%65%74%3E?subject=Comments%20on%20shell.htm%20&amp;body=comments%20concerning%20a%20--My%20Excel%20Pages--%20webpage%0D%0A%20at%20http://www.mvps.org/dmcritchie/excel/shell.htm%20%0D%0A%0D%0AHi%20David,%0D%0A"><span style=" font-family:'Times New Roman'; font-size:small; font-style:italic; text-decoration: underline; color:#0000ff;">send email comments</span></a></p></body></html>