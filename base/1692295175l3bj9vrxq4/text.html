<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:33pt; color:#222222;">VBA Чтение файла в Excel (txt, xml, csv, двоичный файл)</span> </p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">Написано </span><a href="https://analystcave.com/author/analystcave/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Томом (AnalystCave)</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">  в8 мая 2015 г. в </span><a href="https://analystcave.com/category/ms-office/ms-office-excel/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Excel</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">MS Office</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/outlook/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Outlook</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/powerpoint/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">PowerPoint</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/word/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Word</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Вы можете читать двоичные или текстовые данные файла VBA, используя несколько различных подходов в Excel. VBA предоставляет вам набор встроенных операторов, таких как </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">Open</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> , чтобы открыть и подготовить файлы. Однако в этой статье, помимо демонстрации этих собственных подходов к чтению файлов с помощью макросов Excel, вы можете читать файлы CSV и другие схемы структурированных данных с помощью драйвера Jet.OLEDB, запросов Microsoft или </span><a href="https://analystcave.com/vba-filesystemobject-fso-in-excel/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">FileSystemObject</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Текстовые/двоичные файлы являются распространенными способами хранения данных, в отличие от баз данных или обычных файлов Excel. Глядя на различные ресурсы, я пропустил один ресурс, который демонстрировал бы различные методы </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">ПРАВИЛЬНОГО чтения файлов в VBA.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Другие файловые ресурсы VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Файловые функции VBA</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-read-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Чтение файлов VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-write-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Запись файлов VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-dir-function-how-to-traverse-directories/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Обход каталогов</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-xml-working-xml-files/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">VBA Работа с файлами XML</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-downloading-files-from-ftp-using-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Загрузка файлов VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/excel-quick-versioning-excel-files/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Файлы управления версиями VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/merge-csv-files-or-txt-files-in-a-folder/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">VBA Объединение файлов CSV или TXT</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Важно помнить, что вы не должны читать все файлы, используя один и тот же подход. Обратите внимание на структуру файла. Если это структурированный CSV, используйте соединение ADODB, если вам нужно прочитать только пару строк, прочитайте файл построчно или по частям, иначе прочитайте весь файл. Хочешь производительности — всегда выбирай правильный подход.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ЧТЕНИЕ ТЕКСТОВЫХ ФАЙЛОВ В VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">VBA Чтение текстовых файлов (построчно)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Чтобы прочитать весь текстовый файл построчно, используйте приведенный ниже код.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="748" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="704" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, textData </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, textRow </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Integer</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileName = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;C:\text.txt&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileNo = FreeFile </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Get first free file number  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Open fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Input </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> #fileNo</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Do</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">While</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Not</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> EOF(fileNo)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">  </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Line Input #fileNo, textRow</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">  </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> textData = textData &amp; textRow</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Loop</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Close #fileNo</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">VBA Чтение текстовых файлов (чтение всего файла)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Чтобы прочитать весь текстовый файл за один раз (не построчно), используйте приведенный ниже код.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, textData </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Integer</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileName = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;C:\text.txt&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileNo = FreeFile </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Get first free file number   </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Open fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Input </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> #fileNo</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">textData = Input$(LOF(fileNo), fileNo)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Close #fileNo</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">VBA Чтение определенного количества строк из текстового файла</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">В тех случаях, когда вы хотите прочитать определенные строки из текстового файла, вы можете адаптировать код построчного чтения, как показано ниже. Он позволяет читать определенное количество строк </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">(noLines)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> из текстового файла с определенного номера начальной строки </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">(sLine)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> . Если вы установите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">для noLines</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> значение 0, он будет читать все строки до конца файла.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="880" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="836" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, textData </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, textRow </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Integer</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lineCounter as </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Long</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, sLine as </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Long</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, noLines as </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Long</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileName = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;C:\text.txt&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">sLine = 20 </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'number of the first line you want to read</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">noLines = 100 </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'number of lines you want to read</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileNo = FreeFile </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Open fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Input </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> #fileNo</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Do</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">While</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Not</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> EOF(fileNo)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Line Input #fileNo, textRow</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lineCount &gt;= sLine and ((noLines &gt; 0 and lineCount &lt; noLines + sLine) or noLines = 0) then</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> textData = textData &amp;amp; textRow</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">If</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lineCount = lineCount + 1   </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Loop</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Close #fileNo</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ЧТЕНИЕ ФАЙЛОВ CSV В VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Чтение файлов CSV (чтение всего файла и обработка каждой строки)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Чтение текстового файла построчно в строку:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="671" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Assuming file looks like this. File path: C:\test.csv</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'&quot;Col1&quot;, &quot;Col2&quot;, &quot;Col3&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'1     , 2     , 3</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">directory = &quot;C:\&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileName = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;test.csv&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Assuming test.csv is in C:\ directory</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> rs = CreateObject(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;ADODB.Recordset&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">strcon = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &amp; directory &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;;&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> _</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Extended Properties=&quot;&quot;text;HDR=Yes;FMT=Delimited&quot;&quot;;&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">strSQL = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;SELECT * FROM &quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &amp; fileName </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">rs.Open strSQL, strcon, 3, 3</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">rs.MoveFirst</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Do</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">  </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> col1 = rs(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Col1&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">  </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> col2 = rs(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Col2&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">  </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> col3 = rs(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Col3&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">  </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> rs.MoveNext</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Loop</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Until</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> rs.EOF</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Чтение файлов CSV (весь файл на лист)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Считайте весь файл на лист Excel:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="775" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="730" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws as Worksheet, destRng as Range, fileName as </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileName = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;C:\text.txt&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> destRng = Range(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;A1&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws = ActiveSheet</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">With</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws.QueryTables.Add(Connection:= </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;TEXT;&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &amp; fileName &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, Destination:=destRng)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .FieldNames = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">True</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .RowNumbers = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .FillAdjacentFormulas = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .PreserveFormatting = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">True</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .RefreshOnFileOpen = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .RefreshStyle = xlInsertDeleteCells</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .SaveData = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">True</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .AdjustColumnWidth = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">True</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .RefreshPeriod = 0</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFilePromptOnRefresh = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFilePlatform = 852</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileStartRow = 1</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileParseType = xlDelimited</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileTextQualifier = xlTextQualifierDoubleQuote</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Select your delimiter - selected below for Comma</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileConsecutiveDelimiter = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileTabDelimiter = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileSemicolonDelimiter = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileCommaDelimiter = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">True</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileSpaceDelimiter = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> .TextFileTrailingMinusNumbers = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">True</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'This will refresh the query</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">With</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Чтобы обновить загрузку CSV (если CSV был обновлен), просто запустите:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#afafaf;">1</span><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">ws.QueryTables.Refresh BackgroundQuery:=</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ЧТЕНИЕ БИНАРНЫХ ФАЙЛОВ В VBA</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Integer</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, intVar </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Integer</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileName = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;C:\text.bin&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">fileNo = FreeFile</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Open fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Binary Lock Read </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> #fileNo</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Get</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> #fileNo, , intVar</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Close #fileNo</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">С двоичными файлами </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">вы часто будете использовать объекты, которые не имеют фиксированной длины в байтах, например, целые числа</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> . Например, вы хотели бы читать строки из двоичных файлов вместе с другими типами данных. </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">В таких случаях используйте тип данных объекта Type при записи в файл. </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Узнайте больше </span><a href="https://msdn.microsoft.com/en-us/library/aa266315(v=vs.60).aspx"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .<br />Ниже приведен простой пример чтения файла, в котором был сохранен тип данных Type, включая Integer и String.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="671" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Type TestType</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> intVar </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Integer</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> strVar </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Type</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ReadBinary()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Integer</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, testVar </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestType</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;C:\test.bin&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNo = FreeFile</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Open fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Binary Lock Read </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> #fileNo</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Get</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> #fileNo, , testVar</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Debug.Print testVar.intVar </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Print the Integer</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Debug.Print testVar.strVar </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Print the String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Close #fileNo</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ЧТЕНИЕ XML-ФАЙЛОВ В VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://www.w3schools.com/xml/xml_whatis.asp"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">Файлы XML</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> — это в основном текстовые файлы, которые следуют таксономии XML. Вы можете попытаться прочитать и обработать XML-файлы так же, как текстовые файлы, показанные выше. Однако, учитывая, что вы, вероятно, захотите извлечь определенную информацию о XML-теге или атрибуте, я предлагаю прочитать мою специальную статью ниже.</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f2f2f2;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">Читайте </span><a href="https://analystcave.com/vba-xml-working-xml-files/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; text-decoration: underline; color:#008000;">здесь о работе с файлами XML в VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ФУНКЦИИ, НЕОБХОДИМЫЕ ДЛЯ ЧТЕНИЯ ФАЙЛОВ В VBA</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#000000" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ffffff;">Функция</span> </p></td>
<td bgcolor="#000000" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ffffff;">Описание</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">Открыть </span><span style=" font-family:'Times New Roman,serif'; font-weight:600; font-style:italic; color:#000000;">[path_to_file]</span><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;"> For </span><span style=" font-family:'Times New Roman,serif'; font-weight:600; font-style:italic; color:#000000;">[Mode] [Access] [Lock]</span><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;"> As </span><span style=" font-family:'Times New Roman,serif'; font-weight:600; font-style:italic; color:#000000;">[long_variable]</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Открывает файл для чтения/записи и возвращает # номер файла (должен иметь тип long) в переменную </span><span style=" font-family:'Times New Roman,serif'; font-style:italic;">long_variable</span><span style=" font-family:'Times New Roman,serif';"><br />Подробнее </span><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/open-statement"><span style=" font-family:'Times New Roman,serif'; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif';"> . Параметры ниже:</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Wingdings'; font-size:10pt;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-weight:600;">Режим</span><span style=" font-family:'Times New Roman,serif';"> — добавление, двоичный, ввод, вывод или случайный</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Wingdings'; font-size:10pt;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-weight:600;">Доступ</span><span style=" font-family:'Times New Roman,serif';"> — </span><span style=" font-family:'Times New Roman,serif'; font-style:italic;">по желанию</span><span style=" font-family:'Times New Roman,serif';"> . Читай, пиши или читай пиши</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Wingdings'; font-size:10pt;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-weight:600;">Блокировка</span><span style=" font-family:'Times New Roman,serif';"> — </span><span style=" font-family:'Times New Roman,serif'; font-style:italic;">по желанию</span><span style=" font-family:'Times New Roman,serif';"> . Общий доступ, блокировка чтения, блокировка записи и блокировка чтения-записи.</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">Закрывать</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Закрывает файл, используя номер файла #.<br />Больше информации </span><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/close-statement"><span style=" font-family:'Times New Roman,serif'; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif';"> .</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">FreeFile</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Получить следующий свободный номер файла, доступный для оператора Open/функции FileOpen. Использование этой функции особенно важно при работе с несколькими файлами одновременно.<br />Больше информации </span><a href="https://msdn.microsoft.com/en-us/library/c3zyf7d8%28v=vs.90%29.aspx?f=255&amp;MSPPError=-2147217396"><span style=" font-family:'Times New Roman,serif'; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif';"> .</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">BOF( </span><span style=" font-family:'Times New Roman,serif'; font-weight:600; font-style:italic; color:#000000;">номер_файла</span><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;"> )</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Возвращает true, если вы находитесь в начале файла, описываемого номером файла.<br />Больше информации </span><a href="https://msdn.microsoft.com/en-us/library/bb221140%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396"><span style=" font-family:'Times New Roman,serif'; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif';"> .</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">EOF( </span><span style=" font-family:'Times New Roman,serif'; font-weight:600; font-style:italic; color:#000000;">номер_файла</span><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;"> )</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Возвращает true, если вы достигли конца файла, указанного номером файла. Больше информации </span><a href="https://support.office.com/en-sg/article/EOF-Function-ae0f97ab-d314-4857-8ae0-a243123ba859"><span style=" font-family:'Times New Roman,serif'; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif';"> .</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">Лок( </span><span style=" font-family:'Times New Roman,serif'; font-weight:600; font-style:italic; color:#000000;">номер_файла</span><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;"> )</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Возвращает </span><span style=" font-family:'Times New Roman,serif'; font-weight:600;">текущую позицию чтения/записи</span><span style=" font-family:'Times New Roman,serif';"> в открытом файле. Больше информации </span><a href="https://msdn.microsoft.com/en-us/library/5tb5ex52(v=vs.90).aspx"><span style=" font-family:'Times New Roman,serif'; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif';"> .</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">LOF( </span><span style=" font-family:'Times New Roman,serif'; font-weight:600; font-style:italic; color:#000000;">номер_файла</span><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;"> )</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Возвращает размер в байтах файла, представленного номером файла. Больше информации </span><a href="https://msdn.microsoft.com/en-us/library/dtz29k5z(v=vs.90).aspx"><span style=" font-family:'Times New Roman,serif'; font-weight:600; text-decoration: underline; color:#008000;">здесь</span></a><span style=" font-family:'Times New Roman,serif';"> .</span> </p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://analystcave.com/excel-use-form-controls-make-dynamic-excel-charts/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#2980b9; background-color:#ecf0f1; vertical-align:middle;">См. также </span></a><a href="https://analystcave.com/excel-use-form-controls-make-dynamic-excel-charts/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000; background-color:#ecf0f1; vertical-align:middle;">  </span></a><a href="https://analystcave.com/excel-use-form-controls-make-dynamic-excel-charts/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#000000; background-color:#ecf0f1; vertical-align:middle;">Использование элементов управления форм для создания динамических диаграмм Excel (без VBA)</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Вышеуказанные функции позволяют нативную загрузку файловых данных. Однако для более сложного сценария вы, вероятно, выберете </span><a href="https://analystcave.com/vba-filesystemobject-fso-in-excel/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">FileSystemObject</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">РЕЗЮМЕ ФАЙЛА ЧТЕНИЯ VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Чтение файлов в VBA не сложно и обычно требует всего несколько строк кода. Однако важно использовать соответствующий подход для чтения файла в VBA. Не все файлы нужно читать построчно, что обычно неэффективно. Точно так же вам не всегда нужно читать весь файл, если вам нужны только первые несколько/последние строки. Работа с файлами XML также не вызовет затруднений, если вы прочтете мой </span><a href="https://analystcave.com/vba-xml-working-xml-files/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">пост о том, как работать с файлами XML</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ХОТИТЕ ВМЕСТО ЭТОГО ПИСАТЬ В ФАЙЛЫ?</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Если вы хотите писать в файлы вместо использования VBA, прочитайте мою статью о том, </span><a href="https://analystcave.com/vba-write-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">как писать в файлы с помощью VBA</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>