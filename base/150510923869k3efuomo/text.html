<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">доброго всем.   <br />гм... возможно, вопрос смешной, но быстрый ответ не нашелся.    <br />поиск по форуму дал 9106 результатов и, м.б., где-то среди них есть нужный... :))   <br />  <br />если кому не трудно, напомните, плиз: как в VBA простым способом отформатировать числовое значение времени, чтобы для 1.2 получить строку &quot;28:48:00&quot;   <br />  <br /></span><span style=" font-family:'Courier New'; color:#008000;">' вариант1:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">a</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> format</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">int</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">t</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">*</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">24</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#808080;">&quot;0&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; color:#000000;"> format</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">t</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#808080;">&quot;:nn:ss&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#008000;">'работает, конечно...   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">но как</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;">то некрасиво это </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'Лучше использовать округление в меньшую сторону т.к. остаток бкдет отображен в минутах и секундах'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'А при преобразовании в Int(Long) часто округление в большую сторону и добавляет лишний час'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">a </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> Trim</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">Application.WorksheetFunction.RoundDown</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">str_value </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">*</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">24</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">))</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; color:#000000;"> Format</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">str_value</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#808080;">&quot;:nn:ss&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">' да, наверное.    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">' полазив по Object Browser, нашел еще один рабочий вариант:   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">' вариант2:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">?</span><span style=" font-family:'Courier New'; color:#000000;"> worksheetfunction.text</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1.2</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#808080;">&quot;[h]:mm:ss&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">' по сути то же самое. вот только не знаю, что быстрее. хотя... мне пока неважно - вычисления хоть и в цикле, но не слишком часто.</span><span style=" font-family:'DejaVu Sans';"><br />  <br />спасибо, тема закрыта.</span></p></body></html>