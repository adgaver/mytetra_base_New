<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:600; color:#ff55ff; background-color:#ffffff;">let</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    ISO8601Week = (Date as date) =&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:600; color:#ff55ff; background-color:#ffffff;">let</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    AncillaryWeek = (Date as date) =&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#ff55ff; background-color:#ffffff;">let</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    WeekDay = 1 + Date.DayOfWeek(Date, Day.Monday),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    OrdinalDay = Date.DayOfYear(Date),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    AncillaryWeekNumber = Number.RoundDown((OrdinalDay - WeekDay + 10) / 7)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:600; color:#ff55ff; background-color:#ffffff;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    AncillaryWeekNumber,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    ThisYear = Date.Year(Date),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    PriorYear = ThisYear - 1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    AncillaryNumber = AncillaryWeek(Date),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    LastWeekOfPriorYear = AncillaryWeek(#date(PriorYear, 12, 28)),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    LastWeekOfThisYear = AncillaryWeek(#date(ThisYear, 12, 28)),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    WeekNumber = if AncillaryNumber &lt; 1 then LastWeekOfPriorYear else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    if AncillaryNumber &gt; LastWeekOfThisYear then 1 else AncillaryNumber</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:600; color:#ff55ff; background-color:#ffffff;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    WeekNumber</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#ff55ff; background-color:#ffffff;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'SegoeUI,Lato,Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:15px; font-weight:296; color:#000000; background-color:#ffffff;">    ISO8601Week</span></p></body></html>