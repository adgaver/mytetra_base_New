<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; font-style:italic; color:#008000;">//разбить текст в список по заданным разделителям, склеить через пробел</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; font-style:italic; color:#008000;">//https://www.planetaexcel.ru/forum/index.php?PAGE_NAME=message&amp;FID=1&amp;TID=96755</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; font-style:italic; color:#008000;">//https://comrade-xl.ru/2019/12/31/power-query-udalit-lishnie-probeli/?</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    str_Text_Split</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Text.From</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Character.FromNumber</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#800080;">32</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">)&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Character.FromNumber</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#800080;">160</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">)&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;.&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    fun_Clear_text </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">this </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff8000;">as</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff8000;">as</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">text</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Text.Combine</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">List.Select</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Text.SplitAny</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">this</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> str_Text_Split</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> _ </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">&lt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot; &quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">),</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    Clear_text </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Table.TransformColumns</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">old_step</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">{</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;Column1&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> fun_Clear_text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff8000;">type</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;Column2&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> fun_Clear_text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff8000;">type</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">},</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;Column3&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> fun_Clear_text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff8000;">type</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">}</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">}),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                                  </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    PromoteHeaders</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Table.PromoteHeaders</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Clear_text</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">PromoteAllScalars</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#800080;">true</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">]),</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; font-style:italic; color:#008000;">//изменить тип столбцов</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    List_Cln_Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Table.ColumnNames</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">PromoteHeaders</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; font-style:italic; color:#008000;">//List_Cln_Name1=List.Range(List_Cln_Name, 1), </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    TransformColumnTypes </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Table.TransformColumnTypes</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">PromoteHeaders</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">List.Transform</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">List.Range</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">List_Cln_Name</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#800080;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">_</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080c0;">Int64.Type</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0080ff;">}))</span></p></body></html>