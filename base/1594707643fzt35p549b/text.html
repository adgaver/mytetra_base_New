<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.excelguru.ca/forums/showthread.php?9754-Import-Dynamic-Workbook"><span style=" font-family:'verdana,arial,sans-serif'; font-size:10pt; font-weight:600; text-decoration: underline; color:#0000ff;">Import Dynamic Workbook</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-28, 04:33 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Hello,</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />I'm new to power query and would like some help on import workbook with dynamic file location.<br /><br />I have a an excel file with power query saved under W:\Excel\Jan and the source file is saved under W:\Excel\Jan\Source. I copy the same file to another location for the next month (W:\Excel\Feb) from a new source file W:\Excel\Feb\Source.<br /><br />I don't want to change my source from my queries every month, is there anyway to have a dynamic source location?<br /><br />I have googled and it suggested to create a parameter table with the value of the source location =LEFT(CELL(&quot;filename&quot;,A1),FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1),1)-1) and create a ParameterValue query of = Table.TransformColumnTypes(Source,{{&quot;ParameterValue&quot;, type text}}). Now I'm stuck. In my query, I changed my source to the following but it is giving me an error or &quot;The important ParameterQuery matches no exports&quot;:<br />Let<br />Source = Excel.Workbook(File.Contents(ParameterQuery[ParameterValue]{0})),<br /><br />I am not a tech savy and have no idea how it should work. Much appreciated if anyone could help.<br /><br />Thanks.<br />Belebala</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-29, 02:01 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">There are several ways to do what you want, the following is the method that Ken Puls uses in his excellent book M is for (Data) Monkey</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br />In the workbook where you have your PowerQuery, create an Excel Table, name it 'ParameterTable' with two columns 'Parameter' and 'Value' and add a parameter in the first row of the table.<br />Enter FilePath in the first row of the Parameter column and enter a value path name (e:\pq) in the first row of the value column.<br />Create a blank query and select 'View' and 'Advanced Editor'<br />Past the following<br /></span><span style=" font-family:'Consolas'; font-size:9pt; color:#005500;">// fnGetParameter function written by Ken Puls, FCPA, FCMA, MS MVP (Excel)<br />// Original source can be found at the following URL:<br />// http://www.excelguru.ca/blog/2014/11/26/building-a-parameter-table-for-power-query/<br /><br />// To use the function you must have a table called &quot;Parameters&quot; in your workbook<br />// The header row must contain a &quot;Parameter&quot; and a &quot;Value&quot; column (with those names)<br /><br />// Data rows should list the paramter name in the first column and the value of that<br />// parameter in the second column<br /><br />// Provided you save this query under the name &quot;fnGetParameter&quot;, you can then reference<br />// it from other queries as follows:<br />//<br />// =fnGetParameter(&quot;your_parameter_name&quot;)<br /><br />// One useful sample to return the current folder:<br />// Parameter Name: File Path<br />// Parameter Value: =LEFT(CELL(&quot;filename&quot;,A1),FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1),1)-1)<br />// Call as &quot;fnGetParamater(&quot;File Path&quot;)</span><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;"><br /><br />(ParameterName as text) =&gt;<br />let<br />ParamSource = Excel.CurrentWorkbook(){[Name=&quot;Parameters&quot;]}[Content],<br />ParamRow = Table.SelectRows(ParamSource, each ([Parameter]=ParameterName)),<br />Value=<br />if Table.IsEmpty(ParamRow)=true<br />then null<br />else Record.Field(ParamRow{0},&quot;Value&quot;)<br />in<br />Value</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />save and name the query as fnGetParameter in your existing query edit the existing source line so it looks like<br /><br />Source = Folder.Files(fnGetParameter(&quot;FilePath&quot;)),<br /><br />You can now use the table created above as a 'variable' data source.<br /><br />Paul Christie</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-29, 03:01 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Hi Paul Christie,</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />After I replaced the code of fnGetParameter, it asked me to invoke my function and the function return null. Is it normal?<br /><br />88278828</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 10:36 AM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">If you enter 'FilePath' and then press the Invoke button it should return the value you have for that parameter in the table.</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />Paul</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 01:39 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Ok, I have invoke the File Path as a parameter. Now I get an error when I tried to add a custom column of File Path in MyTable query. I'm sorry for so many questions.</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br />8829</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 01:48 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Is it possible for you to post the workbook so I can look at it?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 02:16 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Sure. That would be very helpful if you could review it.</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />Thank you.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 02:37 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">The fnGetParameter bit works perfectly it's the next bit that is causing you the problem. I'll see what I can do with one of my examples. What's your location from a time zone point of view relative to the UK?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 04:50 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">My time zone is GTM-6.</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />Thanks a bunch for looking into this for me.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 06:18 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">I've attached a full example using anonomised data</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />8832<br /><br />Hope this helps</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 06:39 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">I got a question, why my query fnGetParameter display the table icon not function icon? Did I do something wrong?</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />8833</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 06:50 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Without being able to watch what you were doing I can't be sure. What I did was create a blank query, pasted the function code in, named the function as fnGetParameter and saved it as connection only.</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />Paul</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 06:59 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">I think I got ParameterTable query working. How do I replace the source file if my import file is an excel workbook?</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />I tried this, but it said token identifier expected.<br />Source = Excel.Workbook(fnGetParameter(&quot;FilePath&quot;)&amp;fnGetParameter(&quot;FileName&quot;)),null, true),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 08:13 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">The source line needs to look like this</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />Source = Excel.Workbook(File.Contents(fnGetParameter(&quot;FilePath&quot;)&amp;fnGetParameter(&quot;FileName&quot;)), null, true),<br /><br />Paul</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-30, 08:20 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Now I get the error of :</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br />Expression.Error: We cannot convert the value &quot;D:\PowerQuery...&quot; to type Function.<br />Details:<br />Value=D:\PowerQuery\<br />Type=Type<br /><br />Any idea?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-31, 04:23 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">Is it possible to post the workbook with the query and the workbook with the data so i can see both ends of what is going wrong?</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />Paul</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-31, 04:41 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">My query is saved under the Dynamic File Test and the data is coming fom the Book1 workbook.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Paul_Christie</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-31, 06:17 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">It looks like it had something to do with how you created fnGetParameter</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />88438844<br /><br />Have you got Ken Puls book M is for (Data) Monkey. It really is worth every penny it will cost you.<br /><br />Paul</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">Belebala</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-01-31, 06:36 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">I will definitely grab Ken Puls' book.</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />I get it now, if I invoked the fnGetParameter query, it will turn into the query table icon. If I don't invoke it, it will work.<br /><br />Thank you very much Paul for solving my problem. I appreciate your effort!<br /><br />Belebala</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">El Cid</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-03-27, 03:01 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">let</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br />path = Excel.CurrentWorkbook(){[Name=&quot;PATH&quot;]}[Content]{0}[Column1],<br />filename = Excel.CurrentWorkbook(){[Name=&quot;FNAME&quot;]}[Content]{0}[Column1],<br />address = Text.Combine({path,filename}, &quot;&quot;),<br />Source = Excel.Workbook(File.Contents(address), null, true),<br /><br /><br /><br /><br />First you make two named ranges in a separate worksheet tab I name PARAM: PATH and FNAME using two separate cells, one right after the other.<br /><br /><br /><br /><br />Next, place these formulas in each of these named ranges<br /><br /><br /><br /><br />In PATH and put this formula (which gets the path of the current spreadsheet) in it:<br /><br /><br />=LEFT(CELL(&quot;filename&quot;,A1),FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1))-1)<br /><br /><br /><br />FNAME and put this formula (to get the name of the current spreadsheet) in it if you are pulling data from it to use in your current spreadsheet.<br /><br /><br />=MID(CELL(&quot;filename&quot;,A1),FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1))+1,FIND(&quot;]&quot;, CELL(&quot;filename&quot;,A1))-FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1))-1)<br /><br />OR<br /><br />Just type in the name of the file you want to use.<br /><br /><br /><br />Then, to transfer it to Power Query as a constants, you insert these lines in the PQ editor:<br /><br /><br />path = Excel.CurrentWorkbook(){[Name=&quot;PATH&quot;]}[Content]{0}[Column1],<br />filename = Excel.CurrentWorkbook(){[Name=&quot;FNAME&quot;]}[Content]{0}[Column1],<br /><br />It loads the named ranges as a (single value) table and gets the first row ({0}) of Column1, i.e., the path and file name of the current sheet. This way, you can load the file using a relative address and you &quot;current file&quot; can change names.<br /><br /><br /><br />Now you assign the variable &quot;address&quot; to the actual name of your import file combined with the &quot;path&quot; added in step 2.<br /><br /><br />address = Text.Combine({path,filename}, &quot;&quot;),<br /><br />OR, if you did not use FNAME<br /><br />address = Text.Combine({path,&quot;QB QIP.csv&quot;}, &quot;&quot;), //Note that “path” will be the path to the current spreadsheet. If the files are in the same folder, then their paths are “path” as well<br /><br /><br /><br />This final steps brings it all together and will import the desired file<br /><br /><br />Excel File: Source = Excel.Workbook(File.Contents(address), null, true),<br />CSV File: Source = Csv.Document(File.Contents(address),[Delimiter=&quot;,&quot;, Encoding=1252, QuoteStyle=QuoteStyle.None]),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; font-weight:600; color:#000000;">El Cid</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;">2019-03-27, 03:46 PM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000; background-color:#f9f9f9;">I prefer the Range Naming method.</span><span style=" font-family:'verdana,arial,sans-serif'; font-size:11px; color:#000000;"><br /><br />let<br />path = Excel.CurrentWorkbook(){[Name=&quot;PATH&quot;]}[Content]{0}[Column1],<br />filename = Excel.CurrentWorkbook(){[Name=&quot;FNAME&quot;]}[Content]{0}[Column1],<br />address = Text.Combine({path,filename}, &quot;&quot;),<br />Source = Excel.Workbook(File.Contents(address), null, true),<br /><br /><br /><br /><br />PARAM tab: First set up a worksheet tab named PARAM or whatever name you like that will contain the range names where you do not want to dump your data when and if you do dump your PQ report to a sheet.<br />RANGE NAMES: In this tab-sheet named PARAM, or whatever, setup two named ranges: PATH and FNAME using two separate cells. Place them right after each other cell A1 and then cell A2.<br />FORMULAS for NAMED RANGES: Next, place these formulas in each of these named ranges<br /><br /><br /><br />a. PATH - put this formula (which gets the path of the current spreadsheet) in it:<br /><br /><br /><br />=LEFT(CELL(&quot;filename&quot;,A1),FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1))-1)<br /><br /><br /><br />b. FNAME - put this formula (to get the name of the current spreadsheet) in it if you are pulling data from it to use in your current spreadsheet.<br /><br />=MID(CELL(&quot;filename&quot;,A1),FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1))+1,FIND(&quot;]&quot;, CELL(&quot;filename&quot;,A1))-FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1))-1)<br /><br />OR<br /><br />Just type in the full name of the file you want to use, including the file name extension.<br /><br /><br /><br />4. Insert these lines in the PQ editor to bring them into your query:<br /><br />path = Excel.CurrentWorkbook(){[Name=&quot;PATH&quot;]}[Content]{0}[Column1],<br />filename = Excel.CurrentWorkbook(){[Name=&quot;FNAME&quot;]}[Content]{0}[Column1],<br /><br />It loads the named ranges as a (single value) table and gets the first row ({0}) of Column1, i.e., the path and file name of the current sheet. This way, you can load the file using a relative address and you &quot;current file&quot; can change names.<br /><br />5. &quot;address&quot; variable: Now you assign the variable &quot;address&quot; to the actual name of your import file combined with the &quot;path&quot; added in steps 2-3.<br /><br />address = Text.Combine({path,filename}, &quot;&quot;),<br /><br />OR, if you did not use FNAME<br /><br />address = Text.Combine({path,&quot;PICKME.csv&quot;}, &quot;&quot;),<br /><br />//Note that “path” will be the path to the current spreadsheet. If they are in a different location you'll have to override the formula used in step 3.<br /><br />6. This final steps brings it all together and will import the desired file<br /><br />Excel File: Source = Excel.Workbook(File.Contents(address), null, true),<br /><br />CSV File: Source = Csv.Document(File.Contents(address),[Delimiter=&quot;,&quot;, Encoding=1252, QuoteStyle=QuoteStyle.None]),<br /><br />Examples:<br /><br />//CSVFILE_NEW.csv<br />let<br />path = Excel.CurrentWorkbook(){[Name=&quot;PATH&quot;]}[Content]{0}[Column1],<br />filename = Excel.CurrentWorkbook(){[Name=&quot;FNAME&quot;]}[Content]{0}[Column1],<br />address = Text.Combine({path,filename}, &quot;&quot;),<br />Source = Csv.Document(File.Contents(address),[Delimiter=&quot;,&quot;, Encoding=1252, QuoteStyle=QuoteStyle.None])<br />in<br />Source<br /><br />//EXCEL FILE.xlsx<br />let<br />path = Excel.CurrentWorkbook(){[Name=&quot;PATH&quot;]}[Content]{0}[Column1],<br />filename = Excel.CurrentWorkbook(){[Name=&quot;FNAME&quot;]}[Content]{0}[Column1],<br />address = Text.Combine({path,filename}, &quot;&quot;),<br />Source = Excel.Workbook(File.Contents(address), null, true)<br />in<br />Source<br /><br /><br /><br /><br /><br />Reference: Thanks to VITO post here https://powerpivotpro.com/2015/10/share-and-refresh-power-query-with-local-links/#comment-235526</span></p></body></html>