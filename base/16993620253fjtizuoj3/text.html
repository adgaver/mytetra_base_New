<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; color:#000000;">Как конвертировать XLS в XLSX с помощью Python</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">В этом уроке мы узнаем, как конвертировать файлы Excel из формата .xls в формат .xlsx с помощью Python.</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Это может быть полезно, если у вас есть старые файлы Excel, которые необходимо обновить, или когда вам необходимо согласованно работать с файлами разных форматов. Для этого преобразования мы будем использовать библиотеки </span><span style=" font-family:'Open Sans'; font-size:14px; font-weight:600; color:#444444;">openpyxl</span><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;"> и </span><span style=" font-family:'Open Sans'; font-size:14px; font-weight:600; color:#444444;">xlrd .</span></p>
<p style=" margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%;"><span style=" font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;">Шаг 1. Установите необходимые библиотеки</span></p>
<p style="-qt-paragraph-type:empty; margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%; font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Во-первых, давайте установим необходимые библиотеки для этого преобразования. Вы можете установить </span><span style=" font-family:'Open Sans'; font-size:14px; font-weight:600; color:#444444;">openpyxl</span><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;"> и </span><span style=" font-family:'Open Sans'; font-size:14px; font-weight:600; color:#444444;">xlrd</span><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;"> с помощью pip, выполнив следующие команды:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">pip install openpyxl</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">pip install xlrd</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:14px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Прежде чем двигаться дальше, убедитесь, что эти библиотеки успешно установлены.</span></p>
<p style=" margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%;"><span style=" font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;">Шаг 2. Импортируйте необходимые библиотеки</span></p>
<p style="-qt-paragraph-type:empty; margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%; font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Теперь давайте импортируем необходимые библиотеки в наш скрипт Python:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,monospace'; font-size:14px; font-weight:496; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">import os</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">from openpyxl import Workbook</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">import xlrd</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:14px; color:#000000;"><br /></p>
<p style=" margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%;"><span style=" font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;">Шаг 3. Откройте файл XLS.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%; font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Теперь мы откроем файл .xls, используя библиотеку </span><span style=" font-family:'Open Sans'; font-size:14px; font-weight:600; color:#444444;">xlrd</span><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;"> . Сначала укажем путь к файлу .xls:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xls_file = 'sample.xls'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Далее мы откроем файл .xls с помощью </span><span style=" font-family:'Consolas,Monaco,Lucida Console,monospace'; font-size:14px; color:#444444;">xlrd.open_workbook</span><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">функции:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xls_workbook = xlrd.open_workbook(xls_file)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:14px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Теперь, когда мы открыли файл .xls, мы можем приступить к созданию нового файла .xlsx, который будет содержать данные из файла .xls.</span></p>
<p style=" margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%;"><span style=" font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;">Шаг 4. Конвертируйте XLS в XLSX.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%; font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Чтобы преобразовать данные из файла .xls в файл .xlsx, мы создадим новый объект рабочей книги </span><span style=" font-family:'Open Sans'; font-size:14px; font-weight:600; color:#444444;">openpyxl</span><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;"> и скопируем в него содержимое файла .xls:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xlsx_workbook = Workbook()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"># Iterate through sheet names</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">for sheet_name in xls_workbook.sheet_names():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    xls_sheet = xls_workbook.sheet_by_name(sheet_name)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    xlsx_sheet = xlsx_workbook.active</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    # Iterate through rows and columns of the xls sheet</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    for row in range(xls_sheet.nrows):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        for col in range(xls_sheet.ncols):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            cell_value = xls_sheet.cell_value(row, col)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            xlsx_sheet.cell(row=row + 1, column=col + 1, value=cell_value)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:14px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Здесь мы перебираем все листы в файле .xls и для каждого листа перебираем все строки и столбцы, чтобы скопировать значения ячеек из файла .xls в файл .xlsx.</span></p>
<p style=" margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%;"><span style=" font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;">Шаг 5. Сохраните файл XLSX.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:30px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.84615%; font-family:'Open Sans'; font-size:large; font-weight:600; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Теперь, когда все данные из файла .xls скопированы в файл .xlsx, мы можем сохранить файл .xlsx с тем же именем, но с расширением .xlsx:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,monospace'; font-size:14px; font-weight:496; color:#444444;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#272822">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-654a32be85a14524869772"></a>1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2</p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-654a32be85a14524869772-1"></a>xlsx_file = os.path.splitext(xls_file)[0] + '.xlsx'</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-654a32be85a14524869772-2"></a>xlsx_workbook.save(xlsx_file)</p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">Теперь ваш файл .xls должен быть успешно преобразован в формат .xlsx.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">Полный код:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">import os</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">from openpyxl import Workbook</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">import xlrd</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xls_file = 'sample.xls'</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xls_workbook = xlrd.open_workbook(xls_file)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xlsx_workbook = Workbook()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">for sheet_name in xls_workbook.sheet_names():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    xls_sheet = xls_workbook.sheet_by_name(sheet_name)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    xlsx_sheet = xlsx_workbook.active</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    for row in range(xls_sheet.nrows):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        for col in range(xls_sheet.ncols):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            cell_value = xls_sheet.cell_value(row, col)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            xlsx_sheet.cell(row=row + 1, column=col + 1, value=cell_value)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xlsx_file = os.path.splitext(xls_file)[0] + '.xlsx'</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">xlsx_workbook.save(xlsx_file)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:14px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">Заключение</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><span style=" font-family:'Open Sans'; font-size:14px; color:#444444;">В этом уроке мы узнали, как конвертировать файлы Excel из формата .xls в .xlsx с помощью библиотек openpyxl и xlrd в Python. Этот метод может быть полезен при работе с файлами Excel разных форматов и обновлении старых файлов до более нового формата. Удачной конвертации!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans'; font-size:large; font-weight:600; color:#444444;">Навигация по публикациям</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://techinima.com/python/add-a-variable-to-a-text-file-in-python/"><span style=" font-family:'Open Sans'; font-size:14px; text-decoration: underline; color:#21759b; background-color:#ffffff;">← Как добавить переменную в текстовый файл в Python                </span></a><a href="https://techinima.com/python/extract-specific-characters-from-a-string-in-python/"><span style=" font-family:'Open Sans'; font-size:14px; text-decoration: underline; color:#0f3647; background-color:#ffffff;">Как извлечь определенные символы из строки в Python →</span></a></p></body></html>