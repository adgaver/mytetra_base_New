<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vc.ru/dev/212520-massovaya-zamena-teksta-s-pomoshchyu-power-query?ysclid=l1dhgw3q9l"><span style=" font-size:11pt; text-decoration: underline; color:#0000ff;">Массовая замена текста с помощью Power Query — Разработка на vc.ru</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#004080;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#004080; background-color:#eeeeee;">let</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">   source </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#400080;">#table</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Найти&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;Заменить&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot; &quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;SAUF&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;/&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;.&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">   </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">   Справочник</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ToRecords</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">source</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">)</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-weight:600; color:#004080; background-color:#eeeeee;">in</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">   Справочник</span><span style=" font-size:11pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:11pt; background-color:#ffffff;"><br /></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//========================================================================</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//------------------------------------------------------------------------- </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//замена символов по списку внутри запроса (без добавления столбца)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//справочник символов для замены </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    source_справочник </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#400080;">#table</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Найти&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;Заменить&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;НОК&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;NOK&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;ОК&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;OK&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;НП&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;NT&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}</span><span style=" font-family:'Courier New'; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    Справочник1</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ToRecords</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">source_справочник</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    fun_Replace </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;"> this </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff8000;">as</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#000080;">text</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff8000;">as</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#000080;">text</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=&gt;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">List.Accumulate</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">Справочник1</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> this </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,(</span><span style=" font-family:'Courier New'; color:#000000;">state</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;">current</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">)=&gt;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Text.Replace</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">state</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;">current</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Courier New'; color:#000000;">Найти</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">],</span><span style=" font-family:'Courier New'; color:#000000;">current</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Courier New'; color:#000000;">Заменить</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">])),</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    Clear_text </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.TransformColumns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;"> #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Переименованные столбцы&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Результат&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> fun_Replace  </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">                                        </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//------------------------------------------------------------------------- </span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//========================================================================</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-weight:600; color:#004080; background-color:#eeeeee;">let</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//справочник значений для замены</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    source_справочник </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#400080;">#table</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Найти&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;Заменить&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot; &quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;SAUF&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;/&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">},</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">         </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;.&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">      </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">   </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">   Справочник1</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ToRecords</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">source_справочник</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//источник основной таблицы</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    Источник </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Excel.CurrentWorkbook</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(){[</span><span style=" font-family:'Courier New'; color:#000000;">Name</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Таблица1&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]}[</span><span style=" font-family:'Courier New'; color:#000000;">Content</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">],</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Строки с примененным фильтром&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.SelectRows</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">Источник</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">([</span><span style=" font-family:'Courier New'; color:#000000;">Column1</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">&lt;&gt;</span><span style=" font-family:'Courier New'; color:#000000;"> null</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">)),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Другие удаленные столбцы&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">#</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Строки с примененным фильтром&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Column1&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Удаленные дубликаты&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.Distinct</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">#</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Другие удаленные столбцы&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Текст в верхнем регистре&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.TransformColumns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">#</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Удаленные дубликаты&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,{{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Column1&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Text.Upper</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff8000;">type</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#000080;">text</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}}),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//замена значений по списку</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Добавлен пользовательский объект&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.AddColumn</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">#</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Текст в верхнем регистре&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;Item&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">List.Accumulate</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">Справочник1</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,[</span><span style=" font-family:'Courier New'; color:#000000;">Column1</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">],(</span><span style=" font-family:'Courier New'; color:#000000;">state</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;">current</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">)=&gt;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Text.Replace</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">state</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;">current</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Courier New'; color:#000000;">Найти</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">],</span><span style=" font-family:'Courier New'; color:#000000;">current</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Courier New'; color:#000000;">Заменить</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]))),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Удаленные столбцы&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.RemoveColumns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">#</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Добавлен пользовательский объект&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Column1&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}),</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-weight:600; color:#004080; background-color:#eeeeee;">in</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Удаленные столбцы&quot;</span><span style=" font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//========================================================================</span><span style=" font-size:11pt;"> </span><span style=" font-family:'Courier New'; color:#000000;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:11pt;">  </span></p></body></html>