<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,geneva,lucida,lucida grande,arial,helvetica,sans-serif'; font-size:13px; color:#000000; background-color:#f6f6f6;">В любом случае - открытый рекордсет - это переменная в памяти компьютера, а не объект базы данных. Из переменной нельзя сделать From. В принципе нельзя. </span><span style=" font-family:'verdana,geneva,lucida,lucida grande,arial,helvetica,sans-serif'; font-style:italic; color:#808080; background-color:#f6f6f6;">Добавлено через 5 минут</span><span style=" font-family:'verdana,geneva,lucida,lucida grande,arial,helvetica,sans-serif'; font-size:13px; color:#000000; background-color:#f6f6f6;"> Какую альтернативу можно педложить, если ссылка на базу оракл в тексте запроса не получитя: </span></p>
<p style="-qt-paragraph-type:empty; margin-top:5px; margin-bottom:5px; margin-left:30px; margin-right:10px; -qt-block-indent:0; text-indent:0px; font-family:'verdana,geneva,lucida,lucida grande,arial,helvetica,sans-serif'; font-size:13px; color:#000000; background-color:#f6f6f6;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:10px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td colspan="2" style=" padding-left:2; padding-right:2; padding-top:2; padding-bottom:2;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'sans-serif'; font-size:11px; font-weight:600; color:#606060;">Visual Basic</span><a href="https://www.cyberforum.ru/#"><span style=" font-family:'sans-serif'; font-size:11px; text-decoration: underline; color:#606060;">Выделить код</span></a></p></td></tr></thead>
<tr>
<td style=" vertical-align:top;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top; padding-left:5; padding-right:10; padding-top:0; padding-bottom:0;"></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#151b8d;">Dim</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> rsADO </span><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#151b8d;">As</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> Adodb.Recordset, rsGoal </span><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#151b8d;">As</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> Adodb.Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#151b8d;">Set</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> rsADO = </span><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#e56717;">New</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> ADODB.Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">rsADO.</span><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#151b8d;">Open</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> SQL_запрос,Conn, и т.д.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#151b8d;">Set</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> rsGoal = </span><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#e56717;">New</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> ADODB.Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">rsGoal.</span><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#151b8d;">Open</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> ИмяТаблицыКуда, Conn, и т.д.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#8d38c9;">While</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:13px; font-weight:696; color:#8d38c9;">not</span><span style=" font-family:'Courier New'; font-size:13px; color:#000000;"> rsADO.EOF</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">    rsGoal.AddNew</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">    rsGoal.ИмяПоля = rsADO.ИмяПоля</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">    rsGoal.ИмяПоля = rsADO.ИмяПоля</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">....</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">    rsGoal.ИмяПоля = rsADO.ИмяПоля</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">    rsADO.MoveNext</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">wend</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:13px; color:#000000;">rsGoal.UpdateBatch</span></p></td></tr></table></td>
<td></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'verdana,geneva,lucida,lucida grande,arial,helvetica,sans-serif'; font-style:italic; color:#808080; background-color:#f6f6f6;">Добавлено через 59 секунд</span><span style=" font-family:'verdana,geneva,lucida,lucida grande,arial,helvetica,sans-serif'; font-size:13px; color:#000000; background-color:#f6f6f6;"> В некоторых случаях метод .UpdateBatch не работает (если честно, я по хелпу по ADO так и не поняла, в каких именно (похоже, зависит от особенностей конкретного сервера), посто запомнила сам факт, что может и не работать) - тогда нужно делать rsGoal.Update в каждом цикле. Но на MS SQL Server .UppendAll работал нормально.</span></p></body></html>