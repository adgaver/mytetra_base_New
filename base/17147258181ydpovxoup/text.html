<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-weight:400; font-style:normal; "  bgcolor="#ffffff">
Version:0.9
StartHTML:0000000187
EndHTML:0000031940
StartFragment:0000000223
EndFragment:0000031904
SourceURL:https://learntutorials.net/ru/vba/topic/990/scripting-filesystemobject
<html>
<body>
<!--StartFragment--><header style="box-sizing: border-box; color: rgb(0, 0, 0); font-family: Candara; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.5px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><div class="page-header bg-colorful" style="box-sizing: border-box; background: linear-gradient(90deg, rgba(2, 0, 36, 0.9) 0%, rgba(84, 37, 105, 0.9) 66%, rgba(69, 174, 195, 0.9) 100%) 0% 0% / cover, url(&quot;/assets/images/abstract-waves-2.jpg&quot;); color: rgb(255, 255, 255); padding: 30px 0px; min-height: 300px; text-align: center;"><div class="container-content" style="box-sizing: border-box; position: relative; width: 1000px; margin-left: 300px; padding-left: 20px; padding-right: 20px;"><h1 id="vba------------------------------scripting-filesystemobject" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem; font-size: 3.75rem; font-weight: 300; letter-spacing: 3px; line-height: 1.25;">Scripting.FileSystemObject</h1><div class="url-list" style="box-sizing: border-box; margin-bottom: 50px;"><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(34, 34, 34); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(51, 51, 51);"><a href="https://learntutorials.net/ru/dot-net/topic/14/-----------------net-framework" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">.NET Framework</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(17, 17, 17); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(34, 34, 34);"><a href="https://learntutorials.net/ru/csharp/topic/15/----------------c-sharp-language" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">C# Language</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(34, 34, 34); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(51, 51, 51);"><a href="https://learntutorials.net/ru/excel-vba/topic/777/----------------excel-vba" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">excel-vba</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(17, 17, 17); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(34, 34, 34);"><a href="https://learntutorials.net/ru/html/topic/217/----------------html" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">HTML</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(34, 34, 34); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(51, 51, 51);"><a href="https://learntutorials.net/ru/javascript/topic/185/----------------javascript" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">JavaScript</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(17, 17, 17); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(34, 34, 34);"><a href="https://learntutorials.net/ru/python/topic/193/-----------------------python" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">Python Language</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(34, 34, 34); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(51, 51, 51);"><a href="https://learntutorials.net/ru/regex/topic/259/---------------------------------------" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">Regular Expressions</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(17, 17, 17); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(34, 34, 34);"><a href="https://learntutorials.net/ru/sql/topic/184/----------------sql" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">SQL</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(34, 34, 34); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(51, 51, 51);"><a href="https://learntutorials.net/ru/sql-server/topic/236/----------------microsoft-sql-server" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">Microsoft SQL Server</a></span><span> </span><span class="url-item" style="box-sizing: border-box; border: 1px solid rgb(17, 17, 17); display: inline-block; padding: 3px 10px; margin: 3px; letter-spacing: 2px; background-color: rgb(34, 34, 34);"><a href="https://learntutorials.net/ru/vb-net/topic/352/----------------visual-basic--net-language" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none;">Visual Basic .NET Language</a></span></div></div></div><div class="page-header-append" style="box-sizing: border-box; position: relative; top: -60px;"><div class="container-content" style="box-sizing: border-box; position: relative; width: 1000px; margin-left: 300px; padding-left: 20px; padding-right: 20px;"><div class="box-search-google" style="box-sizing: border-box; background: linear-gradient(33deg, rgb(23, 23, 23) 50%, rgb(75, 75, 75) 100%); color: rgb(255, 255, 255); margin: auto; padding: 20px; width: 576px;"><div class="box-header" style="box-sizing: border-box; margin-bottom: 10px;"><h5 id="------" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem; font-size: 20px; font-weight: 300; letter-spacing: 2px; text-transform: uppercase;"><i class="fas fa-binoculars" style="box-sizing: border-box; -webkit-font-smoothing: antialiased; display: inline-block; font-style: normal; font-variant: normal; text-rendering: auto; line-height: 1; font-family: &quot;Font Awesome 5 Pro&quot;; font-weight: 900; color: rgb(0, 144, 186);"></i><span> </span>ПОИСК…</h5></div><div class="box-body" style="box-sizing: border-box; padding-bottom: 1rem;"><div id="___gcse_0" dir="ltr" style="box-sizing: border-box;"><form class="gsc-search-box gsc-search-box-tools" accept-charset="utf-8" style="box-sizing: border-box; font-size: 13px; margin: 0px 0px 4px; width: 536px;"><table cellspacing="0" cellpadding="0" role="presentation" class="gsc-search-box" style="box-sizing: border-box; border-collapse: collapse; border-style: none; border-width: 0px; border-spacing: 0px; width: 536px; margin-bottom: 2px;"><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box;"><td class="gsc-input" style="box-sizing: border-box; font-size: 16px; vertical-align: middle; padding-right: 0px;"><div class="gsc-input-box" id="gsc-iw-id1" style="box-sizing: border-box; border: 0px; background: rgb(64, 64, 65);"><table cellspacing="0" cellpadding="0" role="presentation" id="gs_id50" class="gstl_50 gsc-input" style="box-sizing: border-box; border-collapse: collapse; font-size: 16px; padding: 0px; width: 469px;"><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box;"><td id="gs_tti50" class="gsib_a" style="box-sizing: border-box; width: 465px; padding: 0px; vertical-align: middle;"><input autocomplete="off" type="text" size="10" class="gsc-input" name="search" title="поиск" aria-label="поиск" id="gsc-i-id1" dir="ltr" spellcheck="false" style="box-sizing: border-box; font-size: 1.125rem; padding: 0px; border: none; width: 465px; background: url(&quot;https://www.google.com/cse/static/images/1x/ru/branding.png&quot;) left center no-repeat rgb(255, 255, 255); color: rgb(255, 255, 255); letter-spacing: 2px; opacity: 0.5; height: auto; margin: 0px; outline: none;"></td><td class="gsib_b" style="box-sizing: border-box; vertical-align: middle;"><div class="gsst_b" id="gs_st50" dir="ltr" style="box-sizing: border-box; font-size: 16px; padding: 0px 2px; position: relative; user-select: none; white-space: nowrap;"></div></td></tr></tbody></table></div></td><td class="gsc-search-button" style="box-sizing: border-box; width: 67px; margin: 0px; vertical-align: middle; background-color: rgb(64, 64, 65); border: 0px; height: 3.625rem;"><button class="gsc-search-button gsc-search-button-v2" style="box-sizing: border-box; width: auto; margin: 0px; font-size: 0px; padding: 6px 27px; vertical-align: middle; border: 0px; border-radius: 2px; background-color: rgb(64, 64, 65); height: 3.625rem;"><svg width="13" height="13" viewBox="0 0 13 13"><path d="m4.8495 7.8226c0.82666 0 1.5262-0.29146 2.0985-0.87438 0.57232-0.58292 0.86378-1.2877 0.87438-2.1144 0.010599-0.82666-0.28086-1.5262-0.87438-2.0985-0.59352-0.57232-1.293-0.86378-2.0985-0.87438-0.8055-0.010599-1.5103 0.28086-2.1144 0.87438-0.60414 0.59352-0.8956 1.293-0.87438 2.0985 0.021197 0.8055 0.31266 1.5103 0.87438 2.1144 0.56172 0.60414 1.2665 0.8956 2.1144 0.87438zm4.4695 0.2115 3.681 3.6819-1.259 1.284-3.6817-3.7 0.0019784-0.69479-0.090043-0.098846c-0.87973 0.76087-1.92 1.1413-3.1207 1.1413-1.3553 0-2.5025-0.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239c0-1.3553 0.4696-2.4966 1.4088-3.4239 0.9392-0.92727 2.0864-1.3969 3.4417-1.4088 1.3553-0.011889 2.4906 0.45771 3.406 1.4088 0.9154 0.95107 1.379 2.0924 1.3909 3.4239 0 1.2126-0.38043 2.2588-1.1413 3.1385l0.098834 0.090049z"></path></svg></button></td></tr></tbody></table></form></div></div></div></div></div></header><br style="box-sizing: border-box; color: rgb(0, 0, 0); font-family: Candara; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.5px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><br style="box-sizing: border-box; color: rgb(0, 0, 0); font-family: Candara; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.5px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><div class="container-content" style="box-sizing: border-box; position: relative; width: 1000px; margin-left: 300px; padding-left: 20px; padding-right: 20px; color: rgb(0, 0, 0); font-family: Candara; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.5px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><div id="___gcse_1" style="box-sizing: border-box;"><div class="gsc-control-cse gsc-control-cse-ru" style="box-sizing: border-box; padding: 1em; width: auto; font-family: arial, sans-serif; font-size: 13px; background-color: rgb(255, 255, 255); border: 1px solid rgb(255, 255, 255);"><div class="gsc-control-wrapper-cse" dir="ltr" style="box-sizing: border-box; width: 932px;"><div class="gsc-results-wrapper-nooverlay" style="box-sizing: border-box;"><div class="gsc-positioningWrapper" style="box-sizing: border-box; position: relative;"></div><div class="gsc-positioningWrapper" style="box-sizing: border-box; position: relative;"></div><div class="gsc-wrapper" style="box-sizing: border-box; position: relative; display: block;"></div></div></div></div></div></div><span class="ezoic-autoinsert-video ezoic-under_page_title" style="box-sizing: border-box; color: rgb(0, 0, 0); font-family: Candara; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.5px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"></span><div class="container-content" style="box-sizing: border-box; position: relative; width: 1000px; margin-left: 300px; padding-left: 20px; padding-right: 20px; color: rgb(0, 0, 0); font-family: Candara; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.5px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><div id="ezoic-pub-ad-placeholder-110" style="box-sizing: border-box;"></div><h2 id="создание-файла-filesystemobject" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Создание файла FileSystemObject</h2><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForReading = 1</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForWriting = 2</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForAppending = 8</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub FsoExample()</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim fso As Object ' declare variable</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set fso = CreateObject("Scripting.FileSystemObject") ' Set it to be a File System Object</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    ' now use it to check if a file exists</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFilePath As String</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    myFilePath = "C:\mypath\to\myfile.txt"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    If fso.FileExists(myFilePath) Then</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        ' do something</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Else</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        ' file doesn't exist</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        MsgBox "File doesn't exist"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    End If</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><span class="ezoic-autoinsert-video ezoic-under_first_paragraph" style="box-sizing: border-box;"></span><h2 id="чтение-текстового-файла-с-помощью-filesystemobject" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Чтение текстового файла с помощью FileSystemObject</h2><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForReading = 1</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForWriting = 2</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForAppending = 8</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub ReadTextFileExample()</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim fso As Object</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set fso = CreateObject("Scripting.FileSystemObject")</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim sourceFile As Object</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFilePath As String</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFileText As String</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    myFilePath = "C:\mypath\to\myfile.txt"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set sourceFile = fso.OpenTextFile(myFilePath, ForReading)</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    myFileText = sourceFile.ReadAll ' myFileText now contains the content of the text file</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    sourceFile.Close ' close the file</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    ' do whatever you might need to do with the text</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    ' You can also read it line by line</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim line As String</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set sourceFile = fso.OpenTextFile(myFilePath, ForReading)</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    While Not sourceFile.AtEndOfStream ' while we are not finished reading through the file</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        line = sourceFile.ReadLine</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        ' do something with the line...</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Wend</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    sourceFile.Close</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><span class="ezoic-autoinsert-video ezoic-under_second_paragraph" style="box-sizing: border-box;"></span><h2 id="создание-текстового-файла-с-помощью-filesystemobject" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Создание текстового файла с помощью FileSystemObject</h2><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub CreateTextFileExample()</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim fso As Object</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set fso = CreateObject("Scripting.FileSystemObject")</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim targetFile As Object</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFilePath As String</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFileText As String</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    myFilePath = "C:\mypath\to\myfile.txt"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set targetFile = fso.CreateTextFile(myFilePath, True)  ' this will overwrite any existing file</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    targetFile.Write "This is some new text"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    targetFile.Write " And this text will appear right after the first bit of text."</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    targetFile.WriteLine "This bit of text includes a newline character to ensure each write takes its own line."</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    targetFile.Close ' close the file</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><h2 id="запись-в-существующий-файл-с-помощью-filesystemobject" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Запись в существующий файл с помощью FileSystemObject</h2><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForReading = 1</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForWriting = 2</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Const ForAppending = 8</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub WriteTextFileExample()</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim oFso</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set oFso = CreateObject("Scripting.FileSystemObject")</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim oFile as Object</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFilePath as String</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFileText as String</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    myFilePath = "C:\mypath\to\myfile.txt"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    ' First check if the file exists</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    If oFso.FileExists(myFilePath) Then</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        ' this will overwrite any existing filecontent with whatever you send the file</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        ' to append data to the end of an existing file, use ForAppending instead</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Set oFile = oFso.OpenTextFile(myFilePath, ForWriting)  </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Else</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        ' create the file instead</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Set oFile = oFso.CreateTextFile(myFilePath) ' skipping the optional boolean for overwrite if exists as we already checked that the file doesn't exist.</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    End If</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    oFile.Write "This is some new text"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    oFile.Write " And this text will appear right after the first bit of text."</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    oFile.WriteLine "This bit of text includes a newline character to ensure each write takes its own line."</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    oFile.Close ' close the file</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><span class="ezoic-autoinsert-video ezoic-longer_content" style="box-sizing: border-box;"></span><h2 id="перечислять-файлы-в-каталоге-с-помощью-filesystemobject" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Перечислять файлы в каталоге с помощью FileSystemObject</h2><p style="box-sizing: border-box;">Ранняя привязка (требует ссылки на время выполнения сценариев Microsoft Scripting):</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Public Sub EnumerateDirectory()</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim fso As Scripting.FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set fso = New Scripting.FileSystemObject</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim targetFolder As Folder</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set targetFolder = fso.GetFolder("C:\")</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim foundFile As Variant</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    For Each foundFile In targetFolder.Files</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Debug.Print foundFile.Name</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Next</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><span class="ezoic-autoinsert-video ezoic-longest_content" style="box-sizing: border-box;"></span><p style="box-sizing: border-box;">Поздняя оценка:</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Public Sub EnumerateDirectory()</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim fso As Object</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set fso = CreateObject("Scripting.FileSystemObject")</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim targetFolder As Object</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set targetFolder = fso.GetFolder("C:\")</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim foundFile As Variant</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    For Each foundFile In targetFolder.Files</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Debug.Print foundFile.Name</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Next</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><h2 id="рекурсивно-перечислять-папки-и-файлы" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Рекурсивно перечислять папки и файлы</h2><p style="box-sizing: border-box;">Ранняя привязка (со ссылкой на<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">Microsoft Scripting Runtime</code><span> </span>)</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub EnumerateFilesAndFolders( _</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    FolderPath As String, _</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Optional MaxDepth As Long = -1, _</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Optional CurrentDepth As Long = 0, _</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Optional Indentation As Long = 2)</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim FSO As Scripting.FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set FSO = New Scripting.FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    'Check the folder exists</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    If FSO.FolderExists(FolderPath) Then</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Dim fldr As Scripting.Folder</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Set fldr = FSO.GetFolder(FolderPath)</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        'Output the starting directory path</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        If CurrentDepth = 0 Then</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">          Debug.Print fldr.Path</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        End If</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        'Enumerate the subfolders</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Dim subFldr As Scripting.Folder</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        For Each subFldr In fldr.SubFolders</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            Debug.Print Space$((CurrentDepth + 1) * Indentation) &amp; subFldr.Name</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            If CurrentDepth &lt; MaxDepth Or MaxDepth = -1 Then</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                'Recursively call EnumerateFilesAndFolders</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                EnumerateFilesAndFolders subFldr.Path, MaxDepth, CurrentDepth + 1, Indentation</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            End If</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Next subFldr</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        'Enumerate the files</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Dim fil As Scripting.File</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        For Each fil In fldr.Files</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            Debug.Print Space$((CurrentDepth + 1) * Indentation) &amp; fil.Name</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Next fil</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    End If</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="box-sizing: border-box;">Вывод при вызове с такими аргументами, как:<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">EnumerateFilesAndFolders "C:\Test"</code></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">C:\Test</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Documents</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Personal</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">      Budget.xls</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">      Recipes.doc</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Work</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">      Planning.doc</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Downloads</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    FooBar.exe</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  ReadMe.txt</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="box-sizing: border-box;">Вывод при вызове с аргументами:<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">EnumerateFilesAndFolders "C:\Test", 0</code></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">C:\Test</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Documents</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Downloads</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  ReadMe.txt</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="box-sizing: border-box;">Вывод при вызове с такими аргументами, как:<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">EnumerateFilesAndFolders "C:\Test", 1, 4</code></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">C:\Test</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Documents</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Personal</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Work</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Downloads</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        FooBar.exe</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    ReadMe.txt</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><h2 id="расширение-файла-strip-из-имени-файла" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Расширение файла Strip из имени файла</h2><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim fso As New Scripting.FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Debug.Print fso.GetBaseName("MyFile.something.txt")</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="box-sizing: border-box;">Печать<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">MyFile.something</code></p><p style="box-sizing: border-box;">Обратите внимание, что метод<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">GetBaseName()</code><span> </span>уже обрабатывает несколько периодов в имени файла.</p><h2 id="получить-только-расширение-из-имени-файла" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Получить только расширение из имени файла</h2><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim fso As New Scripting.FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Debug.Print fso.GetExtensionName("MyFile.something.txt")</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="box-sizing: border-box;">Печать<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">txt</code><span> </span>Обратите внимание, что метод<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">GetExtensionName()</code><span> </span>уже обрабатывает несколько периодов в имени файла.</p><h2 id="получить-только-путь-из-пути-к-файлу" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Получить только путь из пути к файлу</h2><p style="box-sizing: border-box;">Метод GetParentFolderName возвращает родительскую папку для любого пути. Хотя это также можно использовать с папками, возможно, более полезно для извлечения пути из абсолютного пути к файлу:</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim fso As New Scripting.FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Debug.Print fso.GetParentFolderName("C:\Users\Me\My Documents\SomeFile.txt")</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="box-sizing: border-box;">Печать<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">C:\Users\Me\My Documents</code></p><span class="ezoic-autoinsert-video ezoic-mid_content" style="box-sizing: border-box;"></span><p style="box-sizing: border-box;">Обратите внимание, что разделитель конечных путей не включен в возвращаемую строку.</p><h2 id="использование-fso.buildpath-для-создания-полного-пути-из-пути-к-папке-и-имени-файла" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0.5rem;">Использование FSO.BuildPath для создания полного пути из пути к папке и имени файла</h2><span class="ezoic-autoinsert-video ezoic-long_content" style="box-sizing: border-box;"></span><p style="box-sizing: border-box;">Если вы принимаете пользовательский ввод для путей к папкам, вам может потребоваться проверить обратную косую черту (<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">\</code><span> </span>) перед созданием пути к файлу. Метод<span> </span><code style="box-sizing: border-box; border: 1px solid rgb(128, 128, 128); display: inline-block;">FSO.BuildPath</code><span> </span>делает это проще:</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Const sourceFilePath As String = "C:\Temp"  '&lt;-- Without trailing backslash</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Const targetFilePath As String = "C:\Temp\" '&lt;-- With trailing backslash</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Const fileName As String = "Results.txt"</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Dim FSO As FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Set FSO = New FileSystemObject</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Debug.Print FSO.BuildPath(sourceFilePath, fileName)</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  Debug.Print FSO.BuildPath(targetFilePath, fileName)</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="box-sizing: border-box;">Выход:</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">C:\Temp\Results.txt</p><p style=" font-family:'Consolas'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">C:\Temp\Results.txt</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><br style="box-sizing: border-box;"><br style="box-sizing: border-box;"><span class="ezoic-autoinsert-video ezoic-under_page_title" style="box-sizing: border-box;"></span><div style="box-sizing: border-box;"><div style="box-sizing: border-box;">Modified text is an extract of the original<span> </span><a href="https://archive.org/details/documentation-dump.7z" target="_blank" style="box-sizing: border-box; color: rgb(55, 155, 228); text-decoration: none;">Stack Overflow Documentation</a></div><div style="box-sizing: border-box;">Лицензировано согласно<span> </span><a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" style="box-sizing: border-box; color: rgb(55, 155, 228); text-decoration: none;">CC BY-SA 3.0</a></div><div style="box-sizing: border-box;">Не связан с<span> </span><a href="https://stackoverflow.com/" target="_blank" style="box-sizing: border-box; color: rgb(55, 155, 228); text-decoration: none;">Stack Overflow</a></div></div></div><!--EndFragment-->
</body>
</html></body></html>