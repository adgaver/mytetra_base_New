<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="question-header"></a><a href="https://stackoverflow.com/questions/3827567/how-to-get-the-path-of-the-batch-script-in-windows"><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">К</span></a><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">ак получить путь к пакетному скрипту в Windows?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/ask"><span style=" text-decoration: underline; color:#0000ff;">Задавать вопрос</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Спросил 13 лет, 7 месяцев назад</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Изменено <a href="https://stackoverflow.com/questions/3827567/how-to-get-the-path-of-the-batch-script-in-windows?lastactivity"><span style=" text-decoration: underline; color:#0000ff;">10 месяцев назад</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Просмотрено 478 тыс. раз</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="mainbar"></a>434</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Я знаю, что он <span style=" font-family:'Courier New';">%0</span>содержит полный путь к пакетному сценарию, например<span style=" font-family:'Courier New';">c:\path\to\my\file\abc.bat</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Я хочу <span style=" font-family:'Courier New';">path</span>быть равным <span style=" font-family:'Courier New';">c:\path\to\my\file</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как я могу этого добиться?</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">%~dp0</span>будет каталог. <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/call#batch-parameters"><span style=" text-decoration: underline; color:#0000ff;">Вот некоторая документация по всем модификаторам пути</span></a> . Забавная штука :-)</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы удалить последнюю обратную косую черту, вы можете использовать <span style=" font-family:'Courier New';">:n,m</span>синтаксис подстроки, например:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">SET mypath=%~dp0</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">echo %mypath:~0,-1%</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">К сожалению, я не верю, что есть способ объединить синтаксис <span style=" font-family:'Courier New';">%0</span>с <span style=" font-family:'Courier New';">:~n,m</span>синтаксисом.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">%~dp0</span>может быть относительным путем. Чтобы преобразовать его в полный путь, попробуйте что-то вроде этого:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">pushd %~dp0</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">set script_dir=%CD%popd</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы можете использовать следующий скрипт, чтобы получить путь без завершения &quot;\&quot;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">for %%i in (&quot;%~dp0.&quot;) do SET &quot;mypath=%%~fi&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">%~dp0</span> - вернуть путь, откуда был выполнен скрипт</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Но важно знать также следующее:<br /><br /><span style=" font-weight:600;">%CD%</span> — возвращает текущий путь во время выполнения, например, если вы попадаете в другие папки, используя <span style=" font-style:italic;">«cdfolder1»</span> , а затем <span style=" font-style:italic;">«cdfolder2»</span> , он вернет полный путь до папки2 и не исходный путь, где находится скрипт</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p></body></html>