<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p align="center" style=" margin-top:0px; margin-bottom:7px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:48px;"><span style=" font-family:'GillSans,Calibri,Trebuchet,sans-serif'; font-size:xx-large; font-weight:600; color:#000000;">4 способа добавления колонок в датафреймы Pandas</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1%;"><span style=" font-family:'GillSans,Calibri,Trebuchet,sans-serif'; font-size:11px; color:#767676;">25.06.2021</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; color:#000000;">Pandas — это библиотека для анализа и обработки данных, написанная на языке Python. Она предоставляет множество функций и способов для управления табличными данными. Основная структура данных Pandas — это датафрейм, который хранит информацию в табличной форме с помеченными строками и столбцами.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; color:#000000;">В контексте данных строки представляют собой утверждения, или точки данных. Столбцы отражают свойства, или атрибуты утверждений. Рассмотрим эту структуру на простом примере. Допустим, каждая строка — это дом. В таком случае, столбцы заключают в себе сведения об этом доме (его возрасте, количестве комнат, стоимости и т.д.).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; color:#000000;">Добавление или удаление столбцов — обычная операция при анализе данных. Ниже мы разберем 4 различных способа добавления новых столбцов в датафрейм Pandas.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Сначала создадим простой фрейм данных для использования в примерах:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">import</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;"> numpy </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">as</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;"> np</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">import</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;"> pandas </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">as</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;"> pd</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df = pd.DataFrame({</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;A&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">: [</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">1</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">2</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">3</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">4</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">                   </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;B&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">: [</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">5</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">6</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">7</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">8</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">]})</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:10px; font-weight:296; color:#222222;"><br /></p>
<p style=" margin-top:30px; margin-bottom:20px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; line-height:38px;"><a name="h-1"></a><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">С</span><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">пособ 1-й</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Пожалуй, это самый распространенный путь создания нового столбца в Pandas:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#007700;">df</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">[</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;C&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">] =</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#3344bb;"> [10, 20, 30, 40]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#007700;">df</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:10px; font-weight:296; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Мы указываем имя столбца подобно тому, как выбираем столбец во фрейме данных. Затем этому столбцу присваиваются значения. Новый столбец добавляется последним (т. е. становится столбцом с самым высоким индексом).</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Можно добавить сразу несколько столбцов. Их наименования перечисляются списком, а значения должны быть двумерными для совместимости с количеством строк и столбцов. Например, следующий код добавляет три столбца, заполненные случайными целыми числами от 0 до 10:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df[[</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;1of3&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;2of3&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;3of3&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">]] = np.random.randint(</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">10</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, size=(</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">4</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">,</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">3</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:10px; font-weight:296; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Давайте удалим эти три столбца, прежде чем перейти к следующему методу.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df.drop([</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;1of3&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;2of3&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;3of3&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">], axis=</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">1</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, inplace=</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">True</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:10px; font-weight:296; color:#222222;"><br /></p>
<p style=" margin-top:30px; margin-bottom:20px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; line-height:38px;"><a name="h-2"></a><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">С</span><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">пособ 2-й</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">В первом способе мы добавляли новый столбец в конец. Pandas также позволяет добавлять столбцы по определенному индексу. Для настройки расположения нового столба воспользуемся функцией вставки (insert function). Давайте добавим один столбец рядом с А:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df.insert(</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">1</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;D&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">5</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:10px; font-weight:296; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Для использования функции вставки необходимо 3 параметра: индекс, имя столбца и значение. Индексы столбцов начинаются с 0, поэтому мы устанавливаем параметр индекса 1, чтобы добавить новый столбец рядом со столбцом A. Мы можем указать постоянное значение, которое будет выставлено во всех строках.</span></p>
<p style=" margin-top:30px; margin-bottom:20px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; line-height:38px;"><a name="h-3"></a><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">С</span><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">пособ 3-й</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Функция </span><span style=" font-family:'monospace,monospace'; font-size:15px; font-weight:296; color:#222222; background-color:#f1f1f1;">loc</span><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;"> позволяет выбирать строки и столбцы, используя их метки. Таким же образом можно создать новый столбец:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df.loc[:, </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;E&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">] = </span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#009999;">list</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">(</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#dd1144;">&quot;abcd&quot;</span><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:10px; font-weight:296; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Для выбора строк и столбцов мы указываем нужные метки. Если хотим выбрать все строки, ставим двоеточие. В части таблицы, где нужно проставить столбец, указываем метки столбцов, которые нам необходимо выбрать. Поскольку в датафрейме нет столбца E, Pandas создаст новый столбец.</span></p>
<p style=" margin-top:30px; margin-bottom:20px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; line-height:38px;"><a name="h-4"></a><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">С</span><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">пособ 4-й</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Добавить столбцы можно также с помощью функции </span><span style=" font-family:'monospace,monospace'; font-size:15px; font-weight:296; color:#222222; background-color:#f1f1f1;">assign</span><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df = df.assign(F = df.C * 10)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; font-weight:296; color:#222222; background-color:#eff0f1;">df</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:10px; font-weight:296; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">В функции </span><span style=" font-family:'monospace,monospace'; font-size:15px; font-weight:296; color:#222222; background-color:#f1f1f1;">assign</span><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;"> необходимо прописать имя столбца и значения. Обратите внимание: мы получаем значения, используя другой столбец во фрейме данных. Предыдущие способы также допускают такую операцию.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Надо понимать, что между функциями assign и insert есть существенное различие.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Функция вставки (</span><span style=" font-family:'monospace,monospace'; font-size:15px; font-weight:296; color:#222222; background-color:#f1f1f1;">insert</span><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">) работает на месте. Это означает, что изменение (добавление нового столбца) сохраняется во фрейме данных.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">С функцией назначения ситуация немного иная. Он возвращает измененный фрейм данных, но не изменяет исходный. Чтобы использовать измененную версию (с новым столбцом), нам нужно явно назначить ее.</span></p>
<p style=" margin-top:30px; margin-bottom:20px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px; line-height:38px;"><a name="h-"></a><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">З</span><span style=" font-family:'roboto,sans-serif'; font-size:x-large; font-weight:600; color:#4b77be;">аключение</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Мы рассмотрели 4 различных способа добавления новых столбцов в фрейм данных Pandas. Это обычная операция при анализе и обработке данных.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Мне нравится пользоваться библиотекой Pandas, поскольку она предоставляет, как правило, несколько способов для выполнения одной задачи. По-моему, это говорит о гибкости и универсальности Pandas.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Читайте также:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;" style=" margin-top:12px; margin-bottom:10px; margin-left:-3px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><a href="https://nuancesprog.ru/p/12819/"><span style=" font-size:15px; color:#4b77be; background-color:transparent;">3 функции Pandas для группировки и агрегирования данных</span></a></li>
<li style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;" style=" margin-top:0px; margin-bottom:10px; margin-left:-3px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><a href="https://nuancesprog.ru/p/12234/"><span style=" font-size:15px; color:#4b77be; background-color:transparent;">7 полезных операций в Pandas при работе с DataFrame</span></a></li>
<li style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;" style=" margin-top:0px; margin-bottom:26px; margin-left:-3px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><a href="https://nuancesprog.ru/p/11219/"><span style=" font-size:15px; color:#4b77be; background-color:transparent;">Новая библиотека превосходит Pandas по производительности</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">Читайте нас в </span><a href="https://vk.com/away.php?to=https%3A%2F%2Ft.me%2Fnuancesproghumor&amp;cc_key="><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#4b77be; background-color:transparent;">Telegram</span></a><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">, </span><a href="https://vk.com/nuancesprog"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#4b77be; background-color:transparent;">VK</span></a><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;"> и </span><a href="https://vk.com/away.php?to=https%3A%2F%2Fzen.yandex.ru%2Fnuancesprog&amp;cc_key="><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#4b77be; background-color:transparent;">Яндекс.Дзен</span></a></p>
<hr />
<p style=" margin-top:0px; margin-bottom:26px; margin-left:-24px; margin-right:-24px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; font-style:italic; color:#222222;">Перевод статьи</span><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;"> </span><a href="https://sonery.medium.com/"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#4b77be; background-color:transparent;">Soner Yıldırım</span></a><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#222222;">: </span><a href="https://towardsdatascience.com/4-methods-for-adding-columns-to-pandas-dataframes-dd0696863c16"><span style=" font-family:'Verdana,BlinkMacSystemFont,-apple-system,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif'; font-size:15px; font-weight:296; color:#4b77be; background-color:transparent;">4 Methods for Adding Columns to Pandas Dataframes</span></a></p></body></html>