<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; color:#000000;">Базовые элементы автоматизации Excel с помощью Python</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px; line-height:16px;"><span style=" font-family:'Roboto'; font-size:medium; color:rgba(57,64,92,0.658824);">10.08.2022 Духанов Станислав,г. Москва</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; line-height:29px; background-color:#ffffff;"><span style=" font-family:'Manrope'; font-size:16px; font-weight:696; color:#72788b;">Время прочтения: 5 мин.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Ответ приходит в виде openpyxl, библиотеки Python, которая позволяет вам читать файлы Excel и управлять ими. Помимо базовых задач, таких как поиск и изменение значений ячеек, вы также можете агрегировать диапазоны ячеек, добавлять стиль к своим шрифтам и даже строить графики, используя всего несколько строк кода.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Загрузка рабочей книги и листа</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Сначала нужно установить библиотеку openpyxl. Чтобы загрузить рабочую книгу из существующего файла Excel, сначала нужно импортировать модуль load_workbook, затем создать экземпляр load_workbook(), указав путь к файлу Excel в качестве единственного аргумента. Также нужно будет указать лист, к которому необходимо получить доступ из рабочей книги. Выполнение команды печати в переменной sheet вернёт имя активного листа.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#импортируем модули</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">from</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> openpyxl </span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">import</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#660066;">Workbook</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> load_workbook</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#создаем экземпляр с именем пути к файлу excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">wb </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> load_workbook</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#выбираем активный лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">sheet </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">active</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">print</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Доступ к значению ячейки</span><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;"> Чтобы получить доступ к значению ячейки, нужно передать имя ячейки в квадратных скобках после имени листа, за которым следует метод value.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">print</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">[</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;A1&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">].</span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">value</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">print</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">[</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;A2&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">].</span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">value</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">print</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">[</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;B3&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">].</span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">value</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Изменение значения ячейки</span><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;"> Можно изменить значение ячейки, обратившись к значению, а затем указав новое значение с помощью оператора equal. Необходимо запустить метод save(), чтобы изменения вступили в силу. Не забывайте всегда закрывать файл в Excel перед внесением каких-либо изменений, чтобы Python не выдавал ошибку.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#изменяем значение ячейки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">[</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;A2&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">]</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;TestTest&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example1.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Создание нового листа</span><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;"> Создать новый лист так же просто, как использовать метод create_sheet() и передать имя листа. Затем можно использовать имена листов, чтобы вернуть список всех листов в рабочей книге.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#создаем новый лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">create_sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;New_sheet&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#возвращаем список листов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">print</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">sheetnames</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Создание нового файла</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Можно создать пустую рабочую книгу, используя метод Workbook(). Чтобы добавить данные в первую строку, буду использовать метод append().</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#создаем новую рабочую книгу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#660066;">Workbook</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#выбираем активный лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">active</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#переименовываем активный лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">title  </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;New_sheet2&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#добавляем данные в активный лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">append</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">([</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;1&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;2&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;3&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;4&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Каждый раз, когда я использую метод append(), он добавляет новую строку на лист.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#заполняем несколько строк</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">append</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">([</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;5&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;6&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;7&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;8&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">append</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">([</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;9&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;10&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;11&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;12&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">append</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">([</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;13&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Вставка и удаление строк</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Можно вставить новую строку в лист, используя метод insert_rows(), а затем указав номер строки, по которой нужно выполнить вставку.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#вставляем новую строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">insert_rows</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Таким же образом можно удалять строки, используя метод delete_rows() и указав позицию строки.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#удаляем строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">delete_rows</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Объединение ячеек и разъединение ячеек</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Объединить ячейки так же просто, как использовать метод merge_cells() и указать диапазон.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#объединяем ячейки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">merge_cells</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;A1:A2&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Можно отключить их с помощью метода unmerge_cells().</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#разъединяем ячейки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">unmerge_cells</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;A1:A2&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Вставка и удаление столбцов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Можно вставлять столбцы в любую позицию, указав номер в методе insert_cols().</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#вставляем столбец</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">insert_cols</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">2</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Метод delete_cols() удалит указанные столбцы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#удаляем столбцы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">delete_cols</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">2</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Копирование и перемещение значений ячеек</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Можно скопировать значения в любом диапазоне ячеек и переместить их в новую позицию с помощью метода move_range(). Он принимает три аргумента: диапазон перемещаемых данных, затем строки, которые могут быть положительным (количество строк вниз) или отрицательным (количество строк вверх) целым числом. Последний аргумент — cols, который также является либо положительным (количество столбцов справа), либо отрицательным (количество столбцов слева) целым числом. Перемещу диапазон A1:B1 на четыре строки вниз и на один столбец вправо.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#диапазон перемещения</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">ws</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">move_range</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;A1:B1&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">rows</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">4</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">cols</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#880000;">#сохраняем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">new_wb</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;/users/user1/downloads/example3.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">А теперь некоторые функции разберу на примере.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">Кейс – делаю расчет в Excel по формуле</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Многие сталкивались с ситуацией, когда было множество готовых excel</span><span style=" font-family:'Manrope,system-ui'; font-size:16px; font-weight:600; color:#444b65;">—</span><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">файлов и в них необходимо провести одинаковую операцию. Сейчас рассмотрю пример, когда нужно применить одинаковую формулу во множестве файлов. Может быть 5,10,100 файлов по которым нужно рассчитать, например, сумму значений в двух столбцах. С помощью python и библиотеки openpyxl можно избавиться от ручного применения формул автоматизировав этот процесс. Ниже представлен код, который по очереди к каждому excel-файлу из папки применяет формулу и записывает новый excel-файл с результатом расчёта по формуле.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">import</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> openpyxl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">import</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> os</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">path </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> r</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">'C:\Users\User1'</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># Задаем путь к папке с excel-файлами, в которых будем рассчитывать формулу</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">files </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">[</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">i </span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">for</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> i </span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">in</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> os</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">listdir</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">path</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">if</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">'xlsx'</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">in</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> i</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">]</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">  </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># В этой папке выбираем названия только excel-файлов и создаем из них список</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">for</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> i </span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">in</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> files</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">:</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># Идем по каждому excel-файлу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">    x </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> openpyxl</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">open</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">i</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># Открываем этот файл</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">    sheet </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> x</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">active </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># Выбираем лист для работы</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">    cell </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">cell</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">row</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">max_row</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">+</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> column </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">2</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># Создаем ячейку с координатами, где показываем результаты расчета</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">    cell</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">value</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">&quot;=СУММ(A2:B{})&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">format</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">sheet</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">max_row</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">  </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># Пишем формулу в ячейку</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">    cell</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">font </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> cell</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">font</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">copy</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">bold </span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">=</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#000088;">True</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># Изменяем стиль шрифта</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:16px; color:#444b65; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#444b65; background-color:#eff0f1;">    x</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">save</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">'formulas_{}.xlsx'</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">format</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">i</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">.</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;">split</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#008800;">'.'</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">)[</span><span style=" font-family:'Consolas'; font-size:16px; color:#006666;">0</span><span style=" font-family:'Consolas'; font-size:16px; color:#666600;">]))</span><span style=" font-family:'Consolas'; font-size:16px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#880000;"># сохраняем результат в файл</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px; font-family:'Manrope,system-ui'; font-size:10px; color:#444b65;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">В моём примере расположения столбцов для расчёта в каждом файле одинаковое (столбец A и столбец B), но количество строк может быть разным, соответственно результат по формуле тоже будет располагаться в разной строке под данными. Чтобы не высчитывать количество строк в каждом файле, применяю метод sheet.max_row, когда задаю ячейку для записи результата +1 строка в переменную cell, чтобы результат на следующей строке, под данными.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Manrope,system-ui'; font-size:16px; color:#444b65;">Надеюсь, читатели, которые только погружаются в Python, смогли получить общее представление о том, как работать с файлами Excel на Python. С openpyxl вы cможете сделать форматирование, создавать сводные таблицы и диаграммы, делать фильтрацию и сортировку, агрегировать значения ячеек, изменять шрифт, перемещение данные на новый лист. С этими возможностями можно ознакомиться в официальной документации.</span></p></body></html>