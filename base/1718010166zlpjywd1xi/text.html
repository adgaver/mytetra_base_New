<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; color:#000000;">Примеры применения Pandas в Python</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pythonist.ru/category/machine_learning/"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:12px; font-weight:600; color:#03c4eb; background-color:transparent; text-transform:uppercase;">ML</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:12px; font-weight:600; color:#777777; text-transform:uppercase;">, </span><a href="https://pythonist.ru/category/modules/"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:12px; font-weight:600; color:#03c4eb; background-color:transparent; text-transform:uppercase;">МОДУЛИ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Pandas — очень популярная библиотека Python для анализа данных. Она предоставляет множество функций и методов, ускоряющих подготовку данных и работу с ними. Поскольку библиотека популярна, вы легко найдете стати и руководства по ее применению. В этой статье мы рассмотрим практические примеры использования Pandas в Python.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; font-weight:600; color:#242424;">Примечание редакции Pythonist:</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> о том, что собой представляет Pandas, можно почитать в статье </span><a href="https://pythonist.ru/polnoe-rukovodstvo-po-pandas-dlya-nachinayushhih/"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#03c4eb; background-color:transparent;">«Полное руководство по Pandas для начинающих»</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Функции и методы, которые мы рассмотрим, чаще всего применяются в обычных процессах анализа данных. Работать будем с </span><a href="https://www.kaggle.com/shubh0799/churn-modelling"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#03c4eb; background-color:transparent;">набором данных отпавших клиентов, доступным на Kaggle</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Начнем со считывания csv-файла в датафрейм Pandas.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#286491;">import</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;"> numpy </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#286491;">as</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;"> np</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#286491;">import</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;"> pandas </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#286491;">as</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;"> pd</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df = pd.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">read_csv</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">&quot;/content/churn.csv&quot;</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.shape</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># (10000,14)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.columns</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># Index(['RowNumber', 'CustomerId', 'Surname', 'CreditScore', 'Geography', 'Gender', 'Age', 'Tenure', 'Balance', 'NumOfProducts', 'HasCrCard','IsActiveMember','EstimatedSalary', 'Exited'], dtype='object')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">1. Удаление столбцов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Функция </span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop.html"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#03c4eb; background-color:transparent;">drop</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> используется для удаления столбцов и строк. Мы передаем в нее метки строк или столбцов, которые нужно удалить.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">drop</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">([</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'RowNumber'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'CustomerId'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Surname'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'CreditScore'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, axis=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">1</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, inplace=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#34068a;">True</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.shape</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># (10000,10)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Параметр </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">axis</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> («ось») определяет, что именно мы удаляем: строки или столбцы. Для строк значение </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">axis</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> — 0, а для столбцов — 1. У нас </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">axis=1</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Параметр </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">inplace</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> определяет, нужно ли вносить изменения в существующий датафрейм или нужно вернуть его копию. По умолчанию значение </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">inplace</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> — False (возвращается копия). У нас </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">inplace=True</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> для внесения изменений на месте. Мы удаляем 4 столбца, поэтому число столбцов уменьшается до 10 (было 14).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">2. Выборка определенных столбцов при чтении</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Мы можем прочитать не целый CSV-файл, а только определенные столбцы. Для этого нужно передать список нужных столбцов в параметр </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">usecols</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> при считывании файла. Если вы знаете, какие столбцы вас интересуют, лучше выбрать их заранее, а не удалять ненужные после считывания всего файла.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_spec = pd.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">read_csv</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">&quot;/content/churn.csv&quot;</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, usecols=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Gender'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Age'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Tenure'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Balance'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_spec.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">head</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:14px; color:#777777;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">3. Чтение части датафрейма</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Функция r</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#03c4eb; background-color:transparent;">ead_csv</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> позволяет считывать часть csv-файла, определяя ее в строках. Применять эту функцию можно двумя способами. Первый вариант — указать нужное количество строк в параметре </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">nrows</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_partial = pd.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">read_csv</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">&quot;/content/churn.csv&quot;</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, nrows=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">5000</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_partial.shape</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># (5000,14)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Используя </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">nrows</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">, мы создаем датафрейм, содержащий первые 5000 строк csv-файла.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Второй вариант — использовать параметр </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">skiprows</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">. Если мы укажем </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">skiprows=5000</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">, при считывании файла первые 5000 строк будут пропущены.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">4. Случайная выборка</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">После создания датафрейма вы можете захотеть просмотреть небольшую выборку из него. Для определения размера выборки можно использовать следующие параметры:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;" style=" margin-top:20px; margin-bottom:6px; margin-left:69px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">n</span><span style=" font-size:16px;"> — число строк в выборке</span></li>
<li style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;" style=" margin-top:8px; margin-bottom:20px; margin-left:69px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">frac</span><span style=" font-size:16px;"> — доля от всего датафрейма</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_sample = df.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">sample</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">n=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">1000</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_sample.shape</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># (1000,10)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_sample2 = df.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">sample</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">frac=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">0.1</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df_sample2.shape</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># (1000,10)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">5. Проверка пропущенных значений</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Функция </span><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isna.html"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#03c4eb; background-color:transparent;">isna</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> определяет пропущенные значения в датафрейме. Используя ее с функцией </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">sum</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">, можно увидеть количество недостающих значений по каждому столбцу.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">isna</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">sum</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Здесь у нас нет пропущенных значений.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">6. Добавление пропущенных значений при помощи loc и iloc</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Методы </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">loc</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> и </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">iloc</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> служат для выборки строк и столбцов по индексу или меткам.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;" style=" margin-top:20px; margin-bottom:6px; margin-left:69px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html"><span style=" font-size:16px; color:#03c4eb; background-color:transparent;">loc</span></a><span style=" font-size:16px;"> — выборка по меткам</span></li>
<li style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;" style=" margin-top:8px; margin-bottom:20px; margin-left:69px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html"><span style=" font-size:16px; color:#03c4eb; background-color:transparent;">iloc</span></a><span style=" font-size:16px;"> — выборка по индексу</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Давайте сперва создадим переменную, содержащую 20 случайных индексов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">missing_index = np.random.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">randint</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">10000</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, size=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">20</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Эти индексы мы используем, чтобы заменить некоторые значения на np.nan (пропущенное значение). Мы применяем функцию </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">loc</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> и указываем метки столбцов — </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">['Balance','Geography']</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.loc</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">missing_index, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Balance'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">,</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Geography'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;"> = np.nan</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Теперь в столбцах Balance и Geography 20 пропущенных значений.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Давайте теперь применим </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">iloc</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> и индексы столбцов вместо меток.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.iloc</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">missing_index, </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">-1</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;"> = np.nan</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">-1 — это индекс последнего столбца (Exited).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Хотя мы использовали разные представления столбцов для </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">loc</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> и </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">iloc</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">, значения строк не изменились. Причина в том, что в качестве меток строк мы используем числовой индекс. То есть для строк метки и индексы одинаковы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Количество пропущенных значений поменялось:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">7. Заполнение отсутствующих значений</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">При помощи функции </span><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.fillna.html"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#03c4eb; background-color:transparent;">fillna</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> можно заполнить недостающие значения. У этой функции много опций. Мы можем использовать конкретное значение, агрегатную функцию (например, среднее значение), предыдущее или следующее значение.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">В этом примере мы выбрали в качестве заполнителя для пропущенных значений в столбце Geography наиболее часто встречающееся значение.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">mode = df</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Geography'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">value_counts</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.index</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">0</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Geography'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">fillna</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">value=mode, inplace=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#34068a;">True</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">А для столбца Balance используем среднее значение:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">avg = df</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Balance'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">mean</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Balance'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">fillna</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">value=avg, inplace=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#34068a;">True</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">При помощи параметра method можно заполнить пропущенное значение, основываясь на предыдущем или следующем значении в столбце (например, </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">method='ffill'</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">). Это может быть очень полезным для последовательных данных.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">8. Удаление пропущенных значений</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Пропущенные значения можно не только заполнять, но и просто удалять. У нас есть такие пропуски значений в столбце Exited. При помощи следующего кода можно удалить строки, содержащие любые пропущенные значения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">dropna</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">axis=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">0</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, how=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'any'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, inplace=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#34068a;">True</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Если задать параметр </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">axis=1</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">, то удалены будут не строки, а столбцы с отсутствующими значениями. Можно также задать параметр </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">thresh</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">, чтобы указать, какое минимальное число непропущенных значений должно быть в столбце или строке. Например, </span><span style=" font-family:'Monaco,Consolas,Andale Mono,DejaVu Sans Mono,monospace'; font-size:16px; color:#bd4147; background-color:#e9e9e9;">thresh=5</span><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;"> означает, что строка должна иметь как минимум 5 значений. Строки с меньшим количеством значений будут удалены.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Теперь в нашем датафрейме нет пропущенных значений.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">isna</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">sum</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">sum</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">9. Выборка строк на основе условий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">В некоторых случаях нам нужно сосредоточиться на данных, отвечающих каким-то условиям. Например, можно выбрать отпавших клиентов, которые живут во Франции.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">france_churn = df</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.Geography == </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'France'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;"> &amp; </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df.Exited == </span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">1</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">france_churn.Geography.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">value_counts</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#8181a1;"># France    808</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; color:#000000;">10. Описание условий при помощи query</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Функция query позволяет задавать условия более гибко. Например, при помощи строк:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df2 = df.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">query</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'80000 &lt; Balance &lt; 100000'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Давайте проверим результат, нарисовав диаграмму столбца Balance.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7fa;"><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">df2</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">[</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'Balance'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">]</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">.</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#0086b3;">plot</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">kind=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#dd1144;">'hist'</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">, figsize=</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">(</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">8</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#2f3235;">,</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#009999;">5</span><span style=" font-family:'inherit'; font-size:15px; font-weight:696; color:#777777;">))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">В этой статье мы рассмотрели простые примеры использования Pandas в Python. Но Pandas предлагает куда больше возможностей, чем можно охватить в одном руководстве. Применяя эту библиотеку на практике, вы будете открывать для себя все новые и новые функции. Как и во многих других случаях, практика ведет к совершенству.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">Перевод части статьи </span><a href="https://towardsdatascience.com/30-examples-to-master-pandas-f8a2da751fa4"><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#03c4eb; background-color:transparent;">«30 Examples to Master Pandas»</span></a><span style=" font-family:'-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif'; font-size:16px; color:#242424;">.</span></p></body></html>