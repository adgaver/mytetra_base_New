<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Используя Visual Basic 2015, можно внести в базу данных Microsoft Access данные о трех регистрах хранения с ПЛК, а также время и дату. Мы будем ежеминутно вносить в базу данных информацию, которую мы собираем с ПЛК через Modbus TCP (Ethernet). Весь код будет выполнен и показан, чтобы вы могли реализовать его в своем приложении с различными параметрами. Информация, собранная в базе данных, может быть распространена или проанализирована в будущем.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2';"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1719821822eaju0sd42a.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Visual Basic 2015 будет использоваться с клиент-серверной библиотекой EasyModbusTCP для .net. Мы будем взаимодействовать с ПЛК системы автоматизации Direct – Do-More. Используя бесплатное программное обеспечение для моделирования PLC Designer Software, мы получим три значения из регистров хранения Modbus, используя протокол Modbus TCP. Как только мы получим эту информацию из программируемого логического контроллера, она будет помещена в базу данных Microsoft Access (2010). Это будет сделано с помощью SQL-команды для вставки данных.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">В Automation Direct есть мощный тренажер с ПЛК Do-More. Программное обеспечение для ПЛК можно бесплатно скачать на сайте Automation Direct.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Мы начнем с программы ПЛК. Будут использоваться первые три регистра хранения. В ПЛК Do-More это будут MBR1, MBR2 и MBR3. Это будет соответствовать регистрационным номерам 40001, 40002 и 40003. Ниже приведена таблица со всеми ссылками на Modbus-соединения для Do-More.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<table border="0" style=" border-style:solid; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="center" width="80%" cellspacing="-1" cellpadding="0" bgcolor="#ffffff">
<tr>
<td width="23%">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Coil/Register Numbers</span></p></td>
<td width="17%">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Data Addresses</span></p></td>
<td width="14%">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Type</span></p></td>
<td width="17%">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Do-More PLC</span></p></td>
<td width="25%">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Table Name</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">00001-09999</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">0000 to 270E</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Read-Write</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">MC1 to MC1023</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Discrete Output Coils</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">10001-19999</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">0000 to 270E</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Read-Only</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">MI1 to MI1023</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Discrete Input Contacts</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">30001-39999</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">0000 to 270E</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Read-Only</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">MIR1 to MIR2047</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Analog Input Registers</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">40001-49999</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">0000 to 270E</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Read-Write</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">MHR1 to MHR2047</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Analog Output Holding Registers</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:55px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:10pt; font-weight:600;">Примечание:</span><span style=" font-family:'DejaVu LGC Sans'; font-size:10pt;"> ПЛК Do More использует для обмена данными область Modbus. Это связано с тем, что прямой доступ к цифровому вводу-выводу может быть опасным при подключении через Ethernet к Интернету. Данные должны поступать в эту область и выходить из нее с помощью программы ПЛК.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Arial'; font-size:12pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Вот программа ПЛК, которая устанавливает три регистра.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1719821859pir9d7h6bz.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Следующее, что нам нужно сделать, это настроить нашу базу данных Microsoft Access 2010. Наша база данных будет называться ACC_Database и будет расположена по следующему адресу: “C:\AccLog”. У нас будет одна таблица с именем ACC_Log. В таблице у нас будет пять полей: LogDate, LogTime, Register1, Register2, Register3.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Visual Basic 2015 является бесплатным и входит в состав Visual Studio 2015. Его можно загрузить по следующему адресу: https://www.visualstudio.com/en-us/products/visual-studio-community-vs</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">EasyModbusTCP - это бесплатная программа. Ссылка на нее будет указана в нашей программе visual basic.  Ее можно загрузить по следующему адресу: https://sourceforge.net/projects/easymodbustcp/</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">После загрузки вы должны извлечь файлы.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">EasyModbusTCP - это клиент-серверная библиотека Modbus TCP, Modbus UDP для .NET и клиентская библиотека для JAVA. Клиент-сервер .NET (.dll) также поддерживает Modbus RTU. Он поддерживает следующие функциональные коды: – Считывание катушек (FC1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Считывание дискретных входов (FC2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Считывание регистров удержания (FC3)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Считывание входных регистров (FC4)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Запись в одну катушку (FC5)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Запись в один регистр (FC6)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Запись нескольких катушек (FC15)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Запись нескольких регистров (FC16)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">– Чтение/запись нескольких регистров (FC23)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Теперь мы вызовем visual Studio и создадим наш проект. Первое, что мы должны сделать, это обратиться к нашей EasyModbus.dll-файл.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1719822122vn7bq6bv3v.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Наша программа зарегистрирует три регистра на основе функции таймера. По истечении времени мы установим интервал в 1 минуту и вызовем подпрограмму (кнопка 1). Эта подпрограмма свяжется с ПЛК по протоколу Modbus TCP и получит наши три регистра. Затем он вставит данные из регистров вместе со временем и датой в базу данных access.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Вот как будет выглядеть наша форма на Visual basic:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image171982217568udj0jvb2.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Вот код на Visual basic для нашего проекта. Мы используем команду Imports для пространства имен EasyModbusTCP.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">Imports EasyModbus 'Import the EasyModbus </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Вот часть подпрограммы, которая будет взаимодействовать с ПЛК через EasyModbusTCP, вы заметите, что мы использовали команду &quot;Try&quot; в ModbusClient.Оператор Connect(). Таким образом, мы можем отслеживать, взаимодействуем ли мы с ПЛК или нет.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Public</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Class</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">Form1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> Private</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Sub</span><span style=" font-family:'Consolas'; font-size:12pt;"> Button1_Click() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Handles</span><span style=" font-family:'Consolas'; font-size:12pt;"> Button1.Click</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'This subroutine will communicate using the EasyModbusTCP to the PLC</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> 'This will execute when the user clicks the button or at specific intervals from the Timer1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt;"> ComError = 0 </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Set communication error flag to 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> 'Specify the IP Address and Port Number that we are connecting</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt;"> ModbusClient </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'Consolas'; font-size:12pt;"> EasyModbus.</span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">ModbusClient</span><span style=" font-family:'Consolas'; font-size:12pt;"> = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">New</span><span style=" font-family:'Consolas'; font-size:12pt;"> EasyModbus.</span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">ModbusClient</span><span style=" font-family:'Consolas'; font-size:12pt;">(TextBox1.Text, 502)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Try</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">ModbusClient.Connect() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Connect to the PLC</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Catch</span><span style=" font-family:'Consolas'; font-size:12pt;"> ex </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">Exception</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'What to do when an error occurs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Label10.ForeColor = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">Color</span><span style=" font-family:'Consolas'; font-size:12pt;">.Red</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> Label10.Text = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;Communication Error!&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">ComError = 1 </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Set communication error flag to 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">End</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Try</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> If</span><span style=" font-family:'Consolas'; font-size:12pt;"> ComError = 0 </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Then</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Do the following when communication is OK</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Label10.ForeColor = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">Color</span><span style=" font-family:'Consolas'; font-size:12pt;">.Black</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> Label10.Text = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;Logging...&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt;"> Registers </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Integer</span><span style=" font-family:'Consolas'; font-size:12pt;">() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Where to store the information</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Registers = ModbusClient.ReadHoldingRegisters(0, 3) </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Read three registers starting at the first one</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Label1.Text = Registers(0) </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Value of MHR1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Label2.Text = Registers(1) </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Value of MHR2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Label3.Text = Registers(2) </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Value of MHR3</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">ModbusClient.Disconnect() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Disconnect from the PLC</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Вот код для открытия соединения с базой данных и вставки данных в наш файл ACC_Database. Мы используем команду &quot;Try&quot;, чтобы убедиться, что в случае возникновения ошибок наша программа не остановится. Строка подключения (</span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\AccLog\ACC_Database.accdb</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) может отличаться от вашей. Чтобы получить строку подключения, пожалуйста, ознакомьтесь с приведенным ниже в предыдущем посте и выполните поиск по строке подключения.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Log values into an Access Database</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> 'We will use a SQL instruction to insert a record into the table</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Try</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> Dim</span><span style=" font-family:'Consolas'; font-size:12pt;"> SQL </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">String</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'SQL Command String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt;"> objCmd </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">New</span><span style=" font-family:'Consolas'; font-size:12pt;"> OleDb.</span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">OleDbCommand</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Command</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> 'Connection String to the Access Database</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt;"> Con = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">New</span><span style=" font-family:'Consolas'; font-size:12pt;"> OleDb.</span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">OleDbConnection</span><span style=" font-family:'Consolas'; font-size:12pt;">(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\AccLog\ACC_Database.accdb&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'SQL Statement - All values must be set for the table</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">SQL = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;INSERT INTO ACC_Log VALUES ('&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;"> &amp; Now.ToString(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;yyyy/MM/dd&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;">) &amp; </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;', '&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;"> &amp; Now.ToString(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;hh:mm:ss&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;">) &amp; </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;', '&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;"> &amp; Registers(0) &amp; </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;', '&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;"> &amp; Registers(1) &amp; </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;', '&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;"> &amp; Registers(2) &amp; </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;')&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Con.Open() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Open the database connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">objCmd = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">New</span><span style=" font-family:'Consolas'; font-size:12pt;"> OleDb.</span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">OleDbCommand</span><span style=" font-family:'Consolas'; font-size:12pt;">(SQL, Con) </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Set the command</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">objCmd.ExecuteNonQuery() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Execute the SQL command</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Con.Close() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Close the database connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Catch</span><span style=" font-family:'Consolas'; font-size:12pt;"> ex </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">Exception</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'What to do when an error occurs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Label10.ForeColor = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">Color</span><span style=" font-family:'Consolas'; font-size:12pt;">.Red</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> Label10.Text = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;Database Error!&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">End</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Try</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> End</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">If</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> End</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Изначально этот таймер установлен на 100 мс. При запуске программа сначала выполнит запись в журнал, а затем установит интервал таймера равным 1 минуте. (60000 мс)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> Private</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Sub</span><span style=" font-family:'Consolas'; font-size:12pt;"> Timer1_Tick(sender </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Object</span><span style=" font-family:'Consolas'; font-size:12pt;">, e </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">EventArgs</span><span style=" font-family:'Consolas'; font-size:12pt;">) </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Handles</span><span style=" font-family:'Consolas'; font-size:12pt;"> Timer1.Tick</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">   Label9.Text = Now </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Display time and date</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Timer1.Interval = 60000 </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Set interval for 1 minute</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Timer1.Enabled = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> Call</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Sub</span><span style=" font-family:'Consolas'; font-size:12pt;">() Button1_Click() </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">'Call the routine to get the PLC information and store in a database</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">End</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Это позволит обработать метку ссылки в форме.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Private</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Sub</span><span style=" font-family:'Consolas'; font-size:12pt;"> LinkLabel1_LinkClicked(sender </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Object</span><span style=" font-family:'Consolas'; font-size:12pt;">, e </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">As</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">LinkLabelLinkClickedEventArgs</span><span style=" font-family:'Consolas'; font-size:12pt;">) </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Handles</span><span style=" font-family:'Consolas'; font-size:12pt;"> LinkLabel1.LinkClicked</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">  ' Specify that the link was visited.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Me</span><span style=" font-family:'Consolas'; font-size:12pt;">.LinkLabel1.LinkVisited = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;">' Navigate to a URL.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#008000;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">System.Diagnostics.</span><span style=" font-family:'Consolas'; font-size:12pt; color:#2b91af;">Process</span><span style=" font-family:'Consolas'; font-size:12pt;">.Start(</span><span style=" font-family:'Consolas'; font-size:12pt; color:#a31515;">&quot;http://www.accautomation.ca&quot;</span><span style=" font-family:'Consolas'; font-size:12pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">End</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;"> End</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">Class</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Запуск программы:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">В статусе будет отображаться &quot;Инициализация..&quot;, так что импорт может быть загружен в программу. Это будет происходить при каждом запуске программного обеспечения.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1719822386skv8j2t4dp.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Ведение журнала (logging) будет отображаться в статусе, указывающем на то, что все работает корректно.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1719822417ysx9gxs9h5.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">При возникновении ошибки в статусе будут отображаться сообщения об ошибках. Мы запрограммировали две ошибки:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Ошибка связи! – Информация не поступает от ПЛК. Это может быть связано с неправильным IP-адресом или повреждением каналов связи.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Ошибка базы данных! – Информация не может быть записана в базу данных, база данных отсутствует и т.д.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Вот как выглядит наша база данных после сбора нескольких образцов данных.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1719822530d3rtgdg19b.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Как вы можете видеть, сбор информации с ПЛК по протоколу Modbus TCP и внесение ее в базу данных Access может быть легко осуществлено.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>