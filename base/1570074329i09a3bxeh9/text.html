<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Уроки по модификации пользовательского ленточного интерфейса &quot;Microsoft Fluent UI&quot; для приложений Word, Excel, PowerPoint и Access.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; font-weight:600;">Оглавление </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Настройка пользовательского интерфейса приложений Microsoft Office. 1 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Вступление. 2 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 1. Эксперимент по редактированию Fluent UI. 3 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 2. Как это работает. Структура документа. 7 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 3. Атрибуты id, idMso и idQ и пространство имён. 9 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 4. Ещё несколько полезных атрибутов. 11 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 5. Работа со встроенными изображениями.. 12 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 6. Работа с внешними изображениями.. 14 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 7. Надписи и всплывающие подсказки. Пример стандартного меню. 17 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 8. Динамические атрибуты. 18 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 9. Выполнение действия по нажатию кнопки. 21 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 10. Создание простейшей надстройки. 22 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 11. Создание второй надстройки, дополняющей первую. 25 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 12. Динамическое меню. 28 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 13. Амперсанд (&amp;), его код &amp;amp; и подчёркивание быстрых клавиш.. 30 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 14. Автоматическое открытие заданной вкладки ленты при запуске документа. 31 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 15. Использование Ribbon XML Editor для создания ленты в Access (устарело, см. ур. 17). 32 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 16. Использование внешних изображений на ленте Access (устарело, см. ур. 17). 34 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 17. Использование внешних изображений на ленте Access в версии RXE 7.5. 46 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Урок 18. Размещение на своей вкладке уже имеющейся в приложении кнопки.. 51 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="3660770205950350466"></a><a href="http://fluentui.blogspot.com/2015/02/blog-post.html"><span style=" font-family:'Times New Roman,serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">В</span></a><span style=" font-family:'Times New Roman,serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">ступление</span><a name="_Toc20980519"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На страницах этого блога я буду вести уроки по модификации пользовательского ленточного интерфейса &quot;Microsoft Fluent UI&quot; для приложений Word, Excel и PowerPoint. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Уроки – вещь длинная и нудная, поэтому для всех тех, кто схватывает на лету, достаточно двух строчек:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">1.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Скачиваем редактор интерфейса Ribbon XML Editor отсюда: </span><a href="http://novikov.gq/products/ribbonxmleditor/ribbonxmleditor.html"><span style=" font-family:'Times New Roman,serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://novikov.gq/products/ribbonxmleditor/ribbonxmleditor.html</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, распаковываем, запускаем. </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">2.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем в нём документ, вставляем в окно xml-кода интерфейса текст, скопированный отсюда: </span><a href="http://novikovmaxim.narod.ru/statyi/ur_progr/word2007/word07_3.htm"><span style=" font-family:'Times New Roman,serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://novikovmaxim.narod.ru/statyi/ur_progr/word2007/word07_3.htm</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, нажимаем F9. </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Собственно, всё. Изучаем код, модифицируем его под свои нужды, тестируем. Для тех же, кто хочет освоить настройку интерфейса в более полном объёме, и предназначены дальнейшие уроки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пожалуйста, оставляйте свои вопросы, советы и рекомендации по теме построения интерфейса в комментариях. Постараюсь ответить на все ваши вопросы. Наиболее частые из них найдут отражение в будущих уроках. Также буду рад сторонним ответам на вопросы новичков. Любая помощь и обсуждение приветствуется. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="374008281896440982"></a><span style=" font-family:'Arial,sans-serif'; font-size:10.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://fluentui.blogspot.com/2015/02/1.html"><span style=" font-family:'Times New Roman,serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">Урок 1. Эксперимент по редактированию Fluent UI.</span></a><a name="_Toc20980520"></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Чтобы не перенапрягать читателя нудной теорией, мы в первом же уроке проведём практический эксперимент по модификации ленточного пользовательского интерфейса приложений Microsoft Office на примере Word, как наиболее распространённого приложения пакета. Замечу, что принципиальных отличий от Excel и PowerPoint в области модификации интерфейса у Word нет, поэтому всё, что справедливо для Word, можно применять и к другим приложениям.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текста для чтения на этом уроке будет много, но фактических действий — всего ничего. Несколько раз щёлкнуть мышкой, так что не пугайтесь. Весь остальной текст — всего лишь дополнительная информация для тех, кто вообще не в курсе темы.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В отличие от 2007-й версии офиса, в более современных версиях (2010 и 2013) уже кое-что можно сделать и собственными настройками ленты. Впрочем, далеко не всё. Поэтому этот вариант настройки мы рассматривать не будем — в нём и так всё предельно понятно, потому что он специально сделан для широких пользовательских масс. Остановимся на другом, низкоуровневом варианте модификации, где нам потребуется построить некоторые описательные конструкции на языке разметки XML, но зато нас не будут ограничивать рамки конкретной реализации настроек офиса.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Небольшое отступление о том, какие преимущества даёт нам разработка интерфейса на XML. Одним из таковых является то, что описание интерфейса внедряется не в приложение, а в документ или шаблон, и поэтому может распространяться вместе с ним. Кроме того, для добавляемых пользовательских элементов посредством процедур обратного вызова можно динамически определять атрибуты, чего нельзя сделать через обычные настройки. На вкладке можно разместить не только уже существующие элементы или кнопки запуска макросов, но и элементы, подобные существующим, но наделённые своим функционалом. Также, можно группировать элементы при помощи элемента box, да и, пожалуй, много чего ещё, чего функционал стандартных настроек не позволяет.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, как я уже сказал выше, для построения своего интерфейса нам нужно его куда-то внедрять — в шаблон или документ. Думаю, проще всего нам создать для опытов обычный документ Word. Откроем Word и сохраним созданный подопытный документ на диск под любым удобным для вас именем, как «Документ Word (*.docx)». Замечу, что для нашей цели нельзя создавать документ через контекстное меню проводника, потому что таким способом создастся просто пустой файл с названием и правильным расширением, но без внутренней структуры, и нам тогда некуда будет внедрять свой интерфейс.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сейчас файл для опытов создан, и теперь настало время выбрать инструмент, который позволил бы нам построить и внедрить в созданный документ наш интерфейс. Сегодня в Интернете можно найти множество различных редакторов, делающих это, начиная с примитивной утилиты Custom UI Editor for Microsoft Office, и заканчивая пакетом Microsoft Visual Studio от того же разработчика. Существуют даже варианты в виде надстроек, реализующие тот же функционал. Но всё это либо неудобно, либо слишком сложно, либо не поддерживает русский язык, либо откровенно глючит, не говоря уже о том, что многое из этого платно.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Среди всего этого многообразия наиболее удобным, на мой взгляд, является специализированный XML-редактор <a href="http://novikovmaxim.narod.ru/products/ribbon/ribbon.htm"><span style=" font-family:'Times New Roman,serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">Ribbon XML Editоr</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">известный ещё как RibbonXMLEditor или RXE</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">) отечественного разработчика. Этот редактор появился ещё на заре зарождения ленточного интерфейса, в далёком 2007 году, и до сих пор поддерживается и развивается. Это не какая-нибудь там надстройка, а полноценная программа, рассчитанная на ускоренное написание нужных нам XML-конструкций. Плюс ко всему прочему — редактор этот абсолютно бесплатный. Ещё один плюс — он не требует установки, а просто распаковывается из архива, и сразу же можно пользоваться.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, скачиваем редактор с <a href="http://novikovmaxim.narod.ru/products/ribbon/ribbon.htm"><span style=" font-family:'Times New Roman,serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">официального сайта</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">чтобы гарантированно получить последнюю версию</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">), распаковываем, например, в «C:\Program Files» или «C:\Program Files (x86)» (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">в 64-битных системах</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">), и запускаем:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960kd2jzccb6q.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Снизу рыжая вкладка означает, что выбрано создание интерфейса версии 2007-го офиса. Рядом расположена другая вкладка — для интерфейса 2010 или 2013 офиса. На этом следует остановиться подробнее. Нам надо понять, какую версию интерфейса мы будем разрабатывать.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если мы хотим сделать наш документ совместимым со всеми версиями, начиная с 2007-й, то оставляем первую вкладку. Если мы хотим использовать дополнительные возможности по конфигурированию (например, сконфигурировать закулисное пространство, находящееся под ярлыком «Файл»), то переключаемся на вторую вкладку. Если мы хотим использовать в версии 2007 один интерфейс, а в версии 2010 или 2013 — другой, то нам надо будет прописать эти интерфейсы на обеих вкладках.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для нашего эксперимента мы воспользуемся первой вкладкой, то есть сделаем наши изменения интерфейса доступными для всех версий офисного пакета, начиная с 2007. Итак, начнём работу.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для начала открываем в редакторе созданный в Word’е документ. Для этого просто нажимаем <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+O</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и выбираем в открывшемся окне нужный файл. Если вы привыкли работать мышкой, можно нажать на кнопку с папочкой в верхнем левом углу программы. Замечу, что все кнопки в редакторе снабжены подробными всплывающими подсказками, что очень удобно, особенно для новичков. На кнопке с папочкой как раз и всплывёт подсказка «Открыть документ», и будет указана комбинация клавиш для этого же действия с клавиатуры.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После открытия документа его имя появится в шапке программы. Если документ новый, и до нас никто ничего в него не внедрял, то окно редактора останется пустым. В нём мы и будем писать наш XML-код, описывающий интерфейс.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как вы, наверное, уже могли заметить в процессе пользования ленточным интерфейсом, элементы в нём располагаются иерархически. На ленте расположены вкладки, на вкладках — группы, в группах — кнопки и другие элементы. При этом нельзя кнопку или другой элемент поместить сразу на вкладку, вне группы. Чтобы представлять себе разрешённую иерархию элементов в целом, можно нажать <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F1</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, и в открывшейся справке выбрать ссылку «Лента (ribbon) — схема интерфейса». Теперь, последовательно нажимая одну и ту же клавишу </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F1</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, можно переходить от схемы к коду и обратно.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На схеме видно, что корнем иерархии ленты является элемент ribbon (собственно, лента). Внутри ленты помещается четыре вложенных элемента. Из них нас будет интересовать сегодня только элемент tabs (вкладки). Вкладки, как понятно из названия, содержат в себе, собственно, одиночные вкладки — tab. Каждая вкладка содержит в себе группу элементов (group), которая, в свою очередь, может содержать большое количество разных других элементов, которые я перечислять не буду — все они видны на схеме.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, начинаем конструирование. Добавляем в область текста корневой элемент ribbon. Для этого нажимаем кнопку с выбором действия с надписью «rib» вверху левой панели, но действие для кнопки не выбираем, оставляем по умолчанию:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image15701599605kmh1vpeqm.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для интересующихся другими возможными действиями этой кнопки советую почитать всплывающую подсказку, из которой становится понятно, что кроме элемента ленты кнопка позволяет вставлять элемент commands (команды), который мы пока не рассматриваем:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После нажатия кнопки «ribbon» в области текста тотчас же появится следующая конструкция:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;?xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">version=&quot;1.0&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">encoding=&quot;UTF-8&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">standalone=&quot;yes&quot;?&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        │</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customUI&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Давайте кратко пробежимся по ней. Первая строчка нас мало интересует, она присутствует для соответствия XML-кода общему стандарту, и её мы рассмотрим как-нибудь потом. Далее мы видим тег customUI внутри которого вставлен тег ribbon выбранного нами элемента. Таким образом, получается, что элемент ленты на самом деле не является корневым, а находится внутри действительно корневого элемента — customUI (настраиваемый пользовательский интерфейс).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Корневой элемент customUI помимо ленты может включать в себя уже упомянутый элемент «команды», а в версиях, начиная с 2010, «контекстные меню» и «закулисье», находящееся под ярлыком «Файл». Но не будем отвлекаться, и ограничимся пока лентой.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Следующим этапом, согласно схеме (<span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F1</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">), в элемент ribbon нужно вставить элемент tabs, и соответствующую кнопку мы как раз видим чуть ниже. Но мы пойдём ещё более простым путём. Чтобы каждый раз не лазить в схему, и не смотреть, что во что вложено, мы просто нажимаем комбинацию клавиш </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+Пробел</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, т.е. принудительно вызываем автодополнение. После нажатия этого сочетания откроется список элементов, доступных внутри текущего элемента. Среди предложенных вариантов видим tabs. Выбираем его, и внутрь элемента ribbon вставляется элемент tabs, сразу же внутрь него — элемент tab, потому что других вариантов всё равно нет, а внутрь tab — group.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы выполнили совсем мало телодвижений, а уже почти создали нужную нам конструкцию. Нам осталось лишь заполнить значения атрибутов (прописать их внутри кавычек). В атрибуты id элементов впишем прямо по-русски, к примеру, «мояВкладка» и «мояГруппа» соответственно, а в атрибуты label — «Моя вкладка» и «Моя группа».</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что все идентификаторы поддерживают строки Unicode, то есть их можно писать и на латинице, и на кириллице, и ещё много на чём. Очень полезную информацию о типах строк можно получить из прекрасной справки Ribbon XML Editor, перейдя с главной её страницы по ссылке «Атрибуты, их типы и списки значений» и прокрутив на последние две таблицы. Проследив иерархию нужного строкового типа можно установить, какая именно строка допустима в строковом значении того или иного атрибута.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом модификацию интерфейса пока закончим, и попробуем посмотреть вживую, что у нас получилось. Сначала нужно проверить правильность нашей разметки интерфейса. Для этого нажимаем клавишу <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F7</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, и читаем результат проверки во всплывшем окне. Вместо клавиши </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F7</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> можно также нажать кнопку с зелёной галочкой в верхнем ряду кнопок программы:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960l4qqmuq375.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если результат проверки положителен, можно попробовать запустить документ на выполнение, чтобы убедиться, что наша модификация сработала. Для этого нажимаем клавишу <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F9</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> (или кнопку с зелёной стрелкой, расположенной через две кнопки правее от кнопки с галочкой). Откроется Word, и мы увидим, что в конец набора вкладок добавилась новая вкладка с присвоенным нами именем «Моя вкладка». Если мы её откроем, то увидим и вставленную нами в неё группу:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960yxug5zoo6n.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Во время открытия документа могут проявится ошибки, которые не определились или были проигнорированы на этапе валидации (<span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F7</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">) в Ribbon XML Editor. Чтобы Word нам сообщал о них, следует включить в нём галочку напротив пункта настроек: «Файл → Параметры → Дополнительно → Общие → Показывать ошибки интерфейса пользователя надстроек».</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом сегодняшний урок мы закончим. Закрываем Word, затем закрываем Ribbon XML Editor. Если после запуска вы что-то меняли в тексте, последует вопрос о сохранении изменений. Подтверждаем изменения и закроем редактор.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сегодня мы получили общее представление о модификации ленточного интерфейса. На следующем уроке мы чуть глубже погрузимся в структуру документа, и узнаем, как в нём хранится настраиваемый пользовательский интерфейс для приложения.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="2567141727595053422"></a><a href="http://fluentui.blogspot.com/2015/02/2.html"><span style=" font-family:'Times New Roman,serif'; text-decoration: underline; color:#000000;">У</span></a><a name="_Toc20980521"></a><span style=" font-family:'Times New Roman,serif'; font-size:16.5pt; font-weight:600; color:#3778cd;">р</span><span style=" font-family:'Times New Roman,serif'; font-size:16.5pt; font-weight:600; color:#3778cd;">ок 2. Как это работает. Структура документа.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На прошлом уроке мы написали новую вкладку и внедрили её в интерфейс документа, не останавливаясь подробно на самом механизме такого внедрения, чтобы не перегружать и так длинный урок. Сегодня я расскажу о том, как именно происходит внедрение написанных нами XML-конструкций в файл.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Файлы документов офисных приложений в версиях, начиная с 2007-й, кардинально отличаются от файлов документов предыдущих версий по формату хранения в них данных. Если раньше это был внутренний, закрытый формат, то теперь любой документ Word, Excel или PowerPoint представляет собой банальную структуру папок с информацией документа, сжатую алгоритмами ZIP, которую можно распаковать практически любым архиватором.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этой структуре папок есть специальные папки для хранения текста, изображений, стилей и прочих составляющих, из которых состоит документ. Одной из таких папок является папка customUI, в которой и хранится XML-файл с написанным нами интерфейсом. Давайте в этом убедимся.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откройте программу <a href="http://novikovmaxim.narod.ru/products/ribbon/ribbon.htm"><span style=" font-family:'Times New Roman,serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">Ribbon XML Editor</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, и нажмите </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Shift+Ctrl+O</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, чтобы загрузить последний документ, созданный на прошлом уроке. Вместо клавиатурной комбинации можно нажать и на соответствующую кнопку в интерфейсе программы, расположенную в верхней панели с изображением открытой папки, из которой торчит листок с текстом. Это кнопка с выбором действия. По умолчанию она открывает последний документ, но, щёлкнув по стрелочке справа, можно открыть список всех файлов, открываемых в программе в последнее время. Пока в этом списке содержится только один документ, но их может быть сколько угодно. Максимальное количество запоминаемых документов можно изменить в настройках программы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда программа открывает документ, фактически она распаковывает его к себе в техническую папку и считывает из неё файл с XML-макетом интерфейса. Давайте посмотрим, что из себя представляет наш распакованный документ. Для этого откроем техническую папку программы, нажав самую правую кнопку в верхней панели с изображением открытой папки, из которой торчит шестерёнка.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В открывшейся папке мы видим папку с распакованным документом, а рядом ещё два файла, содержащих настройки Ribbon XML Editor. Нас интересует папка с распакованным документом. Открыв её, мы, среди других папок, увидим папку <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Это папка настраиваемого пользовательского интерфейса. В документах, не имеющих внедрённого интерфейса, эта папка отсутствует.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откроем эту папку, и увидим файл <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">customUI.xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, содержащий набранный нами на прошлом уроке текст. Так что всё очень прозрачно и доступно. Но этим файлом модификация интерфейса не ограничивается. Приложению надо как-то дать знать, что интерфейс находится именно в этом файле, потому что теоретически название папки и файла с интерфейсом могут быть любыми. Для этого в корневой папке документа имеется папка </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">_rels</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, содержащая файл </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">.rels</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. В этом файле содержится список ссылок на различные компоненты документа, в том числе и на настраиваемый пользовательский интерфейс.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Содержимое файла корневых ссылок <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">.rels</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> можно увидеть непосредственно в редакторе Ribbon XML Editor, открыв вкладку с названием «Корневые ссылки (.rels)», ярлык которой расположен в верхней части программы, сразу под верхней панелью. Рассмотрим файл корневых ссылок подробнее. Перейдите в редактор, и откройте эту вкладку:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960z639ymplw2.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Корневые ссылки оформлены тоже в виде XML-конструкций. Каждая ссылка содержит идентификатор, тип и ссылку на файл, который она представляет. Интересующая нас ссылка является последней. Можно увидеть, что она указывает путь к нашему файлу интерфейса. При внедрении интерфейса в документ Ribbon XML Editor добавляет эту ссылку автоматически. Теоретически идентификатор ссылки (атрибут Id) может быть любым, но обычно используют именно этот (CustomUI2007RelID для версии 2007 и CustomUI2010RelID для версий 2010/2013).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Помимо ссылки на интерфейс, в файле содержатся ссылки на файлы основных данных по документу (принадлежность приложению, на каком шаблоне документ основан, количество символов в документе и др. статистическая информация), основных настроек документа (название, автор, кто редактировал, когда документ был создан и когда отредактирован и пр.), а также ссылка на собственно содержимое документа. Все эти данные также содержатся в виде XML-конструкций.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В структуре документа есть ещё пару мест, которые нас будут интересовать, когда мы начнём импортировать в интерфейс собственные иконки, и они отражаются на третьей и четвёртой вкладках редактора интерфейса. Замечу, что нам вряд ли когда-нибудь потребуется что-то менять на всех этих дополнительных вкладках программы. Все изменения там происходят автоматически по мере работы на первой вкладке, и существуют они больше в образовательных целях, чем для какой-то реальной работы.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом мы закончим сегодняшний урок. Закройте документ, нажав <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+W</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, или щёлкнув по кнопке с изображением закрытой папки с красным крестиком. Папка документа исчезнет из технической папки программы, текстовые редакторы на всех вкладках очистятся, документ закроется. Закроем и окно программы, стандартным образом — щёлкнув по красному крестику в правом верхнем углу.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Небольшое дополнение по закрытию документа. Фактически, сам файл документа закрывается сразу же после его распаковки в техническую папку, и работа ведётся только с распакованной копией. При сохранении документа распакованная папка снова архивируется со всеми изменениями, и полученный документ просто перезаписывает основной документ. Это надо иметь ввиду, если вы редактируете документ в приложении офиса, когда он уже открыт в Ribbon XML Editor. В этом случае после сохранения документа из приложения с последующим его сохранением из Ribbon XML Editor данные, внесённые ранее через приложение, будут потеряны.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для одновременного редактирования приложения в обеих программах надо не забывать закрывать его в Ribbon XML Editor перед открытием в офисном приложении, а при открытии в Ribbon XML Editor — закрывать его в MS Office. Для автоматизации этого рутинного процесса в Ribbon XML Editor есть специальные настройки «Закрывать документ перед запуском его в MS Office» и «Открывать документ при закрытии его в MS Office». Их можно найти на вкладке настроек в разделе «Документы». Впрочем, одновременное редактирование бывает полезно только при работе с написанием макросов, поэтому пока просто запомним эту возможность программы.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На следующе уроке мы продолжим начатую в первом уроке модификацию интерфейса и разберёмся с атрибутами <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> идентификаторов и пространствами имён.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="3461060491230433499"></a><a href="http://fluentui.blogspot.com/2015/02/3-id-idmso-idq.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 3. Атрибуты id, idMso и idQ и пространство имён.</span><a name="_Toc20980522"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На первом уроке мы добавили свою вкладку со своей группой в интерфейс. Как вы, наверное, уже заметили, каждый элемент интерфейса формируется XML-структурой, которая состоит из открывающего и закрывающего тегов, атрибутов, присутствующих внутри открывающего тега, а также значений этих атрибутов, помещённых в кавычки. Имя тега — это имя элемента. Атрибуты — это параметры того или иного элемента.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Одним из важнейших параметров является идентификатор элемента, по которому приложение офиса отличает его от других элементов того же типа, находящихся рядом в том же родительском элементе-контейнере. Другими словами, он присутствует в любом элементе, если подразумевается возможность нахождения нескольких однотипных элементов на одном уровне иерархии. Так, например, элемент tabs не имеет идентификатора, поскольку внутри родительского элемента ribbon может быть только один элемент tabs. Других элементов tabs рядом быть не может. А вот элемент tab обязан иметь идентификатор, поскольку внутри tabs этих элементов может быть много, и их надо как-то различать.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда мы вставляем в интерфейс какой-либо элемент, вместе с формирующими элемент тегами в него вставляются некие обязательные атрибуты. При вставке tabs были вставлены только теги, обязательных атрибутов у этого элемента нет. А вот у tab обязательно должен быть идентификатор, поэтому внутри открывающего тега мы видим атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, который как раз и задаёт этот идентификатор. Кроме того, странно было бы видеть вкладку без названия (её тогда даже не будет видно, если она не является текущей), поэтому в тег по умолчанию включён также атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">label</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, который, хотя и не является обязательным, но практически всегда используется.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> позволяет задать пользовательский идентификатор созданного элемента. Но наряду с элементами, созданными пользователем, существуют и штатные элементы, уже присутствующие в приложении. Это имеющиеся в нём изначально вкладки, группы, кнопки и т.д. Если мы захотим вставить в нашу вкладку уже готовую штатную группу, то вместо </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> мы пишем </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> (атрибут, задающий штатный идентификатор Microsoft Office) и вставляем в его значение идентификатор того элемента, который хотим видеть. Таким образом, </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> задаёт идентификатор для созданных пользователем элементов, а </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> — идентификатор уже существующего, штатного элемента офиса.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проверим это на практике, вставив на нашу вкладку вместо нашей группы другую, уже существующую в Word’е. Для этого откроем в <a href="http://novikovmaxim.narod.ru/products/ribbon/ribbon.htm"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">Ribbon XML Editor</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> наш последний документ, установим курсор в любое место атрибута </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> созданной нами группы и нажмём </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+Пробел</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Выберем в появившемся списке атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> поменяется на атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Теперь поставим курсор внутрь кавычек перед нашим идентификатором, и снова нажмём </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+Пробел</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Откроется список идентификаторов существующих групп. Выберем идентификатор </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">GroupFont</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Теперь запустим документ, и если у вас было включено отображение ошибок интерфейса (Файл - Параметры - Дополнительно - Общие - Показывать ошибки интерфейса пользователя надстроек), Word выдаст ошибку по поводу того, что не может изменить label существующей группы. Закрыв окно ошибки, мы увидим, что вместо нашей группы в нашей вкладке появилась существующая в Word’е группа «Шрифт», а наш атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">label</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> не применился. Так же были бы обруганы и все другие созданные нами элементы, если бы мы попытались вставить их внутрь этой группы. Отметим на будущее, что готовые штатные группы не поддаются модификации.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Помимо <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> есть ещё один интересный атрибут для задания идентификаторов — </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. С помощью него можно выйти за рамки пользовательских и штатных идентификаторов, и сослаться на элемент, находящийся, например, в какой-нибудь сторонней надстройке. Это становится возможным благодаря тому, что </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> позволяет задать в своём значении не только сам идентификатор, но и некий префикс, которому заранее присвоено </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">пространство имён</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, использующееся в сторонней надстройке. Другими словами, можно сказать, что область видимости </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> не ограничена конкретным пространством имён, как это происходит у </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> или </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Немного о том, что такое упомянутое мной в выше пространство имён. Пространство имён — это просто часть имени идентификатора, т.е. кусок строки, негласно добавляемый перед строкой каждого идентификатора, находящегося в зоне действия этого пространства имён. Этим достигается уникальность имён всех идентификаторов внутри офисного приложения, даже если элементы одновременно присутствующих надстроек, в которых объявлены разные пространства имён, названы одинаково.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кроме банального достижения уникальности, пространство имён часто используется для того, чтобы объединить несколько надстроек на одной, созданной для них вкладке. Обычно это делается в случае разделения одной большой надстройки на несколько более мелких. Это особенно удобно, если, например, разные группы в надстройке разрабатывается разными авторами. В этом случае во всех разрабатываемых надстройках объявляется одинаковое пространство имён, а идентификатор общей вкладки указывается атрибутом <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> с указанием префикса этого пространства. С примером использования </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> для объединения надстроек на одной вкладке мы познакомимся позже.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Исходя из вышесказанного вытекает, что <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> можно применять и вместо </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и вместо </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, и это так. Поясню на простейшем примере. Все штатные идентификаторы в 2007-й версии офиса находятся в пространстве имён «http://schemas.microsoft.com/office/2006/01/customui». Если мы посмотрим атрибуты элемента customUI в нашем коде, то найдём среди них атрибут xmlns, которому присвоена вышеупомянутая строка. Если в xmlns не указан префикс, то всем идентификаторам без префикса присваивается именно это пространство имён (т.н. пространство имён по умолчанию). В этом случае, атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> рассматривает все идентификаторы без префикса как идентификаторы пространства имён «http://schemas.microsoft.com/office/2006/01/customui». То есть, теоретически, мы можем писать </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> вместо </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> без какой-либо дополнительной доработки кода.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь про использование <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> вместо </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Для этого надо объявить какое-то своё, дополнительное пространство имён — добавить второй атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">xmlns</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> с указанием желаемого префикса (в виде постфикса атрибута xmlns), и присвоить ему любую другую строку, которая и будет определять новое пространство имён, например:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    xmlns:моё=&quot;Моё пространство имён&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь все идентификаторы, имеющие префикс «моё:» будут находится в нашем пространстве имён «Моё пространство имён», и вместо id=&quot;мояВкладка&quot; можно написать idQ=&quot;моё:мояВкладка&quot;. В качестве пространств имён можно использовать любую строку с пробелами и другими символами, но на практике чаще всего используют URL (интернет-адрес). </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Фактически по этому адресу в Интернете может не быть ничего. Например, в случае со стандартными пространствами имён «http://schemas.microsoft.com/office/2006/01/customui» и «http://schemas.microsoft.com/office/2009/07/customui» при переходе по этим адресам (по крайней мере, на момент написания этого урока) сайт <a href="http://schemas.microsoft.com/"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> вываливает строку «The resource you are looking for has been removed, had its name changed, or is temporarily unavailable.», т.е. «Ресурс, который вы ищете, был удалён, переименован, или временно недоступен.». Но в других случаях по подобным адресам можно найти странички с описанием соответствующего пространства имён.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На практике с пространствами имён и атрибутами, позволяющими его задавать внутри своих значений (а это не только idQ, а ещё и <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">insertAfterQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">insertBeforeQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">), мы познакомимся позже. А пока мы просто попытались понять различия между атрибутами </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, а также получили первичное представление о пространствах имён.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом сегодняшний урок мы закончим, а следующий раз продолжим модификацию интерфейса и познакомимся с некоторыми другими полезными атрибутами элементов интерфейса.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="2609894541187437674"></a><a href="http://fluentui.blogspot.com/2015/02/4.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 4. Ещё несколько полезных атрибутов.</span><a name="_Toc20980523"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Ранее мы уже использовали такие атрибуты для элементов интерфейса, как </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">label</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Всё это были статические атрибуты, то есть атрибуты, значения которым мы присваиваем сразу, а не получаем их в процессе работы офисного приложения, как это было бы в случае использования динамических атрибутов, о которых мы поговорим позже. Давайте рассмотрим другие полезные статические атрибуты, которые мы можем использовать для должного оформления интерфейса.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Давайте переместим нашу вкладку с конца ленты в её начало, поставив её перед самой первой вкладкой «Главная». Для этого вставим в элемент новый атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">insertBeforeMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> (вставить перед…) и присвоим ему идентификатор вкладки «Главная».</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как узнать идентификатор вкладки «Главная»? Обычно для определения идентификаторов различных элементов в офисном приложении открывают настройки ленты, наводят курсор на нужный элемент в списке, и читают всплывающую подсказку. Но вот на именах вкладках и групп подсказок почему-то нет. Как же быть? Элементарно! Открываем встроенную справку программы <a href="http://novikovmaxim.narod.ru/products/ribbon/ribbon.htm"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">Ribbon XML Editor</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, и на её главной странице в списке приложений к справке находим пункт «Word — идентификаторы всех вкладок и групп». Открываем и вуаля! Замечу, что более полного списка идентификаторов вкладок и групп я не встречал больше нигде.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Установим курсор в любое свободное место внутри тега tab в области атрибутов, чтобы слева и справа были пробелы. Нажмём <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+Пробел</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и выберем в списке атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">insertBeforeMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Выбранный атрибут вставится в текст. Затем наберём знак «=». Вы увидите, как тут же после знака автоматически добавятся кавычки, и курсор установится внутри них. Снова нажмём </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+Пробел</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и выберем из предлагаемых идентификаторов вкладок найденный в справке идентификатор TabHome, который соответствует вкладке «Главная». </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Можно и не нажимать <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+Пробел</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, а просто начать набирать первые буквы идентификатора в любом регистре. Окно автодополнения со списком идентификаторов вкладок покажется после набора первых двух букв. Продолжение набора будет уточнять список, пока не останется только один вариант. На любом этапе вы можете сделать окончательный выбор из списка, или не использовать его вовсе. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Замечу, что количество набранных букв до показа списка автодополнения можно регулировать в настройках программы. На первой вкладке настроек в разделе «Автодополнение» находится три маленькие странички настроек. Первая — это общие настройки для всех списков, а следующие две относятся к длинным и коротким спискам. Короткие списки — это списки тегов, атрибутов или их значений, если эти значения — не идентификаторы. Такие списки удобно видеть целиком, без сокращения по мере набора. Длинные списки — это списки идентификаторов, которые обычно очень большие, и их полезно сокращать, принимая во внимание уже набранную часть идентификатора.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проверим, что у нас получилось. Запустив документ на выполнение, мы увидим, что наша вкладка переместилась в самое начало, и расположилась перед вкладкой «Главная». Аналогично работает атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">insertAfterMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, позволяя расположить наш элемент после существующего.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы можем автоматически скрывать все стандартные вкладки ленты при загрузке документа, и оставлять только созданные нами. Для этого достаточно в элементе ribbon изменить значение атрибута <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">startFromScratch</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> (начать с чистого листа) с false на true. Не знаю, имеет ли это большой смысл, но просто запомним, что такая возможность есть.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кроме того, можно скрывать каждую вкладку и по-отдельности, используя атрибут visible:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;TabHome&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">visible=&quot;false&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;TabInsert&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">visible=&quot;false&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;TabPageLayoutWord&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">visible=&quot;false&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;TabReferences&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">visible=&quot;false&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;TabMailings&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">visible=&quot;false&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Здесь мы с помощью атрибута <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> ссылаемся на стандартные вкладки и присваиваем атрибуту visible (видимость) значение false.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом сегодняшний урок мы закончим. В следующий раз мы попробуем поработать с изображениями.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="1995627046415296068"></a><a href="http://fluentui.blogspot.com/2015/02/5.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 5. Работа со встроенными изображениями</span><a name="_Toc20980524"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Давайте создадим новый проект. Откроем в </span><a href="http://novikovmaxim.narod.ru/products/ribbon/ribbon.htm"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">Ribbon XML Editor</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> новый документ и вставим вкладку и группу, как мы уже делали на предыдущем уроке. Затем вставим в группу кнопку (button):</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;?xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">version=&quot;1.0&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">encoding=&quot;UTF-8&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">standalone=&quot;yes&quot;?&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя вкладка&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHome&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Группа1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя группа&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;DeleteWord&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customUI&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пусть кнопка будет удалять текущее слово с позиции курсора до конца. Идентификатор этой кнопки мы можем посмотреть в настройках ленты в приложении Word. Запустим документ, посмотрим на результат. По умолчанию, эта кнопка не содержит изображения, и потому выглядит в интерфейсе не очень симпатично. Давайте добавим кнопке изображение.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Microsoft Office уже содержит в себе несколько тысяч изображений. Надо только узнать идентификатор наиболее подходящего, и вставить его в атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">imageMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Довольно нетривиальная задача, не правда ли? К счастью, Ribbon XML Editor имеет в своём распоряжении галерею всех встроенных в офис иконок, которая позволяет осуществить выбор и вставку понравившегося изображения.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ставим курсор после последнего атрибута кнопки перед закрывающими тег символами, и нажимаем кнопку галереи:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960x2gwdlc960.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откроется галерея иконок, содержащая несколько вкладок. На каждой вкладке по 500 изображений. При наведении мыши на каждое изображение появляется всплывающая подсказка с его идентификатором:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960mes3wve4b1.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выберем понравившееся изображение, и нажмём на него. Окно закроется, а в позицию курсора вставится атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">imageMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> со значением идентификатора выбранного изображения. Проверим результат, нажав </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F9</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> для запуска документа. Я использовал идентификатор WatermarkRemove. Кнопка стала выглядеть намного лучше.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если выбранное изображение выглядит недостаточно хорошо, его легко поменять. Для этого ничего удалять не надо. Просто ставим курсор в любое место старого идентификатора и вновь вызываем галерею. Выбираем другой значок и нажимаем на него. Новый идентификатор встанет на место старого.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Описанным образом можно не только вставлять изображения в кнопки, не имеющие таковых, но и менять имеющиеся изображения на кнопках на другие из состава офиса, хотя это вряд ли будет иметь какой-то смысл. А вот заменить изображение на штатной кнопке собственноручно нарисованное просто так средствами xml не получится. Но это можно сделать для своей кнопки, которая во время своего нажатия будет вызывать функционал штатной кнопки. Но об этом я расскажу уже на следующем уроке.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь давайте изменим размер кнопки. Для этого пропишем атрибут size:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;button</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;DeleteWord&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">imageMso=&quot;WatermarkRemove&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">size=&quot;large&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">size</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> может принимать только два значения, которые нам и предлагает автодополнение: normal и large. По умолчанию кнопка DeleteWord имеет размер normal. После изменения на large и запуска документа на выполнение мы увидим, что увеличилась не только сама кнопка, но и изображение на ней. Теперь вместо иконки 16х16 автоматически используется иконка 32x32. При этом интерполяции не происходит — как правило, офис содержит в себе оба размера иконок.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом сегодняшний урок мы закончим. Следующий раз поговорим о вставке в интерфейс внешних изображений.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="3103785608575814123"></a><a href="http://fluentui.blogspot.com/2015/03/6.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 6. Работа с внешними изображениями</span><a name="_Toc20980525"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На прошлом уроке я упоминал о том, что на встроенных (штатных) кнопках можно использовать только встроенные изображения, уже имеющиеся в офисе. Если же мы создадим свою кнопку, то сможем разместить на ней как встроенное, так и собственное, внешнее изображение. Давайте попробуем это сделать, добавить в интерфейс внешнее изображение.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откроем проект прошлого урока и добавим в нашу группу вторую кнопку. Пусть кнопка должна будет в итоге выводить на экран окно с приветствием. Поскольку кнопка будет самодельная, вместо <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> для задания идентификатора используем </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. В качестве идентификатора укажем произвольное слово, например, «Приветствие»:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;?xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">version=&quot;1.0&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">encoding=&quot;UTF-8&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">standalone=&quot;yes&quot;?&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя вкладка&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHome&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Группа1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя группа&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;DeleteWord&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Приветствие&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Поприветствовать&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customUI&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь запустим документ на выполнение и посмотрим, что получилось. Мы увидим, что справа от нашей большой кнопки, которую мы поместили туда ранее, появилась маленькая, со словом «Поприветствовать». Поскольку изображение ей мы ещё не присвоили, кнопка будет содержать только надпись.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь займёмся изображением. В идеале мы должны создать иконку 32x32, которая бы хорошо смотрелась не только в своём истинном размере, но и при автоматической интерполяции до 16x16. Предпочтительный формат файла изображения, конечно, «png», поскольку он поддерживает градацию прозрачности, что позволит нам избежать рваных краёв у рисунка при его отображении на кнопке.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Само создание иконки в графическом редакторе выходит за рамки нашей темы. В качестве альтернативы, можно поискать нужные иконки в Интернете. Чтобы не нагружать читателя лишними заботами, я выложу пример иконки здесь. Скачайте её и сохраните на диске:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image15701599600iggyhwevk.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Чтобы вставить изображение в код, нужно, чтобы оно уже находилось внутри структуры документа. На втором уроке я упоминал о паре мест внутри документа, которые нас будут интересовать при использовании внешних изображений. Эти места отображаются на вкладках «Ссылки на изображения» и «Типы файлов».</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поскольку изображений в документе ещё нет, редактор вкладки «Ссылки на изображения» будет пуст. Он будет отображать содержимое файла CustomUI.xml.rels с сылками на импортированные изображения, который будет располагаться внутри документа в папке customUI\_rels. Но пока этого файла тоже нет. Всю эту структуру, а также папку images для хранения изображений внутри документа, Ribbon XML Editor создаст автоматически, в процессе импорта внешнего изображения.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Давайте импортируем изображение в документ. Для работы с внешними изображениями в интерфейсе редактора предусмотрен специальный блок, состоящий из кнопки импорта файла изображения, комбобокса выбора изображения для вставки его идентификатора в текст, кнопки вставки идентификатора и кнопки удаления файла изображения из документа:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image15701599606jevod4xsl.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На рисунке блок работы с изображениями выделен красной рамкой. Нажмём первую кнопку блока для выбора изображения для импорта, и выберем скачанный и сохранённый ранее файл Рука.png. Его изображение и идентификатор тотчас добавится в комбобокс. Изображение уже в документе.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Что изменилось на вкладках «Ссылки на изображения» и «Типы файлов». На первой из этих вкладок появился следующий текст:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;?xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">version=&quot;1.0&quot;?&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;relationships</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.openxmlformats.org/package/2006/relationships"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.openxmlformats.org/package/2006/relationships</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;relationship</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Рука&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">target=&quot;images/xTCxUBxU2xTS.png&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">type=&quot;</span><a href="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.openxmlformats.org/officeDocument/2006/relationships/image</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/relationship&gt;&lt;/relationships&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Внутри корневого тега Relationships содержится тег Relationship с сылкой на только что импортированное изображение. Бегло пройдёмся по атрибутам этого тега. C атрибутом <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> всё понятно — это идентификатор изображения, который будет применяться в тексте. А вот дальше следует атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">target</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, указывающий расположение файла внутри папки интерфейса, но вместо имени файла мы видим странный набор символов. Объясняется это просто — офис не поддерживает кириллицу в именах файлов изображений, и поэтому Ribbon XML Editor автоматически кодирует кириллистические символы 36-ричными кодами, содержащими только цифры и латиницу.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Последним атрибутом ссылки является <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">type</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> — тип ссылки. Тип записывается наподобие пространства имён — интернет-адресом, по которому, на момент написания урока, ничего нет. Из его записи мы можем лишь понять, что рассматриваемый тег является ссылкой на изображение, что мы уже и так знаем.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На второй из рассматриваемых вкладок отображается файл [Content_Types].xml, который тоже подвергается некоторым изменениям во время импорта изображений. Файл находится в корне структуры документа и содержит перечисление типов объектов, помещённых в документ. Он уже содержит ряд объектов, а при добавлении изображения в него помещается строка с указанием типа файла изображения в привязке к его расширению. В нашем случае мы добавляли файл «png», поэтому в список добавилась соответствующая строка:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;default</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">contenttype=&quot;image/png&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">extension=&quot;png&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При добавлении следующего изображения с тем же расширением редактор обнаружит наличие этой строки, и не будет уже добавлять новую. А вот если добавить файл другого формата, то в текст вставится новая строка, соответствующая новому формату файла.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Тут надо упомянуть про форматы изображений, поддерживаемых офисом. Процитирую справку Ribbon XML Editor с перечислением форматов, которые поддерживаются этим редактором для импорта:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">1.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">png (тип image/png) — поддерживает градацию прозрачности.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">2.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">gif (тип image/gif) — поддерживает единственный уровень прозрачности — полную прозрачность.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">3.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">bmp (конвертируя в png) — может поддерживать градацию прозрачности (32-битный формат)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">4.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">ico, icon (тип image/x-icon) — поддерживает градацию прозрачности.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">5.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">jpg, jpeg, jpe, pjpeg (тип image/jpeg) — не поддерживает прозрачность.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">6.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">tif, tiff (тип image/tiff) — поддерживает градацию прозрачности.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">7.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">wmf (тип image/x-wmf) — векторный формат, поддерживает прозрачность.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">8.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">emf (тип image/x-emf) — усовершенствованный wmf, поддерживает прозрачность.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Практически интерес представляют только первые четыре формата. Остальные, как правило, для интерфейсных изображений не применяются. Отдельно скажу про формат «bmp», опять же процитировав справку:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">«Несмотря на то, что интерфейс офисных программ понимает файлы формата .bmp, он отображает их без учёта прозрачности (в случае 32-битного bmp) и без принудительного вырезания фона, поэтому Ribbon XML Editor при импорте конвертирует такие файлы в формат .png либо копируя канал прозрачности в случае 32-битного .bmp, либо вырезая фон, определяя его, как пиксели, цвет которых совпадает с цветом левого нижнего пикселя.»</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так что, если у вас есть коллекция иконок в формате «bmp», никто не запрещает их применять. Но я всё же рекомендую использовать именно формат «png», как наиболее приспособленный для этого дела.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, изображение у нас в документе. Дело осталось за малым — сослаться на него в коде интерфейса. Для этого ставим курсор в конец атрибутов тега кнопки, и нажимаем кнопку «Вставить ссылку на изображение в текущую позицию курсора». В тег вставляется атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">image</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> со значением идентификатора картинки. Происходит это так же, как и при вставке встроенного изображения из галереи в атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">imageMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запускаем документ на выполнение, и любуемся красивой кнопкой. При желании можем тоже сделать её большой, добавив атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">size</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> с указанием в нём значения </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">large</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом урок мы закончим. На следующем уроке мы разберём ещё несколько атрибутов, задающих различные надписи элементам, а также увидим интересный пример реализации классического меню с панелями, размещённого прямо на вкладке ленты. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="2508468859731493173"></a><a href="http://fluentui.blogspot.com/2015/03/7.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 7. Надписи и всплывающие подсказки. Пример стандартного меню.</span><a name="_Toc20980526"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Давайте добавим к созданной нами на прошлом уроке кнопке полноценную всплывающую подсказку. Для этого добавим в тег button два статических атрибута: </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">screentip</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">=&quot;Вывести окно приветствия&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> и </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">supertip</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">=&quot;Вывести окно приветствия для получения удовольствия&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Запустим документ, и посмотрим, что получилось. Теперь, при наведении мыши на кнопку, отображается всплывающая подсказка с текстом, сформированном из значений обоих атрибутов.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Что ещё можно задать в статических атрибутах для кнопки? Например, быстрые клавиши (<span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">keytip</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">), подсказки о которых появляются в интерфейсе после кратковременного нажатия на клавишу Alt. Для одного элемента интерфейса можно задавать последовательности до трёх клавиш, хотя в большинстве случаев достаточно одной, максимум — двух, если количество элементов на вкладке достаточно велико.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отдельно упомяну про атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">description</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. В любом случае не будет ошибкой, если он тоже будет заполнен текстом, но срабатывать он будет только тогда, когда элемент с этим атрибутом будет помещён внутрь меню в качестве пункта этого меню, а атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">itemSize</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> самого меню будет содержать значение large. Другими словами, </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">description</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> актуален</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">только внутри меню с большими пунктами. Поэтому в нашем случае заполнять его пока не будем.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь я расскажу об одной интересной находке. Она будет интересна приверженцам старого классического меню. Неожиданно оригинал кода интерфейса находится (в составе предлагаемого шаблона документа) на личном сайте начальника отдела артиллерийско-технической службы подводной лодки военно-морских сил США в отставке:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://gregmaxey.mvps.org/word_tip_pages/ribbon_menu_control.html"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://gregmaxey.mvps.org/word_tip_pages/ribbon_menu_control.html</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ниже можно скачать отдельно код интерфейса, переведённого мною на русский язык:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://sites.google.com/site/fluentui/word2003UI.exportedUI"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">word2003UI.exportedUI</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для тестирования сохраните скачанный файл на диске, откройте в Ribbon XML Editor какой-нибудь новый документ Word и нажмите кнопку «Импортировать файл настроек ленты»:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image15701599602p73spdj9r.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выберите скачанный файл. Его текст вставится в текущее окно. Первая строчка будет закомментирована в целях совместимости с типом файла «.exportedUI». Раскомментируйте её (для этого просто выделите весь комментарий целиком и нажмите кнопку «Комментарий» в строке над окном, четвёртую слева). Всё, теперь можете запустить документ на выполнение и насладиться видом классического меню.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В качестве альтернативного варианта можно просто открыть скачанный файл в блокноте, и скопировать его содержимое непосредственно в окно Ribbon XML Editor, но зачем делать лишние телодвижения?</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Самостоятельно рассмотрите код. Он весьма прост. В нём создаются пользовательские меню, помещённые в горизонтальный контейнер (box) в которые посредством атрибута <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idMso</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> вставляются стандартные элементы. Ниже контейнера в два ряда располагаются группы кнопок, имитирующие классические панели инструментов. Ничего более сложного в коде не производится.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что на вышеупомянутом сайте американского офицера можно найти очень много полезной и интересной информации для новичков, владеющих английским. Всё очень толково и грамотно, с иллюстрациями, разложено по полочкам.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="7675249282089698181"></a><a href="http://fluentui.blogspot.com/2015/03/8.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 8. Динамические атрибуты.</span><a name="_Toc20980527"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Помимо </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">статических </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">атрибутов существуют т.н. </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">динамические </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">атрибуты. Они позволяют задавать в своём значении имя внешней функции, которая сама предоставит нужное значение атрибута. Функции пишутся на языке VBA (Visual Basic for Applications), что переводится, как «Визуальный Бейсик для приложений». Это именно тот язык программирования, на котором в приложениях Microsoft Office записываются макросы, о которых вы уже, несомненно, слышали. Код функций хранится внутри документа и редактируется встроенным в приложение редактором Бейсика.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функции, имена которых передаются элементу интерфейса, как в нашем случае, называются функциями обратного вызова. Смысл названия заключается в том, что вызов функции осуществляется не из кода программы, а как бы с обратной стороны, из интерфейса. То есть, основной код программы всего лишь передаёт имя функции в интерфейс в качестве параметра, а интерфейс вызывает её только тогда, когда ему самому это нужно.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вы не очень поняли смысл этого названия, то не заморачивайтесь с этим. На создание интерфейсов это не повлияет. Считайте, что смысл технических нюансов вызова этих функций скрыт для вас за некоторым уровнем абстракции.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как правило, <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">динамические </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">атрибуты начинаются со слова </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">get</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> (получить). Фактически, эти атрибуты являются парными для </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">статических</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, то есть, задают один и тот же параметр. Только в одном случае он задаётся сразу в XML-тексте, т.е. статически, а в другом возвращается из функции в качестве результата её работы, непосредственно в момент запуска документа, то есть, динамически.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Давайте рассмотрим один пример. Откроем Word, создадим документ, и сохраним его, как документ с макросами, т.е. с расширением .docm. Именно этот тип документа позволит нам сохранять в нём код VBA-функций. Закроем Word, откроем Ribbon XML Editor, и откроем в нём только что созданный нами файл. Напишем код аналогичный тому, что мы создавали раньше: создадим новую вкладку, в неё поместим группу, а в группу — кнопку:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customui</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHome&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя вкладка&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Группа1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя группа&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Кнопка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image=&quot;Рука&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">keytip=&quot;ХАЙ&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Поприветствовать&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">screentip=&quot;Вывести окно приветствия&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">size=&quot;large&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">supertip=&quot;Вывести окно приветствия для получения удовольствия&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customui&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запустим документ на выполнение, и проверим, что код работает правильно. Теперь мы попробуем заменить статический атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">label </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">у кнопки на его динамический аналог — </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">getLabel</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Но вначале изменим кое-какую настройку Ribbon XML Editor.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После запуска документа на выполнение мы будем писать код на VBA через редактор Бейсика, встроенный в Word, и чтобы этот код мог сохранится в документе, нам следует перед его сохранением закрывать документ в Ribbon XML Editor. Иначе, очевидно, что последний его перезатрёт уже при своём сохранении, ведь в Ribbon XML Editor документ был открыт раньше, чем в Word.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы делать всё автоматически, откроем страницу настроек Ribbon XML Editor и в разделе «Документы» установим галочку на пункте «Закрывать документ перед запуском его в MS Office». Удостоверимся, что следующая галочка, «Открывать документ при закрытии его в MSOffice», тоже установлена, и вернёмся на страницу кода.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Посмотрим, как это работает. Запустим документ на выполнение (F9). Документ запустится. Переключимся на приложение Ribbon XML Editor, и убедимся, что документ там закрылся. Снова вернёмся к Word. Закроем документ или весь Word целиком. Тотчас Ribbon XML Editor выйдет на передний план и автоматически откроет документ. Таким образом, мы можем попеременно редактировать и XML и VBA, не боясь, что сохранение документа в одном редакторе перезатрёт изменения, сделанные в другом редакторе.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь находим атрибут <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">label </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">и установив на него курсор, и нажав </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+Пробел</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> сменим его на </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">getLabel</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. В качестве значения впишем имя функции (можем оставить в качестве такового старое значение, пусть теперь это будет именем функции, оно вполне подходит для этого).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь нам надо написать соответствующую функцию на VBA. Чтобы упростить программистам жизнь, Ribbon XML Editor может сгенерировать шаблон для этой функции, чтобы потом только осталось её заполнить. Для этого нажмём <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> или кнопку в правой части верхней панели:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960i09f85t8i6.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откроется окно с шаблоном нашей функции. Его можно заполнить прямо здесь, но лучше воспользоваться специализированным редактором Бейсика. Для этого вначале сохраним шаблон функции в файл: нажмём кнопку с изображением дискетки в верхней панели окна шаблонов Ribbon XML Editor. Предложенное имя файла RibbonCallbacks.bas оставим без изменений.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь закроем в Ribbon XML Editor окно шаблонов и запустим документ на выполнение (F9). Найдя в интерфейсе ссылку на функцию «Поприветствовать», Word предупредит нас о том, что не нашёл соответствующий макрос. Всё правильно, его ещё нет, соглашаемся. Обратите внимание, что на нашей кнопке пропала надпись. Тут тоже всё правильно, ведь макроса, генерирующего её, в документе ещё нет.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переходим в редактор Бейсика. Для этого нажимаем ту же комбинацию <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, но уже в Word. В качестве альтернативы можно включить в настройках Word вкладку разработчика, переключиться на неё и нажать кнопку «Visual Basic» в группе «Код».</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В открывшемся редакторе Бейсика нажимаем <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Ctrl+M</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, или выбираем в меню «File -&gt; Import Faile…». Находим сохранённый из Ribbon XML Editor файл с шаблонами (RibbonCallbacks.bas) и открываем его. В документ в раздел Modules добавляется новый модуль RibbonCallbacks (смотрите его слева, в структуре проекта). Открываем папку модулей, делаем двойной щелчок на модуле RibbonCallbacks и видим текст нашего шаблона.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь вписываем внутрь функции команду возврата имени кнопки:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Кнопка1 (компонент: button, атрибут: getLabel), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Поприветствовать(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl, ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label)    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    label = &quot;Динамическая надпись&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сохраняем, закрываем редактор Бейсика, закрываем документ, а затем снова его запускаем и любуемся динамически созданной надписью. Точно так же можно найти динамическую пару и для других статических атрибутов, и тоже генерировать их значения на лету.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Несмотря на то, что обучение программированию на VBA не входит в задачи наших уроков, вкратце опишу написанную нами функцию.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сначала идёт комментарий, который на VBA начинается с апострофа. Затем идёт сама функция, начинающаяся со слова Sub, и заканчивающаяся End Sub. Сразу после Sub идёт имя функции, которое мы задали в динамическом атрибуте. В скобках за именем указаны имена атрибутов, через которые функция принимает и возвращает параметры. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Первый параметр — control (ожидается тип IRibbonControl). Сюда передаётся объект нашей кнопки. Второй параметр — label. Перед ним указан способ передачи параметра — ByRef, что означает «по ссылке». То есть, в функцию передаётся не копия параметра, а ссылка непосредственно на сам объект. Объектом служит некая строка, возвращаемая функцией. То есть, именно в эту строку необходимо помещать текст, который должен возвращаться функцией.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обычно результат зависит от каких-либо условий, но в нашем случае, чтобы не усложнять пример, мы вернули текст без всяких условий.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом мы закончим текущий урок. Теперь вы сами можете поупражняться в динамическом возвращении других атрибутов. Замечу, что в дальнейшем не надо сохранять шаблоны функций в файл. Когда добавляется новая функция, то просто надо найти её шаблон и cкопировать её в редактор Бейсика. При этом важно помнить, что <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">редактор Бейсика не поддерживает Unicode</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, поэтому при копировании следите за тем, чтобы при взятии текста в буфер обмена была включена та раскладка клавиатуры, на которой вы пишите комментарии. Иначе система не сможет распознать кодовую страницу забираемого в буфер текста комментариев, и вставит кракозябры. То же относится и к именам функций, если они написаны не на латинице.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом урок закончим. В следующий раз продолжим изучение динамических атрибутов на примере атрибута onAction, задающего макрос, срабатывающий при нажатии на элемент, в котором этот атрибут прописан.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="2898797043381227723"></a><a href="http://fluentui.blogspot.com/2015/03/9.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 9. Выполнение действия по нажатию кнопки.</span><a name="_Toc20980528"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На прошлом уроке мы познакомились с написанием функций для динамического возвращения значений атрибутов. Теперь мы напишем функцию, которая будет выполняться при нажатии на кнопку. Если мы рассмотрим все предлагаемые для button атрибуты, то увидим атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">onAction</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Именно в этом атрибуте и указывается функция, которая будет выполняться при нажатии на эту кнопку.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавим кнопке атрибут: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">onAction=&quot;ОтобразитьПриветствие&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сгенерируем шаблоны функций (<span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">), проконтролируем текущую раскладку, чтобы была русская, и скопируем в буфер шаблон для функции «ОтобразитьПриветствие». Затем закроем окно, запустим документ на выполнение, нажмём в Word </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, и вставим скопированное рядом нашей предыдущей с функцией. Внутри функции пишем команду вывода сообщения:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">MsgBox &quot;Приветствую тебя, мой повелитель!&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сохраняем, всё закрываем, затем снова запускаем документ. Нажимаем на кнопку и получаем удовольствие.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вместо вывода сообщения можно вызвать любую имеющуюся в Word команду. Выше я упоминал, что штатной кнопке нельзя присвоить внешнее изображение. Но можно создать свою кнопку, присвоить ей внешнее изображение, а в <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">onAction </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">прописать команду, выполняющуюся при нажатии штатной кнопки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Давайте повесим на нашу кнопку команду открытия редактора Бейсика. Запускаем документ, переходим в редактор Бейсика, и правим наши функции. Сначала в функции «Поприветствовать» меняем название кнопки на, например, «Открыть редактор Бейсика» (можем изменить и имя самой функции, но тогда надо не забыть поменять его также и в атрибуте <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">onAction</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">). Затем в функции «ОтобразитьПриветствие» комментируем апострофам строку вывода приветствия, и пишем вместо неё строку:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ShowVisualBasicEditor = True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сохраняем, закрываем редактор Бейсика, нажимаем на кнопку и… снова оказываемся в редакторе! Всё, как и задумывалось!</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь, вопрос: откуда я узнал, что редактор Бейсика открывается именно так? Всё очень просто. Для того, чтобы узнать, как программно проделать те или иные действия, можно штатными средствами Word просто создать макрос, и записав в него нужную последовательность действий, открыть его код и скопировать в нашу функцию. При этом не всегда стоит копировать код бездумно. Как правило, полученные макросы можно уточнить, убрать из них лишнее и т.п.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что обучение записи макросов и программированию на VBA не входит в задачи наших уроков, но всё это очень легко осваивается самостоятельно. Особенно запись макросов. Для неё даже предусмотрена группа «Макросы» на вкладке «Вид» или группа «Код» с кнопкой «Запись макроса» на вкладке «Разработчик».</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На сегодня закончим. В следующем уроке мы перейдём к важной теме - созданию надстроек. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="2122775994292570675"></a><a href="http://fluentui.blogspot.com/2015/03/10.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 10. Создание простейшей надстройки.</span><a name="_Toc20980529"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Конструирование интерфейсов чаще всего используется при создании надстроек. Надстройка представляет собой невидимый документ со встроенным VBA-кодом и с собственными дополнениями к интерфейсу, автоматически открываемый приложением при запуске. При запуске он не показывает своё тело (т.е. содержимое документа </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">—</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> текст, рисунки и пр.), а проявляется только своими изменениями в интерфейсе и подключенными макросами. Таким образом, приложение Microsoft Office дополняет свой функционал, и позволяет редактировать другие документы, используя вновь полученные функции.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Документ надстройки для Word имеет расширение .dotm. Фактически, надстройка для Word является обычным шаблоном с поддержкой макросов. Для надстроек Excel и PowerPoint имеются отдельные расширения — .xlam и .ppam соответственно. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что надстройки .xlam и .ppam просто так не открываются в приложениях в качестве документа для редактирования, поэтому пока такая надстройка не готова, её сохраняют как обычный документ с поддержкой макросов. А вот шаблон .dotm можно открыть в Word именно как шаблон (по крайней мере, Ribbon XML Editor это делает), поэтому его можно сохранять шаблоном и в процессе разработки надстройки. Однако, я всё же рекомендую действовать единообразно, и исходники надстроек всегда держать в формате обычных документов с поддержкой макросов, и переводить их в шаблоны или надстройки только после полного окончания их разработки.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, давайте попробуем построить надстройку Word, которая будет выглядеть, как отдельная вкладка, и содержать группу с кнопками, выполняющими некоторые действия. Пусть это будут некие действия с пробелами. Замечу, что процесс создания надстройки Excel ничем не отличается от создания надстройки Word и, умея создавать одно, вы будете уметь создавать другое.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откроем Ribbon XML Editor, откроем в нём наш подопытный документ, и в окно для 2007-го интерфейса скопируем текст интерфейса нашей надстройки:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Полезные надстройки&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHome&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">keytip=&quot;Н&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;РаботаСПробелами&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Работа с пробелами&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        id=&quot;УдалитьПовторяющиесяПробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        onAction=&quot;УдалитьПовторяющиесяПробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        label=&quot;Удалить повторяющиеся пробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        keytip=&quot;У&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        imageMso=&quot;WordArtSpacingMenu&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        size=&quot;large&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        screentip=&quot;Удалить повторяющиеся пробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        supertip=&quot;Найти и заменить все повторяющиеся пробелы одним&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        id=&quot;ПробелыВПереносыСтрок&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        onAction=&quot;ПробелыВПереносыСтрок&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        label=&quot;Пробелы в переносы строк&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        keytip=&quot;ПС&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        imageMso=&quot;PivotExpandField&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        size=&quot;large&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        screentip=&quot;Пробелы в переносы строк&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        supertip=&quot;Найти и заменить все пробелы переносом строки&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        id=&quot;ПереносыСтрокВПробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        onAction=&quot;ПереносыСтрокВПробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        label=&quot;Переносы строк в пробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        keytip=&quot;СП&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        imageMso=&quot;PivotCollapseField&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        size=&quot;large&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        screentip=&quot;Переносы строк в пробелы&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        supertip=&quot;Найти и заменить все переносы строк пробелами&quot;/&gt;                        </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customUI&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ознакомьтесь с кодом интерфейса. Тут всё просто. Надстройка добавляет новую вкладку, и располагает на ней группу работы с пробелами, содержащую три кнопки. Для упрощения примера, в качестве иконок для кнопок я использовал максимально подходящие встроенные изображения. Вы можете использовать вместо них свои собственные, вы это уже умеете.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Первая кнопка удаляет все повторяющиеся пробелы. Довольно полезная функция, учитывая то, что правильная вёрстка в Word вообще не предполагает идущих подряд пробелов. Вторая кнопка преобразует все пробелы в переносы строк, а третья — обратное действие, т.е. переносы строк в пробелы. Тоже нужная функция для работы с последовательностями различных лексем.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сгенерируем функции обратного вызова (<span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">). Скопируем шаблоны в буфер обмена (обращаем внимание на раскладку клавиатуры во избежание появления кракозябр). Закроем окно шаблонов и запустим документ. Перейдём в редактор Бейсика (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">) и вставим взятые в буфер обмена шаблоны функций вместо наших старых функций модуля RibbonCallbacks.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь осталось написать на Бейсике нужные команды. Очевидно, нам понадобится функция поиска и замены. С помощью штатной функции записи макросов я выяснил, каким кодом осуществляется поиск и замена, и организовал это в виде отдельной функции, которую мы будем использовать внутри наших функций обратного вызова.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, вставляем в код новую функцию:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'НайтиИЗаменить (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(findString As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String, replaceString As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    With</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Selection.Find</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .ClearFormatting</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Replacement.ClearFormatting</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Text = findString</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Replacement.Text = replaceString</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Forward = True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Wrap = wdFindContinue</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Format = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchCase = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchWholeWord = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchWildcards = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchSoundsLike = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchAllWordForms = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Execute Replace:=wdReplaceAll</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">With</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функция принимает на вход строку для поиска и строку для замены, а внутри функции вставлен код из макроса, который записывался во время реального поиска и замены. Несомненно, в нём много лишнего, так как все эти параметры наверняка имеют значения по умолчанию. Тем не менее, для надёжности я оставил всё как есть — хуже уж точно не будет.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь заполняем шаблоны процедур обратного вызова:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'УдалитьПовторяющиесяПробелы (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">УдалитьПовторяющиесяПробелы(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">NumCharsBefore As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, NumCharsAfter As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Do</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        NumCharsBefore = ActiveDocument.Characters.Count</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Call</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(&quot;  &quot;, &quot; &quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        NumCharsAfter = ActiveDocument.Characters.Count</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Loop</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Until</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">NumCharsBefore = NumCharsAfter</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'ПробелыВПереносыСтрок (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ПробелыВПереносыСтрок(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Call</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(&quot; &quot;,&quot;^p&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'ПереносыСтрокВПробелы (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ПереносыСтрокВПробелы(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Call</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(&quot;^p&quot;, &quot; &quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Call</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(&quot;^w^p&quot;, &quot;&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как видите, код элементарен, ничего сложного. В первой функции мы организовываем цикл, в котором сдвоенные пробелы меняем на одинарные, и который будет выполняться до тех пор, пока при очередной его итерации размер текста до и после поиска и замены не останется равным. Это будет означать, что сдвоенных пробелов в тексте уже не осталось.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Две последние функции ещё более элементарны. Там просто вызывается наша функция по поиску и замене, которая меняет пробел на символ абзаца (^p) или наоборот. В последнем случае мы ещё и удаляем появившийся в конце текста из-за неубирающегося символа абзаца лишний пробел (^w — чистое пространство, например, пробелы или табуляция).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сохраняем код, закрываем редактор Бейсика и сразу проверяем работу кнопок в документе. Замечу, что закрывать редактор Бейсика не обязательно, можно просто сохранить в нём изменения и переключиться в окно документа. Если кнопки заработали, как надо, сохраняем документ как шаблон с макросами (.dotm) в папку:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">C:\Users\[ИмяПользователя]\AppData\Roaming\Microsoft\Word\STARTUP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь добавим нашу надстройку. Закрываем всё, открываем Word, лезем в Файл -&gt; Параметры -&gt; Надстройки -&gt; Управление, выбираем «Надстройки Word» и нажимаем кнопку «Перейти». В открывшемся окне на первой же вкладке нажимаем «Добавить…» и выбираем наш файл. Нажимаем «ОК», и наша надстройка начинает действовать.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="2455848646371840243"></a><a href="http://fluentui.blogspot.com/2015/03/11.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 11. Создание второй надстройки, дополняющей первую.</span><a name="_Toc20980530"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На этом уроке мы попробуем написать вторую надстройку, которая могла бы использоваться как независимо от первой, так и располагаться вместе с ней на той-же вкладке. Пусть это будет надстройка работы со строками. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Создадим в Word новый документ и сохраним его как документ с макросами (.doсm). Убедимся, что в новом документе работает надстройка, сделанная нами на прошлом уроке. Закроем документ, и откроем его через Ribbon XML Editor.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Кстати, документы можно открывать в Ribbon XML Editor как непосредственно из этого редактора, так и из контекстного меню самого документа, что очень удобно. Но для этого нужно вначале добавить в эти контекстные меню соответствующий пункт. Это легко делается со страницы настроек Ribbon XML Editor. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откройте вкладку настроек, и обратите внимание на раздел в правой части «Добавление «Открыть в Ribbon XML Editor» в контекстное меню проводника». Отметьте галочками те документы, для которых в контекстное меню проводника должен быть добавлен соответствующий пункт. В нашем случае достаточно одной галочки в столбце «Для файлов Word» напротив «Документ с макросами», но можно отметить и все галочки. Затем нажмите кнопку «Установить». </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обязательно прочтите всплывающую подсказку на кнопке, там есть много полезной информации. В частности, то, что документ будет открываться в той копии Ribbon XML Editor, из которой была осуществлена установка. Перед удалением программы, для того, чтобы убрать ненужные уже пункты контекстных меню, не забудьте снять все установленные галочки и снова нажать кнопку «Установить» для установки отменённого состояния пунктов контекстного меню.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Напишем интерфейс, аналогичный прежней надстройке:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;?xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">version=&quot;1.0&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">standalone=&quot;yes&quot;?&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Полезные надстройки&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHome&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">keytip=&quot;Н&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;РаботаСоСтроками&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Работа со строками&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        id=&quot;ДублироватьТекущуюСтроку&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        onAction=&quot;ДублироватьТекущуюСтроку&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        label=&quot;Дублировать&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        keytip=&quot;Д&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        imageMso=&quot;QuickStylesSets&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        size=&quot;large&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        screentip=&quot;Дублировать текущую строку&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        supertip=&quot;Сопировать текущую строку в строку ниже&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        id=&quot;УдалитьСдвоенныеПустыеСтроки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        onAction=&quot;УдалитьСдвоенныеПустыеСтроки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        label=&quot;Удалить повторные пустые строки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        keytip=&quot;С&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        imageMso=&quot;RecordsCollapseAllSubdatasheets&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        size=&quot;large&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        screentip=&quot;Удалить повторные пустые строки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        supertip=&quot;Найти и заменить все повторяющиеся пустые строки одной&quot;/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        id=&quot;УдалитьПустыеСтроки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        onAction=&quot;УдалитьПустыеСтроки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        label=&quot;Удалить пустые строки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        keytip=&quot;В&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        imageMso=&quot;GroupQuerySetup&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        size=&quot;large&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        screentip=&quot;Удалить все пустые строки&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        supertip=&quot;Найти и удалить все пустые строки&quot;/&gt;                            </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customUI&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Сгенерируем процедуры обратного вызова и сохраним их в файле. Запустим документ на выполнение. Ожидаем, что на уже существующую вкладку «Вкладка1» добавится новая группа. Попробуем запустить документ (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F9</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">). Запустили? Вот те на…</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Вместо того, чтобы группа добавилась на вкладку с указанным идентификатором, мы увидели, что создалась ещё одна вкладка с тем же именем, куда и была помещена новая группа! Что же произошло не так?</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">По всей видимости, приложения офиса всё же различают внутри себя одинаковые идентификаторы. Очевидно, им автоматически присваиваются разные пространства имён (о которых мы говорили на первых наших уроках). Какой же из этого выход? Принудительно присвоить нашим идентификаторам одинаковое пространство имён. Для этого нам придётся произвести небольшую модификацию кода в обеих надстройках и вспомнить, что такое </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Закроем Word, и удалим нашу прежнюю надстройку из папки:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    C:\Users\[ИмяПользователя]\AppData\Roaming\Microsoft\Word\STARTUP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В текущей надстройке, открытой в Ribbon XML Editor, добавим в тег customUI второй атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">xmlns</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> с указанием идентификатора нашего собственного пространства имён, например, МПИ (Моё Пространство Имён), и присвоим значение этому идентификатору, например, http://customui.blogspot.ru (интернет-адрес этого блога), как показано в строке ниже:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    xmlns:МПИ=&quot;http://customui.blogspot.ru&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Этим самым мы объявим новое пространство имён, в дополнение к пространству по умолчанию, которое выражалось строкой</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    xmlns=&quot;http://schemas.microsoft.com/office/2006/01/customui&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Теперь в теге tab заменим атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">на атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, чтобы иметь возможность включить в идентификатор вкладки префикс пространства имён, и перед идентификатором «Вкладка1» вставим этот префикс нашего нового пространства. Замечу, что как только мы добавляем новое пространство имён в тег интерфейса (customUI), оно сразу появляется в автодополнении, поэтому вставку префикса мы можем осуществить прямо из него. Итак, мы получили строку:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idq=&quot;МПИ:Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertbeforemso=&quot;TabHome&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">keytip=&quot;Н&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Полезные надстройки&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Запускаем документ на выполнение (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F9</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">) и видим нашу вкладку в интерфейсе. Она будет единственной, потому что старую нашу надстройку, которую мы ещё не модифицировали аналогичным образом, мы удалили. Переходим в редактор Бейсика (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">) и открываем в нём ранее сохранённые нами шаблоны процедур обратного вызова для этой надстройки. Затем заполняем их следующим образом:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'НайтиИЗаменить (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(findString As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String, replaceString As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    With</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Selection.Find</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .ClearFormatting</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Replacement.ClearFormatting</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Text = findString</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Replacement.Text = replaceString</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Forward = True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Wrap = wdFindContinue</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Format = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchCase = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchWholeWord = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchWildcards = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchSoundsLike = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MatchAllWordForms = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Execute Replace:=wdReplaceAll</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">With</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'ДублироватьТекущуюСтроку (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ДублироватьТекущуюСтроку(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    With</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Selection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .HomeKey Unit:=wdLine</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .MoveDown Unit:=wdLine, Count:=1, Extend:=wdExtend</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .Copy</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .HomeKey Unit:=wdLine</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .PasteAndFormat (wdFormatOriginalFormatting)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">With</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'УдалитьСдвоенныеПустыеСтроки (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">УдалитьСдвоенныеПустыеСтроки(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">NumCharsBefore As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, NumCharsAfter As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Do</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        NumCharsBefore = ActiveDocument.Characters.Count</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Call</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(&quot;^p^p^p&quot;, &quot;^p^p&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        NumCharsAfter = ActiveDocument.Characters.Count</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Loop</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Until</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">NumCharsBefore = NumCharsAfter</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'УдалитьПустыеСтроки (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">УдалитьПустыеСтроки(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">NumCharsBefore As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, NumCharsAfter As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Do</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        NumCharsBefore = ActiveDocument.Characters.Count</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Call</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">НайтиИЗаменить(&quot;^p^p&quot;, &quot;^p&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        NumCharsAfter = ActiveDocument.Characters.Count</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Loop</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Until</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">NumCharsBefore = NumCharsAfter</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В этих функциях мы реализовываем функционал кнопок. Мы можем увидеть здесь уже знакомую нам по первой надстройке функцию «НайтиИЗаменить», а также функции обратного вызова для кнопок. Функция дублирования строки создана методом записи макроса с последующей небольшой корректировкой, а две оставшиеся функции в цикле меняют одно количество символов абзаца (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">^p</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">) на другое, в зависимости от задачи.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Замечу, что предложенная реализация функций не является эталонной. Напротив, это первое и самое простое, что пришло в голову. Напомню, что задачей этих уроков является построение интерфейса, а не программирование на VBA.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Сохраним код, перейдём в окно документа и проверим работу кнопок. Если всё работает так, как надо, то сохраняем документ как шаблон с поддержкой макросов (.dotm) в папку:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    C:\Users\[ИмяПользователя]\AppData\Roaming\Microsoft\Word\STARTUP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Эта надстройка готова. В Word пока не включаем её, чтобы не мешалась. Теперь открываем в Ribbon XML Editor документ со старой надстройкой, и правим её аналогично новой. Добавляем то же самое пространство имён, у вкладки меняем атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">id </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">на </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">idQ </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">и добавляем наш префикс перед идентификатором. Запускаем документ (</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">F9</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">), проверяем функционал и сохраняем его как шаблон рядом со второй надстройкой в папке </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    C:\Users\[ИмяПользователя]\AppData\Roaming\Microsoft\Word\STARTUP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Закрываем сохранённый шаблон в Word и открытый документ в Ribbon XML Editor. Обе надстройки готовы к работе. Запускаем Word, лезем в настройки, и включаем обе надстройки, установив напротив них галочки. После сохранения изменений в настройках у нас появляется одна вкладка, содержащая две группы, сформированные разными надстройками! То, что нам и было нужно.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="7665896170368884669"></a><a href="http://fluentui.blogspot.com/2015/03/12.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 12. Динамическое меню.</span><a name="_Toc20980531"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Теперь мы уже почти профессионалы в программировании интерфейсов, и можем замахнуться аж на динамическое меню. Динамическое меню, как и динамические атрибуты, получает своё содержимое из функции обратного вызова. То есть, наша функция должна возвращать некий XML-код, который и будет формировать дочерние элементы меню.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Давайте сделаем ещё одну надстройку-демонстратор динамического меню. Создадим третий документ и откроем его в Ribbon XML Editor. Построим в нём следующий код:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;?xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">version=&quot;1.0&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">standalone=&quot;yes&quot;?&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns:МПИ=&quot;</span><a href="http://customui.blogspot.ru/"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://customui.blogspot.ru</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idQ=&quot;МПИ:Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Полезные надстройки&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHome&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">keytip=&quot;Н&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;ДинамическиеМеню&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Демонстрация меню&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;menu</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Меню1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Обычное меню&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">itemSize=&quot;large&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            id=&quot;Кнопка1&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            label=&quot;Пункт 1&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            description=&quot;Пункт обычного меню&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            onAction=&quot;Сообщение1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            id=&quot;Кнопка2&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            label=&quot;Пункт 2&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            description=&quot;Пункт обычного меню&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            onAction=&quot;Сообщение2&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        &lt;button</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            id=&quot;Кнопка3&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            label=&quot;Пункт 3&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            description=&quot;Пункт обычного меню&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                            onAction=&quot;Сообщение3&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;/menu&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;dynamicMenu</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        id=&quot;ДинамическоеМеню1&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        label=&quot;Динкамическое меню&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                        getContent=&quot;ВернутьДинамическоеМеню&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customUI&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом коде мы создаём на нашей вкладке третью группу, в которой размещаем обычное меню с тремя пунктами и динамическое меню, пункты которого мы будем получать с помощью функции «ВернутьДинамическоеМеню». Сгенерируем шаблоны функций обратного вызова и сохраним их в файле, как мы уже делали это ранее.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кстати, если вы хотите изменить имя, предлагаемое по умолчанию, под которым сохраняются шаблоны функций, зайдите в настройки Ribbon XML Editor, и обратите внимание на окно в правом верхнем углу. Этот блок текста каждый раз помещается в начало сохраняемого файла, и вы можете отредактировать его по вашему усмотрению. В первой строке написано:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Attribute VB_Name = &quot;RibbonCallbacks&quot;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы можем поменять эту строку на:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Attribute VB_Name = &quot;CustomUICallbacks&quot; </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">и при сохранении файла нам будет предлагаться уже новое имя.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, запустим документ на выполнение. Обычное меню уже работает, а для формирования пунктов динамического меню нам нужно открыть редактор Бейсика (<span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Alt+F11</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">) и загрузить в него модуль с сохранёнными нами ранее шаблонами функций обратного вызова. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заполним шаблоны функций следующим кодом:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Кнопка1 (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Сообщение1(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    MsgBox &quot;Был выбран пункт 1&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Кнопка2 (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Сообщение2(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    MsgBox &quot;Был выбран пункт 2&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Кнопка3 (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Сообщение3(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    MsgBox &quot;Был выбран пункт 3&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'ДинамическоеМеню1 (компонент: dynamicMenu, атрибут: getContent), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ВернутьДинамическоеМеню(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl, ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">content)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">sXML As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    sXML = &quot;&lt;menu itemSize=&quot;&quot;large&quot;&quot; xmlns=&quot;&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&quot;&gt;&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; vbCrLf</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    sXML = sXML &amp; &quot;&lt;button id=&quot;&quot;Кнопка1&quot;&quot; label=&quot;&quot;Пункт 1&quot;&quot; description=&quot;&quot;Пункт динамического меню&quot;&quot; onAction = &quot;&quot;Сообщение1&quot;&quot;/&gt;&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; vbCrLf</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    sXML = sXML &amp; &quot;&lt;button id=&quot;&quot;Кнопка2&quot;&quot; label=&quot;&quot;Пункт 2&quot;&quot; description=&quot;&quot;Пункт динамического меню&quot;&quot; onAction = &quot;&quot;Сообщение2&quot;&quot;/&gt;&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; vbCrLf</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    sXML = sXML &amp; &quot;&lt;button id=&quot;&quot;Кнопка3&quot;&quot; label=&quot;&quot;Пункт 3&quot;&quot; description=&quot;&quot;Пункт динамического меню&quot;&quot; onAction = &quot;&quot;Сообщение3&quot;&quot;/&gt;&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; vbCrLf</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    content = sXML &amp; &quot;&lt;/menu&gt;&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В первых трёх функциях мы просто выводим сообщение о нажатии того или иного пункта, а в последней — формируем пункты, которые должны будут вернуться из функции во время выполнения документа. Тут требуются небольшое пояснение.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Формируемые пункты возвращаются в динамическое меню не списком, а XML-структурой, объединенённой корневым элементом menu, имеющим тип CT_MenuRoot. Элемента этого типа нет в иерархии статических элементов. Но в справке Ribbon XML Editor среди приложений мы можем найти ссылку «Динамическое меню», нажав на которую, мы откроем страничку с описанием этого типа и дополнительными сведениями по нему.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Согласно справке, корневой элемент menu должен содержать атрибут xmlns с объявлением пространства имён, используемое нами в основном коде. Замечу, что несмотря на то, что ранее мы использовали этот атрибут только в корневом элементе customUI, теоретически его можно использовать в любом элементе интерфейса, хотя его и не будет среди предлагаемых вариантов в автодополнении ввиду редкости такого использования. В данном случае мы применяем его в элементе menu.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В функции «ВернутьДинамическоеМеню» мы присваиваем строковой переменной sXML сначала открывающий тег menu с атрибутом размера пунктов меню и объявлением пространства имён, затем добавляем туда коды перевода строки (vbCrLf), затем теги элементов пунктов меню с желаемыми атрибутами и, в завершение, присваиваем возвращаемой переменной содержимое полученной строки с добавлением закрывающего тега menu. Внутри строковых переменных знак кавычек делается сдвоенным, чтобы не было конфликта с синтаксисом Бейсика, использующего тот же знак для обозначения строк.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сохраняем код, закрываем редактор Бейсика, потом документ, а затем снова открываем его и нажмём на кнопку открытия динамического меню. В момент нажатия срабатывает код формирования меню, и оно отображается. Сравните его работу с работой рядом расположенного статического меню.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="5903245726684549046"></a><a href="http://fluentui.blogspot.com/2016/03/blog-post.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 13. Амперсанд (&amp;), его код &amp;amp; и подчёркивание быстрых клавиш</span><a name="_Toc20980532"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Иногда в подписях элементов интерфейса необходимо использовать знак &amp; (амперсанд), в английской языковой традиции заменяющий союз and («и»). Кроме того, иногда нужно использовать также и знаки &lt; или &gt;. Но в xml-разметке все эти символы использовать нельзя, поскольку они являются частью языка разметки. Чтобы всё же их использовать, а также использовать символ двойных кавычек внутри двойных кавычек (или символ одинарных кавычек внутри одинарных), применяются специальные коды:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot; — &amp;quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">' — &amp;apos;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt; — &amp;lt;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&gt; — &amp;gt;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&amp; — &amp;amp;<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Для быстрой вставки этих кодов в </span><a href="http://novikov.gq/products/ribbonxmleditor/ribbonxmleditor.html"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">Ribbon XML Editor</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> можно принудительно вызвать меню автодополнения (Ctrl + Пробел) внутри строкового значения параметра и выбрать нужный код из предложенного списка:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960fbpkehlwyk.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поскольку код &amp;amp; используется также и для управления подчёркиванием горячих клавиш в элементе <span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">labelControl</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">, то для его реального отображения его код надо сдваивать: &amp;amp;&amp;amp; В этом случае первый код даёт команду подчеркнуть следующий символ, который уже не рассматривается, как управляющий подчёркиванием, а просто отображается подчёркнутым. Но подчёркивать амперсанд в подписях нужно редко. Как же быть?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы снять ненужное подчёркивание амперсанда, используется следующий трюк. Поскольку подчёркивание в подписи может быть только одно, система оставляет подчёркнутым только последний из отмеченных кодом &amp;amp; символов. Поэтому нам достаточно отметить им либо другой символ, стоящий после подчёркнутого амперсанда, либо, если подчёркивание в labelControl не нужно вообще, поставить &amp;amp; в конце строки. В последнем случае символа после &amp;amp; уже никакого не будет, и подчёркивания в подписи не появится вообще. Кстати, подчеркнуть символ до амперсанда, видимо, нельзя.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что не все элементы отображают подчёркивание. Я нашёл только один элемент — labelControl, поддерживающий эту функцию. Поэтому использовать трюк с убиранием подчёркивания амперсанда в подписях других элементов смысла, наверное, не имеет.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="3198559735939806444"></a><a href="http://fluentui.blogspot.com/2016/07/14.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 14. Автоматическое открытие заданной вкладки ленты при запуске документа.</span><a name="_Toc20980533"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">По умолчанию при открытии документа в ленте всегда открывается первая вкладка (псевдовкладку «файл», открывающую закулисье, мы не считаем). Если мы расположили нашу вкладку не первой, но хотим автоматически её открывать при запуске документа, можно использовать следующий трюк.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">1.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В xml-коде присвоим нашей вкладке символы клавиатурного доступа (keytip). Для этого используем атрибут keytip для тега tab нашей вкладки. Можно задать последовательность от одного до трёх символов, например, так: </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">keytip=&quot;ЁПТ&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Теперь, если в документе нажать и отпустить Alt, у ярлыка нашей вкладки появится заданная нами последовательность «ЁПТ», набрав которую вы откроете эту вкладку.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">2.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В тег customUI нашего интерфейса добавим атрибут </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">onLoad=&quot;ВыборВкладки&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Этот атрибут задаёт процедуру, которая будет вызываться сразу после окончания загрузки интерфейса. В ней мы и будем переключать вкладку.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">3.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Генерируем шаблон процедуры обратного вызова &quot;ВыборВкладки&quot; (кнопка VBA), и вставляем его в код макросов нашего документа. Внутри этой процедуры программно сэмулируем набор символов клавиатурного доступа командой </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">SendKeys &quot;%ЁПТ{F6}&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Процедура должна выглядеть так:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#38761d;">' (компонент: customUI, атрибут: onLoad), 2007</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> ВыборВкладки(ribbon As IRibbonUI)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    SendKeys &quot;%ЁПТ{F6}&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Знак «%» означает клавишу Alt. Буквы ЁПТ </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">—</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> означают сами знаете что. Конструкция {F6} означает клавишу F6. Нажатие на эту клавишу снимает подсказки с элементов внутри открывшейся вкладки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Несколько слов по выбору первого символа последовательности клавиатурного доступа. Не весь алфавит доступен для этого. Во-первых, нельзя дублировать уже имеющиеся на ленте символы, даже если использовать их в другом регистре. В последнем случае будет срабатывать только первый по счёту символ. Во-вторых, некоторые символы используются для каких-то других целей, и задать их физически невозможно.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Список доступных первых символов для Word 2016:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Б, Г, Ё, Ж, З, Й, Н, С, У, Х, Ц, Ш, Щ, Ъ, Ы, Ь.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Также доступны те же символы в нижнем регистре плюс следующие: д, и, к, л, о, р, ф, ч, э, ю, я. Однако некоторые из дополнительно перечисленных символов дублируют уже использующиеся клавиши верхнего регистра, и их использовать не стоит.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Список доступных первых символов для Excel 2016: </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Б, Г, Ё, Ж, З, И, Й, К, Н, С, Т, У, Х, Ц, Ш, Щ, Ъ, Ь.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Также доступны те же символы в нижнем регистре плюс следующие: л, о, р, ф, ч, ы, э, ю, я. Однако некоторые из дополнительно перечисленных символов дублируют уже использующиеся клавиши верхнего регистра, и их использовать не стоит. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="3042048558839943634"></a><a href="http://fluentui.blogspot.com/2017/02/15-ribbon-xml-editor-access.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 15. Использование Ribbon XML Editor для создания ленты в Access (устарело, см. ур. 17).</span><a name="_Toc20980534"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#ff0000;">Внимание! Урок устарел! </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">Написанное ниже можно читать в ознакомительных целях. Актуально только для Ribbon XML Editor версии 6.0 и ниже. В версии 6.1 появилось автодополнение Access и справка по его идентификаторам, а начиная с версии 7.0 редактор Ribbon XML Editor поддерживает прямую работу с базами данных Access! </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Написание надстроек для Access не менее актуально, чем для Word, Excel и уж тем более Power Point. Однако файл Access в отличие от упомянутых приложений имеет совсем иную структуру. Это обычная база данных, и интерфейс там хранится не в виде файла в отдельной папке документа, а в специальной системной таблице USysRibbons базы данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используемый нами Ribbon XML Editor предназначен для работы с файлами папочной структуры (Word, Excel, Power Point), однако схема интерфейса Access аналогична схемам интерфейса упомянутых приложений, а значит мы можем построить интерфейс и для Access, просто разрабатывая его на базе файла Excel.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Единственное неудобство такого способа состоит в том, что в автодополнении и встроенной справке программы отсутствует информация по идентификаторам Access. Но если у вас под рукой есть соответствующая шпаргалка, полученная из других источников, то последняя проблема перестаёт быть актуальной. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что если вы хотите использовать в Access собственные внешние изображения, то внедрять их штатным инструментом RibbonXML Edeitor не получится, поскольку они не могут храниться внутри папочной структуры файла документа, как это происходит в Word, Excel и PowerPoint. Ведь формат документа Access просто не предусматривает такой структуры. Но изображения можно положить рядом с файлом базы данных, и загружать их с помощью функции, прописанной в параметре loadImage корневого элемента customUI. Кроме того, изображения можно поместить внутрь самой базы. Тому, как это всё сделать, будет посвящён один из следующих уроков.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, технология создания интерфейса Access выглядит приблизительно так:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">1.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем Excel и создаём в нём новый документ. Сохраняем документ и закрываем Excel. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">2.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем сохранённый документ Excel в Ribbon XML Editor и как обычно создаём структуру кастомной ленты для Access: вкладки, группы, кнопки — всё это будет работать и в Access.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">3.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Обработчики событий нажатия на кнопки (функции обратного вызова) создаём так же, как и в Excel. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">4.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем Access и создаём в базе данных системную таблицу USysRibbons, в которую копируем весь созданный в Ribbon XML Editor код. Замечу, что для отображения содержимого системной таблицы USysRibbons, в параметрах навигации по таблицам надо разрешить отображение системных объектов.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">5.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Код функций обратного вызова подключаем аналогично Excel. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Всё, интерфейс для Access внедрён. Таким образом, Ribbon XML Editor вполне можно использовать даже для Access. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Для справки. Создание системной таблицы USysRibbons в Access 2016  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">1.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Запускаем Access, создаём новую базу данных или открываем старую.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">2.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Проверка настройки № 1. Открываем вкладку «Файл», выбираем «Параметры», переходим в «Параметры клиента» и ищем раздел «Общий». Убеждаемся, что галочка на пункте «Показывать ошибки интерфейса пользователя надстроек» установлена.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">3.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Проверка настройки № 2. В левой панели навигации щёлкаем правой кнопкой и выбираем пункт «Параметры навигации...». Убеждаемся, что галочка на пункте «Показывать системные объекты» установлена.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">4.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На ленте открываем вкладку «Создание» и нажимаем кнопку «Конструктор таблиц».</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">5.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Создаём 3 поля: ID («Счётчик»), RibbonName («Короткий текст» или «Текст») и RibbonXML («Длинный текст» или «MEMO»). Щёлкаем по строке поля ID и нажимаем на ленте кнопку «Ключевое поле».</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">6.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Нажимаем «Сохранить» </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">(дискетка на панели быстрого доступа или Ctrl+S)</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. На запрос имени таблицы вводим USysRibbons. Таблица создана и сохранена.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">7.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем таблицу и вводим туда данные — имя нашей ленты и её XML-код. Так мы можем ввести в таблицу несколько лент, каждую в свою строку таблицы, и впоследствии выбирать тот или иной интерфейс в зависимости от показанной на экране формы или отчёта </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;">(настраивается в окне свойств конструктора формы, вкладка «Другие», параметр «Имя ленты»)</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">. Сохраняем данные, закрываем, а затем снова открываем файл базы данных. Теперь Access знает о существовании пользовательского варианта интерфейса. Осталось его подключить.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">8.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем вкладку «Файл», выбираем «Параметры», переходим в пункт «Текущая база данных» и ищем раздел «Параметры ленты и панелей инструментов». В комбобоксе «Имя ленты» выбираем имя, которое мы присвоили интерфейсу в поле RibbonName. </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">9.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Закрываем, а затем снова открываем файл базы данных. Если всё сделано правильно и в XML-коде нет ошибок, база данных должна открыться с пользовательской лентой. Если лента не появилась, попробуйте закрыть и открыть приложение Access целиком</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="8498766836592114285"></a><a href="http://fluentui.blogspot.com/2017/02/access.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 16. Использование внешних изображений на ленте Access (устарело, см. ур. 17).</span><a name="_Toc20980535"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#ff0000;">Внимание! Урок устарел!</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;"> Написанное ниже можно читать в ознакомительных целях с учётом того, что начиная с версии 7.0 редактор Ribbon XML Editor поддерживает прямую работу с базами данных Access, и уже не требуется создавать временный файл Excel для хранения интерфейса Access.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На прошлом уроке мы коснулись возможности построения собственных лент для Access. Была упомянута возможность использования на лентах собственных изображений. На этом уроке будут подробно рассмотрены два способа вывода изображений в элементы интерфейса — с помощью параметра loadImage корневого элемента customUI и с помощью параметра getImage целевого элемента интерфейса.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для того, чтобы внедрить собственные изображения в базу данных Access и использовать их в элементах ленточного интерфейса, нужно помимо уже известной нам с прошлого урока системной таблицы USysRibbons с XML-кодом ленты создать ещё одну системную таблицу для хранения изображений.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы иметь возможность свободно пользоваться не только изображениями формата gif, bmp и jpeg но и png, а также рядом других форматов (полный список: bmp, gif, jpg, jpeg, tif, png, wmf, emf, ico), нам нужно будет подключить к базе сторонний модуль basGDIPlus, код которого будет приведён в конце урока.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Всё, что мы будем делать далее, проверялось в Access 2016, но должно также работать и на всех предыдущих версиях Access, вплоть до 2007-й.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Общие подготовительные действия</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">XML-код для Access можно писать как в пустом редакторе, сохраняя его через экспорт в файл настроек интерфейса (Ctrl+E), так и на базе открытого документа, например, Excel. Во втором случае интерфейс можно не только сохранять как обычно, вместе с документом, но и частично отлаживать его в Excel, если в нём не используются специфичные для Access идентификаторы. Рассмотрим второй способ.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, для построения, частичной отладки и хранения нашего XML-кода создаём в Excel документ xlsm. Сохраняем и открываем его в Ribbon XML Editor. Создаём интерфейс с новой вкладкой, группой и несколькими своими кнопками, на которых будем размещать наши внешние изображения. Как построить свою вкладку с группой и кнопками вы уже знаете из предыдущих уроков.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Начиная с версии 6.1 система автодополнения редактора Ribbon XML Editor поддерживает идентификаторы Access, которые включаются вместо идентификаторов текущего приложения (в нашем случае вместо идентификаторов Excel) галочкой «Режим Access» в правом нижнем углу вкладки «Интерфейс». Эта возможность может нам очень пригодиться в дальнейшем. Также в этой версии программы в справку добавлены списки идентификаторов вкладок и групп Access с их русскими названиями, что также существенно облегчает нам ориентирование в интерфейсе Access.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После того, как начальный код ленты построен, создаём в Access новую базу данных. Создаём в ней системную таблицу USysRibbons, как было описано на предыдущем уроке (имя этой таблицы зарезервировано для ленточных интерфейсов). Работаем с первой записью таблицы. Копируем в поле RibbonXML наш код из Ribbon XML Editor.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поскольку поля таблиц Access не поддерживают табуляцию, перед копированием полезно будет отформатировать текст, нажав кнопку форматирования вместе с зажатой клавишей Shift. Код отформатируется, а все символы табуляции заменятся соответствующим количеством пробелов. При включённой галочке «Режим Access» можно вместе с кнопкой форматирования клавишу Shift и не удерживать, табуляция на пробелы в этом случае заменится по умолчанию.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вводим в поле RibbonName название ленты, сохраняем базу, закрываем и снова открываем её. Не забываем добавить имя нашей ленты в настройки Access для текущей базы. Снова сохраняем базу, закрываем и открываем Access целиком, загружаем базу. На ленте должна появиться наша вкладка с кнопками без изображений. Теперь у нас всё готово к вставке внешних изображений.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Способ 1 (loadImage)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">Создание таблицы с изображениями</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавляем в базу ещё одну системную таблицу, но уже с произвольным именем, но тоже начинающимися на USys (User-created System table, созданная пользователем системная таблица), например, «USys Изображения для ленты» с четырьмя полями: «ID» (тип «Счётчик»), «Иденификатор изображения» (тип «Короткий текст»), «Изображение» (тип «Вложение») и «Описание» (тип «Короткий текст»). Как видите, в именах таблиц и полей можно использовать русские буквы и пробелы. В случае использования пробелов не забываем затем в VBA-коде заключать такие имена в квадратные скобки. Не забываем также поле ID в таблице сделать ключевым, поставив туда курсор и нажав на кнопку «Ключевое поле».</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Таблицу «USys Изображения для ленты» построчно заполняем идентификатором изображения и соответствующим внешним изображением. Поскольку сами изображения в таблице видны не будут, для нашего же удобства заполняем поле «Описание».<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">XML-код интерфейса и генерация модуля процедур обратного вызова</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В Ribbon XML Editor в элемент &lt;customUI&gt; добавляем параметр loadImage со значением имени функции обратного вызова, которую мы напишем, и которая будет возвращать нам изображения по их идентификатору. В элементы, в которые мы будем вставлять внешние изображения, добавляем параметр image со значением идентификатора нужного изображения. Нажимаем на кнопку генерации функций обратного вызова и сохраняем полученный модуль с шаблоном нашей функции в файл. Подправленный XML-код интерфейса снова копируем из Ribbon XML Editor в USysRibbons вместо старого.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">Подключение модулей в редакторе Visual Basic</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">1.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем в Access редактор Visual Basic (Alt+F11)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">2.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В контекстном меню базы данных выбираем «Import File…» и импортируем наш модуль.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">3.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Вставляем в тело нашей функции обратного вызова следующий код:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">s As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">s = DLookup(&quot;Изображение&quot;, &quot;[USys Изображения для ленты]&quot;, &quot;[Идентификатор изображения]='&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; imageId &amp; &quot;'&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image = basGDIPlus.AttachmentToPicture(&quot;[USys Изображения для ленты]&quot;, &quot;Изображение&quot;, s)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">4.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Создаём или импортируем вспомогательный модуль «basGDIPlus.bas».</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">5.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В меню редактора Visual Basic открываем Tools -&gt; References, прокручиваем список вниз и отмечаем галочкой Microsoft Office XX.0 Object Library, где XX — номер версии Access. Также проверяем, чтобы стояла галочка на «OLE Automation».</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">6.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Сохраняем изменения и закрываем редактор Visual Basic.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Теперь надо перезагрузить Access с базой. Всё закрываем, снова открываем Access и загружаем нашу базу. На ленте появляется наша вкладка, содержащая кнопки с внешними изображениями.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Способ 2 (getImage)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">Создание таблицы с изображениями</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавляем в базу ещё одну системную таблицу, но уже с произвольным именем, но тоже начинающимися на USys (User-created System table, созданная пользователем системная таблица), например, «USys Изображения для ленты» с четырьмя полями: «ID» (тип «Счётчик»), «Иденификатор элемента» (тип «Короткий текст»), «Изображение» (тип «Вложение») и «Описание» (тип «Короткий текст»). Как видите, в именах таблиц и полей можно использовать русские буквы и пробелы. В случае использования пробелов не забываем затем в VBA-коде заключать такие имена в квадратные скобки. Не забываем также поле ID сделать ключевым, поставив в него курсор и нажав на кнопку «Ключевое поле».</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Таблицу «USys Изображения для ленты» построчно заполняем идентификатором элемента интерфейса, в который нужно вставить изображение, и соответствующим внешним изображением. Поскольку сами изображения в таблице видны не будут, для нашего же удобства заполняем поле «Описание».</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если одно изображение используется сразу в нескольких элементах интерфейса, то имеет смысл разделить нашу таблицу на две. В одной хранить изображения, а в другой идентификаторы и соответствующие им порядковые номера изображений первой таблицы. В этом случае код нашей процедуры обратного вызова будет на строчку больше, поскольку сначала надо будет найти номер изображения по идентификатору, и только потом изображение по найденному номеру.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">XML-код интерфейса и генерация модуля процедур обратного вызова</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В Ribbon XML Editor в элементы, в которые мы будем вставлять внешние изображения, добавляем параметр getImage со значением имени общей функции обратного вызова, которая будет возвращать нам изображения по идентификатору вызвавшего её элемента. Нажимаем на кнопку генерации функций обратного вызова и сохраняем полученный модуль с шаблоном нашей функции в файл. Подправленный XML-код интерфейса снова копируем из Ribbon XML Editor в USysRibbons вместо старого.<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">Подключение модулей в редакторе Visual Basic</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">1.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Открываем в Access редактор Visual Basic (Alt+F11)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">2.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В контекстном меню базы данных выбираем «Import File…» и импортируем наш модуль.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">3.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Вставляем в тело нашей функции обратного вызова следующий код:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">s As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">s = DLookup(&quot;Изображение&quot;, &quot;[USys Изображения для ленты]&quot;, &quot;[Идентификатор элемента]='&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; control.id &amp; &quot;'&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image = basGDIPlus.AttachmentToPicture(&quot;[USys Изображения для ленты]&quot;, &quot;Изображение&quot;, s)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">4.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Создаём или импортируем вспомогательный модуль «basGDIPlus.bas».</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">5.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В меню редактора Visual Basic открываем Tools -&gt; References, прокручиваем список вниз и отмечаем галочкой Microsoft Office XX.0 Object Library, где XX — номер версии Access. Также проверяем, чтобы стояла галочка на «OLE Automation».</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">6.</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">     </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Сохраняем изменения и закрываем редактор Visual Basic.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Теперь надо перезагрузить Access с базой. Всё закрываем, снова открываем Access и загружаем нашу базу. На ленте появляется наша вкладка, содержащая кнопки с внешними изображениями.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Код модуля «basGDIPlus.bas»: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Option</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Compare Database</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Option</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Explicit</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Модуль для вставки изображений в формате .png в элементы ленточного интерфейса Access</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'----------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">' Функция для иконок с поддержкой GDIPlus-API (GDIP) |</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'----------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'        *  Для версий Office 2007 и выше  *         |</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'----------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'   (c) mossSOFT / Sascha Trowitzsch rev. 04/2009    |</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'                  Germany, Berlin                   |</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'----------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'       отредактировал и перевёл Брыкалин А.С.       |</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'----------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Необходимы ссылки на библиотеки:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'«OLE Automation» (stdole)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'«Microsoft Office XX.0 Object Library», где XX - номер версии Access.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Const</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID_IPicture = &quot;{7BF80980-BF32-101A-8BBB-00AA00300CAB}&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'IPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Пользовательские типы данных: ----------------------------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Enum</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicFileType</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    pictypeBMP = 1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    pictypeGIF = 2</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    pictypePNG = 3</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    pictypeJPG = 4</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Enum</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type GUID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Data1 As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Data2 As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Integer</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Data3 As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Integer</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Data4(7) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Byte</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type TSize</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    x As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Double</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    y As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Double</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type RECT</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Bottom As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Left As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Right As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Top As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type PICTDESC</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    cbSizeOfStruct As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    PicType As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    hImage As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    xExt As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    yExt As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type GDIPStartupInput</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    GdiplusVersion As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    DebugEventCallback As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    SuppressBackgroundThread As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    SuppressExternalCodecs As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type EncoderParameter</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    UUID As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    NumberOfValues As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    type As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Value As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type EncoderParameters</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    count As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Parameter As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">EncoderParameter</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Type</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Объявления API: ----------------------------------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Преобразование формата windows bitmap к OLE-Picture :</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">OleCreatePictureIndirect Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;oleaut32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(lpPictDesc As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PICTDESC, riid As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">fPictureOwnsHandle As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, IPic As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Object) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение типа-GUID из строки :</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">CLSIDFromString Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;ole32&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lpsz As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any, pCLSID As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Функции для работы с памятью:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GlobalAlloc Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">uFlags As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">dwBytes As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GlobalSize Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hMem As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GlobalLock Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hMem As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GlobalUnlock Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hMem As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GlobalFree Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hMem As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">CopyMemory Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Alias</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;RtlMoveMemory&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Destination As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any, ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Source As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Length As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">MoveMemory Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Alias</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;RtlMoveMemory&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Destination As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Source As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Byte, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Length As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Модули API:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">FreeLibrary Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hLibModule As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">LoadLibrary Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Alias</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;LoadLibraryA&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lpLibFileName As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GetModuleHandle Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;kernel32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Alias</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;GetModuleHandleA&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lpModuleName As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Таймер API:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">SetTimer Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;user32&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hwnd As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">nIDEvent As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">uElapse As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lpTimerFunc As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">KillTimer Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;user32&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hwnd As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">nIDEvent As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Функции потока OLE-Stream:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">CreateStreamOnHGlobal Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;ole32&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hGlobal As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">fDeleteOnRelease As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ppstm As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GetHGlobalFromStream Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;ole32.dll&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pstm As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any, ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">phglobal As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Объявления GDIPlus Flat-API: ----------------------------------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Инициализация GDIP:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdiplusStartup Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(token As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, inputbuf As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GDIPStartupInput, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">outputbuf As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 0) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Разъединение GDIP:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdiplusShutdown Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">token As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Загрузка GDIP-изображения из файла:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateBitmapFromFile Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">FileName As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, bitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Создание области GDIP-графики из Windows-DeviceContext:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateFromHDC Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hdc As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, GpGraphics As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Удаление области GDIP-графики:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipDeleteGraphics Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Graphics As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Копирование GDIP-изображения в графическую область:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipDrawImageRect Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Graphics As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">x As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Single, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">y As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Single, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Width As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Single, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Height As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Single) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Очищение выделенной памяти под битовый массив из GDIP:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipDisposeImage Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение windows bitmap указателя из GDIP-изображения:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateHBITMAPFromBitmap Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, hbmReturn As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">background As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение Windows-Icon-Handle из GDIP-изображения:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateHICONFromBitmap Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, hbmReturn As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Масштабирование размера GDIP-изображения:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipGetImageThumbnail Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">thumbWidth As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">thumbHeight As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, thumbImage As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">callback As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 0, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">callbackData As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 0) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение GDIP-изображения из Windows-Bitmap-Handle:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateBitmapFromHBITMAP Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hbm As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hpal As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, bitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение GDIP-изображения из Windows-Icon-Handle:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateBitmapFromHICON Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hicon As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, bitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение ширины GDIP-изображения (в пикселях):</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipGetImageWidth Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, Width As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение высоты GDIP-изображения (в пикселях):</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipGetImageHeight Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, Height As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Сохранение GDIP-изображения в файл с требуемым форматом:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipSaveImageToFile Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">FileName As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, clsidEncoder As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID, encoderParams As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Сохранение GDIP-изображения в поток OLE-Stream с требуемым форматом:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipSaveImageToStream Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">stream As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IUnknown, clsidEncoder As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID, encoderParams As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение GDIP-изображения из OLE-Stream-Object:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipLoadImageFromStream Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">stream As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IUnknown, image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Создание GDIP-изображения из развёртки</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateBitmapFromScan0 Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Width As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Height As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">stride As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PixelFormat As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, scan0 As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Any, bitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получение DC GDIP-изображения</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipGetImageGraphicsContext Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, Graphics As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Копирование содержания битового массива GDIP-изображения в другую DC изображения используя позиционирование</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Declare</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipDrawImageRectRectI Lib</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;gdiplus&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Graphics As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">dstx As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">dsty As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">dstwidth As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">dstheight As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">srcx As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">srcy As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">srcwidth As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">srcheight As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">srcUnit As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">imageAttributes As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 0, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">callback As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 0, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">callbackData As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 0) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'-----------------------------------------------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Глобальные переменные модуля:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lGDIP As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bSharedLoad As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Boolean</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'-----------------------------------------------------------------------------------------</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Инициализация GDI+</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">InitGDIP() As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Boolean</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TGDP As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GDIPStartupInput</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hMod As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lGDIP = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IsNull(TempVars(&quot;GDIPlusHandle&quot;)) Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">   </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Если lGDIP вылетает вследствие критической ошибки, восстанавливаем из Tempvars collection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            TGDP.GdiplusVersion = 1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            hMod = GetModuleHandle(&quot;gdiplus.dll&quot;)   'gdiplus.dll ещё не загружен?</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hMod = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                hMod = LoadLibrary(&quot;gdiplus.dll&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                bSharedLoad = False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                bSharedLoad = True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            GdiplusStartup lGDIP, TGDP  'Получить персональный экземпляр gdiplus</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            TempVars(&quot;GDIPlusHandle&quot;) = lGDIP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            lGDIP = TempVars(&quot;GDIPlusHandle&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        AutoShutDown</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    InitGDIP = (lGDIP &gt; 0)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Запланированная выгрузка GDI+ обрабатываемая для предотвращения утечки памяти</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">AutoShutDown()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    'Установка 5 секундного интервала перед следующей выгрузкой</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    'Эта IMO наиболие подходящая для циклов - но можете настроить её как душе угодно</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lGDIP &lt;&gt; 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        TempVars(&quot;TimerHandle&quot;) = SetTimer(0&amp;, 0&amp;, 5000, AddressOf</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TimerProc)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Обратный вызов для AutoShutDown</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Private</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TimerProc(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hwnd As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">uMsg As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idEvent As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">dwTime As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    'Debug.Print &quot;GDI+ AutoShutDown&quot;, idEvent</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TempVars(&quot;TimerHandle&quot;) &lt;&gt; 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">KillTimer(0&amp;, CLng(TempVars(&quot;TimerHandle&quot;))) Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TempVars(&quot;TimerHandle&quot;) = 0</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    ShutDownGDIP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Очистка GDI+</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ShutDownGDIP()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lGDIP &lt;&gt; 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">KillTimer(0&amp;, CLng(TempVars(&quot;TimerHandle&quot;))) Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TempVars(&quot;TimerHandle&quot;) = 0</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdiplusShutdown lGDIP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        lGDIP = 0</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        TempVars(&quot;GDIPlusHandle&quot;) = Null</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Not</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bSharedLoad Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">FreeLibrary GetModuleHandle(&quot;gdiplus.dll&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Загрузка картинки с использованием GDIP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Этот метод эквивалентен LoadPicture() в библиотеке OLE-Automation (stdole2.tlb)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Поддерживаемые форматы: bmp, gif, jpg, jpeg, tif, png, wmf, emf, ico</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">LoadPictureGDIP(sFileName As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hBmp As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hPic As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Not</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">InitGDIP Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateBitmapFromFile(StrPtr(sFileName), hPic) = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipCreateHBITMAPFromBitmap hPic, hBmp, 0&amp;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hBmp &lt;&gt; 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">LoadPictureGDIP = BitmapToPicture(hBmp)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            GdipDisposeImage hPic</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Масштабирование изображения с GDIP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'bSharpen: TRUE=Thumb даёт дополнительную резкость</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ResampleGDIP(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Width As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Height As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                      Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bSharpen As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Boolean</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= True) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lRes As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lBitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Not</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">InitGDIP Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image.type = 1 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        lRes = GdipCreateBitmapFromHBITMAP(image.Handle, 0, lBitmap)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        lRes = GdipCreateBitmapFromHICON(image.Handle, lBitmap)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lRes = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lThumb As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hBitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        lRes = GdipGetImageThumbnail(lBitmap, Width, Height, lThumb, 0, 0)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lRes = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image.type = 3 Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Image-Type 3 это Icon!</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                'Преобразование с этим методом GDI +:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                lRes = GdipCreateHICONFromBitmap(lThumb, hBitmap)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ResampleGDIP = BitmapToPicture(hBitmap, True)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                lRes = GdipCreateHBITMAPFromBitmap(lThumb, hBitmap, 0)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ResampleGDIP = BitmapToPicture(hBitmap)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            GdipDisposeImage lThumb</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipDisposeImage lBitmap</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Получить ширину и высоту изображения в пикселях с GDIP</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Вернуть значение как определённый пользователем тип TSize (X/Y как Long)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GetDimensionsGDIP(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TSize</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lRes As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lBitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">x As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, y As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Not</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">InitGDIP Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image Is</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Nothing</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    lRes = GdipCreateBitmapFromHBITMAP(image.Handle, 0, lBitmap)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lRes = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipGetImageHeight lBitmap, y</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipGetImageWidth lBitmap, x</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GetDimensionsGDIP.x = CDbl(x)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GetDimensionsGDIP.y = CDbl(y)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipDisposeImage lBitmap</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Вспомогательная функция для получения OLE-Picture из Windows-Bitmap-Handle</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Если bIsIcon = TRUE, то Icon-Handle фиксируется</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">BitmapToPicture(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hBmp As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bIsIcon As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Boolean</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= False) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TPicConv As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PICTDESC, UID As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    With</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TPicConv</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bIsIcon Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            .cbSizeOfStruct = 16</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            .PicType = 3    'PicType Icon</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            .cbSizeOfStruct = Len(TPicConv)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            .PicType = 1    'PicType Bitmap</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        .hImage = hBmp</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">With</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    CLSIDFromString StrPtr(GUID_IPicture), UID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    OleCreatePictureIndirect TPicConv, UID, True, BitmapToPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Сохраняет bitmap в файл (с преобразованием формата!)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'image = объект StdPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'sFile = полный путь к файлу</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'PicType = pictypeBMP, pictypeGIF, pictypePNG или pictypeJPG</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Quality: 0...100; (Качество сжатия, работает только для pictypeJPG!)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Возвращает TRUE если завершилось успешно</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">SavePicGDIPlus(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture, sFile As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String, PicType As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicFileType, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Quality As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 80) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Boolean</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lBitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TEncoder As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ret As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">EncoderParameters</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">sType As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Not</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">InitGDIP Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateBitmapFromHBITMAP(image.Handle, 0, lBitmap) = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Select</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicType</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypeBMP: sType = &quot;{557CF400-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypeGIF: sType = &quot;{557CF402-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypePNG: sType = &quot;{557CF406-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypeJPG: sType = &quot;{557CF401-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Select</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        CLSIDFromString StrPtr(sType), TEncoder</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicType = pictypeJPG Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            TParams.count = 1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            With</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams.Parameter    ' Качество</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                CLSIDFromString StrPtr(&quot;{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}&quot;), .UUID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                .NumberOfValues = 1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                .type = 4</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                .Value = VarPtr(CLng(Quality))</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">With</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            'Различает количество параметров для GDI+ 1.0 и GDI+ 1.1 в GIF-ах!!</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(PicType = pictypeGIF) Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams.count = 1 Else</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams.count = 0</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        'Сохраняем GDIP-Image в файл:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        ret = GdipSaveImageToFile(lBitmap, StrPtr(sFile), TEncoder, TParams)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipDisposeImage lBitmap</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        DoEvents</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        'Функция возвращает True, если появляется сгенерированный файл:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        SavePicGDIPlus = (Dir(sFile) &lt;&gt; &quot;&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Эта процедура аналогична процедуре SavePicGDIPlus (по параметрам), но отличается тем,</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'что ничего не хранится в виде файла, а преобразование выполняется</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'с помощью OLE-Stream-объект в байт-массив.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ArrayFromPicture(ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Object, PicType As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicFileType, Optional</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Quality As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">= 80) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Byte()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lBitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TEncoder As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GUID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ret As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">EncoderParameters</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">sType As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IStm As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IUnknown</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Not</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">InitGDIP Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GdipCreateBitmapFromHBITMAP(image.Handle, 0, lBitmap) = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Select</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicType    'Выбор GDIP-Format-Encoders CLSID:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypeBMP: sType = &quot;{557CF400-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypeGIF: sType = &quot;{557CF402-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypePNG: sType = &quot;{557CF406-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Case</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">pictypeJPG: sType = &quot;{557CF401-1A04-11D3-9A73-0000F81EF32E}&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Select</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        CLSIDFromString StrPtr(sType), TEncoder</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicType = pictypeJPG Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Если JPG, установить дополнительный параметр</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                                        'для задания уровня качества</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            TParams.count = 1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            With</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams.Parameter    ' Качество</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                CLSIDFromString StrPtr(&quot;{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}&quot;), .UUID</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                .NumberOfValues = 1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                .type = 4</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                .Value = VarPtr(CLng(Quality))</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">With</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            'Различает количество параметров для GDI+ 1.0 и GDI+ 1.1 в GIF-ах!!</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">(PicType = pictypeGIF) Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams.count = 1 Else</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">TParams.count = 0</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        ret = CreateStreamOnHGlobal(0&amp;, 1, IStm)    'Создаём поток</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        'Сохраняем GDIP-Image в поток:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        ret = GdipSaveImageToStream(lBitmap, IStm, TEncoder, TParams)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ret = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hMem As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, LSize As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long, lpMem As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">abData() As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Byte</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            ret = GetHGlobalFromStream(IStm, hMem)    'Получить Memory-Handle из потока</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ret = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                LSize = GlobalSize(hMem)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                lpMem = GlobalLock(hMem)   'Получить доступ к памяти</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                ReDim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">abData(LSize - 1)    'Размер массива</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                'Фиксация стека памяти из потока:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                CopyMemory abData(0), ByVal</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lpMem, LSize</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                GlobalUnlock hMem           'Закрыть память</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                ArrayFromPicture = abData   'Результат</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IStm = Nothing</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Очистка</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipDisposeImage lBitmap    'Очистка GDIP-Image-Memory</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Создание объекта картинки из вложения Access</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'strTable:              Таблица, содержащая вложенный файл картинки</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'strAttachmentField:    Название столбца с вложением</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'strImage:              Название изображения для поиска в записи с вложением</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'? AttachmentToPicture(&quot;ribbonimages&quot;,&quot;imageblob&quot;,&quot;cloudy.png&quot;).Width</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">AttachmentToPicture(strTable As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String, strAttachmentField As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String, strImage As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">strSQL As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bin() As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Byte</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">nOffset As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">nSize As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    </span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    strSQL = &quot;SELECT &quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; strTable &amp; &quot;.&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; strAttachmentField &amp; &quot;.FileData AS data &quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">             &quot;FROM &quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; strTable &amp; _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">             &quot; WHERE &quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; strTable &amp; &quot;.&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; strAttachmentField &amp; &quot;.FileName='&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; strImage &amp; &quot;'&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    On</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Error</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Resume</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Next</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    bin = DBEngine(0)(0).OpenRecordset(strSQL, dbOpenSnapshot)(0)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Err.Number = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bin2() As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Byte</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        nOffset = bin(0)    'Первый байт Field2.FileData определяет смещение блока данных в файле</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        nSize = UBound(bin)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        ReDim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bin2(nSize - nOffset)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        CopyMemory bin2(0), bin(nOffset), nSize - nOffset   'Скопировать файл в новый байтовый массив начиная со смещения</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">AttachmentToPicture = ArrayToPicture(bin2)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Erase</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bin2</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        Erase</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">bin</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'Создать OLE-картинку из байтового массива PicBin()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Public</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ArrayToPicture(ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">PicBin() As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Byte) As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">StdPicture</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IStm As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IUnknown</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">lBitmap As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hBmp As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ret As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Long</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Not</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">InitGDIP Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    ret = CreateStreamOnHGlobal(VarPtr(PicBin(0)), 0, IStm)  'Создать поток из стека памяти</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ret = 0 Then</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'OK, начать GDIP:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        'Конвертировать поток в GDIP-изображение:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        ret = GdipLoadImageFromStream(IStm, lBitmap)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ret = 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            'Получить Windows-Bitmap из GDIP-изображения:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            GdipCreateHBITMAPFromBitmap lBitmap, hBmp, 0&amp;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            If</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">hBmp &lt;&gt; 0 Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                'Конвертировать bitmap в объект картинки:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ArrayToPicture = BitmapToPicture(hBmp)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        'Чистка памяти ...</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        GdipDisposeImage lBitmap</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="622880929294286529"></a><a href="http://fluentui.blogspot.com/2018/07/17-access-rxe-75.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">У</span></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">рок 17. Использование внешних изображений на ленте Access в версии RXE 7.5</span><a name="_Toc20980536"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Как уже говорилось на прошлых уроках, использовать внешние изображения на контролах (элементах управления) ленты Access чуточку сложнее, чем на лентах Excel, Word и PowerPoint. Для осуществления этого действия требуется работа не только в Ribbon XML Editor, но и в редакторе VBA приложения, а также в таблицах самой базы данных Access. Тем не менее, последние версии Ribbon XML Editor максимально упростили этот процесс.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Напомню, что вывод изображений в интерфейс Access можно осуществить двумя основными способами: либо с помощью события, заданного в параметре loadImage корневого тега customUI, либо с помощью события, заданного в параметре getImage в контролах. В первом случае изображения контролы грузятся один раз при первом их показе пользователю, а во втором их можно перезагружать, сбрасывая кеши изображений в VBA-коде методами InvalidateControl и Invalidate. Тогда при очередном показе загрузка изображений произойдёт снова, что полезно, если в процессе работы необходимо менять картинки на контролах интерфейса.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Давайте рассмотрим создание кнопки с собственным изображением на новой вкладке ленты Access по первому способу, используя новый функционал последней версии <a href="http://novikov.gq/products/ribbonxmleditor/ribbonxmleditor.html"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">Ribbon XML Editor 7.5</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предполагается, что нужный файл изображения 32х32 или 16х16 формата .png, который мы будем выводить на ленту, у нас уже есть. В противном случае, его можно скачать прямо отсюда:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image15701599600iggyhwevk.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также предполагается, что файл базы данных Access, в который мы будем внедрять новый интерфейс, уже создан.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Шаг 1. Ввод XML-кода интерфейса</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, запускаем Ribbon XML Editor 7.5 и открываем файл базы данных Access. Замечу, что в редакторе можно открыть базы форматов .accdb, .accde, и .accdr, однако в последних двух случаях функционал будет несколько ограничен (нельзя будет автоматически интегрировать в базу модули с кодом). Поэтому всю работу ведём с .accdb.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После открытия базы в редакторе вставляем в окно xml-кода на вкладку интерфейса 2007 версии отчасти знакомый нам по прежним урокам код:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;?xml</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">version=&quot;1.0&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">encoding=&quot;UTF-8&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">standalone=&quot;yes&quot;?&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customUI</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">loadImage=&quot;ЗагрузкаИзображений&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Вкладка1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя вкладка&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHomeAccess&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Группа1&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя группа&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;Приветствие&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Поприветствовать&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image=&quot;Рука&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customUI&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Тут мы формируем новую вкладку, на ней располагаем группу, внутри которой размещаем кнопку. Для размещения изображения на кнопке в параметре image прописываем идентификатор «Рука».</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если целевая версия нашего будущего интерфейса будет выше, и мы не стремимся к совместимости с 2007 версией офиса, то вставляем код на вкладку интерфейса 2010, 2013, 2016 и корректируем соответствующим образом параметр xmlns тега customUI (используем для этого функцию автодополнения Ctrl + Пробел). Внедрить код для обеих версий офиса, как это было в случае с Excel, Word и PowerPoint, в Access не получится.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Не забываем также задать имя нашего интерфейса, вписав его в поле, расположенное в правом нижнем углу редактора (на картинке отмечено красным прямоугольником): </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image157015996061q0j8l2bv.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оно нам пригодится при выборе нашего интерфейса в настройках базы Access.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для тех, кто ранее создавал интерфейсы для других приложений офиса, замечу, что в присвоении имени интерфейсу мы видим основное отличие Access. В базу Access можно сохранить не два (для разных версий), а несколько интерфейсов одной версии под разными именами. Ribbon XML Editor позволяет раскрыть поле с именем интерфейса, и переключаться между несколькими интерфейсами, добавлять новые, удалять ненужные, переименовывать и т.п.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, сохраняем изменения. Сейчас у нас создана кнопка, но изображения на ней не будет, поскольку у нас нет ни макроса «ЗагрузкаИзображений», осуществляющего возврат картинок в контролы в зависимости от указанных в контролах в параметре image идентификаторов, ни самой картинки. Поэтому переходим к следующим шагам.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Шаг 2. Создание таблицы для хранения изображений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь нам надо создать в базе Access специальную системную таблицу для хранения изображений. Нажимаем кнопку импорта в блоке работы с внешними изображениями:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960zm2lamidhe.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откроется окно работы с таблицей внешних изображений:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://1.bp.blogspot.com/-Yv4UAhFC-Vc/WzpBBqBBwqI/AAAAAAAAAN8/Xm1spdCU78MbzZnFiUYNSj03ZGRAJ5EMwCEwYBhgL/s1600/%25D0%259F%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA.png"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;"> </span></a><img src="image1570159960itz97hv4e5.png" /><a href="https://1.bp.blogspot.com/-Yv4UAhFC-Vc/WzpBBqBBwqI/AAAAAAAAAN8/Xm1spdCU78MbzZnFiUYNSj03ZGRAJ5EMwCEwYBhgL/s1600/%25D0%259F%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA.png"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;"> </span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Раскроем верхний комбобокс и, просмотрев имена таблиц, находящихся в открытой базе данных, убедимся, что таблицы с изображениями в базе ещё нет. Кнопкой с крестиком очистим поле верхнего комбобокса, если мы случайно в него что-нибудь занесли, и нажимаем кнопку «Создать таблицу». Будет создана таблица с именем по умолчанию USYSRibbons_Images, которое будет занесено в поле комбобокса, а в поле второго комбобокса автоматически подставится название столбца этой таблицы, предназначенного для идентификаторов.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что можно создать таблицу и с любым другим именем. Для этого перед нажатием кнопки создания следует вписать в поле верхнего комбобокса любое подходящее для этой таблицы имя. Поскольку мы создаём системную таблицу, то её имя должно начинаться с «USYS», но для большей информативности лучше начинать его с «USYSRibbons_». В имени таблицы также можно использовать пробелы и кириллицу.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заполнение таблицы изображениями в Access мы оставим на потом, а пока переходим к следующему шагу. Окно работы с таблицей внешних изображений пока не закрываем, на следующем шаге оно нам понадобится.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Шаг 3. Добавление вспомогательного модуля в базу.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">По факту интерфейс Access понимает только jpg-изображения. Чтобы заставить его работать с png, требуется подключить специальный VBA-модуль, код которого можно увидеть, нажав в окне работы с таблицей внешних изображений на кнопку «Модуль basGDIPlus». Откроется окно с кодом модуля, текст которого можно скопировать в буфер, сохранить в файл или сразу внедрить в базу. Нажмём на кнопку внедрения модуля в базу, и через пару секунд появится сообщение об успешном внедрении модуля.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; font-style:italic; color:#444444;">Внимание!</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-style:italic; color:#444444;"> Если при внедрении возникли какие-то ошибки, возможно, у вас не совсем корректно установлен Microsoft Office или присутствуют другие проблемы в вашей системе. О способах их устранения можно прочитать во встроенной в Ribbon XML Editor справке, в разделе «Ошибки OLE при внедрении VBA-модуля в документ». Если же ошибку исправить не удалось, то можно сохранить модуль в файл, а затем импортировать его в базу уже из самого Access.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Справа от кнопки модуля basGDIPlus расположена кнопка со знаком вопроса. Нажав на неё, мы можем увидеть примеры использования модуля basGDIPlus с подробными комментариями. В них показана реализация двух способов вывода изображения в интерфейс. Как уже упоминалось ранее, мы будем использовать первый способ получения изображений, используя параметр loadImage корневого элемента интерфейса. Кстати, второй способ не сильно отличается от первого, и вы сами потом сможете изучить его.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Закрываем окна с кодом модулей. Перед закрытием окна поиска идентификаторов ещё раз убеждаемся, что оба комбобокса заполнены правильно. Нижнее поле пока остаётся пустым, поскольку созданная нами таблица ещё не заполнена. Нажимаем кнопку «ОК». Программа запоминает имя столбца с идентификаторами, и впоследствии будет доставать их оттуда в комбобокс внешних изображений основного окна для последующей их вставки нами в XML-код, как это происходит в случае с Excel, Word или PowerPoint.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Шаг 4. Генерация функции обратного вызова.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь в нашей базе есть xml-код интерфейса, таблица для png-изображений и модуль для доставания png-картинки из вложения таблицы изображений и трансформирования этой картинки в распознаваемый интерфейсом объект StdPicture. Осталось написать процедуру обратного вызова «ЗагрузкаИзображений», в которой использовать подключённый модуль для возвращения объекта картинки в интерфейс.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сгенерируем шаблон функции обратного вызова соответствующей кнопкой или сочетанием клавиш (Alt + F11). У нас получится вот такой шаблонный код функции «ЗагрузкаИзображений»:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Attribute VB_Name = &quot;RibbonCallbacks&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Option</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Explicit    'Потребовать явного объявления всех переменных в файле</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">' (компонент: customUI, атрибут: loadImage), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ЗагрузкаИзображений(imageId As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">string, ByRef</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Dim</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">ImageFilename As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    ImageFilename = DLookup(&quot;Image&quot;, &quot;USYSRibbons_Images&quot;, &quot;Image_or_control_identifier='&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&amp; imageId &amp; &quot;'&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Set</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">image = basGDIPlus.AttachmentToPicture(&quot;USYSRibbons_Images&quot;, &quot;Image&quot;, ImageFilename)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">В этом коде уже прописано всё, что нужно. Ничего не меняя внедрим этот модуль с функцией в базу Access так же, как мы это уже проделывали с модулем basGDIPlus.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь можем запустить базу на выполнение соответствующей кнопкой или клавишей F9. Ribbon XML Editor закроет базу данных и откроет её в Access. Все остальные шаги будем проделывать уже в Access.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Шаг 5. Заполнение таблицы изображений в Access.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При открытии базы появится предупреждение системы безопасности об отключении запуска активного содержимого. Нажимаем кнопку «Включить содержимое».</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Находим и открываем созданную нами таблицу изображений. Она имеет 4 столбца, но нам важны лишь 2 из них — Image_or_control_identifier и Image (в режиме таблицы вместо названия столбца показана скрепка). Столбец ID будет заполняться сам по мере добавления строк, а столбец Comment можно заполнить по желанию.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заполняем таблицу — в поле Image_or_control_identifier заносим идентификатор изображения, в нашем случае это будет «Рука», а в поле Image в виде вложения добавляем подготовленный заранее файл картинки ладошки. Сохраняем изменения.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что в поле вложения можно добавить несколько файлов, но нам следует добавлять по одному файлу на строку таблицы, чтобы правильно соблюсти соответствие картинки и её идентификатора.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; font-weight:600; color:#444444;">Шаг 6. Подключение интерфейса в настройках базы Access.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">У нас всё готово. Осталось лишь подключить интерфейс в настройках базы Access. Открываем настройку «Файл → Параметры → Текущая база данных → Параметры ленты и панелей инструментов → Имя ленты» и выбираем имя нашего интерфейса. Нажимаем кнопку ОК, закрываем и снова открываем базу. Появляется наша вкладка, при переходе на которую мы видим кнопку с нашим изображением.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом урок закончен, спасибо за внимание :-) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="4883759000798059622"></a><span style=" font-family:'Arial,sans-serif'; font-size:10.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://fluentui.blogspot.com/2018/07/18.html"><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; text-decoration: underline; color:#0000ff;">Урок 18. Размещение на своей вкладке уже имеющейся в приложении кнопки</span></a><a name="_Toc20980537"></a><span style=" font-family:'Arial,sans-serif'; font-size:16.5pt; font-weight:600; color:#444444;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">На этом уроке я хочу продемонстрировать простейший пример размещения на своей вкладке кнопки, уже имеющуюся в приложении, а также собственной кнопки, выполняющей ту же команду, но вызываемую через VBA из функции обратного вызова.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этот раз рассмотрим задачу на примере Excel. Насколько я могу судить, под это приложение чаще разрабатывают интерфейсы, чем под другие приложения офиса. Замечу, что в других приложениях всё делается абсолютно аналогично.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Открываем в Ribbon XML Editor документ Excel и вставляем в окно кода интерфейса 2007 версии следующий код:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;customui</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">xmlns=&quot;</span><a href="http://schemas.microsoft.com/office/2006/01/customui"><span style=" font-family:'Courier New'; font-size:10pt; text-decoration: underline; color:#0000ff;">http://schemas.microsoft.com/office/2006/01/customui</span></a><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;ribbon</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">startFromScratch=&quot;false&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;tab</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;МояВкладка&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Моя вкладка&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">insertBeforeMso=&quot;TabHome&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;group</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;УдалениеСтрок&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Удаление строк&quot;&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;control</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">idMso=&quot;SheetRowsDelete&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                    &lt;button</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">id=&quot;SheetRowsDelete&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">imageMso=&quot;SheetRowsDelete&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">label=&quot;Удалить строки через VBA&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">onAction=&quot;SheetRowsDelete&quot;</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">/&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">                &lt;/group&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">            &lt;/tab&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        &lt;/tabs&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    &lt;/ribbon&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">&lt;/customui&gt;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если мы внимательно его почитаем, то увидим, что этим кодом мы вставляем на собственную вкладку «Моя вкладка» (размещаемую перед вкладкой «Главная») группу «Удаление строк», в которую помещаем два элемента. Первый элемент является клоном штатной кнопки «Удалить строки с листа», а второй — нашей собственной кнопкой, которая выполняет ту же команду, но через вызов функции обратного вызова, имя которой прописано в параметре onAction.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В данном случае при создании первой кнопки мы ограничились простым клонированием, но при желании мы можем задать ей и свой текст, и своё изображение, и свою подсказку, используя соответствующие параметры. Заметьте, что вместо тега конкретного типа элемента (например, button) мы пишем тег «control». Это даёт нам возможность не ломать голову над типом клонируемого элемента, поскольку он может оказаться не только button.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Идентификаторы имеющихся в приложении элементов прописываются не в параметре id, а в параметре idMso. Подробнее про это различие было написано в <a href="http://fluentui.blogspot.com/2015/02/3-id-idmso-idq.html"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;">уроке 3</span></a><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Узнать идентификатор элемента можно просто посмотрев его во всплывающей подсказке в окне штатных настроек ленты в самом приложении: «Файл → Параметры → Настроить ленту». У всех элементов он написан в конце подсказки в скобках. Идентификаторы же групп и вкладок можно посмотреть в справке Ribbon XML Editor (четыре последних пункта оглавления).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для того, чтобы заработала вторая кнопка, нам надо сгенерировать шаблон функции обратного вызова (Alt + F11) и полученный модуль внедрить в документ, после чего открыть его в Excel, нажать уже там Alt + F11 чтобы открыть редактор VBA и, открыв в нём внедрённый модуль, поместить в тело шаблона функции «SheetRowsDelete» строчку «CommandBars.ExecuteMso (&quot;SheetRowsDelete&quot;)», которая запустит команду удаления строки на выполнение. В итоге функция должна выглядеть так:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'SheetRowsDelete (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">SheetRowsDelete(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    CommandBars.ExecuteMso (&quot;SheetRowsDelete&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечу, что название функции не обязательно должно совпадать с названием команды. Но ничто не мешает нам это сделать.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сохраняем изменения, закрываем редактор VBA и проверяем работу кнопок. Если вы всё сделали правильно, то обе кнопки будут удалять строки. Кстати, в выполнении команд через VBA имеется небольшое отличие — они выполняются без визуальных эффектов.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ещё небольшое замечание. Напоминаю, что не все команды доступны в том или ином случае. Так, вышеиспользованная команда SheetRowsDelete удаляет строки в любом случае, но есть схожая команда TableRowsDeleteExcel, которая делает то же самое, но только внутри «умной таблицы». Вне её она даже не показывается на ленте, а её клон просто не выполняет никаких действий. Если же выполнить эту команду из VBA, возникнет ошибка Run-tome error: Method 'ExecuteMso' of object '_CommandBars' failed:<span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1570159960bhhnj7qgro.png" /><a href="https://1.bp.blogspot.com/-4H0QHj6RayU/Wz9Xb5XOMUI/AAAAAAAAAOI/EKNx1GWjgjoY45aQYDx6gRh8oYuepc3MQCLcBGAs/s1600/VBAErr.png"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; text-decoration: underline; color:#0000ff;"> </span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">Поэтому такие команды следует заключать в «On Error», например:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">'SheetRowsDelete (компонент: button, атрибут: onAction), 2007</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">SheetRowsDelete(control As</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">IRibbonControl)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    ...                     ' Можем вставить сюда какой-нибудь код, если нужно.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    On</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Error</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GoTo</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Error1    ' Начинаем защищённый блок.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">        CommandBars.ExecuteMso (&quot;TableRowsDeleteExcel&quot;) ' Пробуем выполнить команду.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    On</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Error</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">GoTo</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">0         ' Заканчиваем защищённый блок.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    ...                     ' Можем вставить сюда какой-нибудь код, если нужно.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Exit</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">                </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">' Завершаем функцию.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Error1:                     ' Обработка ошибки.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    MsgBox (&quot;Эта команда предназначена для выполнения внутри «Умной таблицы».&quot;) </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">    Resume</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Next</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;">             </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">' Продолжаем выполнение функции.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">End</span><span style=" font-family:'Arial,sans-serif'; font-size:10pt; color:#444444;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#444444;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p></body></html>