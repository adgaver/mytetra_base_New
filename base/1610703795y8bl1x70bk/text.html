<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:xx-large; font-weight:600; color:#222222; background-color:#ffeba0;">ISO 8601 Неделя в DAX</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:296; color:#666666;">Опубликовано </span><a href="https://z5h64q92x9.net/proxy_u/en-ru.ru/https/blog.gbrueckl.at/2012/04/iso-8601-week-in-dax/"><span style=" font-family:'inherit'; font-size:12px; font-weight:600; text-decoration: underline; color:#337ab7;">2012-04-20</span></a><span style=" font-family:'inherit'; font-size:12px; font-weight:296; color:#666666;"> </span><a href="https://z5h64q92x9.net/proxy_u/en-ru.ru/https/blog.gbrueckl.at/author/gbrueckl/"><span style=" font-family:'inherit'; font-size:12px; font-weight:600; text-decoration: underline; color:#337ab7;">Gerhard Brueckl</span></a><span style=" font-family:'inherit'; font-size:12px; font-weight:296; color:#666666;"> - </span><a href="https://z5h64q92x9.net/proxy_u/en-ru.ru/https/blog.gbrueckl.at/2012/04/iso-8601-week-in-dax/#comments"><span style=" font-family:'inherit'; font-size:12px; font-weight:600; text-decoration: underline; color:#337ab7;">15 комментариев ↓</span></a></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">Недавно я построил модель PowerPiovt, где мне нужно было отображать недели в соответствии с ISO 8601. Поскольку я часто сталкивался с этим в прошлом, когда разрабатывал базы данных SQL Server (до 2008 года) Я знал, что недели ISO также могут быть вычислены с использованием некоторых сложных логик. Когда я обсуждал это с некоторыми своими коллегами во время тренинга, один из участников сказал мне, что это можно очень легко решить в Excel с помощью Excels </span><a href="https://z5h64q92x9.net/proxy_u/en-ru.ru/office.microsoft.com/en-us/excel-help/weeknum-HP005209337.aspx"><span style=" font-family:'inherit'; font-size:16px; font-weight:296; text-decoration: underline; color:#337ab7;">WEEKNUM()</span></a><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">-функции. Эта функция принимает аргументы:</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#373737;">Serial_num</span><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">-это дата в пределах недели. Даты следует вводить с помощью функции даты или в виде результатов других формул или функций. Например, используйте дату (2008,5,23) для 23-го дня мая 2008 года. Проблемы могут возникнуть, если </span><a href="https://z5h64q92x9.net/proxy_u/en-ru.ru/office.microsoft.com/en-us/excel-help/redir/HP005200674.aspx?CTT=5&amp;origin=HP005209337"><span style=" font-family:'inherit'; font-size:16px; font-weight:296; text-decoration: underline; color:#337ab7;">даты вводятся в виде текста</span></a><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#373737;">Return_type</span><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">-это число, которое определяет, в какой день начинается Неделя. Значение по умолчанию равно 1.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;"><br /></p>
<table border="1" style=" border-color:#cccccc; border-style:solid; margin-top:0px; margin-bottom:28px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" padding-left:7; padding-right:7; padding-top:7; padding-bottom:7;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="tableoverflow"></a><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#373737;">R</span><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#373737;">eturn_type</span></p></td>
<td style=" padding-left:7; padding-right:7; padding-top:7; padding-bottom:7;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#373737;">Неделя Начинается</span></p></td></tr>
<tr>
<td style=" padding-left:7; padding-right:7; padding-top:7; padding-bottom:7;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#373737;">1</span></p></td>
<td style=" padding-left:7; padding-right:7; padding-top:7; padding-bottom:7;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#373737;">Неделя начинается в воскресенье. Будни пронумерованы от 1 до 7.</span></p></td></tr>
<tr>
<td style=" padding-left:7; padding-right:7; padding-top:7; padding-bottom:7;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#373737;">2</span></p></td>
<td style=" padding-left:7; padding-right:7; padding-top:7; padding-bottom:7;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#373737;">Неделя начинается в понедельник. Будни пронумерованы от 1 до 7.</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">Согласно Excels Online-Help, второй параметр поддерживает только значения 1 и 2. Но это не 100% правда. Вы также можете использовать значение 21 в качестве второго параметра, и угадайте, что – теперь он возвращает номера недель в соответствии с ISO 8601. Поскольку многие DAX-функции являются производными от Excel (включая WEEKNUM ()-function), </span><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#ff0000;">это также работает с функцией DAX</span><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;"> </span><a href="https://z5h64q92x9.net/proxy_u/en-ru.ru/technet.microsoft.com/en-us/library/ee634572.aspx"><span style=" font-family:'inherit'; font-size:16px; font-weight:296; text-decoration: underline; color:#337ab7;">WEEKNUM ()</span></a><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">- function!</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">Таким образом, создавая вычисляемый столбец как</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Monaco,MonacoRegular,Courier New,monospace'; font-size:12px; font-weight:496; color:#373737;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#cccccc" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-600162cbea6d6913173886"></a><span style=" font-family:'inherit'; font-size:12px; color:#8ac1f8;">1</span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-600162cbea6d6913173886-1"></a><span style=" font-family:'inherit'; font-size:12px; color:#a9a9a9;">=</span><span style=" font-family:'inherit'; font-size:12px; color:#000000;">WEEKNUM</span><span style=" font-family:'inherit'; font-size:12px; color:#333333;">([</span><span style=" font-family:'inherit'; font-size:12px; color:#ff4500;">дата</span><span style=" font-family:'inherit'; font-size:12px; color:#333333;">];</span><span style=" font-family:'inherit'; font-size:12px; color:#000080;">21</span><span style=" font-family:'inherit'; font-size:12px; color:#333333;">)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:296; color:#373737;">вы получаете номер недели ISO для текущей [даты].</span></p></body></html>