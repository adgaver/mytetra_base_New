<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Sub        : filters_column_Cri - фильтр по столбцу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Created    : 27-09-2023 12:08</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Author     : girevav</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Copyright  : -</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Argument(s):                 Description</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'*</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* ByVal oSh As Worksheet   : лист на котором фильтруем</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* ByVal int_Cln As Integer : стобец для фильтрации</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* ByVal strCri As String   : текст для фильтрайии</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'*</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> filters_column_Cri</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> oSh </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> Worksheet</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        </span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> int_Cln </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Integer</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        </span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> strCri </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">With</span><span style=" font-family:'Courier New'; color:#000000;"> oSh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        Lng_ClnEnd </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">.</span><span style=" font-family:'Courier New'; color:#000000;">Cells</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">256</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">xlToLeft</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#000000;">Column</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        Lng_RowEnd </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">.</span><span style=" font-family:'Courier New'; color:#000000;">Columns</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#000000;">Rows</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1048576</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">xlUp</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#000000;">Row</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        </span><span style=" font-family:'Courier New'; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; color:#000000;"> rRange </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> Range</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(.</span><span style=" font-family:'Courier New'; color:#000000;">Cells</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">Lng_RowEnd</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">.</span><span style=" font-family:'Courier New'; color:#000000;">Cells</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">Lng_RowEnd</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> Lng_ClnEnd</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">With</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    rRange.AutoFilter Field</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:=</span><span style=" font-family:'Courier New'; color:#000000;">int_Cln</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> Criteria1</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:=</span><span style=" font-family:'Courier New'; color:#000000;">strCri</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; color:#000000;"> rRange </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Sub        : DelFiltersInListObject - Сброс фильтра в &quot;умной таблице&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Created    : 27-09-2023 12:10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Author     : girevav</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Copyright  : -</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* Argument(s):             Description</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'*</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* ByVal oSh As Worksheet :</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'*</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> DelFiltersInListObject</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> oSh </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> Worksheet</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; color:#000000;"> oTb                   </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> ListObject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; color:#000000;"> oTb </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> oSh.ListObjects</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New'; color:#000000;"> oTb.AutoFilter.FilterMode </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        </span><span style=" font-family:'Courier New'; color:#0000ff;">For</span><span style=" font-family:'Courier New'; color:#000000;"> i </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">To</span><span style=" font-family:'Courier New'; color:#000000;"> oTb.ListColumns.Count</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">            oTb.Range.AutoFilter Field</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:=</span><span style=" font-family:'Courier New'; color:#000000;">i</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        </span><span style=" font-family:'Courier New'; color:#0000ff;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#008000;">'ActiveSheet.ListObjects(&quot;Таблица3&quot;).Range.AutoFilter Field:=5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span></p></body></html>