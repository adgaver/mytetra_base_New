<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">Public Function RoundX(ByVal numberToRound As Double, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">                        ByVal roundBase As Integer)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">    RoundX = Round(numberToRound / roundBase + 0.5, 0) * roundBase</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">    result = (numberToRound \ roundBase) * roundBase</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">    If result Mod roundBase &gt; 0 Then result = result + roundBase</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">    </span><span style=" font-family:'Consolas'; font-size:9pt; color:#55aa00;">'</span><span style=" font-family:'Consolas'; font-size:9pt; color:#55aa00;">If result Mod roundBase &gt; 0 Then result = result + roundBase</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">    </span><span style=" font-family:'Consolas'; font-size:9pt; color:#55aa00;">'if </span><span style=" font-family:'Consolas'; font-size:9pt; font-weight:600; color:#ff0000;">&gt;&gt;&gt;numberToRound&lt;&lt;&lt;</span><span style=" font-family:'Consolas'; font-size:9pt; color:#55aa00;"> mod roundBase &gt; 0 then result = result + roundBase</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">End Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:9pt; color:#00007f;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">Private Sub ResultEvent()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">intMin = 123</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">ResultX = RoundX(intMin, 15)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9pt; color:#00007f;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">Есть функция, но работает она несколько неточно, задача в следующем - округлить до десятков, т.е. есть 3861 + 40% = 5 405,4:</span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222;"> </span></p>
<p style=" margin-top:4px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">Public</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> </span><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">Function</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> RoundX(numberToRound </span><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> </span><span style=" font-family:'monospace'; font-size:10pt; color:#6f002f;">Double</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;">, roundBase </span><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> </span><span style=" font-family:'monospace'; font-size:10pt; color:#6f002f;">Integer</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#222222;">    RoundX = Round(numberToRound / roundBase + 0.5, 0) * roundBase</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> </span><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:10pt; color:#0000ff; background-color:#fffaed;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">Private</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> </span><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">Sub</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> ResultEvent()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#222222;">ResultX = RoundX(5405.4, 10)</span></p>
<p style=" margin-top:0px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> </span><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">Получили: 5410, тут все правильно.</span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222;"> </span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">Переходим к следующему числу: 8700+40%=12180, функция тут выдает 12190, что неверно, ведь верно 12180.</span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222;"> </span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">Сталкивался ли кто с универсальным решением данной задачи? Которое бы округляло до нужных десятков, сотен, тысяч.... всегда вверх. В случае с 8700 некоторое решение: вместо 0,5 подставлять 0,49999, но оно опять же, временное и в некоторых случаях при получении числа 5400.2, ставит 5400, что опять неверно, нужно 5410.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Arial,Verdana'; font-size:13px; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">&gt; kiv-1980,</span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222;"> </span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">&gt; ... Которое бы округляло до нужных десятков, сотен, тысяч.... всегда вверх.</span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222;"> </span></p>
<p style=" margin-top:4px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#222222; background-color:#fffaed;">result = ( numberToRound \ roundBase ) * roundBase</span></p>
<p style=" margin-top:0px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">if</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> result </span><span style=" font-family:'monospace'; font-size:10pt; color:#8515ea;">mod</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> roundBase &gt; 0 </span><span style=" font-family:'monospace'; font-size:10pt; color:#0000ff;">then</span><span style=" font-family:'monospace'; font-size:10pt; color:#222222;"> result = result + roundBase</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:10pt; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">Обшыбка. В условии не та величина</span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222;"> </span><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">if &gt;&gt;&gt;numberToRound&lt;&lt;&lt; mod roundBase &gt; 0 then result = result + roundBase</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Arial,Verdana'; font-size:13px; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fffaed;"><span style=" font-family:'Arial,Verdana'; font-size:13px; color:#222222; background-color:#eeeeee;">Указанная функция работает верно, нашел повторный раунд, все поправилось вопрос снят.</span></p></body></html>