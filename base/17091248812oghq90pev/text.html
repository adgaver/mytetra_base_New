<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt;">XmlHttpRequest — HTTP-запросы в Excel VBA (обновлено в 2022 г.)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.666%;"><a href="https://codingislove.com/author/ranjithkumar10/"><span style=" font-family:'inherit'; font-size:12px; text-decoration: underline; color:#949494;">Ранджит Кумар</span></a><a href="https://codingislove.com/http-requests-excel-vba/"><span style=" font-family:'inherit'; font-size:12px; text-decoration: underline; color:#949494;">11 сентября 2022 г.</span></a><span style=" font-family:'lato,sans-serif'; font-size:12px; color:#949494;"> </span><span style=" font-family:'inherit'; font-size:12px; color:#999999;"> </span><a href="https://codingislove.com/tag/coding/"><span style=" font-family:'inherit'; font-size:12px; text-decoration: underline; color:#949494;">кодирование </span></a><a href="https://codingislove.com/tag/excel/"><span style=" font-family:'inherit'; font-size:12px; text-decoration: underline; color:#949494;">Excel </span></a><a href="https://codingislove.com/tag/vba/"><span style=" font-family:'inherit'; font-size:12px; text-decoration: underline; color:#949494;">VBA</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Excel — мощный и самый популярный инструмент для анализа данных! HTTP-запросы в VBA предоставляют Excel дополнительные возможности. Объект XmlHttpRequest используется для выполнения HTTP-запросов в VBA. HTTP-запросы можно использовать для взаимодействия с веб-сервисом, API или даже веб-сайтами. Давайте разберемся, как это работает.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Откройте файл Excel и откройте редактор VBA (Alt + F11) &gt; новый модуль и начните писать код в подпункте.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_363991"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Public sub XmlHttpTutorial</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848; background-color:#0f192a;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Определить XMLHttpRequest</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Определите http-клиент, используя следующий код</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_783325"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim xmlhttp as object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set xmlhttp = CreateObject(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;MSXML2.serverXMLHTTP&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Если вам нужно автозаполнение Intellisense VBA, сделайте это следующим образом:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Сначала добавьте ссылку на MSXML (Инструменты &gt; ссылки).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Выберите подходящую версию в зависимости от вашего ПК:<br />1. Microsoft XML, v 3.0.<br />2. Microsoft XML, v 4.0 (если MSXML 4.0 установлен отдельно).<br />3. Microsoft XML, версия 5.0 (если у вас установлен Office 2003–2007, который предоставляет MSXML 5.0 для приложений Microsoft Office).<br />4. Microsoft XML, v 6.0 для последних версий MS Office.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Затем определите http-клиент</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_354858"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim xmlhttp As New MSXML2.XMLHTTP</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">'Dim xmlhttp As New MSXML2.XMLHTTP60 </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">for</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Microsoft XML, v 6.0 </span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">VBA Intellisense покажет вам правильный вариант, когда вы начнете печатать.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Делать запросы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Запросы могут быть сделаны с использованием методов open и send. Синтаксис открытого метода следующий:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_58513"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.Open Method, URL, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">async</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">true</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">or </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">false</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Я использую </span><a href="http://requestb.in/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">requestBin</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> для проверки запросов. Создайте там корзину и отправляйте запросы на этот URL-адрес для тестирования запросов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Простой запрос GET будет:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_430090"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim xmlhttp As New MSXML2.XMLHTTP60, myurl As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myurl = </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;http://requestb.in/15oxrjh1&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">//replace </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">with</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">your URL</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.Open </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;GET&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, myurl, False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.Send</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">MsgBox(xmlhttp.responseText)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Запустите этот код, появится окно сообщения с ответом на запрос.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><a name="div-gpt-ad-1595500140430-0"></a><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">З</span><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">аголовки запросов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Заголовки запросов можно задать с помощью метода setRequestHeader. Примеры :</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_920232"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.setRequestHeader </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;Content-Type&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;text/json&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.setRequestHeader </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;Content-Type&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;application/x-www-form-urlencoded&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.setRequestHeader </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;User-Agent&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.setRequestHeader </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;Authorization&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, AuthCredentials</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Простой запрос POST для отправки данных формы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">POST-запросы используются для отправки некоторых данных, данные можно отправлять в </span><span style=" font-family:'Courier New'; font-size:14px; color:#484848;">Send</span><span style=" font-family:'inherit'; font-size:16px; color:#484848;">методе. Простой запрос POST для отправки данных формы:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_104630"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">6</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">7</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">8</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Public Sub httpclient()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim xmlhttp As New MSXML2.XMLHTTP, myurl As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myurl = </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;http://requestb.in/15oxrjh1&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.Open </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;POST&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, myurl, False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.setRequestHeader </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;Content-Type&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;application/x-www-form-urlencoded&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.Send </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;name=codingislove&amp;email=admin@codingislove.com&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">MsgBox (xmlhttp.responseText)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Базовая аутентификация в VBA</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Когда нам нужно получить доступ к веб-сервисам с базовой аутентификацией, имя пользователя и пароль должны быть отправлены с заголовком авторизации. Имя пользователя и пароль также должны быть закодированы в формате Base64. Пример :</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_24345"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">user = </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;someusername&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">password = </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;somepassword&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">xmlhttp.setRequestHeader </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;Authorization&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;Basic &quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">+ Base64Encode(user + </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;:&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">+ password)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Вот </span><a href="https://bin.codingislove.com/ojojafoziz"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">вставка служебной функции</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> , которая помогает кодировать строку в Base64.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><a name="div-gpt-ad-1595415581471-0"></a><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">П</span><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">рактические примеры использования</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Варианты практического использования http-запросов в VBA безграничны. Некоторые из них извлекают данные из финансового API Yahoo, API погоды, получают заказы из административной панели электронного магазина, загружают продукты, получают данные веб-форм для Excel и т. д.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Прочтите: </span><a href="https://codingislove.com/parse-html-in-excel-vba/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">Анализ HTML в Excel VBA. Узнайте, анализируя домашнюю страницу хакерских новостей,</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> где я получаю веб-страницу с помощью запроса HTTP GET и анализирую ее HTML для получения данных с веб-страницы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Прочтите </span><a href="https://codingislove.com/weather-app-in-excel-vba/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">, как создать простое приложение погоды в Excel VBA</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> , где я делаю HTTP-запрос Get к API погоды.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Прочтите </span><a href="https://codingislove.com/excel-json/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">JSON Api в Excel VBA</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> , где я вызываю JSON Apis, используя запросы HTTP GET и POST.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-style:italic; color:#484848;">Если у вас есть вопросы или отзывы, оставьте комментарий ниже.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:696; text-decoration: underline; color:#00bfb6;">Получайте уведомления о появлении нового сообщения, нажав на значокв левом нижнем углу.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:696; color:#484848;">Нужна помощь? Задавайте свои вопросы на нашем </span><a href="https://forum.codingislove.com/"><span style=" font-family:'inherit'; font-size:16px; font-weight:696; text-decoration: underline; color:#00bfb6;">форуме</span></a></p></body></html>