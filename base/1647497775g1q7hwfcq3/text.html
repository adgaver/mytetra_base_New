<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Развернутый элемент Data&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ExpandTableColumn</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">( </span><span style=" font-family:'Courier New'; color:#000000;">old_step</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;Data&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">                                    </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ColumnNames</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">( </span><span style=" font-family:'Courier New'; color:#000000;">old_step</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-weight:600; color:#800080;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}[</span><span style=" font-family:'Courier New'; color:#000000;">Data</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">                                    </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ColumnNames</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">( </span><span style=" font-family:'Courier New'; color:#000000;">old_step</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-weight:600; color:#800080;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}[</span><span style=" font-family:'Courier New'; color:#000000;">Data</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]))</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-style:italic; color:#008000;">//------------------------------------------------------------------------- </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-weight:600; color:#004080; background-color:#eeeeee;">let</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        str_File_Path</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;">fnGetParameter</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#800000;">&quot;FilePath&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        str_Sh_Name</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;">fnGetParameter</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Sh_Name&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        Источник </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Excel.Workbook</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">File.Contents</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">str_File_Path</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; color:#000000;"> null</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#800080;">true</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Строки с примененным фильтром&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.SelectRows</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">Источник</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff8000;">each</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">[</span><span style=" font-family:'Courier New'; color:#000000;">Name</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> str_Sh_Name</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        Select_Columns </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.SelectColumns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;">#</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Строки с примененным фильтром&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,{</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Data&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Развернутый элемент Data&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">=</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.Buffer</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">(</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">                                                    </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ExpandTableColumn</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">( </span><span style=" font-family:'Courier New'; color:#000000;">Select_Columns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#800000;">&quot;Data&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">                                                    </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ColumnNames</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">( </span><span style=" font-family:'Courier New'; color:#000000;">Select_Columns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-weight:600; color:#800080;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}[</span><span style=" font-family:'Courier New'; color:#000000;">Data</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]),</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">                                                    </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080c0;">Table.ColumnNames</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">( </span><span style=" font-family:'Courier New'; color:#000000;">Select_Columns</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">{</span><span style=" font-family:'Courier New'; font-weight:600; color:#800080;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">}[</span><span style=" font-family:'Courier New'; color:#000000;">Data</span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">]))</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">                                                    </span><span style=" font-family:'Courier New'; font-weight:600; color:#0080ff;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; font-weight:600; color:#004080; background-color:#eeeeee;">in</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">        #</span><span style=" font-family:'Courier New'; color:#800000;">&quot;Развернутый элемент Data&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> </span></p></body></html>