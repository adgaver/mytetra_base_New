<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:xx-large; font-weight:496; color:#333333;">Как в VBA правильно создавать одномерный массив. ArrayList</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#47c270;">Простой</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#929ca5;">5 мин4.8K</span></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/hubs/programming/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#6f7577; background-color:#000000;">Программирование</span></a><a href="https://habr.com/ru/hubs/programming/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#6f7577; background-color:#000000;">*</span></a><a href="https://habr.com/ru/hubs/vba/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#6f7577; background-color:#000000;">Visual Basic for Applications</span></a><a href="https://habr.com/ru/hubs/vba/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#6f7577; background-color:#000000;">*</span></a></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#2385e7;">Обзор</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><a name="post-content-body"></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">К</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">огда я впервые встретил этот класс, подумал</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#333333;">«Зачем? Ведь есть простые массивы»</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">. А потом попробовал и не представляю как жил без него раньше.</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:large; font-weight:496; color:#333333;">Начну сразу с примера</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Предположим, на активном листе в столбце 1 находится список ФИО сотрудников.</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#909090;">Список ФИО</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Наша задача собрать в массив только уникальные ФИО и отсортировать его по убыванию (ну такая вот немного странная задача). Сначала решим ее без использования </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ArrayList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, а в конце сравним результат.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Для получения уникальных значений, создаем функцию </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">GetDistinctItems</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> и в нее передаем столбец с ФИО. В самой функции пробегаем циклом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">For Each</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> по всем ФИО и добавляем уникальные в объект </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Buffer</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> (</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Dictionary</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">). Далее методом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Keys</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> извлекаем элементы в дополнительную функцию </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">DescendingSort</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> (используем сортировку пузырьком) и получаем отсортированные значения в переменную </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Sorted</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, которую и возвращаем как результат функции.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Sub</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Main()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> FullNameColumn As Range</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> FullNameColumn = ActiveSheet.UsedRange.Columns(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Получаем первый столбец.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> DistinctList As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    DistinctList = GetDistinctItems(FullNameColumn) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Передаем диапазон в функцию.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    Debug.Print </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">Join</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(DistinctList, vbCrLf) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Выводим результат.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> GetDistinctItems(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">ByRef</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Range As Range) As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Data As Variant: Data = Range.Value </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Преобразуем диапазон в массив.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer As Object: </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">CreateObject</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#718c00;">&quot;Scripting.Dictionary&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Создаем объект Dictionary.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Item</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Item </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Data</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Not</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer.Exists(Item) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Then</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer.Add Item, </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">Empty</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Проверяем наличие элемента и добавляем если отсутствует.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Sorted As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    Sorted = DescendingSort(Buffer.Keys()) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Сортируем функцией DescendingSort.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    GetDistinctItems = Sorted </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Возвращаем результат.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> DescendingSort(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">ByRef</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Data As Variant) As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> i As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> i = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">LBound</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(Data) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">To</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">UBound</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(Data) - </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> j As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> j = i + </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">To</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">UBound</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(Data)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Data(i) &lt; Data(j) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">                </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Temp As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">                Temp = Data(j)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">                Data(j) = Data(i)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">                Data(i) = Temp</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Next</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    DescendingSort = Data</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#909090;">Результат</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Тривиально? Вполне. Компактно? Ну в целом да, но в конце мы напишем еще более компактней, а заодно решим проблему написания новой функции, если вдруг результат нужно будет сортировать по возрастанию.</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:large; font-weight:496; color:#333333;">Что есть такое</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Начнем с того, что </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ArrayList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> это класс из пространства имен </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">System.Collections</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> библиотеки </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">mscorlib</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, который реализует интерфейс </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">IList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">. Естественно, в VBA он несколько порезан в плане методов, иначе и быть не могло (например нет методов </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">AddRange</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> или </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">BinarySearch</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">). Но и тем не менее с ним можно (и нужно) работать.<br />По сути, это динамический массив. Его не нужно самостоятельно переопределять, чтобы изменить размерность, достаточно добавлять элементы с помощью метода </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Add</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">. Где-то я читал, что на низком уровне </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000; background-color:#bbcdd6;">(да простят меня знатоки, я не знаю правильно ли я применяю это словосочетание здесь)</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">есть свои нюансы в плане производительности, но, откровенно говоря, за все время использования этого объекта каких-либо проблем я не замечал и время работы макроса из-за него </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; text-decoration: underline; color:#333333;">если</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> и растет вообще, то совсем не критично.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#333333;">В чем же </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; text-decoration: line-through; color:#333333;">сила брат</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#333333;"> удобство?</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Как минимум в том, что это динамический массив. Вы просто добавляете элементы через метод и не нужно заморачиваться на тему </span><span style=" font-family:'FreeMono'; font-size:medium; color:#6a1009;">ReDim</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> (и уж тем более </span><span style=" font-family:'FreeMono'; font-size:medium; color:#6a1009;">Preserve</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">) и вычислений размеров будущего массива.</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:large; font-weight:496; color:#333333;">А дальше начинаются вкусняхи</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Во-первых, мы можем выгрузить все элементы одним методом </span><span style=" font-family:'FreeMono'; font-size:medium; color:#6a1009;">ToArray</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">. Как следует из названия, он преобразует все элементы объекта в обычный массив типа </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Variant</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">.<br />Во-вторых, мы можем составлять список уникальных значений, проверяя их наличие методом </span><span style=" font-family:'FreeMono'; font-size:medium; color:#6a1009;">Contains</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">В-третьих, можно забыть про функцию </span><span style=" font-family:'FreeMono'; font-size:medium; color:#6a1009;">UBound</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, ведь у этого класса есть свойство </span><span style=" font-family:'FreeMono'; font-size:medium; color:#6a1009;">Count</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, которое, как не сложно догадаться, возвращает количество элементов помещенных в объект.<br />В-четвертых, есть возможность быстро отсортировать элементы как по возрастанию (метод </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Sort</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">), так и по убыванию (сначала используем метод </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Sort</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, а после метод </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Reverse</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">).</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#333333;">Ну и быстро пробегаем по оставшимся свойствам:</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Item(Index)</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Предоставляет доступ к элементу по его индексу.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#333333;">и методам:</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">IndexOf(Item, StartFrom)</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Возвращает индекс элемента. Обязательный аргумент </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">StartFrom</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> поможет найти каждый последующий индекс одинаковых элементов.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">RemoveAt(Index)</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Удаляет элемент по индексу.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Remove(Item)</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Удаляет переданный элемент.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">RemoveRange(StartPosition, Count)</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Удаляет диапазон элементов. </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">StartPosition</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> указывает на индекс первого элемента, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Count</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> на количество элементов в удаляемом диапазоне.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Clear()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Удаляет все элементы.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Insert(Position, Item)</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Добавляет элемент по заданной позиции.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Clone()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br />Создает копию объекта (по сути создает новый объект, а не возвращает ссылку на текущий).</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:large; font-weight:496; color:#333333;">Как создать это чудо</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Создать объект класса </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ArrayList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> можно с помощью функции </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">CreateObject</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> List As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> List = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">CreateObject</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#718c00;">&quot;System.Collections.ArrayList&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">или через </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#333333;">Tools -&gt; Reference</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> подключить библиотеку </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#333333;">mscorlib.dll</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, а дальше создавать как обычный объект:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> List As </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">New</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> ArrayList</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Минус и той и другой привязки в том, что интерфейс объекта вы не получите. Причину лично я не знаю, но почему-то VBA в Excel (больше нигде не проверял) не видит свойства и методы этого класса (в поздней привязке их и так нет ни у какого объекта, так как тип переменной </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Object</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, а вот в ранней обычно есть).</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Можно, конечно, получить часть интерфейса, объявив переменную с типом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">IList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> и уже после этого присвоить ей инстанс </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ArrayList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, но тем самым мы потеряем бОльшую часть функционала, например методы </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Sort</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ToArray</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Reverse</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">.</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:large; font-weight:496; color:#333333;">Вернемся в начало</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Помните наш пример? Предлагаю решение с новыми знаниями.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Теперь мы добавляем уникальные значения в объект </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Buffer</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> (</span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ArrayList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">), перед этим проверяя методом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Contains</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> наличие ФИО в списке элементов. По окончанию цикла применяем метод </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Sort</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> и </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Reverse</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> для получения списка по убыванию. Выгружаем результат методом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ToArray</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">. Согласитесь на этот раз все гораздо компактней.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Sub</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Main()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> FullNameColumn As Range</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> FullNameColumn = ActiveSheet.UsedRange.Columns(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Получаем первый столбец.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> DistinctList As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    DistinctList = GetDistinctItems(FullNameColumn) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Передаем диапазон в функцию.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    Debug.Print </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">Join</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(DistinctList, vbCrLf) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Выводим результат.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> GetDistinctItems(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">ByRef</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Range As Range) As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Data As Variant: Data = Range.Value </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Преобразуем диапазон в массив.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer As Object: </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">CreateObject</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#718c00;">&quot;System.Collections.ArrayList&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Создаем объект ArrayList.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Item</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Item </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Data</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Not</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer.Contains(Item) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Then</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> Buffer.Add Item </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Проверяем наличие элемента и добавляем если отсутствует.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Next</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    Buffer.Sort: Buffer.Reverse </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Сортируем по возрастанию, а потом переворачиваем (по убыванию).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333; background-color:#eff0f1;">    GetDistinctItems = Buffer.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">To</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#f5871f;">Array</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;">() </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#8e908c;">' Выгружаем в виде массива.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:medium; font-weight:696; color:#8959a8;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#909090;">Итоговый результат</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:large; font-weight:496; color:#333333;">Что в итоге</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">В итоге мы имеем преимущество перед классом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Collection</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> в том, что есть проверка на наличие элемента в списке (без танцев с бубном) и быстрая выгрузка в виде массива (без написания цикла).</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Перед классом </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Dictionary</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">, пожалуй, преимущество в отсутствии необходимости прописывать ключи (если они изначально не нужны).</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Ну и оба вышеперечисленных проигрывают в плане сортировки, добавления элементов по индексу и т.д.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">В общем и целом, достаточно удобный в применении класс для работы с одномерными массивами. Конечно, получать данные из объекта </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">Range</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> гораздо проще в обычный массив, но если нужно создавать новый (например в цикле), то, как по мне, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#333333; background-color:#f7f7f7;">ArrayList</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> превосходный вариант.</span></p>
<p style=" margin-top:56px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:x-large; font-weight:496; color:#333333;">P.S. (проблемки, проблемушки)</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Уже после написания статьи обратил внимание, что мой пример на чистом ПК не работает, появляется </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#333333;">automation error -2146232576</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> при создании объекта ArrayList.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Судя по </span><a href="https://stackoverflow.com/questions/40625618/automation-error-2146232576-80131700-on-creating-an-array"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa; background-color:#000000;">этому</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> ответу, для работы mscorlib необходимо включить .NET Framework 3.5.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">Сделать это можно через </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#333333;">Панель управления -&gt; Программы -&gt;</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#333333;">Включение или отключение компонентов Windows -&gt; поставить галочку напротив .NET Framework 3.5 (включает .NET 2.0 и 3.0) </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">после чего на ПК скачаются необходимые файлы для работы компонента.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#333333;">Обязательно</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;"> после проделанных действий перезагрузить Excel. У меня при установке выдал ошибку. Исправилось выключением Excel и повторным включением компонента.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#333333;">К слову на моем рабочем ПК таких проблем не было, т.е. данный компонент уже был подключен организацией (или по умолчанию в ранних Windows, не знаю точно).</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:transparent;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#333333;">Спасибо, что прочитали до конца.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#333333;">Как насчет применения этого класса? Пишите в комментариях!<br />А также, подписывайтесь на мой </span><a href="https://t.me/VBAn_Diary"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#548eaa; background-color:#000000;">телеграмм</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#333333;">.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#333333;">Теги:</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BArrayList%5D"><span style=" font-size:medium; font-weight:496; background-color:#000000;">ArrayList</span></a></li>
<li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BVBA%5D"><span style=" font-size:medium; font-weight:496; background-color:#000000;">VBA</span></a></li>
<li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%94%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%BC%D0%B0%D1%81%D1%81%D0%B8%D0%B2%5D"><span style=" font-size:medium; font-weight:496; background-color:#000000;">Динамический массив</span></a></li></ul>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#333333;">Хабы:</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/hubs/programming/"><span style=" font-size:medium; font-weight:496; background-color:#000000;">Программирование</span></a></li>
<li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#548eaa;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/hubs/vba/"><span style=" font-size:medium; font-weight:496; background-color:#000000;">Visual Basic for Applications</span></a></li></ul></body></html>