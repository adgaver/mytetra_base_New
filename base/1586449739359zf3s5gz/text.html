<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; font-weight:600;">outlook-vba 3.2 Ссылка на папку по умолчанию </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ript_desk_article_lb2"></a><br /></p>
<p style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="------"></a><span style=" font-size:x-large; font-weight:600;">п</span><span style=" font-size:x-large; font-weight:600;">ример</span><a href="https://riptutorial.com/ru/outlook-vba/example/27630/3-2-%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B0-%D0%BD%D0%B0-%D0%BF%D0%B0%D0%BF%D0%BA%D1%83-%D0%BF%D0%BE-%D1%83%D0%BC%D0%BE%D0%BB%D1%87%D0%B0%D0%BD%D0%B8%D1%8E#------"><span style=" font-size:x-large; font-weight:600; text-decoration: underline; color:#0000ff;">#</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В <span style=" font-family:'Courier New';">TestDefaultFldr()</span> я установил <span style=" font-family:'Courier New';">Fldr</span> в папку «Входящие» по умолчанию. Постоянный <span style=" font-family:'Courier New';">olFolderInbox</span> можно заменить другими значениями, предоставляющими доступ к любой из папок по умолчанию. Если вы <span style=" font-family:'Courier New';">Set Fldr = Session.GetDefaultFolder(</span> , в редакторе VB появится выпадающий список всех возможных значений. </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Sub TestDefaultFldr()</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">  Dim Fldr As Folder</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">  Set Fldr = Session.GetDefaultFolder(olFolderInbox)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">  Debug.Print Join(GetFldrNames(Fldr), &quot;|&quot;)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">End Sub</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На моем ноутбуке <span style=" font-family:'Courier New';">TestDefaultFldr()</span> отображает <span style=" font-family:'Courier New';">Outlook data file|Inbox</span> который стал неожиданностью. Я написал <span style=" font-family:'Courier New';">GetFldrNames(Fldr)</span> чтобы убедиться, что папка, на которую я ссылался, была той, которую я хотел. Я получил доступ к папке «Входящие» по умолчанию и обнаружил, что он пуст! Магазин «Выходной файл данных» поставляется с установкой по умолчанию, и я проигнорировал его, так как Outlook создал хранилище для каждой из моих учетных записей электронной почты. Только после того, как я обнаружил свой пустой почтовый ящик по умолчанию, я подумал о том, как Outlook будет знать, какая из моих учетных записей электронной почты была учетной записью, которую я хотел бы использовать по умолчанию. Из стандартных папок Outlook по умолчанию нет или по умолчанию находится «Выходной файл данных». Возможно, будет возможно изменить, какой из входящих сообщений является папкой «Входящие» по умолчанию, но я не исследовал, потому что я не уверен, какие из моих учетных записей электронной почты я бы сделал по умолчанию, если бы я это изменил. Просто помните, что все ваши элементы календаря, задачи и т. Д. Находятся в «файле данных Outlook» и убедитесь, что вы включили «Outlook.pst» в свой список архивов. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Большинство объектов Outlook имеют свойство <span style=" font-family:'Courier New';">Parent</span> . <span style=" font-family:'Courier New';">GetFldrNames(Fldr)</span> записывает имя папки в массиве, прежде чем пытаться получить доступ к ее родительскому <span style=" font-family:'Courier New';">GetFldrNames(Fldr)</span> . Он циклически добавляет имена в конец массива, пока не достигнет магазина. В хранилище нет родителя, поэтому попытка доступа к нему не выполняется. Последовательность имен в массиве меняется на обратный и затем возвращается вызывающему. Я использовал <span style=" font-family:'Courier New';">Join</span> чтобы превратить массив имен в отображаемую строку. </p></body></html>