<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:33pt; color:#222222;">Работа с файлами XML в VBA (VBA XML)</span> </p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">Написано </span><a href="https://analystcave.com/author/analystcave/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Томом (AnalystCave)</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">  в10 июля 2015 г. в </span><a href="https://analystcave.com/category/ms-office/ms-office-excel/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Excel</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">MS Office</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/outlook/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Outlook</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/powerpoint/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">PowerPoint</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/word/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Word</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Файлы XML являются одним из наиболее распространенных типов файлов данных, помимо текстовых файлов и файлов CSV (значения, разделенные запятыми). Чтение файлов данных, которые не являются иерархическими (например, файлы XML или JSON), относительно просто. Вы можете читать данные построчно и обрабатывать столбцы отдельно. С XML (и JSON) задача не так проста, поскольку данные иерархичны (между записями в схеме существуют отношения родитель-потомок), а количество базовых узлов может варьироваться, в отличие от табличных данных, которые обычно имеют постоянное количество столбцов. разделены специальным разделителем.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Другие файловые ресурсы VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Файловые функции VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-read-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Чтение файлов VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-write-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Запись файлов VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-dir-function-how-to-traverse-directories/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Обход каталогов</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-xml-working-xml-files/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">VBA Работа с файлами XML</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-downloading-files-from-ftp-using-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Загрузка файлов VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/excel-quick-versioning-excel-files/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Файлы управления версиями VBA</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/merge-csv-files-or-txt-files-in-a-folder/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">VBA Объединение файлов CSV или TXT</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">К счастью, мы можем использовать объект </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">MSXML2.DOMDocument</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> в VBA. Однако давайте, как всегда, начнем с краткого введения в то, как XML сохраняет структуру, прежде чем мы углубимся в примеры.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ЗАГРУЗКА XML-ДОКУМЕНТА В VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Объект </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">MSXML2.DOMDocument</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> позволяет легко перемещаться по структуре XML и извлекать любой необходимый узел XML и/или атрибут. Давайте посмотрим на пример ниже.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Ниже мы начнем с загрузки XML-документа. Обратите внимание, что я выбираю синхронную загрузку, а не проверку при разборе документа. Не стесняйтесь изменять эти параметры, если это необходимо.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestXML()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, root as </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = CreateObject(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;MSXML2.DOMDocument&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.async = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">: XDoc.validateOnParse = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.Load (ThisWorkbook.Path &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;\test.xml&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> root = XDoc.DocumentElement</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'... </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">В качестве альтернативы загрузите XML из строки:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestXML()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, root as </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = CreateObject(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;MSXML2.DOMDocument&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.async = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">: XDoc.validateOnParse = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.LoadXML (</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;&lt;root&gt;&lt;child&gt;&lt;/child&gt;&lt;/root&gt;&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> root = XDoc.DocumentElement</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'... </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Вот и все. Вы загрузили документ XML в память в объект DOMDocument. Документ был проанализирован, и вы можете легко перемещаться по вложенным элементам. См. следующий раздел.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">УЗЛЫ XML DOM В VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Ниже я буду использовать следующие примеры XML:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="671" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&lt;?</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">xml</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#808080;">version</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">=</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;1.0&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#808080;">encoding</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">=</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;utf-8&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">?&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">DistributionLists</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">List</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Name</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Recon&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Name</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">TO</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;John;Bob;Rob;Chris&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">TO</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">CC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Jane;Ashley&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">CC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">BCC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Brent&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">BCC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">List</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">List</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Name</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Safety Metrics&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Name</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">TO</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Tom;Casper&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">TO</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">CC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Ashley&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">CC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">BCC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;John&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">BCC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">List</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">List</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Name</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Performance Report&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Name</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">TO</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Huck;Ashley&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">TO</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">CC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Tom;Andrew&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">CC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">BCC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;John;Seema&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">BCC</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">List</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&lt;/</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">DistributionLists</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Документ XML предоставит вам корень всего DOM (типа XDoc.DocumentElement). Каждый DocumentElement (узел XML DOM) поддерживает следующие ссылки на узлы:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#000000" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ffffff;">Ссылка на узел</span> </p></td>
<td bgcolor="#000000" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ffffff;">Тип</span> </p></td>
<td bgcolor="#000000" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ffffff;">Описание</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">родительский узел</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">[Элемент XDoc.Документа]</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Родительский узел, на один узел выше в иерархии DOM.</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">Первый ребенок</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">[Элемент XDoc.Документа]</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Первый дочерний узел, первый узел ниже в иерархии DOM</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">последний ребенок</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">[Элемент XDoc.Документа]</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Последний дочерний узел, последний узел ниже в иерархии DOM</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">дочерние узлы</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">[Массив типа XDoc.DocumentElement]</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Все дочерние узлы текущего узла, все узлы ниже в иерархии DOM</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">следующийРодной брат</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">[Элемент XDoc.Документа]</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Следующий родственный узел, т. е. узел на том же уровне в иерархии DOM, имеющий тот же родительский узел.</span> </p></td></tr>
<tr>
<td bgcolor="#eeeeee" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-weight:600; color:#000000;">предыдущийРодной брат</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">[Элемент XDoc.Документа]</span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif';">Предыдущий родственный узел, т. е. узел на том же уровне в иерархии DOM, имеющий тот же родительский узел.</span> </p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Все приведенные выше ссылки позволяют свободно перемещаться в XML DOM.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Дочерние узлы</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Начнем с </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">извлечения первого списка и печати его XML и текстового содержимого</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> . Основой перемещения по XML DOM является использование </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">ChildNodes</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="671" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestXML()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = CreateObject(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;MSXML2.DOMDocument&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.async = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">: XDoc.validateOnParse = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.Load (ThisWorkbook.Path &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;\test.xml&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Get Document Elements</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lists = XDoc.DocumentElement</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Get first child ( same as ChildNodes(0) )</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> getFirstChild = lists.FirstChild</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Print first child XML</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Debug.Print getFirstChild.XML</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Print first child Text</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Debug.Print getFirstChild.Text</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Nothing</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Это результат</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Print first child XML</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&lt;List&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;Name&gt;Recon&lt;/Name&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;TO&gt;John;Bob;Rob;Chris&lt;/TO&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;CC&gt;Jane;Ashley&lt;/CC&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;BCC&gt;Brent&lt;/BCC&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&lt;/List&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Print first child Text</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Recon John;Bob;Rob;Chris Jane;Ashley Brent</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Обход всего XML в VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Теперь, когда у нас есть основы, давайте распечатаем все содержимое XML DOM, включая </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">базовые имена</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> (имена узлов).</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="757" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="713" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestXML()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = CreateObject(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;MSXML2.DOMDocument&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.async = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">: XDoc.validateOnParse = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.Load (ThisWorkbook.Path &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;\test.xml&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Get Document Elements</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lists = XDoc.DocumentElement</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Traverse all elements 2 branches deep</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Each</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> listNode </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">In</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lists.ChildNodes</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Debug.Print </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;---Email---&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Each</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fieldNode </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">In</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> listNode.ChildNodes</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Debug.Print </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;[&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &amp; fieldNode.BaseName &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;] = [&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &amp; fieldNode.Text &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;]&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Next</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fieldNode</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Next</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> listNode</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Nothing</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Вот результат:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="671" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">---Email---</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[Name] = [Recon]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[TO] = [John;Bob;Rob;Chris]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[CC] = [Jane;Ashley]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[BCC] = [Brent]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">---Email---</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[Name] = [Safety Metrics]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[TO] = [Tom;Casper]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[CC] = [Ashley]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[BCC] = [John]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">---Email---</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[Name] = [Performance Report]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[TO] = [Huck;Ashley]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[CC] = [Tom;Andrew]</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">[BCC] = [John;Seema]</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Легко, верно? Используя приведенные выше основы, мы можем легко перемещаться по документу. Но это все еще кажется большим количеством кодирования, верно? Что ж, есть более простой способ перемещения/извлечения элементов с помощью объекта </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">DOMDocument</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> , который называется </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">XPath</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://analystcave.com/vba-the-vba-type/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#2980b9; background-color:#ecf0f1; vertical-align:middle;">См. также </span></a><a href="https://analystcave.com/vba-the-vba-type/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000; background-color:#ecf0f1; vertical-align:middle;">  </span></a><a href="https://analystcave.com/vba-the-vba-type/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#000000; background-color:#ecf0f1; vertical-align:middle;">Тип VBA — пользовательский тип VBA, альтернативный классу.</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Ссылки на узлы примера XML-документа</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Теперь, когда у нас есть представление о нашем XML-документе, на основе приведенного выше примера XML я сопоставил ссылку на то, как получить различные элементы нашего XML-файла с помощью ссылок на узлы:</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Списки рассылки </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">[FirstChild]</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Список </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">[дочерних узлов (0)]</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Название: Recon </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">[ChildNodes(0).ChildNodes(0).innerText]</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">КОМУ: Джон;Боб;Роб;Крис </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">[ChildNodes(0).ChildNodes(1).innerText]</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Копия: Джейн; Эшли</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">БЦК: Брент</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">(…)</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Список </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">[дочерних узлов (1)]</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Название: Отчет о производительности </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">[ChildNodes(1).ChildNodes(0).innerText]</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">КОМУ: Гек; Эшли</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Копия: Том; Эндрю</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;">  </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">BCC: Джон; Сима</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">XPATH В VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Вместо обхода элементов/узлов в вашем XML с помощью свойств </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">.ChildNodes/.FirstChild/NextChild</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> мы также можем использовать </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">XPath</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> . XPath — это язык запросов, используемый для выбора узлов XML в документе XML. </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Он представлен одной строкой. </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Он позволяет извлекать любое количество узлов (0 и более), соответствующих указанному запросу XPath.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Если вы хотите изучить XPath, я могу порекомендовать этот обзор:<br /></span><a href="https://www.w3schools.com/xml/xpath_syntax.asp"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">https://www.w3schools.com/xml/xpath_syntax.asp</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Теперь давайте перейдем к примеру:</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Пример 1: извлечь все списки</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="671" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestXML()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = CreateObject(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;MSXML2.DOMDocument&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.async = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">: XDoc.validateOnParse = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc.Load (ThisWorkbook.Path &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;\test.xml&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e0e0e0;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lists = XDoc.SelectNodes(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;//DistributionLists/List&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Nothing</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Пример 2: Извлечение всех полей TO</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> toFields = XDoc.SelectNodes(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;//DistributionLists/List/TO&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Пример 3: Извлечение полей имени и фамилии</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> firstNameField = XDoc.SelectNodes(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;//DistributionLists/List[0]/Name&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> lastNameField = XDoc.SelectNodes(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;//DistributionLists/List[2]/Name&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Пример 3. Извлечение всех дочерних узлов списка (Имя, Кому, Копия, Скрытая копия)</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#afafaf;">1</span><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> listChildrenField = XDoc.SelectNodes(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;//DistributionLists/List/*&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">АТРИБУТЫ XML В VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Давайте рассмотрим последний пример — атрибуты. Давайте немного изменим приведенный выше XML и включим в качестве примера атрибут с именем </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">attribute</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#6ce26c;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&lt;?xml version=</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;1.0&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> encoding=</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;utf-8&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">?&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&lt;DistributionLists&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;List&gt;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e0e0e0;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> &lt;Name attribute=</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;some&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">&gt;Recon&lt;/Name&gt;</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Используя XPath (или обход DOM), мы можем легко извлечь атрибут, как показано ниже.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> firstNameField = XDoc.SelectNodes(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;//DistributionLists/List[0]/Name&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">Debug.Print firstNameField(0).Attributes(0).Text</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Result: &quot;some&quot;</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">СОЗДАНИЕ XML-ДОКУМЕНТОВ</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Создание документов также довольно просто в VBA.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td width="671" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, root </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, elem </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> XDoc = CreateObject(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;MSXML2.DOMDocument&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> root = XDoc.createElement(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Root&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">XDoc.appendChild root</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Add child to root</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> elem = XDoc.createElement(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Child&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">root.appendChild elem</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Add Attribute to the child</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> rel </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Object</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> rel = XDoc.createAttribute(</span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Attrib&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">rel.NodeValue = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Attrib value&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">elem.setAttributeNode rel</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Save the XML file</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">XDoc.Save </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;C:\my_file.xml&quot;</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">Похожие сообщения:</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>