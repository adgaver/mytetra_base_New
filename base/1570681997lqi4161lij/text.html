<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Working with Microsoft Excel tables in VBA</span><span style=" font-family:'DejaVu Sans,serif';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This blog post will be based on working with tables via VBA. They present some unique issues, which has to do with how their structured in the object model. Good or bad, it’s what we have. These are based on my trial and errors, so hopefully this will help somebody out there. That being said I consider this an intermediate level post.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">If you’re not up to speed with tables, take a look at these:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelandaccess.wordpress.com/2013/01/07/why-you-should-use-structured-references-in-tables/"><span style=" font-family:'DejaVu Sans,serif'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://excelandaccess.wordpress.com/2013/01/07/why-you-should-use-structured-references-in-tables/</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">When looking for information about tables, or adding/deleting data, it can be tricky. Here are some pieces of information to keep in mind, which isn’t very obvious, but are cornerstones in working with tables in VBA:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Deleting the DataBodyRange (data portion of a table) will set it to Nothing *</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">If table parts (i.e. header, totals row) aren’t showing, attempting access will result in an error</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Accessing the straight Range of a table includes all visible parts (i.e. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">[#All]) </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Tables are ListObjects * </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">If you’ve worked with tables in VBA, you may have noticed that when deleting a table’s entire data body, you are still left with a single, blank row. This is because you must have at least one row of data for the table to still be “alive”. No data rows, no table. You can hide the header and totals row, but you can’t get rid of the body. This presents some interesting coding when working with tables, and can be problematic, aka headache-inducing.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">* Check the links at the bottom of the post for additional information on these topics.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Here are some VBA examples for doing various things with tables in VBA. The file will be available (link at bottom of post) for download.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Common variables used throughout</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">[sourcecode language=”text”] Public WS As Worksheet</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Public loSet As ListObject<br />Public loGet As ListObject<br />Public loTest As ListObject</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Public rCols As Range<br />Public rRows As Range<br />Public rBody As Range<br />Public rData As Range<br />Public rHeader As Range<br />Public rStart As Range</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Public iCol As Long<br />Public iRow As Long<br />Public iStep As Long<br />Public iLastRow As Long<br />Public iRowCnt As Long<br />Public iColCnt As Long</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Public sMsg As String</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Public Const sSheetName As String = “Sheet1”<br />Public Const sTableName As String = “Table1”<br />Public Const sTableName2 As String = “Table2”<br />Public Const NL As String = vbNewLine<br />Public Const DNL As String = vbNewLine &amp; vbNewLine</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">As you can see I used some constants for testing in this specific workbook. Change these variables for testing in your environment. I tried to keep the naming convention simple.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Getting information from your tables</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">When working with tables via VBA it’s important to know how to look at them, and thus where to go for information. These are some examples of how to get dimension(s) information from your tables.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Listing columns</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This will step through a table and list the column headers in a message box, as well as the Immediate window in the Visual Basic Editor (Ctrl + G to show it).</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Sub Table_ListColumns()</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">On Error Resume Next<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loTest = WS.ListObjects(sTableName)<br />On Error GoTo 0</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">If WS Is Nothing Or loTest Is Nothing Then<br />MsgBox “There was an error setting the variables.”, vbInformation, “ERROR!”<br />Exit Sub<br />End If</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">sMsg = vbNullString<br />For iStep = 1 To loTest.ListColumns.Count<br />Debug.Print loTest.ListColumns.Item(iStep).Name<br />sMsg = sMsg &amp; NL &amp; iStep &amp; “) ” &amp; loTest.ListColumns(iStep)<br />Next iStep<br />sMsg = “‘” &amp; loTest.Name &amp; “‘ column headers:” &amp; NL &amp; sMsg</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">MsgBox sMsg, vbOKOnly, “COLUMN HEADERS”</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">End Sub</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Column count</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This will not loop through the table, but give a straight count of columns, along with which/where the start/end columns are.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Sub Table_CountColumns()</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">On Error Resume Next<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loTest = WS.ListObjects(sTableName)<br />On Error GoTo 0</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">If WS Is Nothing Or loTest Is Nothing Then<br />MsgBox “There was an error setting the variables.”, vbInformation, “ERROR!”<br />Exit Sub<br />End If</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">sMsg = “There are ” &amp; loTest.ListColumns.Count &amp; ” columns in ‘” &amp; sTableName &amp; “‘.”<br />sMsg = sMsg &amp; DNL &amp; “Starting on column ” &amp; loTest.ListColumns(1).Range.Column &amp; ” (” &amp; loTest.ListColumns(1) &amp; “)”<br />sMsg = sMsg &amp; NL &amp; “Ending on column ” &amp; loTest.ListColumns(loTest.ListColumns.Count).Range.Column &amp; ” (” &amp; loTest.ListColumns(loTest.ListColumns.Count) &amp; “)”</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">MsgBox sMsg, vbInformation, UCase(sTableName)</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">End Sub</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Row count</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Again, no loop, just find out how many rows are in the table and where they are.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Sub Table_CountRows()</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">On Error Resume Next<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loTest = WS.ListObjects(sTableName)<br />On Error GoTo 0</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">If WS Is Nothing Or loTest Is Nothing Then<br />MsgBox “There was an error setting the variables.”, vbInformation, “ERROR!”<br />Exit Sub<br />End If</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">sMsg = “There are ” &amp; loTest.ListRows.Count &amp; ” rows in ‘” &amp; sTableName &amp; “‘.”<br />sMsg = sMsg &amp; DNL &amp; “Starting on row ” &amp; loTest.ListRows(1).Range.Row<br />sMsg = sMsg &amp; NL &amp; “Ending on row ” &amp; loTest.ListRows(loTest.ListRows.Count).Range.Row</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">MsgBox sMsg, vbInformation, UCase(sTableName)</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">End Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Resizing Tables</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Resize table based on original</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This will basically clear out the manual data and leave the formulas. It gets a row count and uses that to insert rows to its original size. Please note these focus on resizing rows programmatically, not columns, which can be trickier.</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub ResizeTableRows() </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loSet = WS.ListObjects(sTableName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Ensure the table has a data range<br />If loSet.DataBodyRange Is Nothing Then<br />MsgBox “The source table has no data stucture.”, vbExclamation, “ERROR!”<br />Exit Sub<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Get the number of rows in the table<br />iRowCnt = loSet.ListRows.Count </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Delete destination table data<br />If Not loSet.DataBodyRange Is Nothing Then<br />loSet.DataBodyRange.Delete<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Resize to source table size<br />For iStep = 1 To iRowCnt<br />loSet.ListRows.Add iStep<br />Next iStep </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘///////////////////////////////////////////////////////////////////////////<br />‘/// At this point the table is restructured, and the formulas which were<br />‘/// there are re-populated<br />‘/////////////////////////////////////////////////////////////////////////// </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Resize table based on another tables size (in rows)</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This utilizes two tables. The second table is only used for its row size and makes the first table the same size. It deletes the DataBodyRange as well, so all manual data will be erased, leaving only formulas.</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub ResizeTableRowsBasedOnAnother() </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set two tables, one to set (destination)<br />‘/// and one to resize from (source)<br />Set loSet = WS.ListObjects(sTableName)<br />Set loGet = WS.ListObjects(sTableName2) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Delete destination table data<br />If Not loSet.DataBodyRange Is Nothing Then<br />loSet.DataBodyRange.Delete<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Ensure source table has data range<br />If loGet.DataBodyRange Is Nothing Then<br />MsgBox “The source table has no data stucture.”, vbExclamation, “ERROR!”<br />Exit Sub<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Resize to source table size<br />For iStep = 1 To loGet.ListRows.Count<br />loSet.ListRows.Add iStep<br />Next iStep </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘///////////////////////////////////////////////////////////////////////////<br />‘/// At this point the table is restructured, and the formulas which were<br />‘/// there are re-populated<br />‘/////////////////////////////////////////////////////////////////////////// </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Resize table columns</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This example will add a single column. While I am very hesitant to code something like this, here is an example. While it’s easier to add rows, adding columns present some unique problems, which include:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Where should the columns be inserted?</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Without proper absolute structured formula referencing, this could throw off formulas</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Ideally no data should be to the right of the table, so an error won’t be thrown.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub ResizeTableCols() </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loSet = WS.ListObjects(sTableName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Ensure the table has a data range<br />If loSet.DataBodyRange Is Nothing Then<br />MsgBox “The source table has no data stucture.”, vbExclamation, “ERROR!”<br />Exit Sub<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Get the number of columns in the table, add one<br />iColCnt = loSet.ListColumns.Count + 1 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Delete destination table data<br />If Not loSet.DataBodyRange Is Nothing Then<br />loSet.DataBodyRange.Delete<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Resize to source table size<br />On Error Resume Next<br />For iStep = 1 To iColCnt<br />If loSet.ListColumns(iStep) Is Nothing Then<br />Err.Clear<br />loSet.ListColumns.Add<br />If Err.Number &gt; 0 Then<br />‘something prevented the column from being added<br />Exit For<br />End If<br />End If<br />Next iStep<br />On Error GoTo 0 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘///////////////////////////////////////////////////////////////////////////<br />‘/// At this point the table is restructured, and the formulas which were<br />‘/// there are re-populated<br />‘/////////////////////////////////////////////////////////////////////////// </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Select table parts</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Table ranges</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">It’s always best to work with actual table range referernces. While you can access the range object of the underlying worksheet, it gets tough. This shows an example.</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub ListTableParts() </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loSet = WS.ListObjects(sTableName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">If loSet.DataBodyRange Is Nothing Then<br />If MsgBox(“Data range has been deleted. Create now?”, vbYesNo, “ERROR!”) = vbYes Then<br />loSet.ListRows.Add 1<br />End If<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Using standard table referencing objects<br />sMsg = “Standard table referencing” &amp; DNL<br />If Not loSet.DataBodyRange Is Nothing Then<br />sMsg = sMsg &amp; “Data range: ” &amp; loSet.DataBodyRange.Address(0, 0) &amp; NL<br />End If<br />If Not loSet.HeaderRowRange Is Nothing Then<br />sMsg = sMsg &amp; “Header range: ” &amp; loSet.HeaderRowRange.Address(0, 0) &amp; NL<br />Else<br />sMsg = sMsg &amp; “Header range: (none set)” &amp; NL<br />End If<br />If Not loSet.TotalsRowRange Is Nothing Then<br />sMsg = sMsg &amp; “Totals range: ” &amp; loSet.TotalsRowRange.Address(0, 0) &amp; NL<br />Else<br />sMsg = sMsg &amp; “Totals range: (none set)”<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Using range referencing objects<br />sMsg = sMsg &amp; DNL &amp; “Range referencing” &amp; NL<br />If Not loSet.DataBodyRange Is Nothing Then<br />sMsg = sMsg &amp; “Data range: ” &amp; loSet.Range(1, 1).Address(0, 0) &amp; “:” &amp; loSet.Range(loSet.Range.Rows.Count, loSet.Range.Columns.Count).Address(0, 0) &amp; NL<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">MsgBox sMsg, vbInformation, “INFO” </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Select table Header</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This selects just the header range of the table, if it is showing. If it’s not showing the user gets the option to show it at that time.</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub SelectHeader() </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loSet = WS.ListObjects(sTableName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">If Not loSet.HeaderRowRange Is Nothing Then<br />loSet.HeaderRowRange.Select<br />Else<br />If MsgBox(“Header row isn’t showing. Show now?”, vbYesNo, “ERROR!”) = vbYes Then<br />loSet.ShowHeaders = True<br />End If<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Select table data</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This selects just the data range of the table, if it is not deleted. If it’s not there the user gets the option to add it at that time.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">NOTE: Adding a data body (DataBodyRange) to a table is as simple as inserting a row. This is quite a useful trick when working with tables via VBA.</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub SelectData() </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loSet = WS.ListObjects(sTableName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">If Not loSet.DataBodyRange Is Nothing Then<br />loSet.DataBodyRange.Select<br />Else<br />If MsgBox(“Data range has been deleted. Create now?”, vbYesNo, “ERROR!”) = vbYes Then<br />loSet.ListRows.Add 1<br />End If<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Select table Totals row</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This selects just the totals row range of the table, if it is showing. If it’s not showing the user gets the option to show it at that time.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub SelectTotalRow() </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loSet = WS.ListObjects(sTableName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">If Not loSet.TotalsRowRange Is Nothing Then<br />loSet.TotalsRowRange.Select<br />Else<br />If MsgBox(“Totals row isn’t showing. Show now?”, vbYesNo, “ERROR!”) = vbYes Then<br />loSet.ShowTotals = True<br />End If<br />End If </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Show table parts</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">This routine has a Boolean (True/False) variable passed to it to turn on or off all table parts (non-formatting)</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub ShowTableParts(Optional ByVal bState As Boolean = True) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">‘/// Set misc variables<br />Set WS = ThisWorkbook.Worksheets(sSheetName)<br />Set loSet = WS.ListObjects(sTableName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">loSet.ShowTotals = bState<br />loSet.ShowHeaders = bState<br />If bState = True Then loSet.ShowAutoFilter = bState </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End Sub </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Note that the ShowAutoFilter portion only runs if a True variable is passed (turning properties on). This is because if you turn off the header row, there’s nothing to filter on, so there’s no need to worry about it.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Summary</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">The important parts of the object model to look at with respect to tables are:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">ListObject</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">DataBodyRange</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">HeaderRowRange</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">TotalsRowRange</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">ListRows</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">ListColumns</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">There are other things you can do with tables via VBA, this certainly isn’t the complete guide. Some of those things include:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Work with slicers *</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Unlist it (convert to standard range)</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol'; font-size:10pt;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">                    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Set style/formatting options</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600;">Additional information</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Jan Karel Pieterse: </span><a href="http://www.jkp-ads.com/articles/Excel2007Tables.asp"><span style=" font-family:'DejaVu Sans,serif'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://www.jkp-ads.com/articles/Excel2007Tables.asp</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Colin Legg: </span><a href="http://colinlegg.wordpress.com/2012/09/01/clearing-excel-tables/"><span style=" font-family:'DejaVu Sans,serif'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://colinlegg.wordpress.com/2012/09/01/clearing-excel-tables/</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">Sample file for download: </span><a href="http://excelandaccess.files.wordpress.com/2013/01/tblexample.xlsb"><span style=" font-family:'DejaVu Sans,serif'; font-size:11pt; text-decoration: underline; color:#0000ff;">tblExample</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">File tested and works in Excel 2010 and 2013 without issue.</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">A special thanks to Chris “Smitty” Smith, Christopher T. Fennell and Colin Legg, equally for the direction, support and inspiration for this blog post. Thank you.</span> </p></body></html>