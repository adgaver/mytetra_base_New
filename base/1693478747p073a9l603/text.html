<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">Первым делом определим откуда запущенно приложение. У обьекта Application есть свойства path</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> которое и позволит нам получить информацию.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> Test</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    MsgBox </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">Application.Path</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">Команды создания и удаления каталогов очень похожи на DOS аналоги. Это MkDir и RmDir. Ниже создаем каталог на диске С.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> Test</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    MkDir </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#808080;">&quot;c:\test&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">И удаляем.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> Test</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    RmDir </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#808080;">&quot;c:\test&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">А вот теперь важный вопрос. Помещается ли удаленный каталог в корзину. Нет не помещается. Это очень возмутительно. Почему </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">????</span><span style=" font-family:'Courier New'; color:#000000;"> Ведь программа создана для Windows c использованием среды разработки от Microsoft и такое возмутительное безобразие. Ладно Linux им судья. Для того</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> чтобы убедиться в этом запустите следующий код и загляните в корзину.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> Test</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    MkDir </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#808080;">&quot;c:\test&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    RmDir </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#808080;">&quot;c:\test&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">Для получения текущего каталога есть функция CurDir.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> Test</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    MsgBox </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">CurDir</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">Для того</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> чтобы сменить каталог тоже есть функция </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;"> chdir</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> Test</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    ChDir </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#808080;">&quot;c:\windows&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    MsgBox </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">CurDir</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">Команда dir позволяет просмотреть все файлы в каталоге. Только использование её несколько специфично. Сначала Вы вызываете dir с параметрами и получаете первое имя файла</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> в дальнейшем можно вызвать её без параметров и получить следующее имя и так до тех пор</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> пока не вернется пустое имя файла.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; color:#000000;"> Test</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; color:#000000;"> s </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    s </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> Dir</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#808080;">&quot;c:\windows\inf\*.*&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    Debug.Print s</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Do</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">While</span><span style=" font-family:'Courier New'; color:#000000;"> s </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">&lt;&gt;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#808080;">&quot;&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">        s </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> Dir</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">        Debug.Print s</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Loop</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#000000;">Результат работы в Окне отладки </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">Ctrl</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;">G</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>