<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так же не помешает проверить наличие лишних ссылок и среди проверки данных(<a href="https://www.excel-vba.ru/chto-umeet-excel/proverka-dannyx/"><span style=" text-decoration: underline; color:#0000ff;">Что такое проверка данных</span></a>). Как правило связи могут быть в проверке данных с типом Список. Но как их отыскать, если проверка данных распространена на множество ячеек? Проверять каждую? Это очень долго. Поэтому я предлагаю коротенький код, который отыщет все такие ссылки быстрее и сэкономит время): </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Option</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Explicit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">' Author : The_Prist(Щербаков Дмитрий)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'          Профессиональная разработка приложений для MS Office любой сложности</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'          Проведение тренингов по MS Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'          https://www.excel-vba.ru</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'          info@excel-vba.ru</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'          WebMoney - R298726502453; Яндекс.Деньги - 41001332272872</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">' Purpose:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Sub</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> FindErrLink()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'надо посмотреть в Данные -Изменить связи ссылку на файл-иточник</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'и записать сюда ключевые слова в нижнем регистре(часть имени файла)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'звездочка просто заменяет любое кол-во символов, чтобы не париться с точным названием</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    Const sToFndLink$ = </span><span style=" font-family:'monospace'; font-size:14px; color:#800000;">&quot;*продажи 2018*&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Dim</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rr </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> Range, rc </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> Range, rres </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> Range, s$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'определяем все ячейки с проверкой данных</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">On</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Error</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Resume</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rr = ActiveSheet.UsedRange.SpecialCells(xlCellTypeAllValidation)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rr </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Is</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#00c2ff;">Nothing</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        MsgBox </span><span style=" font-family:'monospace'; font-size:14px; color:#800000;">&quot;На активном листе нет ячеек с проверкой данных&quot;</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">, vbInformation, </span><span style=" font-family:'monospace'; font-size:14px; color:#800000;">&quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Exit</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">On</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Error</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">GoTo</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'проверяем каждую ячейку на предмет наличия связей</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">For</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Each</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rc </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">In</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rr</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'на всякий случай пропускаем ошибки - такое тоже может быть</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'но наши связи должны быть без них и они точно отыщутся</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        s = </span><span style=" font-family:'monospace'; font-size:14px; color:#800000;">&quot;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">On</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Error</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Resume</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        s = rc.Validation.Formula1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">On</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Error</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">GoTo</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'нашли - собираем все в отдельный диапазон</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> LCase(s) </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Like</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> sToFndLink </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">            </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rres </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Is</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#00c2ff;">Nothing</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">                </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rres = rc</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">            </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">                </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rres = Union(rc, rres)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">            </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'если связь есть - выделяем все ячейки с такими проверками данных</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Not</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> rres </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Is</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#00c2ff;">Nothing</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">        rres.</span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Select</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'        rres.Interior.Color = vbRed 'если надо выделить еще и цветом</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'monospace'; font-size:14px; font-weight:296; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717; background-color:transparent;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717; background-color:transparent;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Есть пара нюансов:<br />1. Прежде чем искать ненужную связь необходимо определить её ссылку: Данные -Изменить связи. Запомнить имя файла и записать в этой строке внутри кавычек:<br />Const sToFndLink$ = &quot;*продажи 2018*&quot;<br />Имя файла можно записать не полностью, все пробелы и другие символы можно заменить звездочкой дабы не ошибиться. Текст внутри кавычек должен быть в нижнем регистре. Например, на картинках выше есть связь с файлом &quot;Продажи 2018.xlsx&quot;, но я внутри кода записал &quot;*продажи 2018*&quot; - будет найдена любая связь, в имени которой есть &quot;продажи 2018&quot;.<br />2. Код ищет проверки данных только на активном листе<br />3. Код только выделяет все найденные ячейки(обычное выделение), он ничего сам не удаляет.<br />4. Если надо подсветить ячейки цветом - достаточно убрать апостроф(') перед строкой<br />rres.Interior.Color = vbRed 'если надо выделить еще и цветом</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как правило после описанных выше действий лишних связей остаться не должно. Но если вдруг связи остались и найти Вы их никак не можете или по каким-то причинам разорвать связи не получается(например, лист со связью защищен)- можно пойти совершенно иным путем. Действует этот рецепт только для файлов новых форматов Excel 2007 и выше:<br />1. Обязательно делаем резервную копию файла, связи в котором никак не хотят разрываться<br />2. Открываем файл при помощи любого архиватора(WinRAR отлично справляется, но это может быть и другой, работающий с форматом ZIP)<br />3. В архиве перейти в папку xl -&gt; externalLinks<br />4. Сколько связей содержится в файле, столько файлов вида externalLink1.xml и будет внутри. Файлы просто пронумерованы и никаких сведений о том, к какому конкретному файлу относится эта связь на поверхности нет. Чтобы узнать какой файл .xml к какой связи относится надо зайти в папку &quot;_rels&quot; и открыть там каждый из имеющихся файлов вида externalLink1.xml.rels. Там и будет содержаться имя файла-источника.<br />5. Если надо удалить только связь на конкретный файл - удаляем только те externalLink1.xml.rels и externalLink1.xml, которые относятся к нему. Если удалить надо все связи - удаляем все содержимое папки externalLinks<br />6. Закрываем архив<br />7. Открываем файл в Excel. Появится сообщение об ошибке вроде &quot;Ошибка в части содержимого в Книге ...&quot;. Соглашаемся. Появится еще одно окно с перечислением ошибочного содержимого. Нажимаем закрыть.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После этого связи должны быть удалены.</p></body></html>