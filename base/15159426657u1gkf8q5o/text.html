<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9. Классы </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#000000;">9.1. Несколько слов об именах и объектах </span></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.2. Области видимости и пространства имен в Python </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.2.1. Примеры областей видимости и пространств имен </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.3. Первый взгляд на классы </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.3.1. Синтаксис определения класса </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.3.2. Объекты класса </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.3.3. Экземплярные объекты </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.3.4. Методы объектов </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.3.5. Переменные класса и экземпляра </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.4. Некоторые замечания </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.5. Наследование </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.5.1. Множественное наследование </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.6. Приватные переменные </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.7. Различные заметки </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.8. Итераторы </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.9. Генераторы </li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9.10. Выражения генераторов</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:9pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">По сравнению с другими языками программирования, механизм классов Python добавляет классы с минимумом нового синтаксиса и семантики. Это смесь механизмов класса похожая на C++ и Modula-3. Классы Python предоставляют все стандартные возможности объектно-ориентированного программирования: механизм наследования классов позволяет использовать несколько базовых классов, производный класс может переопределить любые методы своего базового класса или классов, а метод может вызвать метод базового класса с тем же именем. Объекты могут содержать произвольные количество и типы данных. Как и в случае модулей, классы используют динамическую природу Python: они создаются во время выполнения и могут быть изменены в дальнейшем после создания. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">В терминологии C++ обычно члены класса (в том числе данные) являются </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">public</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> (кроме см. ниже </span><a href="http://pythoner.name/documentation/tutorial/classes#private-variables"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">Приватные переменные</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">), а все функции-члены являются </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">virtual</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Как и в Modula-3 отсутствуют сокращения для привязок (referencing) членов объекта из его методов: метод-функция объявляется с явным первым аргументом, представляющим объект, который неявно предоставляется вызовом. Как и в Smalltalk, классы сами являются объектами. Это обеспечивает семантику для импортирования и переименования. В отличие от C++ и Modula-3, встроенные типы могут быть использованы как базовые классы для расширения их пользователем. Также как и в C++ большинство встроенных операторов со специальным синтаксисом (арифметические операторы, индексирование и т.д.) могут быть переопределены для экземпляров класса. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">(Из-за отсутствия общепринятой терминологии при разговоре о классах, я буду время от времени использовать термины Smalltalk и C++. Я хотел бы использовать терминологию Modula-3, так как его объектно-ориентированная семантика ближе к Python, чем C++, но мне кажется, что только некоторые читатели слышали о нем.) </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="a-word-about-names-and-objects"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.1. Несколько слов об именах и объектах</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">У объектов есть индивидуальность, и несколько имен (в несколько областях видимости) могут быть связаны с одним и тем же объектом. Это известно как использование псевдонимов (aliasing) в других языках. Обычно это не принимается во внимание при первом знакомстве с Python, и это можно спокойно игнорировать при работе с неизменными основными типами (числами, строками, кортежами). С другой стороны, использование псевдонимов предоставляет возможность неожиданного эффекта от семантики кода Python с участием изменяемых объектов, таких как списки, словари и множества других типов. Это обычно несет пользу для программы, так как псевдонимы в некоторых отношениях ведут себя как указатели. Например, передать объект легче, так как реализацией передается только указатель; и если функция изменяет объект, переданный в качестве аргумента, в вызывающей части кода будут наблюдаться изменения - это устраняет необходимость для двух различных механизмов передачи параметров как в Pascal. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="python-scopes-and-namespaces"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.2. Области видимости и пространства имен в Python</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Перед введением в классы, сначала необходимо кое-что сказать о правилах областей видимости в Python. Определения классов выполняют небольшие аккуратные трюки с пространствами имен, и вы должны знать, как работают области видимости и пространства имен, чтобы хорошо понимать, что происходит. Кстати, знания в этой области полезны для любого продвинутого программиста на Python. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Давайте начнем с некоторых определений. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">namespace</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> (пространство имен) представляет собой отображение имен на объекты. Большинство пространств имен в настоящее время реализованы как словари Python, но в любом случае это обычно не заметно (за исключением производительности), и это может измениться в будущем. Примеры пространств имен: множество встроенных имен (содержащие такие функции, как abs() (docs.python.org/3/library/functions.html#abs) и встроенные имена исключений); глобальные имена в модуле и локальные имена в вызове функции. В определенном смысле набор атрибутов объекта также образует пространство имен. Важная деталь в знаниях о пространствах имен заключается в том, что нет абсолютно никакой связи между именами в разных пространствах; например, в двух различных модулях может быть определена функция </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">maximize</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, и это не создаст путаницы - пользователи модулей должны использовать префикс в виде имени модуля перед именем функции. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Кстати, слово </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">attribute</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> я использую для любого имени после точки - например, в выражении </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">z.real</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">real</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является атрибутом объекта </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">z</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Строго говоря, ссылки на имена в модулях - это ссылки атрибутов: в выражении </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">modname.funcname</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">modname</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> - это объект модуля, а </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">funcname</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является его атрибутом. В этом случае существует простое отображение между атрибутами модуля и глобальными именами, определенными в модуле: они разделяют одно и то же пространство имен! </span><a name="id1"></a><a href="http://pythoner.name/documentation/tutorial/classes#id11"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">[</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">1]</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Атрибуты могут быть только для чтения или изменяемыми. В последнем случае, возможно присвоение атрибутов. Атрибуты модуля доступны для записи: вы можете написать </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">modname.the_answer = 42</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Записываемые атрибуты могут также быть удалены с помощью оператора del (docs.python.org/3/reference/simple_stmts.html#del). Например, </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">del modname.the_answer</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> удалит атрибут </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">the_answer</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> у объекта </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">modname</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Пространства имен создаются в различные моменты времени и имеют разные периоды жизни. Пространство, содержащее встроенные имена, создается, когда запускается интерпретатор Python, и никогда не удаляется. Глобальное пространство имен для модуля создается, когда определение модуля считывается; обычно пространство имен модуля также существует до выхода из интерпретатора. Операторы, выполняющиеся на высшем уровне вызова интерпретатора, либо читающиеся из файла скрипта или интерактивно, рассматриваются как часть модуля под названием __main__ (docs.python.org/3/library/__main__.html#module-__main__), поэтому они имеют свое собственные глобального пространство имен. (Встроенные имен на самом деле находятся в модуле, который называется builtins (docs.python.org/3/library/builtins.html#module-builtins).) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Локальное пространство имен функции создается при ее вызове и удаляется, когда функция возвращает управление или вызывает исключение, которое не обрабатывается внутри нее. (Действительно, забывчивость была бы лучшим способом описать то, что происходит на самом деле.) Конечно, рекурсивные вызовы имеют свои собственные локальные имена. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">scope (область видимости) является буквальной областью Python-программы, где непосредственно доступно пространство имен. &quot;Непосредственно доступно&quot; здесь означает, что &quot;неспецифическая&quot; ссылка на имя пытается найти имя в пространстве имен. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Хотя области (scopes) определяются статически, но используются динамически. В любое время выполнения есть по крайней мере три вложенные области видимости, чьи пространства имен доступны сразу: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">внутренняя область видимости, которая просматривается в первую очередь, содержит локальные имена </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">область любых ограждающих функций, которая просматривается, начиная с ближайшей области видимости, содержит нелокальные, но и неглобальные имена </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">предпоследняя область видимости включает глобальные имена текущего модуля </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">внешняя область (исследуется последней) является пространством имен, содержащем встроенные имена</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Если имя объявлено как глобальное, то все ссылки и присвоения переходят непосредственно к средней области видимости, содержащей глобальные имена модуля. Для переназначения переменных, находящихся вне внутренней области видимости, может быть использован оператор nonlocal (docs.python.org/3/reference/simple_stmts.html#nonlocal); если такого объявления нет, эти переменные доступны только для чтения (попытка записи в такую переменную будет просто создавать новую локальную переменную в самой внутренней области видимости, в результате чего внешняя переменная с таким же именем остается без изменений). </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Обычно локальная область ссылается на локальные имена (текстуально) текущей функции. Вне функций ссылки локальной области - то же самое, что пространство имен глобальной области: пространство имен модуля. Определения классов размещают еще одно пространство имен в локальной области. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Важно понимать, что области видимости определяются текстуально: глобальная область функции, определенной в модуле, есть пространство имен этого модуля, независимо от того, где и под каким псевдонимом вызывается функция. С другой стороны, фактический поиск имен производится динамически, во время выполнения. Тем не менее, определение языка развивается в сторону статического разрешения имен, ко времени &quot;компиляции&quot;, так что не полагайтесь на динамическое разрешение имен! (На самом деле, локальные переменные уже определены статически.) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Специальная причуда Python - если нет оператора global, присвоения имен всегда идут в самые внутренние области. Присваивания не копируют данные - они просто связывают имена с объектами. То же самое верно для удалений: оператор del x убирает привязку х из пространства имен, на которые ссылается локальная область видимости. На самом деле все операции, которые вводят новые имена используют локальную область: в частности, оператор import (docs.python.org/3/reference/simple_stmts.html#import) и определения функций связывают модуль или имя функции в локальной области видимости. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Оператор global может быть использован для указания, какие определенные переменные находятся в глобальной области и должны быть отосланы туда; оператор nonlocal указывает, что некоторые переменные находятся в огражденной области видимости и должны быть отосланы туда. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="scopes-and-namespaces-example"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.2.1. Пример областей видимости (scopes) и пространств имен (namespaces)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Это пример демонстрирует, как ссылаться на различные области и пространства имен, и как global и nonlocal влияют на связывание переменных: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">def scope_test():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def do_local():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        spam = &quot;local spam&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def do_nonlocal():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        nonlocal spam</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        spam = &quot;nonlocal spam&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def do_global():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        global spam</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        spam = &quot;global spam&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    spam = &quot;test spam&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    do_local()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(&quot;After local assignment:&quot;, spam)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    do_nonlocal()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(&quot;After nonlocal assignment:&quot;, spam)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    do_global()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(&quot;After global assignment:&quot;, spam)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">scope_test()</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">print(&quot;In global scope:&quot;, spam)</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Вывод данного примера будет таким: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">After local assignment: test spam</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">After nonlocal assignment: nonlocal spam</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">After global assignment: nonlocal spam</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">In global scope: global spam</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Заметьте, что присвоение local (которое происходит по умолчанию) не изменило связывания spam в scope_test. Присвоение nonlocal изменило связывание spam в scope_test, и присвоение global изменило связывание до уровня модуля. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Вы также можете видеть, что не было никакого предварительного связывания spam до присваивания global. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="tut-firstclasses"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.3. Первый взгляд на классы</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Классы вводят немного нового синтаксиса, три новых объектных типа и некоторую новую семантику. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="class-definition-syntax"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.3.1. Синтаксис определения класса</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Простейшая форма определения класса выглядит следующим образом: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class ClassName:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &lt;statement-1&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &lt;statement-N&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Определения классов, как и определения функций (операторы def (docs.python.org/3/reference/compound_stmts.html#def)), должны быть выполнены до их вызова. (Предположительно вы может поместить определение класса в ветке оператора if (docs.python.org/3/reference/compound_stmts.html#if) или внутри функции.) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">На практике операторы внутри определения класса, как правило, будут определениями функций, но другие выражения разрешены также, а иногда и полезны - мы вернемся к этому позже. Определения функций внутри класса обычно имеют своеобразную форму списка аргументов, продиктованную соглашениями по вызову методов - опять же, это объясняется позже. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Когда определение класса введено, создается новое пространство имен и используется в качестве локальной области видимости - поэтому все присваивания локальным переменным происходят в этом новом пространстве имен. В частности определения функций связываются с именем новой функции здесь. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Когда определение класса остается обычным (через завершение), создается объект класса. В основном это обертка вокруг содержимого пространства имен, созданного определением класса; мы узнаем больше об объектах класса в следующем разделе. Первоначальная локальная область видимости (в действительности она была введена как раз перед определением класса) будет восстановлена​​, и объект класса связан здесь с именем класса, данным в заголовке определения класса (ClassName в примере). </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="class-objects"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.3.2. Объекты класса</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Объекты класса поддерживают два вида операций: ссылки на атрибуты и экземпляры. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Ссылки на атрибуты используют стандартный синтаксис, используемый для всех ссылок на атрибуты в Python: </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">obj.name</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Допустимыми именами атрибутов являются все имена, которые были в пространстве имен класса, когда был создан объект класса. Таким образом, если определение класса выглядит так: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class MyClass:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &quot;&quot;&quot;A simple example class&quot;&quot;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    i = 12345</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def f(self):</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        return 'hello world'</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">тогда </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass.i</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass.f</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> правильные ссылки на атрибуты, возвращающие целое число и объект-функцию соответственно. Атрибуты класса также могут быть назначены, так что вы можете изменить значение </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass.i</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> с помощью присвоения. </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__doc__</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> также является доступным атрибутом, возвращающим строку документации, принадлежащей классу: </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">&quot;A simple example class&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Экземпляр класса использует нотацию в виде функции. Просто делается вид, что объект класса - это функция без параметров, которая возвращает новый экземпляр класса. Например (предполагая, класс выше): </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">x = MyClass()</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">создается новый экземпляр класса, и этот объект присваивается локальной переменной </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">х</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Операция создания экземпляра (вызов объекта класса) создает пустой объект. Многие классы при создании экземпляров настроены на определенное исходное состояние. Поэтому в классе может быть определен специальный метод с именем </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__init__()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> (docs.python.org/3/reference/datamodel.html#object.__init__), например: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">def __init__(self):</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    self.data = []</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Если класс определяет метод __init__(), он автоматически вызывается при создании экземпляра класса. В данном примере новый инициализированный экземпляр может быть получен так: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">x = MyClass()</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Конечно, для большей гибкости метод  </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__init__()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> может иметь аргументы. В этом случае аргументы, переданные оператору создания экземпляра класса, передаются в </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__init__()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Пример: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; class Complex:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...     def __init__(self, realpart, imagpart):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...         self.r = realpart</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...         self.i = imagpart</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; x = Complex(3.0, -4.5)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; x.r, x.i</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">(3.0, -4.5)</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="instance-objects"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.3.3. Объекты экземпляров</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Теперь что мы можем делать с объектами экземпляров? Допустимы только операции, представляющие собой ссылки на атрибуты объекта. Есть два вида допустимых имен атрибутов, атрибуты данных и методы. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">data attributes</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> (атрибуты данных) соответствуют &quot;переменным экземпляра&quot; в Smalltalk, а также &quot;элементам данных&quot; в C++. Нет необходимости объявлять атрибуты данных; как локальные переменные, они начинают существовать, когда им впервые происходит присваивание. Например, если </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">х</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является экземпляром </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, созданного выше, следующий фрагмент кода выведет значение 16: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.counter = 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">while x.counter &lt; 10:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    x.counter = x.counter * 2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">print(x.counter)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">del x.counter</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Другой вид ссылки на атрибут экземпляра - это </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">method</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Метод является функцией, которая &quot;принадлежит&quot; объекту. (В Python, термин метод не является уникальным для экземпляров класса: другие типы объектов также могут иметь методы. Например, объекты списка имеют методы, называемые append, insert, remove, sort (добавление, вставка, удаление, сортировка) и т. д. Тем не менее в последующем обсуждении мы будем использовать термин </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">метод</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> исключительно для обозначения методов объектов-экземпляров класса, если явно не указано иное.) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Допустимые имена методов объекта-экземпляра зависят от его класса. По определению, все атрибуты класса, которые являются объектами-функциями, определяют соответствующие методы его экземпляров. Так в нашем примере, </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.f</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является допустимой ссылкой-методом, так как </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass.f</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является функцией, но не </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.i</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, так как </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass.i</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> не является. Но </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.f</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> - это не то же самое, что и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass.f</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> - это метод-объект, а не функция-объект. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="method-objects"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.3.4. Объекты метода</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Обычно метод вызывается сразу после точки: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.f()</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">В </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, например, такой вызов вернет строку </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">'hello world'</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Тем не менее, нет необходимости вызывать метод сразу: </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.f</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является методом- объектом, и может быть сохранен в &quot;стороне&quot; и вызываться позже. Например: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">xf = x.f</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">while True:</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(xf())</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">будет продолжать выводить </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">hello world</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> до конца времени. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Что именно происходит, когда вызывается метод? Вы могли заметить, выше </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.f()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> был вызван без аргумента, при том, что в определении функции </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">f()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> указывается аргумент. Что случилось с аргументом? Конечно Python генерирует исключение, когда функция, которая требует аргумент вызывается без него - даже если аргумент фактически не используется... </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">На самом деле, вы могли уже догадаться: особенность метода в том, что объект передается в качестве первого аргумента функции. В нашем примере вызов </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">x.f()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> в точности эквивалентно </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">MyClass.f(х)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. В общем, вызов метода со списком </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">n</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> аргументов эквивалентен вызову соответствующей функции со списком аргументов, который создается путем введения объекта метода перед первым аргументом. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Если вы все еще не понимаете, как работают методы, взгляд на реализацию, возможно прояснит ситуацию. Когда ссылаются на атрибут экземпляра, который не является атрибутом данных, ищется его класс. Если имя обозначает действительный атрибут класса, который является объектом-функцией, метод-объект создается упаковкой (указателями на) объект-экземпляр и объект-функцию только что вошедших вместе в абстрактный объект: это метод-объект. Когда объект метода вызывается со списком аргументов, новый список аргументов строится из объекта-экземпляра и списка аргументов, и объект-функция вызывается с этим новым списком аргументов. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="class-and-instance-variables"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.3.5. Переменные класса и экземпляра</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Вообще говоря, данные переменных экземпляра уникальны для каждого экземпляра, а атрибуты и функции переменных класса разделяются всеми экземплярами класса: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class Dog:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    kind = 'canine'         # переменная класса разделяется всеми экземплярами</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __init__(self, name):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.name = name    # переменная экземпляра уникальна для каждого</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d = Dog('Fido')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e = Dog('Buddy')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d.kind                  # разделяется всеми собаками</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">'canine'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e.kind                  # разделяется всеми собаками</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">'canine'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d.name                  # уникальна для d</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">'Fido'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e.name                  # уникальна для e</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">'Buddy</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Как уже говорилось в разделе 9.1., разделяемые данные могут иметь возможно неожиданные эффекты в случае привлечения изменяемых (docs.python.org/3/glossary.html#term-mutable) объектов, таких как списки и словари. Например, список tricks в следующем коде не должен быть использован как переменная класса просто потому, что единственный список будет разделяться всеми экземплярами Dog: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class Dog:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    tricks = []             # ошибочное использование переменной класса</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __init__(self, name):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.name = name</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def add_trick(self, trick):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.tricks.append(trick)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d = Dog('Fido')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e = Dog('Buddy')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d.add_trick('roll over')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e.add_trick('play dead')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d.tricks                # неожиданно разделяется всеми собаками</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">['roll over', 'play dead']</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Вместо этого в корректной разработке класса следует использовать переменную экземпляра: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class Dog:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __init__(self, name):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.name = name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.tricks = []    # создает новый пустой список для каждой собаки</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def add_trick(self, trick):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.tricks.append(trick)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d = Dog('Fido')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e = Dog('Buddy')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d.add_trick('roll over')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e.add_trick('play dead')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; d.tricks</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">['roll over']</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; e.tricks</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">['play dead']</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="random-remarks"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.4. Некоторые замечания</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Атрибуты данных переопределяют атрибуты метода с тем же именем; чтобы избежать случайных конфликтов имен, которые могут привести к трудно обнаруживаемым ошибкам в больших программах, имеет смысл использовать какое-либо соглашение, которое свело бы к минимуму вероятность подобных конфликтов. Это может быть использование большой первой буквы для имен методов, предварение имен атрибутов данных небольшой уникальной строкой (возможно, просто подчеркивание), или использование глаголов для методов и существительных для атрибутов данных. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">На атрибуты данных могут ссылаться методы, а также обычные пользовательские (&quot;клиенты&quot;) объекты. Другими словами, классы не могут быть использованы для реализации чисто абстрактных типов данных. На самом деле ничто в Python не позволяет обеспечить соблюдение сокрытия данных - все что есть основано лишь на соглашениях. (С другой стороны, реализация Python, написанная на C, может полностью скрыть детали реализации и контроль доступа к объекту при необходимости; это может быть использовано расширениями Python, написанными на C.) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Клиенты должны использовать атрибуты данных с осторожностью - клиенты могут испортить постоянные, поддерживаемые методами, &quot;штампуя&quot; на их атрибуты данных. Обратите внимание, что клиенты могут добавить свои атрибуты данных экземплярному объекту без использования существующих методов до тех пор, пока не возникает конфликта имен; - опять же, соглашение об именах позволит избежать головной боли. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Не существует сокращений для того, чтобы сослаться на атрибуты данных (или другие методы!) изнутри методов. Я считаю, что это на самом деле повышает удобство чтения методов: нет шансов запутаться в локальных переменных и переменных экземпляра, когда просматриваешь методы. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Часто первый аргумент метода называется </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">self</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Это не более, чем соглашение: имя </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">self</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> не имеет абсолютно никакого особого значение для Python. Однако следует отметить, что если не следовать соглашению, то ваш код может быть менее читаемым для других программистов Python, и также возможно, что класс browser программы может быть написан, полагаясь на такое соглашение. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Любой объект-функция, которая является атрибутом класса, определяет метод для экземпляров этого класса. Не обязательно, чтобы определение функции текстуально заключалось в определении класса: присваивание объекта-функции локальной переменной в классе также возможно. Например: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"># Функция определяется вне класса</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">def f1(self, x, y):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    return min(x, x+y)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class C:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    f = f1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def g(self):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        return 'hello world'</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    h = g</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Теперь и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">f</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">g</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">h</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> являются атрибутами класса C, который ссылается на функции-объекты, и, следовательно, все они являются методами экземпляров класса C - </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">h</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> есть точный эквивалент </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">g</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Обратите внимание, что эта практика, как правило, способна лишь запутать читателя программы. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Методы могут вызывать другие методы путем использования аргумента </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">self</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class Bag:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __init__(self):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.data = []</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def add(self, x):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.data.append(x)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def addtwice(self, x):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.add(x)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.add(x)</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Методы могут ссылаться на глобальные имена также, как и обычные функции. Глобальная область видимости, ассоциированная с методом, есть модуль, содержащий его определение. (Класс никогда не используется как глобальная область). Поскольку это редко встречается, то это хороший повод для использования глобальных данных в методе, есть много уместных использований глобальной области: с одной стороны, функции и модули, импортированные в глобальную область видимости, могут использоваться методами также как функциями и классами, определенными здесь. Как правило, класс, содержащий метод, сам по себе определяется в этой глобальной области видимости, и в следующем разделе мы найдем несколько хороших причин, почему метод хотел бы ссылаться на свой собственный класс. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Каждое значение является объектом, и поэтому имеет класс (также называемый его типом). Он хранится как </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">object.__class__</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="inheritance"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.5. Наследование</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Несомненно свойство языка не имела бы право называться &quot;классом&quot; без поддержки наследования. Синтаксис для определения производного класса выглядит следующим образом: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class DerivedClassName(BaseClassName):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &lt;statement-1&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &lt;statement-N&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Имя </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">BaseClassName</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> должны быть определено в пределах области видимости производного класса. На месте имени базового класса также допускается иные произвольные выражения. Это может быть использовано, например, когда базовый класс определен в другом модуле: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class DerivedClassName(modname.BaseClassName):</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Выполнение определения производного класса протекает так же, как для базового класса. Когда объект класса создается, базовый класс запоминается. Это используется для выяснения ссылок на атрибуты: если запрошенный атрибут не найден в классе, поиск продолжается в базовом классе. Это правило применяется рекурсивно, если сам базовый класс является производным от другого класса. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Нет ничего особенного в экземплярах производных классов: </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">DerivedClassName</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000;">()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> создает новый экземпляр класса. Ссылки на методы разрешаются следующим образом: требуемый атрибут класса ищется по убыванию вниз по цепочке базовых классов, если это необходимо, и ссылка на метод работает, если она дает объект функции. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Производные классы могут переопределить методы их базовых классов. Потому как методы не имеют особых привилегий при вызове других методов того же объекта, так метод базового класса, что вызывает другой метод, определенный в том же базовом классе, может в конечном итоге вызвать метод производного класса, который переопределяет его. (Для программистов на C++: все методы в Python фактически являются </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">virtual</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">.) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Переопределенный метод в производном классе на самом деле может потребоваться расширить, а не просто заменить метод базового класса с тем же именем. Существует простой способ вызвать метод базового класса напрямую: просто напишите </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">BaseClassName.methodname(self, arguments)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Это также иногда полезно для клиентов. (Заметим, что это работает только если базовый класс доступен как </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">BaseClassName</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> в глобальной области видимости.) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">У Python есть две встроенные функции, которые работают с наследованием: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используйте isinstance(), чтобы проверить тип экземпляра: <span style=" font-family:'Courier New,courier';">isinstance(obj, int)</span> вернет <span style=" font-family:'Courier New,courier';">True</span>, если только <span style=" font-family:'Courier New,courier';">obj.__class__</span> является int или некоторый класс, производный от int. </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используйте issubclass() для проверки наследования классов: <span style=" font-family:'Courier New,courier';">issubclass(bool, int)</span> есть <span style=" font-family:'Courier New,courier';">True</span>, поскольку bool - это подкласс int. Однако, <span style=" font-family:'Courier New,courier';">issubclass(float, int)</span> ложно, так как float не является подклассом int.</li></ul>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="multiple-inheritance"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.5.1. Множественное наследование</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Python также поддерживает форму множественного наследования. Определение класса с несколькими базовыми классами выглядит следующим образом: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class DerivedClassName(Base1, Base2, Base3):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &lt;statement-1&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    .</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &lt;statement-N&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Для большинства целей, в простейших случаях, вы можете думать о поиске атрибутов, унаследованных от родительского класса, как сначала в глубину, затем слева-направо, не ищет дважды в том же классе, где есть совпадение в иерархии. Таким образом, если атрибут не найден в </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">DerivedClassName</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, он ищется в </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">Base1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, затем (рекурсивно) в базовых классах </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">Base1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, и если не был найден там, поиск будет продолжен в </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">Base2</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> и так далее. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">На самом деле все немного сложнее; порядок выбора метода динамически изменяется для поддержки совместных вызовов к </span><a href="http://pythoner.name/documentation/library/functions#super"><span style=" font-family:'Courier New,courier'; font-size:9pt; text-decoration: underline; color:#0000ff;">super()</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Такой подход известен в некоторых других языках с множественным наследованием как &quot;вызов следующего метода&quot; и является более мощным, чем вызов super, присутствующего в языках с одиночным наследованием. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Динамическое следование необходимо потому, что все случаи множественного наследования обладают одним или несколькими взаимосвязанными отношениями (где по крайней мере один из родительских классов может быть доступен через множество путей от самого нижнего класса). Например, все классы унаследованы от </span><a href="http://pythoner.name/documentation/library/functions#object"><span style=" font-family:'Courier New,courier'; font-size:9pt; text-decoration: underline; color:#0000ff;">object</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, так что любой случай множественного наследования обеспечивает более одного пути, чтобы добраться до </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">object</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Чтобы сохранить базовые классы от доступа более одного раза, динамический алгоритм делает линейным порядок поиска таким образом, чтобы сохранить порядок слева-направо, указанный в каждом классе, который вызывает каждого родителя только один раз (это означает, что от класса можно создать подкласс не затрагивая порядок приоритетов его родителей). Взятые вместе эти свойства делают возможным создание надежных и расширяемых классов с множественным наследованием. Более подробно см. python.org/download/releases/2.3/mro/. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="private-variables"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.6. Приватные переменные</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">В Python не существует &quot;частных&quot; (приватных) переменных экземпляра, т.е. тех, которые не могут быть доступны, кроме как изнутри объекта. Тем не менее есть соглашение, которое поддерживается большей частью кода Python: идентификатор с префиксом нижней черты (например </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">_spam</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">) должны рассматриваться как непубличная часть API (будь то функция, метод или элемент данных). Следует учитывать, детали реализации и предмет могут быть изменены без предварительного уведомления. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Поскольку есть действительные прецеденты для приватных членов класса (а именно, чтобы избежать конфликтов имен с именами, определенными подклассами), есть ограниченная поддержка такого механизма, называемого корректировкой имен (</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">name mangling</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">). Любой идентификатор вида </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__spam</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> (по крайней мере с двумя первыми подчеркиваниями и не более чем одним завершающим) текстуально заменяются на </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">_classname__spam</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, где </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">classname</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> - это текущее имя класса с начальным символом(ами) подчеркивания. Эта корректировка делается безотносительно к синтаксической позиции идентификатора до тех пор, пока это происходит в определении класса. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Корректировка имен полезна для того, чтобы позволить подклассам переопределять методы, не нарушая внутриклассовых вызовов методов. Например: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class Mapping:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __init__(self, iterable):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.items_list = []</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.__update(iterable)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def update(self, iterable):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        for item in iterable:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">            self.items_list.append(item)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    __update = update   # приватная копия оригинального метода update()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class MappingSubclass(Mapping):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def update(self, keys, values):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        # предоставляет новую подпись для update()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        # но не ломает __init__()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        for item in zip(keys, values):</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">            self.items_list.append(item)</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Хотя в основном правила корректировки предназначены для избежания несчастных случаев, но все равно можно получить доступ или изменить переменную, которая считается приватной. Это даже может быть полезно при особых обстоятельствах, например, в отладчике. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Обратите внимание, что код, передающийся </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">exec()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> или </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">eval()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, не учитывает имя класса вызывающего класса к текущему классу; это похоже на эффект оператора </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">global</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, эффект, который также ограничивается кодом, который байт-скомпилированный вместе. То же ограничение применяется к </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">getattr()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">setattr()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">delattr()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, а также при обращении к </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__dict__</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> напрямую. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="odds-and-ends"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.7. Различные заметки</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Иногда бывает полезно иметь тип данных похожий на запись в Паскале или структуру в C, связав вместе несколько именованных элементов данных. Определение пустого класса превосходно представит такую возможность: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class Employee:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    pass</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">john = Employee() # Создает пустую запись employee</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"># Заполняются поля записи</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">john.name = 'John Doe'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">john.dept = 'computer lab'</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">john.salary = 1000</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Часть кода Python, который ожидает определенного абстрактного типа данных, часто может быть передан классу, который эмулирует методы вместо этого типа данных. Например, если у вас есть функция, которая форматирует некоторые данные из файлового объекта, вы можете определить класс с методами </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">read()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">readline()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, которые вместо этого получают данные из буфера строки, и передают их в качестве аргумента. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Объекты методов экземпляра имеют атрибуты также: </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">m.__self__</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является объектом экземпляра с методом </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">m()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">m.__func__</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> является объектом функцией, соответствующей этому методу. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="iterators"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.8. Итераторы</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">К этому моменту вы возможно заметили, что большинство контейнерных объектов позволяют совершить по ним циклический проход с помощью оператора for (docs.python.org/3/reference/compound_stmts.html#for): </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">for element in [1, 2, 3]:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(element)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">for element in (1, 2, 3):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(element)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">for key in {'one':1, 'two':2}:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(key)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">for char in &quot;123&quot;:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(char)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">for line in open(&quot;myfile.txt&quot;):</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    print(line, end='')</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Этот стиль доступа является ясным, кратким, и удобным. Использование итераторов пронизывает и объединяет Python. За сценой оператор for вызывает </span><a href="http://pythoner.name/documentation/library/functions#iter"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">iter()</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> на объект-контейнер. Эта функция возвращает объект-итератор, который определяет метод </span><a href="http://pythoner.name/documentation/library/stdtypes#iterator.__next__"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">__next__()</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, который выбирает элементы контейнера по одному за раз. Когда больше элементов нет, __next__() вызывает исключение StopIteration (docs.python.org/3/library/exceptions.html#StopIteration), которое заставляет цикл for завершиться. Вы можете вызвать метод __next__() с помощью встроенной функции next(); этот пример показывает, как все это работает: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; s = 'abc'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; it = iter(s)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; it</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&lt;iterator object at 0x00A1DB50&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; next(it)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">'a'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; next(it)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">'b'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; next(it)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">'c'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; next(it)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">Traceback (most recent call last):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">  File &quot;&lt;stdin&gt;&quot;, line 1, in ?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    next(it)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">StopIteration</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Увидев как работает механизм протокола итератора, легко добавить поведение итератора в классы. Определите метод __iter__(), который возвращает объект с методом __next__(). Если класс определяет __next__(), затем __iter__(), то можно просто вернуть </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">self</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">class Reverse:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    &quot;&quot;&quot;Итератор для обхода последовательности наоборот.&quot;&quot;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __init__(self, data):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.data = data</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.index = len(data)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __iter__(self):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        return self</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    def __next__(self):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        if self.index == 0:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">            raise StopIteration</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        self.index = self.index - 1</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        return self.data[self.index]</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; rev = Reverse('spam')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; iter(rev)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&lt;__main__.Reverse object at 0x00A1DB50&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; for char in rev:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...     print(char)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">m</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">a</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">p</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">s</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="generators"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.9. Генераторы</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">Генераторы</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> (docs.python.org/3/glossary.html#term-generator) представляют собой простой и мощный инструмент для создания итераторов. Они написаны как обычные функции, но используют оператор </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">yield</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> (docs.python.org/3/reference/simple_stmts.html#yield), всякий раз когда требуется вернуть данные. Каждый раз </span><a href="http://pythoner.name/documentation/library/functions#next"><span style=" font-family:'Courier New,courier'; font-size:9pt; text-decoration: underline; color:#0000ff;">next()</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> вызывается на это, генератор возвращается туда, где был до этого (он запоминает все значения и какой оператор был выполнен последним). Пример показывает, как можно легко создать генератор: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">def reverse(data):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">    for index in range(len(data)-1, -1, -1):</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">        yield data[index]</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; for char in reverse('golf'):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...     print(char)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">f</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">l</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">o</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">g</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Все, что может быть сделано с помощью генераторов, также может быть сделано с итераторами на основе классов, как описано в предыдущем разделе. То, что делает генераторы настолько компактными, это методы </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__iter__()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">__next__()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, которые создаются автоматически. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Еще одной ключевой особенностью является то, что локальные переменные и состояние выполнения автоматически сохраняются между вызовами. Это сделало функцию легче для написания и гораздо яснее, чем подход с использованием переменных экземпляра, как </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">self.index</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> и </span><span style=" font-family:'Courier New,courier'; font-size:9pt;">self.data</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">В дополнение к автоматическому созданию метода и сохранению состояния программы, когда генераторы прекращают работу, они автоматически возбуждают StopIteration (docs.python.org/3/library/exceptions.html#StopIteration). В сочетании эти особенности позволяют легко создавать итераторы с не большими усилиями, чем писать обычные функции. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="generator-expressions"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">9</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">.10. Выражения с использованием генераторов</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Некоторые простые генераторы могут быть закодированы лаконично как выражения, используя синтаксис, аналогичный списку, но с круглыми скобками вместо квадратных. Эти выражения предназначены для ситуаций, когда генератор используется сразу же включающей функцией. Выражения с генератором более компактные, но менее универсальные, чем полные определения генераторов и, как правило, быть более дружелюбны, чем эквивалентное использование списков. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Примеры: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; sum(i*i for i in range(10))                 # сумма квадратов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">285</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; xvec = [10, 20, 30]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; yvec = [7, 5, 3]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; sum(x*y for x,y in zip(xvec, yvec))         # dot product</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">260</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; from math import pi, sin</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; sine_table = {x: sin(x*pi/180) for x in range(0, 91)}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; unique_words = set(word  for line in page  for word in line.split())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; valedictorian = max((student.gpa, student.name) for student in graduates)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; data = 'golf'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">&gt;&gt;&gt; list(data[i] for i in range(len(data)-1, -1, -1))</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:9pt;">['f', 'l', 'o', 'g']</span><span style=" font-family:'DejaVu LGC Sans'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">Примечания</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="id11"></a><a href="http://pythoner.name/documentation/tutorial/classes#id1"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">[</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">1]</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> За исключением одной вещи. У объектов модуля есть секретный атрибут только для чтения атрибут </span><a href="http://pythoner.name/documentation/library/stdtypes#object.__dict__"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">__dict__</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, который возвращает словарь, используемый для реализации пространства имен модуля; имя __dict__ является атрибутом, но не глобальным именем. Очевидно, что его использование нарушает абстракцию реализации пространства имен, и должно быть ограничена к вещам, как завершающие действия отладчиков.</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">Создано</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">2013-05-05 </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pythoner.name/comment/reply/node/35/comment#comment-form"><span style=" text-decoration: underline; color:#0000ff;">Добавить комментарий</span></a> </li></ul>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="book-label-26"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">П</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">ерекрёстные ссылки книги для 9. Классы</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pythoner.name/documentation/tutorial/exceptions"><span style=" text-decoration: underline; color:#0000ff;">8. Ошибки и исключения</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pythoner.name/documentation/tutorial"><span style=" text-decoration: underline; color:#0000ff;">Вверх</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pythoner.name/documentation/tutorial/library"><span style=" text-decoration: underline; color:#0000ff;">10. Краткий обзор стандартной библиотеки</span></a> </li></ul></body></html>