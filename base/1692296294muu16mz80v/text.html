<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:33pt; color:#222222;">Объединяйте файлы CSV или TXT в папку — с помощью Excel или CMD.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">Написано </span><a href="https://analystcave.com/author/analystcave/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Томом (AnalystCave)</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">  в11 марта 2016 г. в </span><a href="https://analystcave.com/category/ms-office/ms-office-excel/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Excel</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">MS Office</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/outlook/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Outlook</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/powerpoint/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">PowerPoint</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/word/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Word</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Часто мы сталкиваемся с проблемой объединения файлов csv или txt в папке в один файл. Excel — очевидный инструмент для таких задач, и сегодня я покажу пару простых способов объединения нескольких файлов в одной или даже целой структуре папок в один файл CSV или текстовый файл. Для объединения CSV-файлов или других текстовых файлов часто лучше всего использовать Visual Basic для приложений в Excel.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Другие файловые ресурсы VBA</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Файловые функции VBA</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-read-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Чтение файлов VBA</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-write-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Запись файлов VBA</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-dir-function-how-to-traverse-directories/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Обход каталогов</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-xml-working-xml-files/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">VBA Работа с файлами XML</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/vba-downloading-files-from-ftp-using-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Загрузка файлов VBA</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/excel-quick-versioning-excel-files/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">Файлы управления версиями VBA</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e3f6fc;"><span style=" font-family:'Symbol'; font-size:10pt; color:#444444; vertical-align:top;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444; vertical-align:top;">         </span><a href="https://analystcave.com/merge-csv-files-or-txt-files-in-a-folder/"><span style=" font-family:'Times New Roman,serif'; font-size:9.5pt; font-weight:600; text-decoration: underline; color:#008000; vertical-align:top;">VBA Объединение файлов CSV или TXT</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Давайте начнем с самого простого подхода с использованием командной строки Windows без использования Excel.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНЕНИЕ ФАЙЛОВ CSV С ПОМОЩЬЮ WINDOWS CMD</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Этот подход использует команду Копировать</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> из командной строки Windows .</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#96dcdc;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Откройте папку, которая должна содержать файлы CSV или TXT.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Откройте в проводнике Windows папку, содержащую файлы CSV или TXT, которые необходимо объединить. Они должны быть без заголовков или только первый файл должен быть с заголовками.<br /></span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#96dcdc;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Откройте командную строку CMD в папке</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Щелкните путь к файлу в окне проводника Windows, введите </span><span style=" font-family:'Courier New'; font-size:8.25pt; color:#323232;">cmd</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">и нажмите </span><span style=" font-family:'Courier New'; font-size:8.25pt; color:#323232;">ENTER</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">.<br /></span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#96dcdc;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Объедините файлы с помощью команды COPY</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Окно командной строки CMD Windows должно открыться. Введите следующую команду и нажмите </span><span style=" font-family:'Courier New'; font-size:8.25pt; color:#323232;">ENTER</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">, чтобы объединить файлы</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#afafaf;">1</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">copy *.csv merge.csv</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Результатом будет только что созданный файл </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">merge.csv</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> с объединенными данными по всем файлам CSV в каталоге.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f2f2f2;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">Просто замените *.csv на *.txt, чтобы объединить текстовые файлы вместо файлов CSV.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНИТЬ СПИСОК ФАЙЛОВ CSV, TXT</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Предыдущий метод был очень простым и не требовал использования Excel или MS Office. Приведенный ниже и следующие подходы обеспечат вам большую гибкость при объединении файлов. Если вы не знаете, как </span><a href="https://analystcave.com/excel-vba-tutorial/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">использовать макросы в Excel, сначала прочитайте мой учебник</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Предполагая, что вы хотите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">объединить список файлов</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> в массив строк, вы можете использовать описанную ниже процедуру. Он объединит все предоставленные CSV или текстовые файлы в один новый текстовый файл.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="1364" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td width="1320" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> MergeFiles(fileNames() </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, newFileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> headers </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> addNewLine </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Variant</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, textData </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Integer</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, result </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, firstHeader </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> firstHeader = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">In</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNames</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNo = FreeFile</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Open fileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Input </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> textData = Input$(LOF(fileNo), fileNo)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Close #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> headers </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> result = result &amp; IIf(addNewLine, vbNewLine, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">) &amp; IIf(firstHeader, textData, Right(textData, Len(textData) - InStr(textData, vbNewLine)))</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> firstHeader = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> result = result &amp; IIf(addNewLine, vbNewLine, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">) &amp; textData</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Next</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNo = FreeFile</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Open newFileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Output </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Print #fileNo, result</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Close #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Пример объединения файлов csv, txt</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Ниже приведен пример использования процедуры </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">MergeFiles</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> :</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#6ce26c;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNames(0 </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">To</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> 1) </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">fileNames(0) = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;C:\somefolder\test.csv&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">fileNames(1) = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;C:\somefolder\test1.csv&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e0e0e0;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">MergeFiles fileNames, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;C:\Merged.csv&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Параметры слияния файлов</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">fileNames()</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Массив строк, представляющих полные пути к файлам, которые необходимо объединить.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">newFileName</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Имя нового объединенного файла, который должен быть создан.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">заголовки</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Необязательно. Верно по умолчанию. Это предназначено для файлов CSV TXT (HDR). Если True, предполагается, что все файлы имеют заголовки (первая строка со столбцами). Только первый заголовок будет объединен с новым файлом (</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;"> newFileName</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> )</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">addNewLine</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Необязательный. Ложь по умолчанию. Если True, между каждым объединенным файлом будет добавлен символ новой строки (vbNewLine).</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНИТЬ CSV, TXT ФАЙЛЫ В УКАЗАННОЙ ПАПКЕ</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Другой случай, когда вы хотите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">объединить все CSV-файлы в одной папке</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> . Эта процедура похожа на предыдущую, за исключением того, что она </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">просматривает все файлы в одном каталоге</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> ( </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">исключая подкаталоги</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> — для этого перейдите к следующей процедуре). Вы также можете использовать подстановочные знаки, такие как «*.csv», чтобы убедиться, что объединяются только файлы csv, а не другие файлы — прочитайте мой пост о функции VBA </span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/vba-dir-function/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">Dir</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> , чтобы узнать больше.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="1364" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td>
<td width="1320" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> MergeFilesInFolder(folderName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, newFileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> headers </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> addNewLine </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Variant</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, textData </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Integer</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, result </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, firstHeader </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> firstHeader = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName = Dir(folderName)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Do</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Until</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNo = FreeFile</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Open (Left(folderName, InStrRev(folderName, &quot;\&quot;)) &amp; fileName) </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Input </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> textData = Input$(LOF(fileNo), fileNo)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Close #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> headers </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> result = result &amp; IIf(addNewLine, vbNewLine, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">) &amp; IIf(firstHeader, textData, Right(textData, Len(textData) - InStr(textData, vbNewLine)))</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> firstHeader = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> result = result &amp; IIf(addNewLine, vbNewLine, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">) &amp; textData</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName = Dir</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Loop</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNo = FreeFile</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Open newFileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Output </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Print #fileNo, result</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Close #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Пример объединения файлов csv, txt в папку</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Ниже приведен пример использования процедуры </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">MergeFilesInFolder</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> :</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="716" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td>
<td width="680" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">MergeFilesInFolder </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;C:\somefolder\*.csv&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;C:\MergedFolder.csv&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Параметры MergeFilesInFolder</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">имя_папки</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Папка, содержащая все файлы, которые необходимо объединить. Подстановочные знаки разрешены, если они поддерживаютсяфункцией</span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/vba-dir-function/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;"> VBA Dir.</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://analystcave.com/tip-day-making-proper-vba-comments/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#2980b9; background-color:#ecf0f1; vertical-align:middle;">См. также </span></a><a href="https://analystcave.com/tip-day-making-proper-vba-comments/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000; background-color:#ecf0f1; vertical-align:middle;">  </span></a><a href="https://analystcave.com/tip-day-making-proper-vba-comments/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#000000; background-color:#ecf0f1; vertical-align:middle;">Создание правильных комментариев VBA.</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">newFileName</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Имя нового объединенного файла, который должен быть создан.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">заголовки</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Необязательно. Верно по умолчанию. Это предназначено для файлов csv (HDR). Если True, предполагается, что все файлы имеют заголовки (первая строка со столбцами). Только первый заголовок будет объединен с новым файлом (</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;"> newFileName</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> )</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">addNewLine</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Необязательный. Ложь по умолчанию. Если True, между каждым объединенным файлом будет добавлен символ новой строки (vbNewLine).</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНИТЬ ФАЙЛЫ CSV, TXT ВО ВСЕХ ПОДПАПКАХ</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Самый сложный случай, когда вы хотите объединить файлы не только внутри определенного каталога </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">, но и во всех подкаталогах. </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Это также будет работать для сценария, когда нет подпапок.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="1440" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td>
<td width="1440" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> MergeFilesInSubFolders(folderName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, pattern </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, newFileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> headers </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> addNewLine </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Variant</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, folder </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Variant</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, textData </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, fileNo </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Integer</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, result </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, firstHeader </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Boolean</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> firstHeader = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> col </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Collection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> col = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">New</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Collection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> col.Add folderName</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> TraversePath folderName, col</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> folder </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">In</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> col</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName = Dir(folder &amp; pattern)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Do</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Until</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName = </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNo = FreeFile</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Open (Left(folder, InStrRev(folder, &quot;\&quot;)) &amp; fileName) </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Input </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> textData = Input$(LOF(fileNo), fileNo)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Close #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> headers </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">               </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> result = result &amp; IIf(addNewLine, vbNewLine, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">) &amp; IIf(firstHeader, textData, Right(textData, Len(textData) - InStr(textData, vbNewLine)))</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">               </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> firstHeader = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Else</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">               </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> result = result &amp; IIf(addNewLine, vbNewLine, </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">) &amp; textData</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileName = Dir</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Loop</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Next</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> folder</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> fileNo = FreeFile</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Open newFileName </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Output </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Print #fileNo, result</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Close #fileNo</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Function</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> TraversePath(path </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Variant</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, allDirCollection </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Collection)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> currentPath </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, directory </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Variant</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> dirCollection </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Collection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> dirCollection = </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">New</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Collection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">    </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> currentPath = Dir(path, vbDirectory)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008200;">'Explore current directory</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Do</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Until</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> currentPath = vbNullString</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Left(currentPath, 1) &lt;&gt; </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;.&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">And</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> Left(currentPath, 2) &lt;&gt; </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;..&quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">And</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> (GetAttr(path &amp; currentPath) </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">And</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> vbDirectory) = vbDirectory </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Then</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> dirCollection.Add path &amp; currentPath &amp; &quot;\&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> allDirCollection.Add path &amp; currentPath &amp; &quot;\&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> currentPath = Dir()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Loop</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">    </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; color:#008200;">'Explore subsequent directories</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Each</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> directory </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">In</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> dirCollection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> TraversePath directory, allDirCollection</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Next</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> directory</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">Function</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f2f2f2;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">Прочтите </span><a href="https://analystcave.com/vba-dir-function-how-to-traverse-directories/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; text-decoration: underline; color:#008000;">этот пост</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;"> , чтобы узнать больше об использовании функции VBA Dir для перемещения по каталогам и подкаталогам.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Пример объединения файлов csv, txt в подпапках</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Ниже приведен пример использования процедуры </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">MergeFilesInSubFolders</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> :</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="731" cellspacing="0" cellpadding="0">
<tr>
<td width="0" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td>
<td width="695" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">MergeFilesInSubFolders </span><span style=" font-family:'Consolas'; font-size:12pt; color:#0000ff;">&quot;C:\somefolder\&quot;, &quot;</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">C:\MergedSubFolders.csv&quot;, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:12pt; font-weight:600; color:#006699;">False</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Параметры MergeFilesInSubFolders</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">имя_папки</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Папка с подпапками или без них, включая все файлы, которые нужно объединить. Используйте подстановочные знаки спараметром</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;"> шаблона</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">шаблон</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />При необходимости шаблон с использованием подстановочных знаков, разрешенных</span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/vba-dir-function/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;"> функцией VBA Dir</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">newFileName</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Имя нового объединенного файла, который должен быть создан.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">заголовки</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Необязательно. Верно по умолчанию. Это предназначено для файлов csv (HDR). Если True, предполагается, что все файлы имеют заголовки (первая строка со столбцами). Только первый заголовок будет объединен с новым файлом (</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;"> newFileName</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> )</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; color:#444444;">addNewLine</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br />Необязательный. Ложь по умолчанию. Если True, между каждым объединенным файлом будет добавлен символ новой строки (vbNewLine).</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНИТЬ ФАЙЛЫ CSV — ФИЛЬТРОВАТЬ ЗАПИСИ</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Иногда мы хотим загрузить только подмножество записей в наших файлах CSV. Один из способов — загрузить данные, а затем отфильтровать их в Excel. Но почему бы не сделать это за один раз? См. мою </span><a href="https://analystcave.com/downloads/excel-sql-addin/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">надстройку SQL</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> или мой </span><a href="https://analystcave.com/vba-read-file-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">прочитанный файл CSV с использованием примера SQL в этом посте здесь</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p></body></html>