<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Перенос контактов из Outlook в Excel макросом VBA</p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px; background-color:#ffffff;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; font-weight:600; color:#999999;">Подробности</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:9px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; color:#999999;">Категория: </span><a href="http://macros-vba.ru/makrosy/outlook"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; color:#0088cc;">Макросы Outlook</span></a></p>
<p style=" margin-top:0px; margin-bottom:18px; margin-left:9px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; color:#999999;"> Опубликовано: 10 июля 2013</span></p>
<p style=" margin-top:0px; margin-bottom:9px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; color:#333333;">Как известно, в почтовом приложении Microsoft Outlook существует </span><a href="http://macros-vba.ru/makrosy/outlook/157-eksport-kontaktov-iz-outlook-v-excel"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; font-style:italic; color:#0088cc;">возможность экспорта контактов в файл</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; color:#333333;">. Существует также и другая возможность - перенос контактных данных из Outlook в Excel при помощи макроса, написанного на языке VBA (Visual Basic for Applications).</span></p>
<p style=" margin-top:0px; margin-bottom:9px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; color:#333333;">Ниже приведен программный код макроса, который запускает приложение Excel в видимом режиме, создает в нем новую рабочую книгу и в определенные ячейки активного рабочего листа переносит заданные свойства контактов. В этом примере на лист Excel переносятся фамилия, имя, отчество и адрес электронной почты каждого контакта, но этот перечень свойств можно изменять и дополнять, используя </span><a href="http://macros-vba.ru/makrosy/outlook/158-kontakty-v-microsoft-outlook"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; font-style:italic; color:#0088cc;">соответствующие свойства контакта</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:14px; color:#333333;">.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Option Explicit</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub Perenos_Kontaktov_v_Excel()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myNamespace As NameSpace</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim myFolder As MAPIFolder, myWorkFolder As MAPIFolder</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim iContact As ContactItem</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim i As Single</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim objXls As Object</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set objXls = CreateObject(&quot;Excel.Application&quot;)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set objXls = objXls.Workbooks.Add</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    objXls.Application.Visible = True</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set myNamespace = Application.GetNamespace(&quot;MAPI&quot;)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set myFolder = myNamespace.GetDefaultFolder(olFolderContacts)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   'Set myWorkFolder = myFolder.Folders(&quot;Имя вашей папки&quot;)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   'в случае, если нужна папка внутри дефолтной</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set myWorkFolder = myFolder</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    i = 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        For Each iContact In myWorkFolder.Items ' перебор контактов</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            With iContact</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                objXls.ActiveSheet.Range(&quot;A&quot; &amp; i).Value = .LastName</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                objXls.ActiveSheet.Range(&quot;B&quot; &amp; i).Value = .FirstName</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                objXls.ActiveSheet.Range(&quot;C&quot; &amp; i).Value = .MiddleName</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                objXls.ActiveSheet.Range(&quot;D&quot; &amp; i).Value = .Email1Address</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            End With</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            i = i + 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            On Error Resume Next</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Next iContact</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set objXls = Nothing</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">В случае, если контактные данные необходимо  перенести не в новый, а в существующий файл,</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://macros-vba.ru/makrosy/outlook/148-kak-otkryt-excel-iz-outlook-makrosom-zapusk-excel-iz-outlook"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:8.25pt; font-style:italic; text-decoration: underline; color:#0088cc;">достаточно внести небольшое изменение</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:8.25pt; color:#333333;"> в приведенный выше программный код, которое вместо создания новой рабочей книги откроет книгу с заданным именем.</span></p>
<p style=" margin-top:0px; margin-bottom:9px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:8.25pt; color:#333333;">Для того, чтобы перенести этот программный код на свой компьютер, наведите курсор мыши на поле с программным кодом, нажмите на одну из двух кнопкок  в правом верхнем углу этого поля, скопируйте программный код и вставьте его в модуль проекта на своем компьютере (подробнее о том, </span><a href="http://macros-vba.ru/knigi/vba/62-kak-sohranit-kod-macrosa"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:8.25pt; font-style:italic; text-decoration: underline; color:#0088cc;">как сохранить программный код макроса</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:8.25pt; color:#333333;">).</span></p></body></html>