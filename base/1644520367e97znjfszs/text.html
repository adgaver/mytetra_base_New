<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Segoe UI,Lucida Grande,Verdana,Arial,Helvetica,sans-serif'; font-size:14px; color:#333333; background-color:#ffffff;">Для кодирования используйте Uri.EscapeDataString («Кодирует специальные символы во входных данных в соответствии с правилами RFC 3986.»).<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Segoe UI,Lucida Grande,Verdana,Arial,Helvetica,sans-serif'; font-size:14px; color:#333333; background-color:#ffffff;">Для декодирования это немного сложнее. Я не нашел никакой специальной функции, поэтому я использовал функцию Uri.Parts, которая разбивает Uri на записи. Вам нужно предоставить фиктивный URL-адрес, чтобы заставить его работать, а затем использовать Record.Field для изоляции нужной части.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Lucida Grande,Verdana,Arial,Helvetica,sans-serif'; font-size:14px; color:#333333;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Segoe UI,Lucida Grande,Verdana,Arial,Helvetica,sans-serif'; font-size:14px; color:#333333; background-color:#ffffff;">//#&quot;Добавлен пользовательский объект&quot; = Table.AddColumn(#&quot;Обрезанный текст&quot;, &quot;Encoded&quot;, each Record.Field(Record.Field(Uri.Parts(&quot;http://www.dummy.com?A=&quot; &amp; [Column1]),&quot;Query&quot;),&quot;A&quot;)),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; color:#000088;">let</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; color:#000000;">    </span><span style=" font-family:'inherit'; font-size:14px; color:#660066;">Source</span><span style=" font-family:'inherit'; font-size:14px; color:#000000;"> </span><span style=" font-family:'inherit'; font-size:14px; color:#666600;">=</span><span style=" font-family:'inherit'; font-size:14px; color:#000000;"> </span><span style=" font-family:'inherit'; font-size:14px; color:#008800;">&quot;this is a &amp; @string to encode and decode !?&quot;</span><span style=" font-family:'inherit'; font-size:14px; color:#666600;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; color:#000000;">    </span><span style=" font-family:'inherit'; font-size:14px; color:#660066;">Encoded</span><span style=" font-family:'inherit'; font-size:14px; color:#000000;"> </span><span style=" font-family:'inherit'; font-size:14px; color:#666600;">=</span><span style=" font-family:'inherit'; font-size:14px; color:#000000;"> </span><span style=" font-family:'inherit'; font-size:14px; color:#660066;">Uri</span><span style=" font-family:'inherit'; font-size:14px; color:#666600;">.</span><span style=" font-family:'inherit'; font-size:14px; color:#660066;">EscapeDataString</span><span style=" font-family:'inherit'; font-size:14px; color:#666600;">(</span><span style=" font-family:'inherit'; font-size:14px; color:#660066;">Source</span><span style=" font-family:'inherit'; font-size:14px; color:#666600;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; color:#000000;">    </span><span style=" font-family:'inherit'; font-size:14px; color:#880000;">#&quot;Decoded again&quot; = Record.Field(Record.Field(Uri.Parts(&quot;http://www.dummy.com?A=&quot; &amp; Encoded),&quot;Query&quot;),&quot;A&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; color:#000088;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; color:#000000;">    </span><span style=" font-family:'inherit'; font-size:14px; color:#880000;">#&quot;Decoded again&quot;</span></p></body></html>