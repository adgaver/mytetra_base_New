<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; font-weight:600;">VBA Excel. Сочетания клавиш для кнопок</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; font-style:italic;">Добавление сочетаний клавиш для быстрого доступа к элементам управления CommandButton (кнопкам), размещенным на пользовательской форме, в VBA Excel.</span></p>
<p style=" margin-top:32px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; font-weight:600; color:#333333;">Содержание</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/sochetaniya-klavish-dlya-knopok/#Socetania_klavis_dla_knopok"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">1. Сочетания клавиш для кнопок</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/sochetaniya-klavish-dlya-knopok/#Dobavlenie_socetanij_klavis"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">2. Добавление сочетаний клавиш</span></a></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Socetania_klavis_dla_knopok"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; font-weight:600;">С</span><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; font-weight:600;">очетания клавиш для кнопок</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">Для кнопок на пользовательской форме в VBA Excel предусмотрена возможность добавления сочетаний клавиш быстрого доступа. За это отвечает свойство Accelerator элемента управления CommandButton.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">Если свойству Accelerator элемента управления CommandButton присвоить символ, который есть в названии кнопки (свойство Caption), тогда этот символ будет отображаться подчеркнутым, а сочетание клавиш </span><span style=" font-family:'Courier New'; font-size:7.8pt; color:#333333; background-color:#d0effb;">Alt+[символ]</span><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;"> будет имитировать нажатие этой кнопки.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_1_host"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">К</span><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">роме элемента управления </span><a href="https://vremya-ne-zhdet.ru/vba-excel/element-upravleniya-commandbutton/"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">CommandButton</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">, свойство Accelerator есть у элементов управления </span><a href="https://vremya-ne-zhdet.ru/vba-excel/element-upravleniya-checkbox/"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">CheckBox</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;"> (флажок), </span><a href="https://vremya-ne-zhdet.ru/vba-excel/element-upravleniya-label/"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">Label</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;"> (метка, надпись), </span><a href="https://vremya-ne-zhdet.ru/vba-excel/element-upravleniya-optionbutton/"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">OptionButton</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;"> (переключатель), </span><a href="https://vremya-ne-zhdet.ru/vba-excel/element-upravleniya-togglebutton/"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">ToggleButton</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;"> (выключатель). Им тоже можно назначить клавиши быстрого доступа.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Dobavlenie_socetanij_klavis"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; font-weight:600;">Д</span><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; font-weight:600;">обавление сочетаний клавиш</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">Добавить сочетания клавиш для быстрого доступа к элементам управления CommandButton очень просто. Вы можете вручную внести необходимый символ в поле «Accelerator» окна «Properties» выбранной кнопки:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:7.8pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">А так можно добавить символы для сочетания клавиш быстрого доступа программно с помощью кода VBA Excel:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Verdana,Arial,sans'; font-size:7.8pt; font-weight:496; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa32a3e9fd8785611542"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#5499de;">5</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa32a3e9fd8785611542-1"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">P</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">rivate</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">Sub</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#004ed0;">UserForm_Initialize</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa32a3e9fd8785611542-2"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#002d7a;">CommandButton1</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#002d7a;">Accelerator</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#008000;">&quot;р&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa32a3e9fd8785611542-3"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#002d7a;">CommandButton2</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#002d7a;">Accelerator</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#008000;">&quot;о&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa32a3e9fd8785611542-4"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#002d7a;">CommandButton3</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#002d7a;">Accelerator</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#008000;">&quot;е&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa32a3e9fd8785611542-5"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">Результат работы кода:</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1694118585odkveum6j6.png" /></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">Для проверки работоспособности сочетания клавиш для быстрого доступа к кнопкам используйте какой-нибудь простенький код, например, такой:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Verdana,Arial,sans'; font-size:7.8pt; font-weight:496; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa32a3e9fe9184906921"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#5499de;">3</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa32a3e9fe9184906921-1"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">P</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">rivate</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">Sub</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#004ed0;">CommandButton1_Click</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa32a3e9fe9184906921-2"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#000000;">MsgBox</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#008000;">&quot;Расчет работает&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa32a3e9fe9184906921-3"></a><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:7.8pt; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_2_host"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">П</span><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">роцедура </span><span style=" font-family:'Courier New'; font-size:7.8pt; color:#333333; background-color:#d0effb;">CommandButton1_Click()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;"> будет запущена нажатием сочетания клавиш </span><span style=" font-family:'Courier New'; font-size:7.8pt; color:#333333; background-color:#d0effb;">Alt+р</span><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">.</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">Как назначить сочетание клавиш для вызова процедуры (макроса) смотрите в статье </span><a href="https://vremya-ne-zhdet.ru/vba-excel/sochetaniye-klavish-dlya-protsedury/"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt; text-decoration: underline; color:#0000ff;">VBA Excel. Сочетание клавиш для процедуры (макроса)</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:7.8pt;"><br /></span></p></body></html>