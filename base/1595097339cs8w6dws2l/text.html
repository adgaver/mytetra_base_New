<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если вы или ваша компания храните данные в облаке OneDrive или на корпоративном портале SharePoint, то напрямую подключиться к ним с помощью Power Query в Excel или из Power BI может оказаться непростой, как это ни странно, задачей.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Когда я в своё время столкнулся с подобным вопросом, то с удивлением обнаружил, что не существует &quot;законных&quot; способов для её решения. В списке доступных источников данных в Excel и даже в Power BI (где набор коннекторов традиционно шире) почему-то отсутствует возможность подключения к файлам и папкам OneDrive.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Так что все предлагаемые ниже варианты - в той или иной степени &quot;костыли&quot;, требующие небольшой, но ручной &quot;доводки напильником&quot;. Но у этих костылей есть большой плюс - они работают :) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">А в чём проблема? </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Короткая вводная для тех, кто последние 20 лет провел в коме не в теме. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">OneDrive - это облачное хранилище данных от Microsoft, доступное в нескольких вариантах: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">OneDrive Personal </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">- для простых (некорпоративных) пользователей. Дают 5Гб бесплатно + дополнительное место за небольшую месячную плату.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">OneDrive for Business</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> - вариант для корпоративных пользователей и подписчиков Office 365 с гораздо большим доступным объемом (от 1Тб и больше) и дополнительными фишками вроде хранения версий и т.п.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Частным случаем OneDrive for Business является хранение данных на корпоративном портале SharePoint - в таком сценарии OneDrive выступает, по сути, одной из библиотек SharePoint'а. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Доступ к файлам возможен либо через веб-интерфейс (сайт </span><a href="https://onedrive.live.com"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">https://onedrive.live.com</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> либо корпоративный сайт SharePoint) либо путем синхронизации выбранных папок с вашим ПК: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Обычно эти папки хранятся в профиле пользователя на диске С - путь к ним выглядит примерно как </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">C:\Users\</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">ИмяПользователя</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">\OneDrive</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">). За актуальностью файлов и синхронизацией всех изменений следит специальная программа - </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Агент OneDrive</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> (синее или серое облачко в правом нижнем углу экрана): </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">А теперь главное.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если нам нужно загрузить данные из OneDrive в Excel (через Power Query) или в Power BI, то мы, конечно, можем указать в качестве источника локальные синхронизируемые файлы и папки обычным образом через </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Получить данные - Из файла - Из книги / Из папки </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Get Data - From file - From workbook / Folder)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, но </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ee105a;">это не будет прямой ссылкой на облако OneDrive</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">То есть в будущем, при изменении, например, файлов в облаке другими пользователями, нам </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">потребуется сначала выполнить синхронизацию</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> (это бывает долго и не всегда удобно) и только </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">потом обновлять наш запрос</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Power Query или модель в Power BI. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Естественно, возникает вопрос: </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ee105a;">как импортировать данные из OneDrive / SharePoint напрямую, чтобы загрузка данных происходила непосредственно из облака?</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Вариант 1. Подключение к книге из OneDrive for Business или SharePoint</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Открываем книгу в нашем Excel - локальную копию из синхронизированной папки OneDrive как обычный файл. Или открываем на сайт сначала в Excel Online, а потом жмем на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Открыть в Excel </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Open in Excel)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Идем в </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Файл - Сведения </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(File - Info)</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Копируем облачный путь к книге кнопкой </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Копировать путь </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Copy Path)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> в заголовке:</span></li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В другом файле Excel или в Power BI, куда нужно залить данные, выбираем команды </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Получить данные - Из интернета </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Get Data - From web)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и вставляем в поле адреса скопированный путь.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Удаляем в конце пути </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#ee1d24;">?web=1</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и жмем на </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">ОК</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">:</span></li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В появившемся окне выбираем способ авторизации </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Учетная запись в организации </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Organization Account)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и жмём на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Вход </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Log in)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">:</span></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Вводим наш рабочий логин-пароль или выбираем корпоративную учетную запись из появившегося списка. Если все сделаете правильно, то надпись </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Вход </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">должна поменяться на </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Войти от имени другого пользователя </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Log in with other user account)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Жмем на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Подключение </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Connect)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span> </li></ol>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Дальше всё как при обычном импорте книги - выбираем нужные листы, умные таблицы для импорта и т.д.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Вариант 2. Подключение к файлу из OneDrive Personal</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Для подключения к книге в личном (некорпоративном) облаке OneDrive подход будет уже другим:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Открываем на сайте OneDrive содержимое нужной папки и находим импортируемый файл.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Щёлкаем по нему правой кнопкой мыши и выбираем команду </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Внедрение </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Embed)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> или выделяем файл и выбираем аналогичную команду в верхнем меню:</span></li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В появившейся справа панели жмем кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Создать</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и копируем сформированный код:</span></li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Вставляем скопированный код в Блокнот и &quot;дорабатываем напильником&quot;:</span> </li></ol>
<ul type="circle" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Убираем всё, кроме ссылки в кавычках </span></li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Удаляем блок </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#ee1d24;">cid=XXXXXXXXXXXX&amp;</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Заменяем слово </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#00a650;">embed</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> на </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#00a650;">download</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В итоге из исходного кода должно получиться такое:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Дальше всё, как и в предыдущем способе. В другом файле Excel или в Power BI, куда нужно залить данные, выбираем команды </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Получить данные - Из интернета </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Get Data - From web)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, вставляем в поле адреса отредактированный путь и жмём ОК.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">При появлении окна авторизации выбираем вариант </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Windows </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">и, при необходимости, вводим логин-пароль от OneDrive.</span> </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Вариант 3. Импорт содержимого целой папки из OneDrive for Business</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если нужно залить в Power Query или Power BI содержимое не одного файла, а сразу целой папки (например, с отчетами), то подход будет чуть попроще: </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В Проводнике щёлкаем правой кнопкой мыши по интересущей нас локальной синхронизированной папке в OneDrive и выбираем </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Просмотреть на сайте </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(View online)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В адресной строке браузера копируем начальную часть адреса - до слова </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#ee1d24;">/_layouts</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">:</span></li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В книге Excel, куда нужно загрузить данные или в отчёте Power BI Desktop выбираем команды </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Получить данные - Из файла - Из папки SharePoint </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Get Data - From file - From SharePoint folder)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">:</span></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Затем вставляем скопированный фрагмент пути в поле адреса и жмем </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">ОК</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если появляется окно авторизации, то выбираем тип </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Учетная запись Microsoft </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Microsoft Account)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, жмём на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Вход </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Log in)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, а потом, после успешного входа, на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Подключение </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Connect)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">:</span></p>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">После этого происходит запрос и загрузка всех файлов из SharePoint и появляется окно предварительного просмотра, где можно смело жать на </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Преобразовать данные </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Transform Data)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Дальнейшее редактирование списка всех файлов и их объединение происходит уже в Power Query или в Power BI стандартным образом. Чтобы сузить круг поиска только до нужной нам папки, можно воспользоваться фильтрацией по столбцу </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Folder Path</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> (1) и затем развернуть всё содержимое обнаруженных файлов с помощью кнопки в столбце </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Content</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> (2):</span></li></ol>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Примечание</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">: при наличии большого количества файлов на портале SharePoint этот способ будет существенно медленее двух предыдущих. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:9pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>