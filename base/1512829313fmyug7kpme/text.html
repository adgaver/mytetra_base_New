<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-title"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">А</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">втозапуск при открытии файла - Макросы в Excel</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="moz-reader-content"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">М</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">ногие вещи хотелось бы запускать автоматически при открытии файла: вызов формы, добавление кнопок на панель инструментов, создание резервной копии открытого файла и многое другое. Запустить всё что угодно при открытии файла можно, задав название макроса </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">auto_open</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">, например: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">    Sub auto_open()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">          MsgBox(“Hello, World!”)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">    End sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cc-m-8429398585"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Е</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">сли вы хотите запустить один макрос из другого макроса, вам нужно просто написать его название. Например запустим макрос с названием another_macro </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">    Sub run_macro()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">        another_macro</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">    End Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cc-m-8351355685"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Ч</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">асто используемые макросы должны быть всегда под рукой. Добавить на ленту или панель быстрого доступа кнопку запуска конкретного макроса – самый логичный и простой способ решения проблемы. Добавить кнопку вручную на панель доступа можно в настройках панели быстрого доступа. Мы же рассмотрим, как автоматически добавить кнопку запуска макроса на ленту. Такой код может запускаться, например, при открытии файла с макросом и особенно полезен при предоставлении макросов другим пользователям – не требуется дополнительных действий, а доступ к макросу прост и понятен. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Итак, чтоб добавить кнопку, нужен следующий код: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">        Application.CommandBars.Add(Name:=&quot; </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">my_cmd_bar</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;"> &quot;, Position:=msoBarTop, Temporary:=True).Visible = True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">        Set </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">button_01</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;"> = Application.CommandBars(&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">my_cmd_bar</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">&quot;).Controls.Add(Type:=msoControlButton)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">        With </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">button_01</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">            .Tag = &quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">tag_name</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">            .OnAction = &quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">macro_name</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">            .FaceId = </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">602</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">            .Caption = &quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600; font-style:italic;">подпись к кнопке</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">        EndWith</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Иконки можно выбрать вот </span><a href="http://www.outlookexchange.com/articles/toddwalker/BuiltInOLKIcons.asp"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">тут</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:9pt;"><br /></p></body></html>