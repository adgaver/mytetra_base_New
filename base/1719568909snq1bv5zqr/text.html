<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="question-header"></a><a href="https://stackoverflow.com/questions/58433333/auto-activate-virtual-environment-in-visual-studio-code"><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">А</span></a><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">втоматическая активация виртуальной среды в Visual Studio Code</span></p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="77987603"></a><span style=" font-weight:600; color:#55aa00;">#</span><span style=" font-weight:600; color:#55aa00;"> ===================================================================================</span></p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    },</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">&quot;terminal.integrated.defaultProfile.windows&quot;</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">: </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">&quot;Cmder&quot;</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">&quot;git.openRepositoryInParentFolders&quot;</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">: </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">&quot;always&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">}</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"><br /></pre>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Ctrl</span>+ <span style=" font-family:'Courier New';">Shift</span>+ <span style=" font-family:'Courier New';">P</span>, поиск<span style=" font-family:'Courier New';">User Settings (JSON)</span></li>
<li style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавьте следующие две строки:</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Решение для Windows</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New';"> &quot;python.terminal.activateEnvInCurrentTerminal&quot;: true,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New';"> &quot;python.defaultInterpreterPath&quot;: &quot;${workspaceFolder}\\.venv\\Scripts\\python.exe&quot;,</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Решение для Linux</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New';"> &quot;python.terminal.activateEnvInCurrentTerminal&quot;: true,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New';"> &quot;python.defaultInterpreterPath&quot;: &quot;${workspaceFolder}/.venv/bin/python&quot;&quot;,</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Примечание</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вышеупомянутое предполагает, что:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">вы размещаете свою среду в папке вашего рабочего пространства, т.е. <span style=" font-style:italic;">в корне вашего репозитория</span></li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ваша среда по умолчанию называется <span style=" font-family:'Courier New';">.venv</span>. Вы можете изменить это в настройках на то, что вы предпочитаете, согласно инструкции.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для пользователей Linux я бы лично избегал решений, размещающих среду в домашней папке (т. е. <span style=" font-family:'Courier New';">~/venv/bin/python</span>) — на самом деле вам следует иметь одну среду на проект (т. е. репозиторий).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Лично я предпочитаю соглашение об именах <span style=" font-family:'Courier New';">.venv</span>с префиксом точки, а не без него. У него есть несколько преимуществ: <span style=" font-family:'Courier New';">.gitignore</span>обычно папки включаются в префикс точки; в Linux он обычно скрыт по умолчанию; когда он виден, он появляется вверху списка папок.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="77987603"></a><span style=" font-weight:600; color:#55aa00;">#</span><span style=" font-weight:600; color:#55aa00;"> ===================================================================================</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answers"></a><span style=" font-size:x-large; font-weight:600;">9</span><span style=" font-size:x-large; font-weight:600;"> ответов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот как я это сделал в 2021 году:</p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Введите <span style=" font-family:'Courier New';">Ctrl</span>+ <span style=" font-family:'Courier New';">Shift</span>+ <span style=" font-family:'Courier New';">P </span>в свой код vs.</li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Найдите свою виртуальную среду:</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-weight:600;">Python: выберите интерпретатор</span> &gt; <span style=" font-weight:600;">Введите путь к интерпретатору</span> &gt; <span style=" font-weight:600;">Найти</span></p>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После того, как вы найдете свое виртуальное окружение, выберите свою версию Python:</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-weight:600;">your-virtual-env</span> &gt; <span style=" font-weight:600;">bin</span> &gt; <span style=" font-weight:600;">python3</span> .</p>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь в вашем проекте вы увидите созданный каталог <span style=" font-weight:600;">.vscode</span> , откройте внутри него <span style=" font-weight:600;">settings.json и добавьте:</span></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New';">&quot;python.terminal.activateEnvironment&quot;: true</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">не забудьте добавить запятую перед ним, чтобы отделить его от уже существующей пары ключ-значение.</p>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь перезапустите терминал.</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ваша виртуальная среда должна активироваться автоматически.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-66281531"></a>54</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#55aa00;">На самом деле предложенные ранее решения мне не помогли, вместо этого я добавил в настройки следующее:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">&quot;settings&quot;: {</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    &quot;python.terminal.activateEnvInCurrentTerminal&quot;: true,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    &quot;python.defaultInterpreterPath&quot;: &quot;~/venv/bin/python&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">}</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Конечно, замените настройку defaultInterpreterPath (ранее это был pythonPath) на свой собственный путь (поэтому не копируйте/вставляйте вторую строку).</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-58435623"></a>21</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вам вообще не нужна эта строка. Просто удалите ее и переключите ваш интерпретатор Python на тот, что находится в вашем <span style=" font-family:'Courier New';">venv</span>. <a href="https://code.visualstudio.com/docs/python/environments#_select-and-activate-an-environment"><span style=" text-decoration: underline; color:#0000ff;">Вот соответствующая документация</span></a> (курсив выделен мной):</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Чтобы выбрать конкретную среду, используйте команду <span style=" font-weight:600;">Python: Select Interpreter</span> на палитре команд ( <span style=" font-family:'Courier New';">Ctrl</span>+ <span style=" font-family:'Courier New';">Shift</span>+ <span style=" font-family:'Courier New';">P</span>).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">... и открытие терминала с помощью команды <span style=" font-weight:600;">Terminal: Create New Integrated Terminal</span> . В последнем случае <span style=" font-style:italic;">VS Code автоматически активирует выбранную среду.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После переключения интерпретатора VS code должен создать <span style=" font-family:'Courier New';">.vscode</span>папку в вашем рабочем пространстве с <span style=" font-family:'Courier New';">settings.json</span>указанием интерпретатора python. Это даст VS code направление, где найти <span style=" font-family:'Courier New';">venv</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-65504572"></a>13</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Существует новый флаг, который можно использовать:<span style=" font-family:'Courier New';">&quot;python.terminal.activateEnvironment&quot;: true</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-76901285"></a>6</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">VS Code должен сделать это по умолчанию, если сможет найти ваш интерпретатор.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если по какой-то причине это невозможно или файл находится в другой папке, лучший способ сделать это — выполнить следующие 2 простых шага:</p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Установите интерпретатор для текущей папки/рабочего пространства</span></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">а. Введите <span style=" font-family:'Courier New';">Ctrl</span>+ <span style=" font-family:'Courier New';">Shift</span>+ <span style=" font-family:'Courier New';">P </span>из VS Code</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">б. Выберите «Python: выберите интерпретатор».</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">в) Найдите подходящую виртуальную среду одним из следующих способов:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор из вариантов в списке</li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Или нажмите «Ввести путь интерпретатора...», затем «Найти...» и найдите правильный исполняемый файл интерпретатора/Python.</li></ul>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Установите необходимые конфигурации в вашем</span><span style=" font-family:'Courier New'; font-weight:600;">settings.json</span></li>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Убедитесь, что среда автоматически активируется при открытии окна:</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:2; text-indent:0px;"><span style=" font-family:'Courier New';">&quot;python.terminal.activateEnvInCurrentTerminal&quot;: true</span></p>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">(Необязательно) Внутренне, <span style=" font-family:'Courier New';">&quot;python.terminal.activateEnvironment&quot;</span>установлено <span style=" font-family:'Courier New';">true</span>по умолчанию. Чтобы не активировать эту среду автоматически по умолчанию для нового терминала, установите ее <span style=" font-family:'Courier New';">false</span>в вашем <span style=" font-family:'Courier New';">settings.json</span>.</li></ul>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">(Необязательно) Вы также можете установить <span style=" font-family:'Courier New';">defaultInterpreterPath</span>как интерпретатор Python, который будет использоваться по умолчанию для ваших папок и рабочих пространств VS Code. Но вы, вероятно, захотите избежать <span style=" font-weight:600;">этого,</span> если у вас есть несколько сред локально для ваших различных папок/рабочих пространств.</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New';">&quot;python.defaultInterpreterPath&quot;: &quot;/path/to/bin/python&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Источник: <a href="https://code.visualstudio.com/docs/python/environments#_working-with-python-interpreters"><span style=" text-decoration: underline; color:#0000ff;">Документация VS Code.</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Примечание</span> : это, по-видимому, не работает для всех окон терминала, если у вас есть несколько окон «История восстановлена» при открытии нового окна VS Code.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-73805189"></a>1</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Моим решением было создать /.vscode/settings.json вручную.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот дерево;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">├───django│   ├───.vscode│   │   ├───settings.json</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Я создал /.vscode/settings.json, а затем добавил этот код в settings.json (я использую Windows, поэтому я использовал двойную обратную косую черту для пути, иначе возникнет ошибка Unicode, и не копируйте и не вставляйте это, найдите свой собственный .virtualenv)</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">{    &quot;python.defaultInterpreterPath&quot;: &quot;C:\\Users\\Talha\\.virtualenvs\\django-okd21pq9\\Scripts\\python.exe&quot;}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p></body></html>