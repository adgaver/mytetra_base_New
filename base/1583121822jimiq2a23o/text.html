<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ucoz-forum-post-54146"></a>Выкладываю код для позиционирования формы пока есть свободная минута :). <br />Код основан на стандартных возможностях экселя делать это. Короткое описание: <br /><br />mod_Functions - функции для перевода пикселей в точки и точек в пиксели <br />mod_GetDesktopMonitor - получение DPI системы и разрешения монитора <br />mod_GetRectForExcel2007Plus - получение прямоугольника координат ячейки в точках <br />mod_SetFormPosition - модуль позиционирования. Фиксит выход за пределы экрана, обрабатывает настройки и размещает форму <br />mod_Test - тестовый код <br /><br />В данном тестовом файла форма вызывается двойным кликом по ячейке. <br /><br />Можно задавать предпочтительную позицию формы при вызове процедуры позиционирования. Примеры: <br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Call SetFormPosition(Form, ActiveCell)<br /><br />' Позиция задается в аргументах процедуры<br />' Call SetFormPosition(Form, ActiveCell, -1, 1, -1, -1)<br />' Call SetFormPosition(Form, ActiveCell, 1, 1, -1, 1)<br />' Call SetFormPosition(Form, ActiveCell, 1, 1, 1, 1)<br />' Call SetFormPosition(Form, ActiveCell, 1, -1, -1, -1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><br />Если кто-то знает, как получить рабочую область экрана без WinAPI, пишите ) </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic; color:#8b4513;">К сообщению приложен файл:</span> <a href="http://www.excelworld.ru/_fr/53/test.xlsm"><span style=" text-decoration: underline; color:#0000ff;">test.xlsm</span></a><span style=" font-size:7pt;">(35.0 Kb)</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ucoz-forum-post-54365"></a>выделено красным <a href="http://u.to/N6PtAw"><span style=" text-decoration: underline; color:#0000ff;">https://disk.yandex.ru/public....JSHk%3D</span></a><span style=" color:#000000;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ucoz-forum-post-56797"></a>По позиционированию формы была тема у Чипа Пирсона, здесь: <br /><a href="http://u.to/dn8fBA"><span style=" text-decoration: underline; color:#0000ff;">http://www.cpearson.com/Excel/FormPosition.htm</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p></body></html>