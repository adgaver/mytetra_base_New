<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-weight:400; font-style:normal; "  bgcolor="#ffffff">
Version:0.9
StartHTML:0000000362
EndHTML:0000234784
StartFragment:0000000398
EndFragment:0000234748
SourceURL:http://excel-inside.pro/blog/2018/07/13/%d0%b0%d0%b1%d1%81%d0%be%d0%bb%d1%8e%d1%82%d0%bd%d1%8b%d0%b5-%d0%b8-%d0%be%d1%82%d0%bd%d0%be%d1%81%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d1%81%d1%81%d1%8b%d0%bb%d0%ba%d0%b8-power-query/#more-327
<html>
<body>
<!--StartFragment--><h1 id="post-title" style="box-sizing: border-box; font-size: 36px; margin: 0px 0px 30px; font-family: &quot;Open Sans&quot;, sans-serif; font-weight: 600; line-height: 1.1em; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Абсолютные и относительные ссылки в Power Query – подход в стиле Excel</h1><blockquote style="box-sizing: border-box; background-color: rgb(247, 247, 247); color: rgb(119, 119, 119); margin: 0px; padding: 30px; border-left: 6px solid rgb(170, 170, 170); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><p style="box-sizing: border-box; margin: 0px; line-height: 1.45em;">Эта статья – перевод моего <a href="http://excel-inside.pro/blog/2015/11/05/absolute-and-relative-references-in-power-query/" style="box-sizing: border-box; background: transparent; color: rgb(68, 68, 68); text-decoration: none; border-bottom: 1px dotted rgb(170, 170, 170);">первого поста в этом блоге</a>, который был опубликован 5 ноября 2015 года на английском языке. К моему удивлению, этот пост – самый популярный, за это время он набрал почти 21000 просмотров. С небольшими стилистическими правками публикую его на русском языке. В переводе помогал мой сын Дмитрий, за что ему отдельное спасибо.</p></blockquote><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Power Query – это мощный инструмент, способный на большее, чем просто брать данные из источника и переносить их в таблицу или Power Pivot. Данные можно очищать и преобразовывать множеством способов, но есть некоторые действия, привычные для Excel, которые не так удобно делать в Power Query.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Например, что, если мне нужна относительная ссылка на конкретную ячейку в таблице Power Query – значение из определённой строки в определённом столбце? Или ссылка на значение в определённом столбце на четыре строки выше? В Excel очевидно, как это сделать: нужно просто указать на нужное значение мышкой, убедиться, что из ссылки к строке убран знак “$” (знак абсолютной ссылки), и всё. Но в Power Query я не могу так просто это сделать.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Но всё же решение, хотя и непрямое, существует.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Прежде всего давайте выясним, как можно получить доступ к конкретному значению из таблицы Power Query.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Простейший способ понять адресацию в Power Query, по-моему, анализировать код шагов.</p><h2 style="box-sizing: border-box; font-family: &quot;Open Sans&quot;, sans-serif; font-weight: 600; margin-bottom: 30px; font-size: 28px; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Абсолютные ссылки на строки</h2><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Допустим, у нас есть простая таблица из двух столбцов: даты (Date) и количества (Amount). В ней пять строк, и в первом столбце стоят, как ни странно, даты, во втором – какие-то значения:</p><div id="attachment_8" class="wp-caption alignnone" style="box-sizing: border-box; max-width: 97%; font-size: 14px; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a href="http://excel-inside.pro/wp-content/uploads/2015/11/Sample0.jpg" style="box-sizing: border-box; background: transparent; color: rgb(68, 68, 68); text-decoration: none; border-bottom: 1px dotted rgb(170, 170, 170);"></a><p id="caption-attachment-8" class="wp-caption-text" style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(170, 170, 170); margin-top: 2px;">Исходные данные</p></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Мы хотим получить значение из ячейки B4, а именно <strong style="box-sizing: border-box; font-weight: bold;">120</strong>.<span id="more-327" style="box-sizing: border-box;"></span><br style="box-sizing: border-box;">В Excel это просто: мы просто пишем ссылку вроде =B4, или =R4C2 в стиле R1C1.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Можно ли использовать этот стиль ссылок (R1C1) в Power Query? Да.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Загрузите эту таблицу в Power Query, щёлкните правой мышкой по нужному значению и выберите “drill to details”. Отлично, мы получили 120.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Теперь взглянем на код.</p><div id="crayon-654dda4b80ea8647138336" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 92px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 0px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="show" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ea8647138336-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div><div class="crayon-num" data-line="crayon-654dda4b80ea8647138336-2" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">2</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom" data-line="crayon-654dda4b80ea8647138336-3" style="box-sizing: border-box; font-family: inherit; background: rgb(179, 211, 244) !important; border-width: 1px !important; border-top-style: solid !important; border-right-style: initial; border-bottom-style: solid !important; border-left-style: initial; border-color: rgb(89, 153, 217) !important; border-image: initial; padding: 0px 5px; margin: 0px; text-align: center; height: 20px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(21, 97, 172) !important;">3</div><div class="crayon-num" data-line="crayon-654dda4b80ea8647138336-4" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">4</div><div class="crayon-num" data-line="crayon-654dda4b80ea8647138336-5" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">5</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 707.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ea8647138336-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-r" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">let</span></div><div class="crayon-line" id="crayon-654dda4b80ea8647138336-2" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">    </span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Source</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span>=<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-st" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">Excel.CurrentWorkbook</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">(</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">)</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Name</span>=<span class="crayon-s" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">"Tab_1"</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Content</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom" id="crayon-654dda4b80ea8647138336-3" style="box-sizing: border-box; font-family: inherit; background: rgb(255, 254, 226) !important; border-width: 1px !important; border-top-style: solid !important; border-right-style: initial; border-bottom-style: solid !important; border-left-style: initial; border-color: rgb(233, 229, 121) !important; border-image: initial; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">    </span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Amount</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span>=<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">2</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span></div><div class="crayon-line" id="crayon-654dda4b80ea8647138336-4" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-r" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">in</span></div><div class="crayon-line" id="crayon-654dda4b80ea8647138336-5" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">    </span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Amount</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">В третьей строке кода мы видим искомую ссылку. Заметьте, что мы ссылаемся на предыдущий шаг (как обычно), затем пишем {2} и затем название столбца [Amount].</p><blockquote style="box-sizing: border-box; background-color: rgb(247, 247, 247); color: rgb(119, 119, 119); margin: 0px; padding: 30px; border-left: 6px solid rgb(170, 170, 170); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><p style="box-sizing: border-box; margin: 0px; line-height: 1.45em;"><strong style="box-sizing: border-box; font-weight: bold;">Важно</strong>: строки и списки в Power Query нумеруются с нуля: первая позиция в списке всегда имеет номер 0, то же самое касается номеров строк в таблице. Поэтому, запрашивая в Power Query значение из<span> </span><span style="box-sizing: border-box; text-decoration: underline;">третьей</span><span> </span>строки, мы должны использовать<span> </span><span style="box-sizing: border-box; text-decoration: underline;">число 2</span><span> </span>для обозначения строки.</p></blockquote><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Эта формула расшифровывается так: дай мне значение из поля [<strong style="box-sizing: border-box; font-weight: bold;">Amount</strong>] в строке с<span> </span><strong style="box-sizing: border-box; font-weight: bold;">индексом 2</strong><span> </span>таблицы <strong style="box-sizing: border-box; font-weight: bold;">Source</strong>. Иными словами, формула ищет определённый номер записи в таблице и затем возвращает значение определённого поля из этой записи.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Формула, полученная нами из редактора, фактически использует два последовательных подхода: выражение: <code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span> </span><span id="crayon-654dda4b80eb1434304408" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name{Argument}</span></span> </code> и выражение <span> </span><span id="crayon-654dda4b80eb4579147102" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Record[Field]</span></span>.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Синтаксис <code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span> </span><span id="crayon-654dda4b80eb5112491454" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name{Argument}</span></span></code> имеет несколько реализаций:</p><ol style="box-sizing: border-box; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box; margin: 0px 0px 5px 18px;">если<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80eb7650088154" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name</span></span></code> – это <strong style="box-sizing: border-box; font-weight: bold;">список (list)</strong>, а <em style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span> </span><span id="crayon-654dda4b80eb8345421916" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Argument</span></span></code></em>– <strong style="box-sizing: border-box; font-weight: bold;">число (number)</strong>, выражение возвращает элемент с соответствующим номером из списка <em style="box-sizing: border-box;">Name</em>;</li><li style="box-sizing: border-box; margin: 0px 0px 5px 18px;">если<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80eba276836427" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name</span></span></code> – это <strong style="box-sizing: border-box; font-weight: bold;">таблица (table)</strong>, а<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ebb269953620" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Argument</span></span></code> – <strong style="box-sizing: border-box; font-weight: bold;">число (number)</strong>, выражение возвращает строку с соответствующим номером из таблицы <em style="box-sizing: border-box;">Name</em>;</li><li style="box-sizing: border-box; margin: 0px 0px 5px 18px;">если<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ebd859046824" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name</span></span></code> – это<span> </span><strong style="box-sizing: border-box; font-weight: bold;">таблица (table)</strong>, а<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ebe958379929" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Argument</span></span></code> – <strong style="box-sizing: border-box; font-weight: bold;">запись (record)</strong>, выражение возвращает<span> </span><span style="box-sizing: border-box; text-decoration: underline;">уникальную</span><span> </span>строку из таблицы<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ebf717292417" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name</span></span></code>, в которой значения полей соответствуют значениям аналогичных полей записи<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ec2171801636" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Argument</span></span></code>.</li></ol><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Последний вариант даёт представить множество возможностей использования, но сейчас мы вернемся прямо к нашему вопросу: абсолютные и относительные ссылки на одиночное значение.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Выражение<span> </span><span id="crayon-654dda4b80ec3940035356" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Record[Field]</span></span> имеет почти такой же синтаксис: оно ищет поле в записи по имени поля. Если в записи нет указанного поля, код выдаёт ошибку.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Взгляните снова на нашу формулу: сперва мы получаем строку (запись) из таблицы Source с номером 2:</p><div id="crayon-654dda4b80ec5124998360" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ec5124998360-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ec5124998360-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">2</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Затем из этой записи мы получаем поле [Amount] (строка таблицы – это запись с именами столбцов в качестве имён полей):</p><div id="crayon-654dda4b80ec6865545907" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ec6865545907-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ec6865545907-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">2</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Выглядит просто, да?</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Но погодите, если мы запросим в Power Query одиночный столбец из таблицы, мы получим как раз нужный список:</p><div id="crayon-654dda4b80ec8540544773" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ec8540544773-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ec8540544773-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">MyList</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Так что, если нам нужно конкретное значение из этого списка (см. первый пункт в описании синтаксиса<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ec9979227635" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name{Argument}</span></span></code>выше), мы просто добавляем в фигурных скобках номер значения после имени списка:</p><div id="crayon-654dda4b80ecb567293585" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ecb567293585-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ecb567293585-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">MyValue</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">MyList</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">2</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Эти два шага можно сократить в один:</p><div id="crayon-654dda4b80ecc418773268" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ecc418773268-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ecc418773268-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">MyValue</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span>=<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">2</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">и получить искомое значение, 120.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Таким образом, у нас фактически есть два возможных способа обратиться к одиночному значению в таблице Power Query.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Давайте сравним два способа адресации:</p><ul style="box-sizing: border-box; margin-bottom: 30px; padding: 0px; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box; margin: 0px 0px 5px 18px;">Обратиться к определённой записи в таблице и получить определённое поле из этой записи:<span> </span><span id="crayon-654dda4b80ecd251596225" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">MyValue</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"><span> </span></span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"><span> </span></span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">2</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span></span></span></li></ul><ul style="box-sizing: border-box; margin-bottom: 30px; padding: 0px; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box; margin: 0px 0px 5px 18px;">Получить список из столбца таблицы и получить значение по определённому номеру в этом списке:<span> </span><span id="crayon-654dda4b80ecf629417904" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">MyValue</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"><span> </span></span>=<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"><span> </span></span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">2</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span></span></span></li></ul><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Они выглядят очень похоже, и может показаться, что нет разницы, в каком порядке ставить название столбца и порядковый номер. На самом деле это два разных подхода, и это нужно запомнить, чтобы использовать в будущем.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Но в любом случае оба подхода дают нам ключ к любым ссылкам на строки в таблицах Power Query.</p><h2 style="box-sizing: border-box; font-family: &quot;Open Sans&quot;, sans-serif; font-weight: 600; margin-bottom: 30px; font-size: 28px; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Относительные ссылки на строки</h2><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">В таблице-образце находятся данные, похожие на остатки на счёте. Предположим, нам нужно добавить столбец, вычисляющий и показывающий изменение значения на счёте. Для этого нужно получить значение из предыдущей строки и сравнить его со значением в текущей строке.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Но в предыдущих примерах мы видели, что ссылка на позицию и столбец зашиты внутрь формулы. Значит, нам нужно найти способ преобразовать номера строк в относительные ссылки.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">И здесь нам (вновь) приходит на помощь Excel. Что бы мы сделали в Excel, чтобы произвести такое вычисление? В простом случае мы просто помещаем в ячейку C3 формулу <span> </span><span id="crayon-654dda4b80ed1024494887" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">B3</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">B2</span></span></span> и растягиваем её на столбец. Но, если мы запишем эту формулу в стиле R1C1, то получим следующее: <span> </span><span id="crayon-654dda4b80ed2430733632" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">RC</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">R</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">C</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span></span></span></p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Это значит: возьми значение из этой строки и столбца на один левее и вычти из него значение из строки на одну выше и столбца на один левее. В Power Query в большинстве случаев мы будем работать с данными из известных столбцов, так что давайте представим, что мы можем опустить часть, относящуюся к столбцу, и ссылаться только на строку, в стиле R1:<span> </span><span id="crayon-654dda4b80ed4483843687" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-i" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">R</span>–<span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">R</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span></span></span></p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Итак, вот оно. Нам нужно получить номер текущей строки и вычислить номер предыдущей, чтобы использовать формулу такого рода:</p><div id="crayon-654dda4b80ed5743054020" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 36px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ed5743054020-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 36px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ed5743054020-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;">=<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">current_row_number</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span>-<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">current_row_number</span>-<span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">или</p><div id="crayon-654dda4b80ed7653952617" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 36px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ed7653952617-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 36px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ed7653952617-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;">=<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">current_row_number</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span>-<span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Source</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">current_row_number</span>-<span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Итак, можно ли получить номер строки в Power Query? Да, с помощью специального столбца индексов <strong style="box-sizing: border-box; font-weight: bold;">Index</strong>.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Столбец индексов генерирует список целочисленных значений, начинающихся с N, с шагом S для каждой строки таблицы. Интерфейс Power Query позволяет выбрать один из двух наиболее популярных вариантов столбцов индексов: “From 0” (с нуля, по умолчанию) или “From 1” (с единицы, оба с шагом 1) – или создать собственный список со своими значениями параметров Start (начальное значение) и Step (шаг).</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Давайте добавим столбец индексов, начинающихся с нуля, после шага<span> </span><em style="box-sizing: border-box;">Source</em><span> </span>в Power Query:</p><div id="crayon-654dda4b80ed9422820828" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ed9422820828-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ed9422820828-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-p" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(184, 92, 0) !important;">#"Added index" = Table.AddIndexColumn(Source, "Index", 0, 1)</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Теперь у нас есть всё, что нужно: мы знаем название столбца и можем получить из столбца индексов номер строки. Давайте переименуем предыдущий шаг в<span> </span><span id="crayon-654dda4b80eda620401430" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">AddInd</span></span></span> для ускорения написания и новым шагом добавим собственный вычисляемый столбец, вводя следующую формулу в диалоговое окно:</p><div id="crayon-654dda4b80edc027736800" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80edc027736800-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80edc027736800-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;">=<span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span>-<span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span>-<span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Таким образом, полная формула этого шага выглядит так:</p><div id="crayon-654dda4b80edd301688890" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 36px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80edd301688890-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 36px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80edd301688890-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Table</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddColumn</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">(</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-s" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">"Custom"</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-st" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">each</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">)</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Мы только что сделали следующее: в каждой строке таблицы мы ссылаемся на значение из столбца<span> </span><span id="crayon-654dda4b80edf993161053" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span></span></span> как аргумент для выражения<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ee1912698555" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Name{Argument}</span></span></code>.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">В этом примере я использовал тип ссылки по положению в списке (см. п.1), а не по записи в таблице. Посмотрите на результат в окне предпросмотра Power Query:</p><div id="attachment_9" class="wp-caption alignnone" style="box-sizing: border-box; max-width: 97%; font-size: 14px; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a href="http://excel-inside.pro/wp-content/uploads/2015/11/Sample1.jpg" style="box-sizing: border-box; background: transparent; color: rgb(68, 68, 68); text-decoration: none; border-bottom: 1px dotted rgb(170, 170, 170);"></a><p id="caption-attachment-9" class="wp-caption-text" style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(170, 170, 170); margin-top: 2px;">Здесь можно увидеть, как работают относительные ссылки на строки в Power Query</p></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">У нас есть искомый список изменений значений из столбца<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ee2160796866" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">Amount</span></span></code>, но с<span> </span><em style="box-sizing: border-box;"><strong style="box-sizing: border-box; font-weight: bold;">ошибкой (error)</strong></em> в первой строке. Очевидно, ведь строки с номером (0-1)=-1 нет. Если бы мы использовали ссылку<span> </span><span style="box-sizing: border-box; text-decoration: underline;">больше</span><span> </span>последнего номера строки, то нужно было бы использовать “?” (вопросительный знак) после ссылки на номер строки. Это называется “факультативный выбор объекта”.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Давайте посмотрим, как это работает. Вернёмся на шаг назад и добавим ещё один столбец со следующей формулой:</p><div id="crayon-654dda4b80ee4399885868" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ee4399885868-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ee4399885868-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">+</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">?</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Мы получим вот это:</p><div id="attachment_10" class="wp-caption alignnone" style="box-sizing: border-box; max-width: 97%; font-size: 14px; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a href="http://excel-inside.pro/wp-content/uploads/2015/11/Sample2.jpg" style="box-sizing: border-box; background: transparent; color: rgb(68, 68, 68); text-decoration: none; border-bottom: 1px dotted rgb(170, 170, 170);"></a><p id="caption-attachment-10" class="wp-caption-text" style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(170, 170, 170); margin-top: 2px;">“Факультативный выбор объекта” возвращает null, если выйти за границу количества строк</p></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">т.е. ссылка на несуществующий номер в списке была заменена значением null. Но, как я уже говорил, это работает только с номерами<span> </span><span style="box-sizing: border-box; text-decoration: underline;">не меньше</span><span> </span>количества объектов в списке (или записей в таблице). Для отрицательных номеров формула выдаёт ошибку.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Теперь давайте уберём этот шаг и вернёмся к добавленному ранее столбцу с ошибкой в первой строке.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Что можно сделать с этой ошибкой? Мы можем добавить ещё один шаг с помощью UI: замену ошибок. Просто выбираем наш столбец Custom, затем на вкладке Transform выполняем Replace errors…, и вводим в диалоговое окно значение 0. Либо просто добавляем эту формулу в редактор:</p><div id="crayon-654dda4b80ee5457684840" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ee5457684840-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ee5457684840-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">RemErrs</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">=</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Table</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">.</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">ReplaceErrorValues</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">(</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">AddCust1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-s" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 128, 0) !important;">"Custom"</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">,</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">0</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">)</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Отлично, мы получили, что хотели:</p><div id="attachment_11" class="wp-caption alignnone" style="box-sizing: border-box; max-width: 97%; font-size: 14px; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a href="http://excel-inside.pro/wp-content/uploads/2015/11/Sample3.jpg" style="box-sizing: border-box; background: transparent; color: rgb(68, 68, 68); text-decoration: none; border-bottom: 1px dotted rgb(170, 170, 170);"></a><p id="caption-attachment-11" class="wp-caption-text" style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(170, 170, 170); margin-top: 2px;">Теперь мы заменили ошибки определёнными фиксированными значениями</p></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Если мы хотим заменить ошибки не точными значениями, а другими вычислениями или функциями, лучше использовать конструкцию<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80ee7909319417" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">try - otherwise</span></span></code>, работающую как функция IFERROR (ЕСЛИОШИБКА)в Excel. Нужно просто исправить предыдущий шаг (на котором мы добавляли первый вычисляемый столбец). Щёлкните шестерёнку (“gear”) рядом с именем шага и замените формулу следующей:</p><div id="crayon-654dda4b80ee8904241264" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 728.656px; padding: 0px; margin: 12px 0px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(153, 153, 153) !important; border-style: solid !important; text-shadow: none !important; background: rgb(253, 253, 253) !important; color: rgb(85, 85, 85); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-size: 16px !important; line-height: 18px !important; height: auto;"><div class="crayon-plain-wrap" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px !important; margin: 0px !important; text-align: left; height: auto !important;"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="box-sizing: border-box; color: rgb(0, 0, 0); font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 16px !important; line-height: 18px !important; font-family: &quot;Courier New&quot;, monospace !important; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; margin: 0px; overflow: hidden; border: 0px; padding: 0px 5px; width: 726.656px; border-radius: 0px; height: 18px; position: absolute; opacity: 0; box-shadow: none; white-space: pre-wrap; overflow-wrap: normal; resize: none; background: rgb(255, 255, 255); tab-size: 4; z-index: 0;"></textarea></div><div class="crayon-main" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; width: 726.656px; overflow: hidden; position: relative; z-index: 1;"><table class="crayon-table" style="box-sizing: border-box; border-collapse: collapse !important; border-spacing: 0px !important; width: auto !important; font-size: 12px; border: none !important; padding: 0px !important; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: -21px; margin-top: 0px !important; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; table-layout: auto !important;"><tbody style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important;"><tr class="crayon-row" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; padding: 0px !important; border: none !important; vertical-align: top !important; margin: 0px !important;"><td class="crayon-nums " data-settings="hide" style="box-sizing: border-box; padding: 0px !important; background: rgb(223, 239, 255) !important; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; color: rgb(84, 153, 222) !important;"><div class="crayon-nums-content" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: 0px center; border: 0px; padding: 0px; margin: 0px; text-align: left; white-space: nowrap; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-654dda4b80ee8904241264-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: center; height: 18px; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important;">1</div></div></td><td class="crayon-code" style="box-sizing: border-box; padding: 0px !important; background: 0px center; border: 0px; font-weight: 400; font-family: &quot;Courier New&quot;, monospace !important; vertical-align: top !important; margin: 0px !important; width: 728.047px;"><div class="crayon-pre" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; background: none !important; border: none !important; padding: 0px; margin: 0px; text-align: left; color: rgb(0, 0, 0); white-space: pre; overflow: visible; tab-size: 4; font-size: 16px !important; line-height: 18px !important;"><div class="crayon-line" id="crayon-654dda4b80ee8904241264-1" style="box-sizing: border-box; font-family: inherit; background: 0px center; border: 0px; padding: 0px 5px; margin: 0px; text-align: left; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; word-break: break-all; white-space: pre-wrap !important;"><span class="crayon-st" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(128, 0, 128) !important;">try</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">AddInd</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-e" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 78, 208) !important;">Amount</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">{</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">[</span><span class="crayon-v" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 45, 122) !important;">Index</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">]</span><span class="crayon-o" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;">-</span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">1</span><span class="crayon-sy" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(51, 51, 51) !important;">}</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-i" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 0, 0) !important;">otherwise</span><span class="crayon-h" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(0, 111, 224) !important;"> </span><span class="crayon-cn" style="box-sizing: border-box; font-family: inherit; height: inherit; font-size: inherit !important; line-height: inherit !important; font-weight: inherit !important; color: rgb(206, 0, 0) !important;">0</span></div></div></td></tr></tbody></table></div></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">или внесите необходимые исправления прямо в строке формул. После оператора<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80eea582108798" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">otherwise</span></span></code><span> </span>может идти любое выражение, например, вы можете использовать собственную функцию, ввести текст или вернуть<span> </span><code style="box-sizing: border-box; font-family: monospace, monospace; font-size: 1em;"><span id="crayon-654dda4b80eeb358495494" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-courier-new" style="box-sizing: border-box; text-align: left; text-size-adjust: none; overflow: hidden !important; position: relative !important; direction: ltr !important; width: 100%; padding: 0px 2px; margin: 0px 2px; font-family: Monaco, MonacoRegular, &quot;Courier New&quot;, monospace; font-weight: 500; border-width: 1px !important; border-color: rgb(221, 221, 221) !important; border-style: solid !important; text-shadow: none !important; background: rgb(250, 250, 250) !important; line-height: 18px !important; font-size: 16px !important;"><span class="crayon-pre crayon-code" style="box-sizing: border-box; font-family: &quot;Courier New&quot;, monospace !important; width: 100%; color: rgb(0, 0, 0); white-space: normal; margin: 0px; padding: 0px; overflow: visible; tab-size: 4; background: none !important; border: none !important; line-height: 18px !important; font-size: 16px !important;">null</span></span></code>.</p><div id="attachment_12" class="wp-caption alignnone" style="box-sizing: border-box; max-width: 97%; font-size: 14px; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a href="http://excel-inside.pro/wp-content/uploads/2015/11/Sample4.jpg" style="box-sizing: border-box; background: transparent; color: rgb(68, 68, 68); text-decoration: none; border-bottom: 1px dotted rgb(170, 170, 170);"></a><p id="caption-attachment-12" class="wp-caption-text" style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(170, 170, 170); margin-top: 2px;">Теперь мы заменили ошибки с помощью выражения “try-otherwise”</p></div><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Эй, да это же всё. Поздравляю, теперь мы знаем, как создавать абсолютные и относительные ссылки в таблицах Power Query.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Этот приём полезен во многих случаях, в основном при преобразовании и очистке сырых данных.</p><blockquote style="box-sizing: border-box; background-color: rgb(247, 247, 247); color: rgb(119, 119, 119); margin: 0px; padding: 30px; border-left: 6px solid rgb(170, 170, 170); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><p style="box-sizing: border-box; margin: 0px; line-height: 1.45em;"><strong style="box-sizing: border-box; font-weight: bold;">Но ОСТОРОЖНО:</strong> <em style="box-sizing: border-box;">использование относительных ссылок в таблицах с большим количеством данных может поглощать очень много ресурсов и увеличивать время обновления запроса.</em></p></blockquote><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Вы можете <a href="http://1drv.ms/1Sr07yw" target="_blank" rel="noopener noreferrer" style="box-sizing: border-box; background: transparent; color: rgb(68, 68, 68); text-decoration: none; border-bottom: 1px dotted rgb(170, 170, 170);">загрузить книгу-образец</a>, чтобы посмотреть, как это работает, и опробовать все приёмы из этой записи.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">А как насчёт относительных ссылок по столбцу? Чуть сложнее и реже встречается, но мы можем сделать и это. В следующий раз.</p><p style="box-sizing: border-box; margin-bottom: 30px; line-height: 1.45em; color: rgb(85, 85, 85); font-family: &quot;Source Sans Pro&quot;, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Если вы хотите почитать больше о продвинутых преобразованиях и моделировании данных в Power Query, я рекомендую следующие книги:</p><!--EndFragment-->
</body>
</html></body></html>