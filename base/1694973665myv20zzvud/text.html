<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-weight:400; font-style:normal; "  bgcolor="#ffffff">
Version:0.9
StartHTML:0000000183
EndHTML:0000021584
StartFragment:0000000219
EndFragment:0000021548
SourceURL:https://vremya-ne-zhdet.ru/vba-excel/metod-range-removeduplicates/
<html>
<body>
<!--StartFragment--><div class="entry-header" style="box-sizing: border-box; text-align: var(--textalign,center); --textalign: left; margin-top: 60px; margin-bottom: var(--spacing,60px); color: rgb(39, 38, 38); font-family: Arial, Helvetica, sans-serif, Arial, Helvetica, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><div class="nv-title-meta-wrap" style="box-sizing: border-box;"><h1 class="title entry-title" style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0px; font-size: var(--fontsize,var(--h1fontsize)); font-weight: var(--fontweight,var(--h1fontweight)); font-family: var(--headingsfontfamily),var(--nv-fallback-ff); line-height: var(--lineheight,var(--h1lineheight)); letter-spacing: var(--letterspacing,var(--h1letterspacing)); text-transform: var(--texttransform,var(--h1texttransform)); overflow-wrap: break-word;">VBA Excel. Удаление повторяющихся значений в диапазоне ячеек</h1><ul class="nv-meta-list" style="box-sizing: border-box; margin: 0px 0px 20px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: var(--listpad,0); list-style: var(--liststyle,none); font-size: 0.9em; --avatarsize: 20px;"></ul></div></div><div class="nv-content-wrap entry-content" style="box-sizing: border-box; counter-reset: footnotes 0; --listpad: 20px; --liststyle: disc; --img-m: 24px; margin-bottom: var(--spacing,60px); color: rgb(39, 38, 38); font-family: Arial, Helvetica, sans-serif, Arial, Helvetica, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><em style="box-sizing: border-box;">Удаление повторяющихся значений (дубликатов) в диапазоне ячеек с помощью кода VBA Excel. Метод Range.RemoveDuplicates — синтаксис, параметры, примеры.</em><span id="more-2132" style="box-sizing: border-box;"></span></p><div class="lwptoc lwptoc-autoWidth lwptoc-baseItems lwptoc-light lwptoc-notInherit" data-smooth-scroll="1" data-smooth-scroll-offset="24" data-lwptoc-initialized="1" style="box-sizing: border-box; margin: 32px 0px;"><div class="lwptoc_i" style="box-sizing: border-box; padding: 14px 18px 18px; text-align: left; display: inline-block; color: rgb(51, 51, 51); background: rgb(250, 250, 250);"><div class="lwptoc_header" style="box-sizing: border-box; margin-bottom: 6px;"><b class="lwptoc_title" style="box-sizing: border-box; font-weight: 600;">Содержание</b></div><div class="lwptoc_items lwptoc_items-visible" style="box-sizing: border-box; font-size: 14.4px;"><div class="lwptoc_itemWrap" style="box-sizing: border-box;"><div class="lwptoc_item" style="box-sizing: border-box; margin-top: 0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-removeduplicates/#Metod_RangeRemoveDuplicates" style="box-sizing: border-box; --linkdeco: underline; color: rgb(49, 117, 228); cursor: pointer; text-decoration: none !important; box-shadow: none !important; border: none !important;"><span class="lwptoc_item_number" style="box-sizing: border-box; margin-right: 2px;">1.</span><span> </span><span class="lwptoc_item_label" style="box-sizing: border-box;">Метод Range.RemoveDuplicates</span></a><div class="lwptoc_itemWrap" style="box-sizing: border-box; margin: 2px 0px 0px 14px;"><div class="lwptoc_item" style="box-sizing: border-box; margin-top: 0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-removeduplicates/#Sintaksis_metoda_RangeRemoveDuplicates" style="box-sizing: border-box; --linkdeco: underline; color: rgb(49, 117, 228); cursor: pointer; text-decoration: none !important; box-shadow: none !important; border: none !important;"><span class="lwptoc_item_number" style="box-sizing: border-box; margin-right: 2px;">1.1.</span><span> </span><span class="lwptoc_item_label" style="box-sizing: border-box;">Синтаксис метода Range.RemoveDuplicates</span></a></div><div class="lwptoc_item" style="box-sizing: border-box; margin-top: 2px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-removeduplicates/#Parametry_metoda_RangeRemoveDuplicates" style="box-sizing: border-box; --linkdeco: underline; color: rgb(49, 117, 228); cursor: pointer; text-decoration: none !important; box-shadow: none !important; border: none !important;"><span class="lwptoc_item_number" style="box-sizing: border-box; margin-right: 2px;">1.2.</span><span> </span><span class="lwptoc_item_label" style="box-sizing: border-box;">Параметры метода Range.RemoveDuplicates</span></a></div></div></div><div class="lwptoc_item" style="box-sizing: border-box; margin-top: 2px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-removeduplicates/#Primery_udalenia_dublikatov" style="box-sizing: border-box; --linkdeco: underline; color: rgb(49, 117, 228); cursor: pointer; text-decoration: none !important; box-shadow: none !important; border: none !important;"><span class="lwptoc_item_number" style="box-sizing: border-box; margin-right: 2px;">2.</span><span> </span><span class="lwptoc_item_label" style="box-sizing: border-box;">Примеры удаления дубликатов</span></a></div></div></div></div></div><h2 style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px; font-size: var(--h2fontsize); font-weight: var(--h2fontweight); font-family: var(--headingsfontfamily),var(--nv-fallback-ff); line-height: var(--h2lineheight); letter-spacing: var(--h2letterspacing); text-transform: var(--h2texttransform);"><span id="Metod_RangeRemoveDuplicates" style="box-sizing: border-box;">Метод Range.RemoveDuplicates</span></h2><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Метод Range.RemoveDuplicates предназначен в VBA Excel для удаления повторяющихся значений по столбцам в заданном диапазоне ячеек рабочего листа. Строки с обнаруженными дубликатами удаляются целиком.</p><h3 style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px; font-size: var(--h3fontsize); font-weight: var(--h3fontweight); font-family: var(--headingsfontfamily),var(--nv-fallback-ff); line-height: var(--h3lineheight); letter-spacing: var(--h3letterspacing); text-transform: var(--h3texttransform);"><span id="Sintaksis_metoda_RangeRemoveDuplicates" style="box-sizing: border-box;">Синтаксис метода Range.RemoveDuplicates</span></h3><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;"><code style="box-sizing: border-box; background: rgb(208, 239, 251); border-radius: 5px; border: 1px solid var(--nv-light-bg); padding: 0px 3px; color: rgb(51, 51, 51);">expression. RemoveDuplicates (Columns , Header)</code></strong>,</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">где<span> </span><strong style="box-sizing: border-box;">expression</strong><span> </span>— переменная или выражение, возвращающее объект Range.</p><h3 style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px; font-size: var(--h3fontsize); font-weight: var(--h3fontweight); font-family: var(--headingsfontfamily),var(--nv-fallback-ff); line-height: var(--h3lineheight); letter-spacing: var(--h3letterspacing); text-transform: var(--h3texttransform);"><span id="Parametry_metoda_RangeRemoveDuplicates" style="box-sizing: border-box;">Параметры метода Range.RemoveDuplicates</span></h3><table style="box-sizing: border-box; border-collapse: separate; border-spacing: 0px; border-width: 1px 0px 0px 1px; margin: 0px 0px 20px; width: 960px; word-break: initial;"><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box;"><th width="30%" style="box-sizing: border-box; padding: 20px 20px 10px; text-align: center; border: 1px solid rgb(47, 79, 79); background: rgb(234, 234, 234);">Наименование</th><th width="70%" style="box-sizing: border-box; padding: 20px 20px 10px; text-align: center; border: 1px solid rgb(47, 79, 79); background: rgb(234, 234, 234);">Описание</th></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box; padding: 20px; text-align: left; font-size: 0.9em; border: 1px solid rgb(47, 79, 79); background: rgb(255, 247, 236);"><em style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Columns</strong></em></td><td style="box-sizing: border-box; padding: 20px; text-align: left; font-size: 0.9em; border: 1px solid rgb(47, 79, 79); background: rgb(255, 247, 236);"><em style="box-sizing: border-box;">Массив индексов столбцов, содержащих ячейки с повторяющимися значениями. Обязательный параметр. Тип данных – Variant.</em></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box; padding: 20px; text-align: left; font-size: 0.9em; border: 1px solid rgb(47, 79, 79); background: rgb(255, 247, 236);"><em style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Header</strong></em></td><td style="box-sizing: border-box; padding: 20px; text-align: left; font-size: 0.9em; border: 1px solid rgb(47, 79, 79); background: rgb(255, 247, 236);"><em style="box-sizing: border-box;">Указывает, содержит ли первая строка диапазона заголовок, который не участвует в поиске дубликатов:</em><ul style="box-sizing: border-box; margin: 30px 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: var(--listpad,0); list-style: var(--liststyle,none);"><li style="box-sizing: border-box; margin: 10px 0px 0px; padding: 0px;"><em style="box-sizing: border-box;"><strong style="box-sizing: border-box;">xlNo</strong><span> </span>— первая строка списка не содержит заголовок (значение по умолчанию);</em></li><li style="box-sizing: border-box; margin: 10px 0px 0px; padding: 0px;"><em style="box-sizing: border-box;"><strong style="box-sizing: border-box;">xlYes</strong><span> </span>— первая строка диапазона содержит заголовок;</em></li><li style="box-sizing: border-box; margin: 10px 0px 0px; padding: 0px;"><em style="box-sizing: border-box;"><strong style="box-sizing: border-box;">xlGuess</strong><span> </span>— VBA Excel решает сам, есть ли у списка заголовок.</em></li></ul><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><em style="box-sizing: border-box;">Необязательный параметр. Тип данных – XlYesNoGuess.</em></p></td></tr></tbody></table><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Метод работает как с круглыми скобками, в которые заключены параметры, так и без них. Если требуется указать несколько столбцов в параметре<span> </span><strong style="box-sizing: border-box;">Columns</strong>, следует использовать функцию Array, например, Array(2, 3).</p><h2 style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px; font-size: var(--h2fontsize); font-weight: var(--h2fontweight); font-family: var(--headingsfontfamily),var(--nv-fallback-ff); line-height: var(--h2lineheight); letter-spacing: var(--h2letterspacing); text-transform: var(--h2texttransform);"><span id="Primery_udalenia_dublikatov" style="box-sizing: border-box;">Примеры удаления дубликатов</span></h2><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;">Исходная таблица для всех примеров</strong></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><a href="https://vremya-ne-zhdet.ru/wp-content/uploads/2019/03/tablitsa-dublikatov-1.png" target="_blank" rel="noopener" style="box-sizing: border-box; --linkdeco: underline; color: var(--nv-primary-accent); cursor: pointer; text-decoration: var(--linkdeco);"></a></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">По третьей колонке легко определить, какие строки были удалены.</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;">Пример 1</strong><br style="box-sizing: border-box;">Удаление повторяющихся значений по первому столбцу:</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;"><code style="box-sizing: border-box; background: rgb(208, 239, 251); border-radius: 5px; border: 1px solid var(--nv-light-bg); padding: 0px 3px; color: rgb(51, 51, 51);">Range("A1:C10").RemoveDuplicates 1</code></strong></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">или</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;"><code style="box-sizing: border-box; background: rgb(208, 239, 251); border-radius: 5px; border: 1px solid var(--nv-light-bg); padding: 0px 3px; color: rgb(51, 51, 51);">Range(Cells(1, 1), Cells(10, 3)).RemoveDuplicates (1)</code></strong></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Второй вариант позволяет использовать вместо индексов строк и столбцов переменные. Наличие или отсутствие скобок, в которые заключен параметр<span> </span><strong style="box-sizing: border-box;">Columns</strong>, на работу метода не влияет.</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Результат:</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><a href="https://vremya-ne-zhdet.ru/wp-content/uploads/2019/03/tablitsa-dublikatov-2.png" target="_blank" rel="noopener" style="box-sizing: border-box; --linkdeco: underline; color: var(--nv-primary-accent); cursor: pointer; text-decoration: var(--linkdeco);"></a></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;">Пример 2</strong><br style="box-sizing: border-box;">Удаление дубликатов по первому столбцу с указанием, что первая строка содержит заголовок:</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;"><code style="box-sizing: border-box; background: rgb(208, 239, 251); border-radius: 5px; border: 1px solid var(--nv-light-bg); padding: 0px 3px; color: rgb(51, 51, 51);">Range("A1:C10").RemoveDuplicates 1, xlYes</code></strong></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Результат:</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><a href="https://vremya-ne-zhdet.ru/wp-content/uploads/2019/03/tablitsa-dublikatov-3.png" target="_blank" rel="noopener" style="box-sizing: border-box; --linkdeco: underline; color: var(--nv-primary-accent); cursor: pointer; text-decoration: var(--linkdeco);"></a></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Здесь мы видим, что первая строка не учитывалась при поиске повторяющихся значений.</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;">Пример 3</strong><br style="box-sizing: border-box;">Удаление дубликатов по первому и второму столбцам:</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><strong style="box-sizing: border-box;"><code style="box-sizing: border-box; background: rgb(208, 239, 251); border-radius: 5px; border: 1px solid var(--nv-light-bg); padding: 0px 3px; color: rgb(51, 51, 51);">Range("A1:C10").RemoveDuplicates Array(1, 2)</code></strong></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Результат:</p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><a href="https://vremya-ne-zhdet.ru/wp-content/uploads/2019/03/tablitsa-dublikatov-4.png" target="_blank" rel="noopener" style="box-sizing: border-box; --linkdeco: underline; color: var(--nv-primary-accent); cursor: pointer; text-decoration: var(--linkdeco);"></a></p><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;">Обратите внимание, что при удалении повторяющихся значений по нескольким столбцам, будут удалены дубли только тех строк, в которых во всех указанных столбцах содержатся одинаковые значения. В третьем примере удалены «лишние» строки с дублями значений по двум первым столбцам: Корова+Лягушка, Свинья+Бурундук и Овца+Собака.</p><hr style="box-sizing: border-box; margin: 10px 0px 20px; padding: 0px; color: inherit; height: 0px; border-width: 2px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-color: initial; border-image: initial; border-top-style: solid; display: inline-block; width: 960px;"><p style="box-sizing: border-box; margin: 0px 0px 30px; padding: 0px;"><em style="box-sizing: border-box;">Смотрите, как отобрать уникальные значения из списка в VBA Excel с помощью<span> </span><a href="https://vremya-ne-zhdet.ru/vba-excel/otbor-unikalnykh-znacheniy-iz-spiska/" style="box-sizing: border-box; --linkdeco: underline; color: var(--nv-primary-accent); cursor: pointer; text-decoration: var(--linkdeco);">объекта Collection</a><span> </span>и<span> </span><a href="https://vremya-ne-zhdet.ru/vba-excel/otbor-unikalnykh-znacheniy-dictionary/" style="box-sizing: border-box; --linkdeco: underline; color: var(--nv-primary-accent); cursor: pointer; text-decoration: var(--linkdeco);">объекта Dictionary</a>.</em></p><div class="blok-fon-3" style="box-sizing: border-box; width: auto; height: auto; padding: 0.4375rem; margin: 0px 0px 1.5rem; background-color: rgb(230, 230, 250);"><a href="https://vremya-ne-zhdet.ru/vba-excel/soderzhaniye-rubriki/" style="box-sizing: border-box; --linkdeco: underline; color: var(--nv-primary-accent); cursor: pointer; text-decoration: var(--linkdeco);">Содержание рубрики VBA Excel</a><span> </span>по тематическим разделам со ссылками на все статьи.</div></div><!--EndFragment-->
</body>
</html></body></html>