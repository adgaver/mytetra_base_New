<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f9f9f9;"><span style=" font-family:'Tinos,Arial,serif'; font-size:18px; color:#333333; background-color:#f9f9f9;">Если же необходимо удалить папку полностью, а не только файлы в ней, то лучше использовать такой код:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Tinos,Arial,serif'; font-size:18px; color:#110000; background-color:#f9f9f9;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="transparent" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Sub</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> RemoveFolderWithContent()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">Dim</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> sFolder </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#f660ab;">String</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;">, sFiles </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#f660ab;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'диалог запроса выбора папки на удаление</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">With</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> Application.FileDialog(msoFileDialogFolderPicker)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">        </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">If</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> .Show = </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#00c2ff;">False</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">Then</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Exit</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Sub</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">        sFolder = .SelectedItems(1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">With</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    sFolder = sFolder &amp; IIf(Right(sFolder, 1) = Application.PathSeparator, </span><span style=" font-family:'monospace'; font-size:14px; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;">, Application.PathSeparator)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'путь к папке можно задать статично, если он заранее известен и не изменяется</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    </span><span style=" font-family:'monospace'; font-size:14px; color:#008000;">'    sFolder = &quot;C:\temp\Ежедневные отчеты\10072017&quot; 'путь к папке, которую надо удалить</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'monospace'; font-size:14px; color:#222222;">    Shell </span><span style=" font-family:'monospace'; font-size:14px; color:#800000;">&quot;cmd /c rd /S/Q &quot;&quot;&quot;</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> &amp; sFolder &amp; </span><span style=" font-family:'monospace'; font-size:14px; color:#800000;">&quot;&quot;&quot;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:16px; background-color:transparent;"><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'monospace'; font-size:14px; color:#222222;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:600; color:#e56717;">Sub</span></pre></td></tr></table></body></html>