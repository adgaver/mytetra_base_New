<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0" bgcolor="#dfe3f0">
<tr>
<td style=" vertical-align:middle;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="subject_34030"></a><a href="https://www.excel-vba.ru/forum/index.php?PHPSESSID=nclp64qmlf0gj5dmtu0dnhada2&amp;topic=6604.msg34030#msg34030"><span style=" font-family:'tahoma,sans-serif'; font-size:14px; font-weight:600; text-decoration: underline; color:#c91a1a;">R</span></a><span style=" font-family:'tahoma,sans-serif'; font-size:14px; font-weight:600; text-decoration: underline; color:#c91a1a;">e:Как узнать, какие строки выделил пользователь в отфильтрованной умной таблице?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'tahoma,sans-serif'; font-size:14px; color:#000000;">« </span><span style=" font-family:'tahoma,sans-serif'; font-size:14px; font-weight:600; color:#000000;">Ответ #10 :</span><span style=" font-family:'tahoma,sans-serif'; font-size:14px; color:#000000;"> 16.07.2021, 14:03:14 »</span></p></td>
<td style=" vertical-align:bottom;"></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#dfe3f0;"><a href="https://www.excel-vba.ru/forum/index.php?PHPSESSID=nclp64qmlf0gj5dmtu0dnhada2&amp;topic=6604.msg34027#msg34027"><span style=" font-family:'tahoma,sans-serif'; font-size:14px; font-weight:600; text-decoration: underline; color:#000000;">Цитата: angel2s2 от 15.07.2021, 23:56:26</span></a></p>
<p style=" margin-top:1px; margin-bottom:1px; margin-left:1px; margin-right:1px; -qt-block-indent:0; text-indent:0px; background-color:#cad2de;"><span style=" font-family:'tahoma,sans-serif'; font-size:14px; color:#000000; background-color:#cad2de;">Еще одна причина, по которой использую Intersect</span><span style=" font-family:'tahoma,sans-serif'; font-size:14px; color:#000000;">а я про Intersect вообще не спрашивал  Я про ListRows спрашивал.<br />По факту. Проще сначала определить, есть ли вообще выделение внутри именно умной таблицы. А потом обрабатывать уже именно те строки, что выделены внутри умной таблицы. Например, так:<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'tahoma,sans-serif'; font-size:14px; font-weight:600; color:#000000;">Код: (vb)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">Sub</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">test</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">()  </span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">Dim</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;"> rr </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">As</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">Range</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">,</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;"> rrow</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">As</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">Range</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">,</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;"> rColCell</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">As</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">Range</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">Dim</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;"> lo </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">As</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#4ec9b0;">ListObject</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">Set </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">lo</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> ThisWorkbook.</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">Worksheets</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#b5cea8;">1</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">).</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">ListObjects</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">&quot;Table1&quot;</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">)  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">Set </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">rr</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">Intersect</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(lo.DataBodyRange, Selection.</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">EntireRow</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">)  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">If</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> rr Is</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;"> Nothing</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">Then</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#6a9955;">'выделена область за умной таблицей  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">        </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">Exit Sub</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">End If</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">For</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">Each</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> rrow In rr.</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">SpecialCells</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">xlCellTypeVisible</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">).Rows  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">        </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#6a9955;">'считываем значение выделенных строк столбца Number умной таблицы  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">        </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">Set </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">rColCell</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">Intersect</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(lo.</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">ListColumns</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">(</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">&quot;Number&quot;</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">).DataBodyRange,</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;"> rrow</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">)  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">        </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">MsgBox</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> rColCell.Value  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">    </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#c586c0;">Next</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">  </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#569cd6;">End Sub</span><span style=" font-family:'tahoma,sans-serif'; font-size:14px; color:#000000;"><br />при таком подходе не придется даже проверять не входит ли обрабатываемый диапазон в заголовок. Браться будут всегда именно данные самой таблицы.</span></pre></body></html>