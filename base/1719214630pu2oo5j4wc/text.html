<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="question-header"></a><a href="https://translated.turbopages.org/proxy_u/en-ru.ru.0b4c8227-66791eed-912d978e-74722d776562/https/stackoverflow.com/questions/22574092/format-current-date-and-time-in-vbscript"><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">Ф</span></a><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">орматирование текущей даты и времени в VBScript</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Параметры форматирования даты ограничены в классическом ASP по умолчанию, есть функция, <span style=" font-family:'Courier New';">FormatDateTime()</span> которая может форматировать вашу дату различными способами в зависимости от региональных настроек сервера.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для большего контроля над форматированием даты существуют встроенные функции даты и времени</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Year(date)</span> - <span style=" font-style:italic;">Возвращает целое число, представляющее год. Передача </span><span style=" font-family:'Courier New'; font-style:italic;">Date()</span><span style=" font-style:italic;"> вернет текущий год.</span></li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Month(date)</span> - <span style=" font-style:italic;">Возвращает целое число от 1 до 12 включительно, представляющее месяц года. Передача </span><span style=" font-family:'Courier New'; font-style:italic;">Date()</span><span style=" font-style:italic;"> вернет текущий месяц года.</span></li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">MonthName(month[, abbv])</span> - <span style=" font-style:italic;">Возвращает строку, указывающую указанный месяц. Ввод </span><span style=" font-family:'Courier New'; font-style:italic;">Month(Date())</span><span style=" font-style:italic;"> в качестве месяца вернет строку текущего месяца. </span><span style=" font-weight:600; font-style:italic;">По предложению </span><a href="https://translated.turbopages.org/proxy_u/en-ru.ru.0b4c8227-66791eed-912d978e-74722d776562/https/stackoverflow.com/users/121333/martha"><span style=" font-weight:600; font-style:italic; text-decoration: underline; color:#0000ff;">@Martha</span></a></li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Day(date)</span> - <span style=" font-style:italic;">Возвращает целое число от 1 до 31 включительно, представляющее день месяца. Передача </span><span style=" font-family:'Courier New'; font-style:italic;">Date()</span><span style=" font-style:italic;"> вернет текущий день месяца.</span></li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Hour(time)</span> - <span style=" font-style:italic;">Возвращает целое число от 0 до 23 включительно, представляющее час дня. Передача </span><span style=" font-family:'Courier New'; font-style:italic;">Time()</span><span style=" font-style:italic;"> вернет текущий час.</span></li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Minute(time)</span> - <span style=" font-style:italic;">Возвращает целое число от 0 до 59 включительно, представляющее минуту часа. Передача </span><span style=" font-family:'Courier New'; font-style:italic;">Time()</span><span style=" font-style:italic;"> вернет текущую минуту.</span></li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Second(time)</span> - <span style=" font-style:italic;">Возвращает целое число от 0 до 59 включительно, представляющее секунду минуты. Передача </span><span style=" font-family:'Courier New'; font-style:italic;">Time()</span><span style=" font-style:italic;"> вернет текущую секунду.</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">ВАЖНО:</span> При форматировании значений даты / времени <span style=" font-weight:600;">всегда</span> сначала сохраняйте значение даты / времени. Кроме того, перед попыткой форматирования следует выполнить любые необходимые вычисления <span style=" font-style:italic;">(</span><span style=" font-family:'Courier New'; font-style:italic;">DateAdd()</span><span style=" font-style:italic;"> и т.д.)</span>, иначе вы получите неожиданные результаты.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функции <span style=" font-family:'Courier New';">Month()</span>, <span style=" font-family:'Courier New';">Day()</span>, <span style=" font-family:'Courier New';">Hour()</span>, <span style=" font-family:'Courier New';">Minute()</span> и <span style=" font-family:'Courier New';">Second()</span> все возвращают целые числа. К счастью, существует простой обходной путь, который позволяет быстро дополнять эти значения, <span style=" font-family:'Courier New';">Right(&quot;00&quot; &amp; value, 2)</span> что он делает, так это добавляет <span style=" font-family:'Courier New';">00</span> перед значением, а затем справа берет первые два символа. Это гарантирует, что все однозначные значения возвращаются с префиксом <span style=" font-family:'Courier New';">0</span>.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">Dim dd, mm, yy, hh, nn, ss</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">Dim datevalue, timevalue, dtsnow, dtsvalue</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'Store DateTimeStamp once.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">dtsnow = Now()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'Individual date components</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">dd = Right(</span><span style=" font-family:'Consolas';">&quot;00&quot; &amp; Day(dtsnow), 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">mm = Right(</span><span style=" font-family:'Consolas';">&quot;00&quot; &amp; Month(dtsnow), 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">yy = Year(dtsnow)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">hh = Right(</span><span style=" font-family:'Consolas';">&quot;00&quot; &amp; Hour(dtsnow), 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">nn = Right(</span><span style=" font-family:'Consolas';">&quot;00&quot; &amp; Minute(dtsnow), 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">ss = Right(</span><span style=" font-family:'Consolas';">&quot;00&quot; &amp; Second(dtsnow), 2)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'Build the date string in the format yyyy-mm-dd</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">datevalue = yy &amp; </span><span style=" font-family:'Consolas';">&quot;-&quot; &amp; mm &amp; &quot;-&quot; &amp; dd</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'Build the time string in the format hh:mm:ss</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">timevalue = hh &amp; </span><span style=" font-family:'Consolas';">&quot;:&quot; &amp; nn &amp; &quot;:&quot; &amp; ss</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">'Concatenate both together to build the timestamp yyyy-mm-dd hh:mm:ss</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; background-color:#eff0f1;">dtsvalue = datevalue &amp; </span><span style=" font-family:'Consolas';">&quot; &quot; &amp; timevalue</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas';">Call Response.Write(dtsvalue)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Примечание:</span> <span style=" font-style:italic;">Вы можете создать строку даты одним вызовом, но решили разбить ее на три переменные, чтобы упростить чтение.</span></p></body></html>