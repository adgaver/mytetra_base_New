<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; color:#000000;">Импортируйте Json в Excel и экспортируйте Excel в Json (обновлено в 2022 г.)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.666%;"><a href="https://codingislove.com/author/ranjithkumar10/"><span style=" font-family:'inherit'; font-size:12px; color:#949494;">Ранджит Кумар</span></a><a href="https://codingislove.com/excel-json/"><span style=" font-family:'inherit'; font-size:12px; color:#949494;">11 сентября 2022 г.</span></a><span style=" font-family:'lato,sans-serif'; font-size:12px; color:#949494;"> </span><span style=" font-family:'inherit'; font-size:12px; color:#999999;"> </span><a href="https://codingislove.com/tag/excel/"><span style=" font-family:'inherit'; font-size:12px; color:#949494;">Excel </span></a><a href="https://codingislove.com/tag/vba/"><span style=" font-family:'inherit'; font-size:12px; color:#949494;">VBA</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">JSON (нотация объектов Javascript) в настоящее время является наиболее используемым форматом обмена данными. Microsoft Excel не имеет встроенной поддержки импорта JSON в Excel или экспорта данных Excel в </span><a href="https://codingislove.com/json-tutorial-indepth/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">JSON</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://github.com/VBA-tools/VBA-JSON"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">VBA-JSON</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> — отличная библиотека для анализа JSON в VBA. Давайте посмотрим, как обрабатывать JSON в Excel VBA. Если вы новичок в JSON, прочитайте </span><a href="https://codingislove.com/json-tutorial-indepth/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">руководство по JSON для начинающих.</span></a></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Предварительные условия</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Сохраните файл Excel как книгу с поддержкой макросов (см. снимок экрана ниже).</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:30px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Включите макросы, если они еще не включены. Вы можете включить его, нажав «Файл» &gt; «Параметры» &gt; «Центр управления безопасностью» &gt; «Настройки центра управления безопасностью» &gt; «Включить все макросы».</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Начиная</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Загрузите последнюю версию VBA JSON отсюда </span><a href="https://github.com/VBA-tools/VBA-JSON/releases"><span style=" font-size:16px; text-decoration: underline; color:#222222;">.</span></a></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Извлеките его, откройте редактор кода VBA в Excel (Alt + F11) и импортируйте библиотеку, как показано на рисунке ниже.</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Добавьте ссылку на среду выполнения сценариев Microsoft. (Инструменты &gt; ссылки &gt; выбрать)</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:30px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Добавьте ссылку на MSXML (Инструменты &gt; ссылки).<br />Выберите соответствующую версию в зависимости от вашего ПК:<br />1. Microsoft XML, v 3.0.<br />2. Microsoft XML, v 4.0 (если MSXML 4.0 установлен отдельно).<br />3. Microsoft XML, версия 5.0 (если у вас установлен Office 2003–2007, который предоставляет MSXML 5.0 для приложений Microsoft Office).<br />4. Microsoft XML, v 6.0 для последних версий MS Office.</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Импортировать JSON в Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Эта библиотека предоставляет простой метод </span><span style=" font-family:'Courier New'; font-size:14px; color:#484848;">ParseJson</span><span style=" font-family:'inherit'; font-size:16px; color:#484848;">анализа строки JSON в объект словаря, который можно использовать для извлечения данных. Давайте посмотрим пример.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Я использую поддельные данные с </span><a href="http://jsonplaceholder.typicode.com/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">сайта http://jsonplaceholder.typicode.com/</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> , который представляет собой службу API с поддельными данными Json.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Мы будем получать пользовательские данные из </span><a href="http://jsonplaceholder.typicode.com/users"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">http://jsonplaceholder.typicode.com/users</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> , выполнив запрос GET, который отвечает данными Json.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Подробнее о </span><a href="https://codingislove.com/http-requests-excel-vba/"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">GET-запросах в VBA читайте здесь.</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Далее мы проанализируем этот Json и импортируем его в Excel. Код для импорта данных выглядит следующим образом:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_910681"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">6</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">7</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">8</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">9</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">10</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">11</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">12</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">13</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">14</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">15</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">16</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">17</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">18</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">19</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">20</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Public Sub exceljson()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim http As Object, JSON As Object, i As Integer</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set http = CreateObject(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;MSXML2.XMLHTTP&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">http.Open </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;GET&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;http://jsonplaceholder.typicode.com/users&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">http.Send</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set JSON = ParseJson(http.responseText)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = 2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">For Each Item In JSON</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 1).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;id&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 2).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;name&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 3).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;username&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 4).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;email&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 5).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;address&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;city&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 6).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;phone&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 7).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;website&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Cells(i, 8).Value = Item(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;company&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;name&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = i + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">MsgBox (</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;complete&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.318%;"><span style=" font-family:'inherit'; font-size:medium; font-weight:600; color:#222222;">Объяснение кода</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Сначала определите JSON как объект и выполните запрос GET к JSON API.</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Данные JSON, полученные в ответе, анализируются путем передачи их в </span><span style=" font-family:'Courier New'; font-size:14px;">ParseJson</span><span style=" font-size:16px;">метод.</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">анализируемые данные преобразуются в коллекцию словарей.</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:30px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Просмотрите коллекцию, чтобы получить сведения о каждом пользователе и установить их значения для первого листа.</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Выполнение приведенного выше кода выглядит как gif ниже.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><a name="div-gpt-ad-1595500140430-0"></a><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Ч</span><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">тение JSON из файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">В том же примере выше: если вы хотите прочитать данные JSON из локального файла, вы можете использовать его </span><span style=" font-family:'Courier New'; font-size:14px; color:#484848;">FileSystemObject</span><span style=" font-family:'inherit'; font-size:16px; color:#484848;">для чтения всего текста в файле, а затем передать его </span><span style=" font-family:'Courier New'; font-size:14px; color:#484848;">ParseJson</span><span style=" font-family:'inherit'; font-size:16px; color:#484848;">методу.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_382499"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">6</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim FSO As New FileSystemObject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim JsonTS As TextStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set JsonTS = FSO.OpenTextFile(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;example.json&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, ForReading)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">JsonText = JsonTS.ReadAll</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">JsonTS.Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set JSON = ParseJson(JsonText)</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Экспорт Excel в Json</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">VBA-JSON предоставляет еще один метод </span><span style=" font-family:'Courier New'; font-size:14px; color:#484848;">ConvertToJson</span><span style=" font-family:'inherit'; font-size:16px; color:#484848;">, который можно использовать для преобразования данных Excel в JSON. Вот пример.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Пример данных с именем, телефоном и электронной почтой представлен на втором листе. Давайте конвертируем его в JSON</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Код для этого выглядит так:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_252324"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">6</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">7</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">8</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">9</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">10</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">11</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">12</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">13</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">14</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">15</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">16</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Public Sub exceltojson()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim rng As Range, items As New Collection, myitem As New Dictionary, i As Integer, cell As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">set rng = Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2:A3&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">'Set rng = Range(Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">), Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">).End(xlDown)) use </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">this</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">for</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">dynamic range</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">For Each cell In rng</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Debug.Print (cell.Value)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;name&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;email&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 1).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;phone&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 2).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">items.Add myitem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set myitem = Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = i + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A4&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">).Value = ConvertToJson(items, Whitespace:=2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.318%;"><span style=" font-family:'inherit'; font-size:medium; font-weight:600; color:#222222;">Объяснение кода</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Сначала определите </span><span style=" font-family:'Courier New'; font-size:14px;">rng</span><span style=" font-size:16px;">диапазон и установите его в диапазон данных.</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:14px;">ConvertToJson</span><span style=" font-size:16px;">Метод принимает в качестве параметра коллекцию словаря или массив. Поэтому мы должны передать наши данные как коллекцию.</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Словарь — это объект с ключами и значениями, такой же, как JSON, но он не поддерживает несколько элементов, таких как массивы или коллекции, поэтому мы создаем словарь для каждого элемента и помещаем его в массив или коллекцию.</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Определите словарь и коллекцию, пройдитесь по диапазону и задайте данные каждой строки в</span><span style=" font-family:'Courier New'; font-size:14px;">myitem</span></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:30px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Вставьте </span><span style=" font-family:'Courier New'; font-size:14px;">myitem</span><span style=" font-size:16px;">его в коллекцию и установите для него ничего, потому что мы используем тот же словарь для добавления данных следующей строки и повторной отправки их в коллекцию.</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Наконец, передайте </span><span style=" font-family:'Courier New'; font-size:14px; color:#484848;">items</span><span style=" font-family:'inherit'; font-size:16px; color:#484848;">коллекцию </span><span style=" font-family:'Courier New'; font-size:14px; color:#484848;">ConvertToJson</span><span style=" font-family:'inherit'; font-size:16px; color:#484848;">методу, который возвращает строку JSON.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Выполнение приведенного выше кода выглядит как gif ниже</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Экспорт Excel в файл JSON</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">В том же примере, приведенном выше, если вы хотите экспортировать данные Excel в файл JSON, это можно сделать, открыв файл для вывода, указав путь к файлу и распечатав в нем данные. Пример кода ниже. При этом файл JSON будет сохранен в папке текущей книги.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_955742"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">6</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">7</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">8</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">9</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">10</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">11</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">12</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">13</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">14</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">15</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">16</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">17</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">18</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">19</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Public Sub exceltojsonfile()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim rng As Range, items As New Collection, myitem As New Dictionary, i As Integer, cell As Variant, myfile As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set rng = Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2:A3&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">'Set rng = Range(Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">), Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">).End(xlDown)) use </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">this</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">for</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">dynamic range</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">For Each cell In rng</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Debug.Print (cell.Value)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;name&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;email&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 1).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;phone&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 2).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">items.Add myitem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set myitem = Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = i + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myfile = Application.ActiveWorkbook.Path &amp;amp;amp; </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;\data.json&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Open myfile For Output As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#8aa6c1;">#1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Print</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#8aa6c1;">#1, ConvertToJson(items, Whitespace:=2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Close</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#8aa6c1;">#1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Экспорт Excel во вложенный JSON</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Приведенный выше код можно немного изменить, чтобы получить на выходе вложенный JSON. Просто добавьте словарь в другой словарь, чтобы он создал вложенный JSON. код выглядит следующим образом:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_260912"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">6</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">7</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">8</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">9</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">10</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">11</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">12</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">13</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">14</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">15</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">16</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">17</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">18</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">19</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Public Sub exceltonestedjson()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dim rng As Range, items As New Collection, myitem As New Dictionary, subitem As New Dictionary, i As Integer, cell As Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set rng = Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2:A3&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">'Set rng = Range(Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">), Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">).End(xlDown)) use </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">this</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">for</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">dynamic range</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">For Each cell In rng</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Debug.Print (cell.Value)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;name&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;email&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 1).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;phone&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 2).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">subitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;country&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 3).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem.Add </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;location&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, subitem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">items.Add myitem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set myitem = Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Set subitem = Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = i + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(2).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A4&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">).Value = ConvertToJson(items, Whitespace:=2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Выполнение приведенного выше кода выглядит как изображение ниже.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">Использование массива строк и объектов в JSON</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Один из наших читателей спросил меня, как использовать массив строк и объектов внутри JSON.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Вот как это сделать:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:13px; margin-bottom:13px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'inherit'; font-size:16px; color:#484848; background-color:#0f192a;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><a name="highlighter_131191"></a><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">1</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">2</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">3</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">4</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">5</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">6</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">7</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">8</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">9</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">10</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">11</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">12</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">13</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">14</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">15</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">16</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">17</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">18</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">19</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">20</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">21</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">22</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">23</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">24</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">25</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">26</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">27</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">28</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">29</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">30</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">31</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">32</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">33</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">34</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">35</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">36</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">37</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">38</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">39</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">40</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">41</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">42</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">43</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">44</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">45</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">46</span></p>
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:13px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'inherit'; font-size:16px; color:#afafaf;">47</span></p></td>
<td bgcolor="#0f192a" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Public</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Sub</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">exceltojson()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Dim</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">rng </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Range, items </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">New</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Collection, myitem </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">New</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dictionary, i </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Integer</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, cell </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Variant</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, objectContainer </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">New</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Dictionary, arrayContainer </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">New</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Dim</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">j </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">As</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Integer</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#428bdd;">'Set rng = Range(&quot;A2:A3&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Set</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">rng = Range(Sheets(1).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">), Sheets(1).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A2&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">).</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">End</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">(xlDown)) </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#428bdd;">'use this for dynamic range</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">For</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Each</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">cell </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">In</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">rng</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;id&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;name&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = cell.Offset(0, 1).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848; background-color:#0f192a;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#428bdd;">'tags</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">tagsString = cell.Offset(0, 2).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">tagsCollection = getCollectionFromString(tagsString)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem.Add </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;tags&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, tagsCollection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848; background-color:#0f192a;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#428bdd;">'ingredients</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">ingredientsString = cell.Offset(0, 3).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">weightsString = cell.Offset(0, 4).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">ingredientsUnit = cell.Offset(0, 5).Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">ingredientsCollection = getCollectionFromString(ingredientsString)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">weightsCollection = getCollectionFromString(weightsString)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848; background-color:#0f192a;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">j = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">For</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Each</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">ingredient </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">In</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">ingredientsCollection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">objectContainer(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;ingredientnaam&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = ingredient</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">objectContainer(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;eenheid&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = ingredientsUnit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">objectContainer(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;hoeveelheid&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">) = weightsCollection(j)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">arrayContainer.Add objectContainer</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Set</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">objectContainer = </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">j = j + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem.Add </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;ingredienten&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">, arrayContainer</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848; background-color:#0f192a;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#428bdd;">'Reset values</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Set</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">arrayContainer = </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">j = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848; background-color:#0f192a;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">items.Add myitem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Set</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">myitem = </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">i = i + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">Sheets(1).Range(</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;A6&quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">).Value = ConvertToJson(items, Whitespace:=2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">End</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848; background-color:#0f192a;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Function</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">getCollectionFromString(val)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">getCollectionFromString = Split(val, </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#1dc116;">&quot;, &quot;</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#d1edff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#0f192a;"><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">End</span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#484848;"> </span><span style=" font-family:'Monaco,consolas,bitstream vera sans mono,courier new,Courier,monospace'; font-size:16px; color:#b43d3d;">Function</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Выполнение приведенного выше кода выглядит как изображение ниже.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.292%;"><a name="div-gpt-ad-1595415581471-0"></a><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">П</span><span style=" font-family:'inherit'; font-size:large; font-weight:600; color:#222222;">одведение итогов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#484848;">Прочтите официальную документацию VBA-JSON </span><a href="https://github.com/VBA-tools/VBA-JSON"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">здесь</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> и воспользуйтесь поддержкой </span><a href="https://github.com/VBA-tools/VBA-Dictionary"><span style=" font-family:'inherit'; font-size:16px; text-decoration: underline; color:#00bfb6;">VBA-Dictionary</span></a><span style=" font-family:'inherit'; font-size:16px; color:#484848;"> для Mac.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:696; color:#484848;">Статьи по Теме :</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Полное руководство по JSON здесь — </span><a href="https://codingislove.com/json-tutorial-indepth/"><span style=" font-size:16px; text-decoration: underline; color:#222222;">JSON для начинающих.</span></a></li>
<li style=" font-family:'inherit'; font-size:16px; color:#484848;" style=" margin-top:0px; margin-bottom:30px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Обработка </span><a href="https://codingislove.com/json-csv/"><span style=" font-size:16px; text-decoration: underline; color:#222222;">CSV в VBA</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-style:italic; color:#484848;">Если у вас есть какие-либо вопросы или отзывы, оставьте комментарий ниже и используйте </span><a href="https://bin.codingislove.com/"><span style=" font-family:'inherit'; font-size:16px; font-style:italic; text-decoration: underline; color:#00bfb6;">CodingisLove Bin</span></a><span style=" font-family:'inherit'; font-size:16px; font-style:italic; color:#484848;"> , чтобы поделиться своим кодом.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:696; text-decoration: underline; color:#00bfb6;">Получайте уведомления о появлении нового сообщения, нажав на значокв левом нижнем углу.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:696; color:#484848;">Нужна помощь? Задавайте свои вопросы на нашем </span><a href="https://forum.codingislove.com/"><span style=" font-family:'inherit'; font-size:16px; font-weight:696; text-decoration: underline; color:#00bfb6;">форуме</span></a></p></body></html>