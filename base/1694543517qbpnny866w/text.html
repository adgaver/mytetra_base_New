<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">VBA Excel. Объект TextStream (свойства и методы)</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Создание, открытие текстового файла из кода VBA Excel, создание связанного с ним объекта TextStream для чтения, записи и добавления информации в файл.</span></p>
<p style=" margin-top:32px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#333333;">Содержание</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/obyekt-textstream/#Svojstva_obekta_TextStream"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">1. Свойства объекта TextStream</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/obyekt-textstream/#Metody_obekta_TextStream"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">2. Методы объекта TextStream</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/obyekt-textstream/#Primery_raboty_s_fajlami"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">3. Примеры работы с файлами</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">TextStream</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> – это объект, возвращаемый методом </span><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-createtextfile/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">CreateTextFile</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> или методом </span><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-opentextfile/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">OpenTextFile</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> объекта </span><a href="https://vremya-ne-zhdet.ru/vba-excel/obyekt-filesystemobject/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">FileSystemObject</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Объект TextStream предоставляет последовательный доступ к текстовому файлу для чтения, записи или добавления в него информации.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Svojstva_obekta_TextStream"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">С</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">войства объекта TextStream</span></p>
<table border="1" style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td width="25%" bgcolor="#eaeaea" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:10;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; background-color:#eaeaea;">Свойство</span></p></td>
<td width="75%" bgcolor="#eaeaea" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:10;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; background-color:#eaeaea;">Описание</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">AtEndOfLine</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Возвращает значение типа Boolean:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">True</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> – указатель файла (курсор) находится непосредственно перед маркером конца строки, </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">False</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> – расположение указателя другое.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">AtEndOfStream</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Возвращает значение типа Boolean:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">True</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> – указатель файла (курсор) находится в конце файла TextStream, </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">False</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> – расположение указателя другое.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Column</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Возвращает номер столбца текущего положения символа в файле TextStream.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Line</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Возвращает номер текущей строки в файле TextStream.</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Metody_obekta_TextStream"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">М</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">етоды объекта TextStream</span></p>
<table border="1" style=" margin-top:0px; margin-bottom:20px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td width="25%" bgcolor="#eaeaea" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:10;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; background-color:#eaeaea;">Метод</span></p></td>
<td width="75%" bgcolor="#eaeaea" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:10;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; background-color:#eaeaea;">Описание</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Close</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Закрывает открытый текстовый файл.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Read</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Считывает указанное число символов из файла TextStream и возвращает результат.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">ReadAll</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Считывает весь текстовый файл и возвращает результат.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">ReadLine</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Считывает одну строку из файла и возвращает результат.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Skip</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Пропускает указанное число символов при чтении файла.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">SkipLine</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Пропускает следующую строку при чтении файла.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Write</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Записывает указанный текст в файл TextStream.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">WriteBlankLines</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Записывает указанное число символов новой строки в текстовый файл.</span></p></td></tr>
<tr>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">WriteLine</span></p></td>
<td bgcolor="#fff7ec" style=" padding-left:20; padding-right:20; padding-top:20; padding-bottom:20;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#fff7ec;">Записывает указанный текст и символ новой строки в файл TextStream.</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Primery_raboty_s_fajlami"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">П</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">римеры работы с файлами</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Для реализации примеров создайте на диске «C» папку «DATA» или в коде примеров замените ее имя на имя любой своей папки на этом диске.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Пример 1</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Создание нового текстового файла и запись в него данных:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_1_host"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">9</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">10</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">11</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">12</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">13</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">14</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">15</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">16</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">17</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">18</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">19</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-1"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Primer1</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-2"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">D</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">im</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fso</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fl</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">ws</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-3"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">Создаем новый экземпляр объекта FileSystemObject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-4"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">et</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fso</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">CreateObject</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;Scripting.FileSystemObject&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-5"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">Присваиваем переменной fl экземпляр объекта TextStream,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-6"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">связанный с созданным файлом и открытым для записи</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-7"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">et</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fl</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fso</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">CreateTextFile</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;C:\DATA\myfile.txt&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-8"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">W</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">ith</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">fl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-9"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Записываем три строки с текстом в файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-10"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">WriteLine</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;Первая строка с символом новой строки.&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-11"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">WriteLine</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;Вторая строка с символом новой строки.&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-12"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Write</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;Третья строка без символа новой строки.&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-13"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Закрываем файл и объект TextStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-14"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-15"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-16"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">Открываем файл для просмотра</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-17"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">et</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">ws</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">CreateObject</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-18"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">w</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">s</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">Run</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;C:\DATA\myfile.txt&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544ded781073550-19"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_2_host"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Р</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">екомендую открывать файлы для просмотра методом ThisWorkbook.FollowHyperlink. Пример и преимущества этого метода в статье </span><a href="https://vremya-ne-zhdet.ru/vba-excel/otkryt-fayl-drugoy-programmy/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">VBA Excel. Открыть файл другой программы</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Пример 2</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Открываем созданный кодом VBA Excel из первого примера текстовый файл myfile.txt в режиме добавления данных, дополняем третью и записываем четвертую строку:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">9</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">10</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">11</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">12</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">13</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">14</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">15</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">16</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">17</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">18</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">19</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">20</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-1"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Primer2</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-2"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">Осуществляем раннюю привязку объектов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-3"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">FileSystemObject и TextStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-4"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">D</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">im</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">fso </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">New</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">FileSystemObject</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">_</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-5"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">f</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">l </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">TextStream</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">ws </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-6"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">Присваиваем переменной fl экземпляр объекта TextStream,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-7"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">связанный с файлом, открытым для добавления данных</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-8"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">et</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fl</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fso</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">OpenTextFile</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;C:\DATA\myfile.txt&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ce0000;">8</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-9"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">W</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">ith</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">fl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-10"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Записываем дополнительный текст в третью строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-11"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'с символом новой строки и четвертую строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-12"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">WriteLine</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot; Добавили символ новой строки.&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-13"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Write</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;Четвертая строка без символа новой строки.&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-14"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Закрываем файл и объект TextStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-15"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-16"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-17"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">Открываем файл для просмотра</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-18"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">et</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">ws</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">CreateObject</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-19"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">w</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">s</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">Run</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;C:\DATA\myfile.txt&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544df8291996617-20"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_3_host"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">К</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">акую использовать </span><a href="https://vremya-ne-zhdet.ru/vba-excel/ranneye-i-pozdneye-svyazyvaniye/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">привязку</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, раннюю или позднюю, выбор за вами. При ранней привязке становится доступен лист автоматической вставки свойств-методов, который открывается после ввода переменной и точки.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Режим открытия текстового файла (чтение, запись, добавление информации) зависит от параметра </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">iomode</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> метода </span><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-opentextfile/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">OpenTextFile</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Пример 3</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Открываем текстовый файл myfile.txt в режиме чтения и считываем второе предложение из третьей строки:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">9</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">10</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">11</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">12</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">13</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">14</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">15</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">16</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">17</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#317cc5; background-color:#c8e1fa;">18</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#5499de;">19</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-1"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Primer3</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-2"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">D</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">im</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">fso </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">New</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">FileSystemObject</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">_</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-3"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">f</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">l </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">TextStream</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">txt </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-4"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">Присваиваем переменной fl экземпляр объекта TextStream,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-5"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">связанный с файлом myfile.txt, открытым для чтения</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-6"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">et</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fl</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#002d7a;">fso</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">OpenTextFile</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#008000;">&quot;C:\DATA\myfile.txt&quot;</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ce0000;">1</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-7"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">W</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">ith</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">fl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-8"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Пропускаем первую строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-9"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">SkipLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-10"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Пропускаем вторую строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-11"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">SkipLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-12"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Пропускаем 40 символов третьей строки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-13"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Skip</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ce0000;">40</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-14"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'Считываем остаток третьей строки и</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-15"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#ff8000;">'отображаем его в окне MsgBox</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-16"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">MsgBox</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#000000;">ReadLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-17"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#004ed0;">Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-18"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500ace544e05031496875-19"></a><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:11pt; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Получаем результат:</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">При открытии текстового файла в режиме чтения, параметр </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">iomode</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> метода </span><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-opentextfile/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">OpenTextFile</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> можно было не указывать, так как режим чтения для этого параметра является значением по умолчанию.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8fbc8;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#c8fbc8;">Смотрите, как открыть файл из кода VBA Excel с помощью оператора</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="https://vremya-ne-zhdet.ru/vba-excel/operator-open/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Open</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> и применить </span><a href="https://vremya-ne-zhdet.ru/vba-excel/operatory-chteniya-i-zapisi-v-fayl/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">операторы</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> чтения файла и записи в него.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e6e6fa;"><a name="aswift_4_host"></a><a href="https://vremya-ne-zhdet.ru/vba-excel/soderzhaniye-rubriki/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">С</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">одержание рубрики VBA Excel</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> по тематическим разделам со ссылками на все статьи.</span></p></body></html>