<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="question-header"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">К</span></a><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">ак я могу перебирать строки в DataFrame Pandas?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/ask"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Задавать вопрос</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Спросил 11 лет, 1 месяц назад</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Изменено </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?lastactivity"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">1 месяц назад</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Просмотрено 7,4 млн раз</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="mainbar"></a><span style=" font-size:8.25pt;">4</span><span style=" font-size:8.25pt;">101</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">У меня есть кадр данных pandas </span><span style=" font-family:'Courier New'; font-size:8.25pt;">df</span><span style=" font-size:8.25pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">   c1   c2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">0  10  100</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1  11  110</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">2  12  120</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Как мне перебирать строки этого кадра данных? Для каждой строки я хочу получить доступ к ее элементам (значениям в ячейках) по имени столбцов. Например:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.rows:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row['c1'], row['c2'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я нашел </span><a href="https://stackoverflow.com/questions/7837722/what-is-the-most-efficient-way-to-loop-through-dataframes-with-pandas"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">аналогичный вопрос</span></a><span style=" font-size:8.25pt;"> , который предлагает использовать любой из них:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New'; font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">for date, row in df.T.iteritems():</li>
<li style=" font-family:'Courier New'; font-size:8.25pt;" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></li>
<li style=" font-family:'Courier New'; font-size:8.25pt;" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></li>
<li style=" font-family:'Courier New'; font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">for row in df.iterrows():</li>
<li style=" font-family:'Courier New'; font-size:8.25pt;" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></li>
<li style=" font-family:'Courier New'; font-size:8.25pt;" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Но я не понимаю, что </span><span style=" font-family:'Courier New'; font-size:8.25pt;">row</span><span style=" font-size:8.25pt;">это за объект и как с ним можно работать.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answers"></a><span style=" font-size:8.25pt; font-weight:600;">3</span><span style=" font-size:8.25pt; font-weight:600;">4 ответа</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Отсортировано по:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-sort-dropdown-select-menu"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                                             Наивысший балл (по умолчанию)                                                                   В тренде (недавние голоса имеют большее значение)                                                                   Дата изменения (сначала самые новые)                                                                   Дата создания (сначала самое старое)                              </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=2&amp;tab=scoredesc#tab-top"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">2Следующий</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-16476974"></a><span style=" font-size:8.25pt;">5</span><span style=" font-size:8.25pt;">338</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iterrows.html#pandas-dataframe-iterrows"><span style=" font-family:'Courier New'; font-size:8.25pt; text-decoration: underline; color:#0000ff;">DataFrame.iterrows</span></a><span style=" font-size:8.25pt;">— это генератор, который выдает как индекс, так и строку (как серию):</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">import pandas as pd</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'c1': [10, 11, 12], 'c2': [100, 110, 120]})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = df.reset_index()  # make sure indexes pair with number of rows</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for index, row in df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row['c1'], row['c2'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">10 100</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">11 110</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">12 120</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Обязательный отказ от </span><a href="https://pandas.pydata.org/docs/user_guide/basics.html#iteration"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">документации</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Перебор объектов pandas обычно происходит </span><span style=" font-size:8.25pt; font-weight:600;">медленно</span><span style=" font-size:8.25pt;"> . Во многих случаях перебор строк вручную не требуется, и его можно избежать с помощью одного из следующих подходов:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Ищите <span style=" font-style:italic;">векторизованное</span> решение: многие операции можно выполнять с помощью встроенных методов или функций NumPy, (логической) индексации,…</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Если у вас есть функция, которая не может работать с полным DataFrame/Series одновременно, лучше использовать ее <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html#pandas.DataFrame.apply"><span style=" font-family:'Courier New'; text-decoration: underline; color:#0000ff;">apply()</span></a>вместо перебора значений. См. документацию по <a href="https://pandas.pydata.org/docs/user_guide/basics.html#basics-apply"><span style=" text-decoration: underline; color:#0000ff;">применению функций</span></a> .</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Если вам нужно выполнять итеративные манипуляции со значениями, но производительность важна, рассмотрите возможность написания внутреннего цикла с помощью cython или numba. Некоторые примеры этого подхода см. в разделе <a href="https://pandas.pydata.org/docs/user_guide/enhancingperf.html#enhancingperf"><span style=" text-decoration: underline; color:#0000ff;">«Повышение производительности» .</span></a></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Другие ответы в этой теме более подробно рассматривают альтернативы функциям iter*, если вам интересно узнать больше.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comments-16476974"></a><span style=" font-size:8.25pt;">Х</span><span style=" font-size:8.25pt;">оть и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">.iterrows()</span><span style=" font-size:8.25pt;">работает, но примерно </span><span style=" font-size:8.25pt; font-weight:600;">в 600 раз</span><span style=" font-size:8.25pt;"> медленнее, чем самый быстрый метод. </span><a href="https://stackoverflow.com/a/77270285/4561887"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">В своем ответе здесь</span></a><span style=" font-size:8.25pt;"> я тестирую скорость и демонстрирую 13 способов перебора DataFrame Pandas . </span><span style=" font-family:'Courier New'; font-size:8.25pt;">.iterrows()</span><span style=" font-size:8.25pt;">является вторым по скорости. 11 из 13 техник быстрее, чем </span><span style=" font-family:'Courier New'; font-size:8.25pt;">.iterrows()</span><span style=" font-size:8.25pt;">, и большинство из них по-прежнему очень просты, если вы увидите пример того, как их выполнять. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4561887/gabriel-staples"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Габриэль Стейплс</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment136491868_16476974"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">4 ноя 2023 в 16:11</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-16476974"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-55557758"></a><span style=" font-size:8.25pt;">2</span><span style=" font-size:8.25pt;">437</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">+100</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Как перебирать строки в DataFrame в Pandas</span></p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Ответ: НЕ </span><span style=" font-size:8.25pt; font-weight:600; vertical-align:super;">*</span><span style=" font-size:8.25pt; font-weight:600;"> !</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Итерация в Pandas — это антишаблон, и ее следует делать только тогда, когда вы исчерпали все остальные варианты. Не следует использовать функцию с &quot; </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iter</span><span style=" font-size:8.25pt;">&quot; в имени более чем на несколько тысяч строк, иначе вам придется привыкнуть к долгому </span><span style=" font-size:8.25pt; font-weight:600;">ожиданию</span><span style=" font-size:8.25pt;"> .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Хотите распечатать DataFrame? Использовать </span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_string.html"><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">DataFrame.to_string()</span></a><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы хотите что-то посчитать? В этом случае ищите методы в следующем порядке (список изменен отсюда </span><a href="https://stackoverflow.com/questions/24870953/does-iterrows-have-performance-issues"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">)</span></a><span style=" font-size:8.25pt;"> :</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Векторизация</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://en.wikipedia.org/wiki/Cython"><span style=" text-decoration: underline; color:#0000ff;">Cython-</span></a> процедуры</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поддержка списков (ванильный <span style=" font-family:'Courier New';">for</span>цикл)</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html"><span style=" font-family:'Courier New'; font-weight:600; text-decoration: underline; color:#0000ff;">DataFrame.apply()</span></a>: i) Сокращения, которые можно выполнить в Cython, ii) Итерация в пространстве Python</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.items.html"><span style=" font-family:'Courier New'; font-weight:600; text-decoration: underline; color:#0000ff;">items()</span></a> <a href="https://pandas.pydata.org/pandas-docs/version/1.5/reference/api/pandas.DataFrame.iteritems.html"><span style=" font-family:'Courier New'; font-weight:600; text-decoration: underline; color:#0000ff;">iteritems()</span></a> <span style=" vertical-align:super;">(устарело с версии 1.5.0)</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.itertuples.html"><span style=" font-family:'Courier New'; font-weight:600; text-decoration: underline; color:#0000ff;">DataFrame.itertuples()</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows"><span style=" font-family:'Courier New'; font-weight:600; text-decoration: underline; color:#0000ff;">DataFrame.iterrows()</span></a></li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows</span><span style=" font-size:8.25pt;">и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples</span><span style=" font-size:8.25pt;">(оба получили много голосов в ответах на этот вопрос) следует использовать в очень редких случаях, например, при создании объектов строк/кортежей имен для последовательной обработки, что на самом деле является единственным, для чего эти функции полезны.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Обращение к властям</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html#iteration"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">На странице документации</span></a><span style=" font-size:8.25pt;"> по итерации есть огромное красное предупреждающее поле, в котором говорится:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Перебор объектов pandas обычно происходит медленно. Во многих случаях перебор строк вручную не требуется [...].</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; vertical-align:sub;">* На самом деле это немного сложнее, чем «не делать». </span><span style=" font-family:'Courier New'; font-size:8.25pt; vertical-align:sub;">df.iterrows()</span><span style=" font-size:8.25pt; vertical-align:sub;">это правильный ответ на этот вопрос, но лучше «векторизировать свои операции». Я признаю, что существуют обстоятельства, при которых итерации избежать невозможно (например, некоторые операции, результат которых зависит от значения, вычисленного для предыдущей строки). Однако чтобы понять, когда это произойдет, требуется некоторое знакомство с библиотекой. Если вы не уверены, нужно ли вам итеративное решение, скорее всего, нет. PS: Чтобы узнать больше о причинах написания этого ответа, перейдите к самому низу.</span></p>
<hr />
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Быстрее, чем цикл: </span><a href="https://stackoverflow.com/questions/1422149/what-is-vectorization"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">векторизация</span></a><span style=" font-size:8.25pt; font-weight:600;"> , </span><a href="https://cython.org/"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">Cython</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Большое количество базовых операций и вычислений «векторизуются» пандами (либо через NumPy, либо через Cythonized функции). Сюда входят арифметика, сравнения, (большинство) сокращений, изменение формы (например, поворот), соединения и операции группировки. Просмотрите документацию по </span><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html#essential-basic-functionality"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Essential Basic Functionality</span></a><span style=" font-size:8.25pt;"> , чтобы найти подходящий векторизованный метод для вашей проблемы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если такового не существует, смело напишите свой собственный, используя собственные </span><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/enhancingperf.html#cython-writing-c-extensions-for-pandas"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">расширения Cython</span></a><span style=" font-size:8.25pt;"> .</span></p>
<hr />
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Следующая лучшая вещь: </span><a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">понимание списков </span></a><span style=" font-size:8.25pt; font-weight:600; vertical-align:super;">*</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Понимание списков должно стать вашим следующим пунктом назначения, если 1) нет доступного векторизованного решения, 2) производительность важна, но недостаточно важна, чтобы справиться с трудностями, связанными с цитонизированием вашего кода, и 3) вы пытаетесь выполнить поэлементное преобразование. по вашему коду. Существует </span><a href="https://stackoverflow.com/questions/54028199/for-loops-with-pandas-when-should-i-care"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">достаточно доказательств</span></a><span style=" font-size:8.25pt;"> того, что понимание списков происходит достаточно быстро (а иногда и быстрее) для многих распространенных задач Pandas.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Формула проста,</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Iterating over one column - `f` is some function that processes your data</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = [f(x) for x in df['col']]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Iterating over two columns, use `zip`</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = [f(x, y) for x, y in zip(df['col1'], df['col2'])]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Iterating over multiple columns - same data type</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = [f(row[0], ..., row[n]) for row in df[['col1', ...,'coln']].to_numpy()]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Iterating over multiple columns - differing data type</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = [f(row[0], ..., row[n]) for row in zip(df['col1'], ..., df['coln'])]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если вы можете инкапсулировать свою бизнес-логику в функцию, вы можете использовать понимание списка, которое ее вызывает. Вы можете заставить работать сколь угодно сложные вещи благодаря простоте и скорости необработанного кода Python.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Предостережения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Понимание списков предполагает, что с вашими данными легко работать — это означает, что ваши типы данных согласованы и у вас нет NaN, но это не всегда может быть гарантировано.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Первый более очевиден, но при работе с NaN отдавайте предпочтение встроенным методам pandas, если они существуют (поскольку они имеют гораздо лучшую логику обработки крайних случаев), или убедитесь, что ваша бизнес-логика включает соответствующую логику обработки NaN.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При работе со смешанными типами данных вам следует выполнять итерацию <span style=" font-family:'Courier New';">zip(df['A'], df['B'], ...)</span>вместо <span style=" font-family:'Courier New';">df[['A', 'B']].to_numpy()</span>того, чтобы последний неявно преобразовывал данные в наиболее распространенный тип. Например, если A является числовым, а B — строкой, <span style=" font-family:'Courier New';">to_numpy()</span>весь массив будет преобразован в строку, что может быть не тем, что вам нужно. К счастью, <span style=" font-family:'Courier New';">zip</span>самым простым решением этой проблемы является проверка связи между вашими столбцами.</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; vertical-align:sub;">*Ваш пробег может отличаться по причинам, указанным в разделе </span><span style=" font-size:8.25pt; font-weight:600; vertical-align:sub;">«Предостережения»</span><span style=" font-size:8.25pt; vertical-align:sub;"> выше.</span></p>
<hr />
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Очевидный пример</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Давайте продемонстрируем разницу на простом примере добавления двух столбцов pandas </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A + B</span><span style=" font-size:8.25pt;">. Это векторизуемая операция, поэтому будет легко сравнить производительность методов, обсуждавшихся выше.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://gist.github.com/Coldsp33d/948f96b384ca5bdf6e8ce203ac97c9a0"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Код сравнительного анализа, для справки</span></a><span style=" font-size:8.25pt;"> . Строка внизу измеряет функцию, написанную на numandas — стиле Pandas, который сильно смешивается с NumPy для достижения максимальной производительности. Следует избегать написания кода numandas, если вы не знаете, что делаете. Придерживайтесь API там, где это возможно (т. е. отдавайте предпочтение </span><span style=" font-family:'Courier New'; font-size:8.25pt;">vec</span><span style=" font-size:8.25pt;">) </span><span style=" font-family:'Courier New'; font-size:8.25pt;">vec_numpy</span><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Однако я должен отметить, что не всегда все так гладко. Иногда на вопрос «какой метод операции лучше всего» отвечает «это зависит от ваших данных». Мой совет — протестируйте различные подходы к вашим данным, прежде чем остановиться на одном.</span></p>
<hr />
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Мое личное мнение </span><span style=" font-size:8.25pt; font-weight:600; vertical-align:super;">*</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Большая часть анализа различных альтернатив семейства iter проводилась через призму производительности. Однако в большинстве ситуаций вы, как правило, будете работать с набором данных разумного размера (не более нескольких тысяч или 100 тысяч строк), и производительность будет отходить на второй план после простоты/читабельности решения.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вот мои личные предпочтения при выборе метода решения проблемы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для новичка:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-style:italic;">Векторизация</span><span style=" font-size:8.25pt;"> (по возможности) </span><span style=" font-size:8.25pt; font-style:italic;">; </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">apply()</span><span style=" font-size:8.25pt; font-style:italic;">; Список понятий; </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">itertuples()</span><span style=" font-size:8.25pt; font-style:italic;">/ </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">iteritems()</span><span style=" font-size:8.25pt; font-style:italic;">; </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">iterrows()</span><span style=" font-size:8.25pt; font-style:italic;">; Китон</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для более опытных:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-style:italic;">Векторизация</span><span style=" font-size:8.25pt;"> (по возможности) </span><span style=" font-size:8.25pt; font-style:italic;">; </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">apply()</span><span style=" font-size:8.25pt; font-style:italic;">; Список понятий; Китон; </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">itertuples()</span><span style=" font-size:8.25pt; font-style:italic;">/ </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">iteritems()</span><span style=" font-size:8.25pt; font-style:italic;">;</span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">iterrows()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Векторизация преобладает как наиболее идиоматический метод решения любой проблемы, которую можно векторизовать. Всегда стремитесь к векторизации! Если у вас есть сомнения, обратитесь к документации или посмотрите Stack Overflow на предмет существующего вопроса по вашей конкретной задаче.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я склонен во многих своих постах говорить о том, насколько </span><span style=" font-family:'Courier New'; font-size:8.25pt;">apply</span><span style=" font-size:8.25pt;">это плохо, но признаю, что новичку легче понять, что он делает. Кроме того, в </span><a href="https://stackoverflow.com/questions/54432583/when-should-i-not-want-to-use-pandas-apply-in-my-code"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">этом моем посте</span></a><span style=" font-family:'Courier New'; font-size:8.25pt;">apply</span><span style=" font-size:8.25pt;"> объяснено довольно много вариантов использования .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Cython занимает последнее место в списке, потому что для правильной реализации требуется больше времени и усилий. Обычно вам никогда не придется писать код с помощью pandas, который требует такого уровня производительности, которого не может удовлетворить даже понимание списка.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; vertical-align:sub;">* Как и любое личное мнение, пожалуйста, относитесь к нему скептически!</span></p>
<hr />
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Дальнейшее чтение</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html"><span style=" text-decoration: underline; color:#0000ff;">10 минут для pandas</span></a> и <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html"><span style=" text-decoration: underline; color:#0000ff;">основные базовые функции</span></a> — полезные ссылки, которые познакомят вас с Pandas и его библиотекой векторизованных*/cythonизированных функций.</li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/enhancingperf.html"><span style=" text-decoration: underline; color:#0000ff;">Повышение производительности</span></a> — учебник из документации по улучшению стандартных операций Pandas.</li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/54028199/for-loops-with-pandas-when-should-i-care"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Действительно ли циклы for в пандах плохи? Когда мне следует беспокоиться?</span></a> - подробное описание списков и их пригодности для различных операций (в основном с нечисловыми данными)</li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/54432583/when-should-i-ever-want-to-use-pandas-apply-in-my-code"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">Когда мне (не) следует использовать pandas apply() в моем коде?</span></a> -<span style=" font-family:'Courier New';">apply</span>медленный (но не такой медленный, как<span style=" font-family:'Courier New';">iter*</span>семейный. Есть, однако, ситуации, когда можно (или нужно) рассматривать<span style=" font-family:'Courier New';">apply</span>как серьезную альтернативу, особенно в некоторых<span style=" font-family:'Courier New';">GroupBy</span>операциях).</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; vertical-align:sub;">* Строковые методы Pandas «векторизованы» в том смысле, что они указаны в серии, но работают с каждым элементом. Базовые механизмы по-прежнему являются итеративными, поскольку строковые операции по своей сути сложно векторизовать.</span></p>
<hr />
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Почему я написал этот ответ</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Общая тенденция, которую я замечаю у новых пользователей, — это задавать вопросы вида «Как я могу перебрать свой df, чтобы сделать X?». Показ кода, который вызывается </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows()</span><span style=" font-size:8.25pt;">при выполнении чего-либо внутри </span><span style=" font-family:'Courier New'; font-size:8.25pt;">for</span><span style=" font-size:8.25pt;">цикла. Вот почему. Новый пользователь библиотеки, который не знаком с концепцией векторизации, скорее всего, представит себе код, который решает его проблему, как перебор данных для выполнения чего-либо. Не зная, как перебирать DataFrame, первое, что они делают, это гуглят и попадают сюда, на этот вопрос. Затем они видят принятый ответ, говорящий им, как это сделать, закрывают глаза и запускают этот код, даже не задаваясь сначала вопросом, правильно ли делать итерацию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Цель этого ответа — помочь новым пользователям понять, что итерация не обязательно является решением каждой проблемы и что могут существовать лучшие, быстрые и более идиоматические решения, и что стоит потратить время на их изучение. Я не пытаюсь начать войну итераций и векторизации, но я хочу, чтобы новые пользователи были информированы при разработке решений своих проблем с помощью этой библиотеки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">И, наконец... TLDR, чтобы подвести итог этому посту.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/55557758/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-55557758"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/55557758/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 13 фев в 19:03</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814wr8x829h4r.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4518341/wjandrea"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">вджандреа</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">31,2 тыс.99 золотых значков6565 серебряных знаков8686 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 7 апр. 2019 в 10:03</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814o1fbz2lc3n.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4909087/cs95"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">cs95</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">395 тыс.102102 золотых значка727727 серебряных знаков779779 бронзовых знаков</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-55557758"></a>1</li>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Итерация может быть инструментом, помогающим во время отладки, скажем, с ipdb, особенно во время начальной разработки и понимания крайних случаев. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/290150/b-dev"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">б_дев</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment135984293_55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">19 сен 2023 в 18:29</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comment-136017861"></a><span style=" font-size:8.25pt;">К</span><span style=" font-size:8.25pt;">аков здесь синтаксис двойной скобки? Что это значит и где это официально задокументировано?</span><span style=" font-family:'Courier New'; font-size:8.25pt;">df[['col1', ...,'coln']].to_numpy()</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4561887/gabriel-staples"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Габриэль Стейплс</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment136017861_55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">22 сен 2023 в 7:55</span></a></p>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-136020567"></a>2</li>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">@GabrielStaples Посмотрите </span><a href="https://pandas.pydata.org/docs/user_guide/indexing.html#basics"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">здесь</span></a><span style=" font-size:8.25pt;"> : </span><span style=" font-size:8.25pt; font-style:italic;">«... Вы можете передать список столбцов, чтобы </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-style:italic;">[]</span><span style=" font-size:8.25pt; font-style:italic;">выбрать столбцы в этом порядке. ...»</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/14311263/timus"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Тимус</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment136020567_55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">22 сен 2023 в 11:41</span></a></p>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-137441980"></a>2</li>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Что вы хотите выполнить какой-то ввод-вывод в кадре данных, строка за строкой. Например, если вам нужно отправить отдельные строки в какую-то «вещь», какой другой подход вы бы использовали, кроме </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows</span><span style=" font-size:8.25pt;">. например: отправка строк в сетевой сокет или Kafka в виде отдельных записей. Возможно, вы могли бы использовать что-то вроде .apply, но это довольно запутанное решение. Это можно сделать без использования глобальных переменных с помощью функтора (класса), но полученный код сложно понять. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/893254/freelanceconsultant"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Внештатный консультант</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment137441980_55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">8 фев в 12:31</span></a></p>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-138095836"></a>1</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Возможно, стоит упомянуть, что иногда вам не нужно вычислять значение для предыдущей строки, и вместо этого вы можете использовать накопительную функцию, например </span><span style=" font-family:'Courier New'; font-size:8.25pt;">cumsum()</span><span style=" font-size:8.25pt;">или </span><span style=" font-family:'Courier New'; font-size:8.25pt;">cummin()</span><span style=" font-size:8.25pt;">. </span><a href="https://stackoverflow.com/q/78009526/4518341"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Вот тот, который я решил с помощью</span></a><a href="https://stackoverflow.com/q/78009526/4518341"><span style=" font-family:'Courier New'; font-size:8.25pt; text-decoration: underline; color:#0000ff;">.cumprod()</span></a><span style=" font-size:8.25pt;"> . </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4518341/wjandrea"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">вджандреа</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment138095836_55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">15 апр в 21:35</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-55557758"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">П</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">оказать еще</span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;"> </span></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">3</span></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;"> комментария</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-41022840"></a><span style=" font-size:8.25pt;">5</span><span style=" font-size:8.25pt;">73</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Сначала подумайте, действительно ли вам нужно </span><span style=" font-size:8.25pt; font-style:italic;">перебирать</span><span style=" font-size:8.25pt;"> строки в DataFrame. Альтернативы см . в </span><a href="https://stackoverflow.com/a/55557758/3844376"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">ответе cs95 .</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если вам все еще нужно перебирать строки, вы можете использовать методы ниже. Обратите внимание на некоторые </span><span style=" font-size:8.25pt; font-weight:600;">важные предостережения</span><span style=" font-size:8.25pt;"> , которые не упоминаются ни в одном другом ответе.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.iterrows.html"><span style=" text-decoration: underline; color:#0000ff;">DataFrame.iterrows()</span></a></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for index, row in df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row[&quot;c1&quot;], row[&quot;c2&quot;])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.itertuples.html"><span style=" text-decoration: underline; color:#0000ff;">DataFrame.itertuples()</span></a></li></ul>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.itertuples(index=True, name='Pandas'):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row.c1, row.c2)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples()</span><span style=" font-size:8.25pt;">должно быть быстрее, чем</span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Но имейте в виду, согласно документации (на данный момент pandas 0.24.2):</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">iterrows: <span style=" font-family:'Courier New';">dtype</span>может не совпадать от строки к строке</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Поскольку iterrows возвращает Series для каждой строки, он </span><span style=" font-size:8.25pt; font-weight:600;">не сохраняет</span><span style=" font-size:8.25pt;"> dtypes во всех строках (dtypes сохраняются в столбцах для DataFrames). Чтобы сохранить dtypes при переборе строк, лучше использовать itertuples(), который возвращает именованные кортежи значений и который обычно работает намного быстрее, чем iterrows().</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">iterrows: не изменять строки</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Никогда не следует </span><span style=" font-size:8.25pt; font-weight:600;">изменять</span><span style=" font-size:8.25pt;"> то, что вы повторяете. Это не гарантирует работу во всех случаях. В зависимости от типов данных итератор возвращает копию, а не представление, и запись в нее не будет иметь никакого эффекта.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Вместо этого используйте </span><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">DataFrame.apply()</span></a><span style=" font-size:8.25pt;"> :</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">new_df = df.apply(lambda x: x * 2, axis=1)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">итертупли:</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Имена столбцов будут переименованы в позиционные имена, если они являются недопустимыми идентификаторами Python, повторяются или начинаются с подчеркивания. При большом количестве столбцов (&gt;255) возвращаются обычные кортежи.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Дополнительную информацию см. </span><a href="https://pandas.pydata.org/docs/user_guide/basics.html#iteration"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">в документации pandas по итерации .</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/41022840"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/41022840/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-41022840"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/41022840/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 1 окт. 2023 в 17:58</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814wr8x829h4r.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4518341/wjandrea"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">вджандреа</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">31,2 тыс.99 золотых значков6565 серебряных знаков8686 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 7 дек 2016 в 16:41</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814zzjiyflmjx.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/3844376/viddik13"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">виддик13</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">603822 золотых значка1414 серебряных значков2121 бронзовый знак</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-41022840"></a>8</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Примечание. Вы также можете сказать что-то вроде </span><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df[['c1','c2']].itertuples(index=True, name=None):</span><span style=" font-size:8.25pt;">включения в итератор строк только определенных столбцов. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/243392/brian-burns"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Брайан Бернс</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment89180584_41022840"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">29 июн 2018 в 7:29</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comment-124151002"></a><span style=" font-size:8.25pt;">Я</span><span style=" font-size:8.25pt;"> не знаю почему, но в моем случае использование </span><span style=" font-family:'Courier New'; font-size:8.25pt;">name=None</span><span style=" font-size:8.25pt;">make на 50% быстрее.</span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/11671779/muhammad-yasirroni"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Мухаммад Ясиррони</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment124151002_41022840"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">5 дек 2021 в 7:13</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-41022840"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-10739432"></a><span style=" font-size:8.25pt;">2</span><span style=" font-size:8.25pt;">51</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вам следует использовать </span><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.iterrows.html"><span style=" font-family:'Courier New'; font-size:8.25pt; text-decoration: underline; color:#0000ff;">df.iterrows()</span></a><span style=" font-size:8.25pt;">. Хотя итерация строка за строкой не особенно эффективна, поскольку </span><span style=" font-family:'Courier New'; font-size:8.25pt;">Series</span><span style=" font-size:8.25pt;">необходимо создавать объекты.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/10739432"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/10739432/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-10739432"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/10739432/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">изменено 11 дек. 2019 в 18:42</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814o1fbz2lc3n.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4909087/cs95"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">cs95</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">395 тыс.102102 золотых значка727727 серебряных знаков779779 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 24 мая 2012 в 14:24</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118147iu7jf9bez.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/776560/wes-mckinney"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Уэс МакКинни</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">104 тыс.3232 золотых значка143143 серебряных знака108108 бронзовых знаков</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-10739432"></a>9</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Я провел небольшое тестирование затрат времени на df.iterrows(), df.itertuples() и zip(df['a'], df['b']) и опубликовал результат в ответе другого вопрос: </span><a href="http://stackoverflow.com/a/34311080/2142098"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">stackoverflow.com/a/34311080/2142098</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/2142098/richard-wong"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Ричард Вонг</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment56363619_10739432"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">16 дек 2015 в 11:41</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-10739432"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-32680162"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">85</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Хотя </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows()</span><span style=" font-size:8.25pt;">это хороший вариант, иногда </span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples()</span><span style=" font-size:8.25pt;">он может быть намного быстрее:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'a': randn(1000), 'b': randn(1000),'N': randint(100, 1000, (1000)), 'x': 'x'})</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">%timeit [row.a * 2 for idx, row in df.iterrows()]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># =&gt; 10 loops, best of 3: 50.3 ms per loop</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">%timeit [row[1] * 2 for row in df.itertuples()]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># =&gt; 1000 loops, best of 3: 541 µs per loop</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/32680162"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/32680162/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-32680162"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/32680162/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 1 июня 2016 в 9:00</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 20 сен 2015 в 13:52</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118142tx5qodncx.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/1054939/e9t"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">е9т</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">16,1 тыс.55 золотых значков2424 серебряных значка2525 бронзовых знаков</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-32680162"></a>10</li>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Похоже, что большая часть разницы во времени в ваших двух примерах связана с тем, что вы, похоже, используете индексацию на основе меток для команды .iterrows() и индексацию на основе целых чисел для команды .itertuples(). </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4602248/alex"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Алекс</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment53208434_32680162"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">20 сен 2015 в 17:00</span></a></p>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-71581133"></a>8</li>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">@AbeMiessler </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows()</span><span style=" font-size:8.25pt;">объединяет каждую строку данных в серию, а </span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples()</span><span style=" font-size:8.25pt;">не делает этого. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4686625/miradulo"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">мирадуло</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment71581133_32680162"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">13 фев 2017 в 17:30</span></a></p>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comment-93283838"></a>2</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Я также получаю увеличение более чем в 50 раз, а также </span><a href="https://i.sstatic.net/HBe9o.png"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">i.sstatic.net/HBe9o.png</span></a><span style=" font-size:8.25pt;"> (при переходе на метод доступа attr во втором запуске). </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/952600/ajasja"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Аджася</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment93283838_32680162"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">7 ноя 2018 в 20:53</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-32680162"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-39370553"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">65</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы можете использовать </span><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html"><span style=" font-family:'Courier New'; font-size:8.25pt; text-decoration: underline; color:#0000ff;">df.iloc</span></a><span style=" font-size:8.25pt;">функцию следующим образом:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in range(0, len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(df.iloc[i]['c1'], df.iloc[i]['c2'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/39370553"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/39370553/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-39370553"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/39370553/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 8 янв. 2022 в 22:42</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814dayyhtya95.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/6160119/tonechas"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Тонечас</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">13,6 тыс.1616 золотых значков5050 серебряных значков8383 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 7 сен 2016 в 12:56</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814rqibx49he1.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/6523882/pjay"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">ПиДжей</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">269711 золотой значок1414 серебряных значков1212 бронзовых знаков</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-39370553"></a>22</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Это единственный известный мне действенный метод, если вы хотите сохранить типы данных, а также обращаться к столбцам по имени. </span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples</span><span style=" font-size:8.25pt;">сохраняет типы данных, но избавляется от любого имени, которое ему не нравится. </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows</span><span style=" font-size:8.25pt;">делает наоборот. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/169947/ken-williams"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Кен Уильямс</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment83643245_39370553"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">18 янв. 2018 в 19:22</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-39370553"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-30566899"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">32</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы также можете использовать </span><span style=" font-family:'Courier New'; font-size:8.25pt;">df.apply()</span><span style=" font-size:8.25pt;">его для перебора строк и доступа к нескольким столбцам для функции.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">документы: DataFrame.apply()</span></a></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def valuation_formula(x, y):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return x * y * 0.5</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df['price'] = df.apply(lambda row: valuation_formula(row['x'], row['y']), axis=1)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Обратите внимание, что </span><span style=" font-family:'Courier New'; font-size:8.25pt;">axis=1</span><span style=" font-size:8.25pt;">здесь то же самое, что и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">axis='columns'</span><span style=" font-size:8.25pt;">, и используется применение функции к каждой </span><span style=" font-size:8.25pt; font-style:italic;">строке</span><span style=" font-size:8.25pt;"> , а не к каждому </span><span style=" font-size:8.25pt; font-style:italic;">столбцу</span><span style=" font-size:8.25pt;"> . Если не указано, по умолчанию функция применяется к каждому </span><span style=" font-size:8.25pt; font-style:italic;">столбцу</span><span style=" font-size:8.25pt;"> .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/30566899"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/30566899/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-30566899"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/30566899/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 18 сен 2023 в 22:55</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814eible07xkd.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4561887/gabriel-staples"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Габриэль Стейплс</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">46,2 тыс.2121 золотой значок242242 серебряных знака324324 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 1 июня 2015 в 6:24</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image171801181464oi4jxde1.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/1803298/cheekybastard"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">нахальный ублюдок</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">566533 золотых значка2323 серебряных значка2626 бронзовых знаков</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-30566899"></a>14</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Обратите внимание, что </span><span style=" font-family:'Courier New'; font-size:8.25pt;">apply</span><span style=" font-size:8.25pt;">он не «перебирает» строки, а применяет функцию по строкам. Приведенный выше код не будет работать, если вам действительно </span><span style=" font-size:8.25pt; font-style:italic;">нужны</span><span style=" font-size:8.25pt;"> итерации и индексы, например, при сравнении значений в разных строках (в этом случае вы не можете ничего делать, кроме итерации). </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/5017267/gented"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">смягченный</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment86313667_30566899"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">4 апр. 2018 в 13:44</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comment-135973412"></a><span style=" font-size:8.25pt;">@</span><span style=" font-size:8.25pt;">gented, это не совсем так. Например, чтобы получить доступ к значениям в предыдущей строке, вы можете просто добавить новый столбец, содержащий значения предыдущей строки, например: </span><span style=" font-family:'Courier New'; font-size:8.25pt;">dataframe[&quot;val_previous&quot;] = dataframe[&quot;val&quot;].shift(1)</span><span style=" font-size:8.25pt;">. Затем вы можете получить доступ к этой </span><span style=" font-family:'Courier New'; font-size:8.25pt;">val_previous</span><span style=" font-size:8.25pt;">переменной в данной строке, используя этот ответ. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4561887/gabriel-staples"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Габриэль Стейплс</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment135973412_30566899"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">18 сен 2023 в 22:58</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-30566899"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-59413206"></a><span style=" font-size:8.25pt;">7</span><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Как эффективно выполнять итерации</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если вам действительно нужно перебирать Pandas </span><span style=" font-family:'Courier New'; font-size:8.25pt;">DataFrame</span><span style=" font-size:8.25pt;">, вы, вероятно, захотите </span><span style=" font-size:8.25pt; font-weight:600;">избежать использования</span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">iterrows()</span><span style=" font-size:8.25pt;"> . Существуют разные методы, и обычный </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows()</span><span style=" font-size:8.25pt;">далеко не самый лучший. </span><span style=" font-size:8.25pt; font-weight:600;">`itertuples()`` может быть в 100 раз быстрее.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Суммируя:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как правило, используйте <span style=" font-family:'Courier New';">df.itertuples(name=None)</span>. В частности, если у вас есть столбцы с фиксированным числом и менее 255 столбцов. <span style=" font-style:italic;">См. пункт (3) ниже.</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В противном случае используйте <span style=" font-family:'Courier New';">df.itertuples()</span>, за исключением случаев, когда ваши столбцы содержат специальные символы, такие как пробелы или <span style=" font-family:'Courier New';">-</span>. <span style=" font-style:italic;">См. пункт (2) ниже.</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Его можно использовать, <span style=" font-family:'Courier New';">itertuples()</span>даже если ваш фрейм данных имеет странные столбцы, используя последний пример ниже. <span style=" font-style:italic;">См. пункт (4) ниже.</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используйте только <span style=" font-family:'Courier New';">iterrows()</span>в том случае, если вы не можете использовать ни одно из предыдущих решений. <span style=" font-style:italic;">См. пункт (1) ниже.</span></li></ul>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Различные методы перебора строк в Pandas </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">DataFrame</span><span style=" font-size:8.25pt; font-weight:600;">:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Во-первых, для использования во всех приведенных ниже примерах сгенерируйте случайный фрейм данных с миллионом строк и 4 столбцами, например:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame(np.random.randint(0, 100, size=(1000000, 4)), columns=list('ABCD'))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">print(df)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вывод всех этих примеров показан внизу.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обычное <span style=" font-family:'Courier New';">iterrows()</span>удобно, но чертовски медленно:</li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">start_time = time.clock()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for _, row in df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    result += max(row['B'], row['C'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">total_elapsed_time = round(time.clock() - start_time, 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">print(&quot;1. Iterrows done in {} seconds, result = {}&quot;.format(total_elapsed_time, result))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Использование имени</span> по умолчанию <span style=" font-family:'Courier New';">itertuples()</span>уже намного быстрее, но оно не работает с именами столбцов, такими как <span style=" font-family:'Courier New';">My Col-Name is very Strange</span>(вам следует избегать этого метода, если ваши столбцы повторяются или если имя столбца не может быть просто преобразовано в имя переменной Python).:</li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">start_time = time.clock()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.itertuples(index=False):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    result += max(row.B, row.C)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">total_elapsed_time = round(time.clock() - start_time, 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">print(&quot;2. Named Itertuples done in {} seconds, result = {}&quot;.format(total_elapsed_time, result))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование <span style=" font-style:italic;">безымянного</span> <span style=" font-family:'Courier New';">itertuples()</span> путем установки <span style=" font-family:'Courier New';">name=None</span>еще быстрее, но не очень удобно, так как вам нужно определить переменную для каждого столбца.</li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">start_time = time.clock()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for(_, col1, col2, col3, col4) in df.itertuples(name=None):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    result += max(col2, col3)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">total_elapsed_time = round(time.clock() - start_time, 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">print(&quot;3. Itertuples done in {} seconds, result = {}&quot;.format(total_elapsed_time, result))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Наконец, использование <span style=" font-style:italic;">поливалента</span> <span style=" font-family:'Courier New';">itertuples()</span> медленнее, чем в предыдущем примере, но вам не нужно определять переменную для каждого столбца, и оно работает с именами столбцов, такими как <span style=" font-family:'Courier New';">My Col-Name is very Strange</span>.</li></ol>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">start_time = time.clock()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">result = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.itertuples(index=False):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    result += max(row[df.columns.get_loc('B')], row[df.columns.get_loc('C')])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">total_elapsed_time = round(time.clock() - start_time, 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">print(&quot;4. Polyvalent Itertuples working even with special characters in the column name done in {} seconds, result = {}&quot;.format(total_elapsed_time, result))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вывод всего кода и примеров выше:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">         A   B   C   D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">0       41  63  42  23</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1       54   9  24  65</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">2       15  34  10   9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">3       39  94  82  97</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">4        4  88  79  54</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">...     ..  ..  ..  ..</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">999995  48  27   4  25</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">999996  16  51  34  28</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">999997   1  39  61  14</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">999998  66  51  27  70</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">999999  51  53  47  99</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">[1000000 rows x 4 columns]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1. Iterrows done in 104.96 seconds, result = 66151519</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">2. Named Itertuples done in 1.26 seconds, result = 66151519</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">3. Itertuples done in 0.94 seconds, result = 66151519</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">4. Polyvalent Itertuples working even with special characters in the column name done in 2.94 seconds, result = 66151519</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">График этих результатов </span><a href="https://stackoverflow.com/a/77270285/4561887"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">от @Gabriel Staples в его ответе здесь</span></a><span style=" font-size:8.25pt;"> :</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118149x1fj2rzsk.png" /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Смотрите также</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://medium.com/swlh/why-pandas-itertuples-is-faster-than-iterrows-and-how-to-make-it-even-faster-bc50c0edd30d"><span style=" text-decoration: underline; color:#0000ff;">Эта статья представляет собой очень интересное сравнение между </span></a><a href="https://medium.com/swlh/why-pandas-itertuples-is-faster-than-iterrows-and-how-to-make-it-even-faster-bc50c0edd30d"><span style=" font-family:'Courier New'; text-decoration: underline; color:#0000ff;">iterrows()</span></a><a href="https://medium.com/swlh/why-pandas-itertuples-is-faster-than-iterrows-and-how-to-make-it-even-faster-bc50c0edd30d"><span style=" text-decoration: underline; color:#0000ff;">и</span></a><a href="https://medium.com/swlh/why-pandas-itertuples-is-faster-than-iterrows-and-how-to-make-it-even-faster-bc50c0edd30d"><span style=" font-family:'Courier New'; text-decoration: underline; color:#0000ff;">itertuples()</span></a></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/59413206"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/59413206/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-59413206"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/59413206/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 11 окт. 2023 в 5:07</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814eible07xkd.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4561887/gabriel-staples"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Габриэль Стейплс</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">46,2 тыс.2121 золотой значок242242 серебряных знака324324 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 19 дек 2019 в 16:02</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814f7ty0409c0.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/3292591/romain-capron"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Ромен Капрон</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">170511 золотой значок1919 серебряных знаков2626 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-59413206"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-48297889"></a><span style=" font-size:8.25pt;">5</span><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я искал, </span><span style=" font-size:8.25pt; font-weight:600;">как перебирать строки </span><span style=" font-size:8.25pt; font-weight:600; font-style:italic;">и</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">столбцы</span><span style=" font-size:8.25pt;"> , и закончил вот так:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i, row in df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    for j, column in row.iteritems():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        print(column)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/48297889"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/48297889/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-48297889"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/48297889/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 11 июн 2020 в 13:37</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 17 янв. 2018 в 9:41</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814cplt2mwrmf.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4458246/lucas-b"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Лукас Б</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">235111 золотой значок2424 серебряных значка2222 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-48297889"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-70096237"></a><span style=" font-size:8.25pt;">4</span><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">У нас есть несколько вариантов сделать то же самое, и многие люди поделились своими ответами.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я нашел два следующих метода простыми и эффективными:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.iterrows.html"><span style=" text-decoration: underline; color:#0000ff;">DataFrame.iterrows()</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.itertuples.html"><span style=" text-decoration: underline; color:#0000ff;">DataFrame.itertuples()</span></a></li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Пример:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> import pandas as pd</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> inp = [{'c1':10, 'c2':100}, {'c1':11,'c2':110}, {'c1':12,'c2':120}]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> df = pd.DataFrame(inp)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> print (df)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> # With the iterrows method</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> for index, row in df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">     print(row[&quot;c1&quot;], row[&quot;c2&quot;])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> # With the itertuples method</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> for row in df.itertuples(index=True, name='Pandas'):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">     print(row.c1, row.c2)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Примечание: itertuples() должен работать быстрее, чем iterrows().</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/70096237"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/70096237/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-70096237"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/70096237/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 4 сен 2022 в 23:06</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 24 ноя 2021 в 12:39</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814ezzxctppen.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/9076666/sachin"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Сачин</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">15841818 серебряных знаков2525 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-70096237"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-47149876"></a><span style=" font-size:8.25pt;">2</span><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы можете написать свой собственный итератор, который реализует</span><span style=" font-family:'Courier New'; font-size:8.25pt;">namedtuple</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">from collections import namedtuple</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def myiter(d, cols=None):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    if cols is None:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        v = d.values.tolist()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        cols = d.columns.values.tolist()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    else:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        j = [d.columns.get_loc(c) for c in cols]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        v = d.values[:, j].tolist()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    n = namedtuple('MyTuple', cols)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    for line in iter(v):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        yield n(*line)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Это напрямую сравнимо с </span><span style=" font-family:'Courier New'; font-size:8.25pt;">pd.DataFrame.itertuples</span><span style=" font-size:8.25pt;">. Я стремлюсь выполнить ту же задачу с большей эффективностью.</span></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для данного кадра данных с моей функцией:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">list(myiter(df))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">[MyTuple(c1=10, c2=100), MyTuple(c1=11, c2=110), MyTuple(c1=12, c2=120)]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Или с </span><span style=" font-family:'Courier New'; font-size:8.25pt;">pd.DataFrame.itertuples</span><span style=" font-size:8.25pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">list(df.itertuples(index=False))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">[Pandas(c1=10, c2=100), Pandas(c1=11, c2=110), Pandas(c1=12, c2=120)]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Комплексное тестирование</span><span style=" font-size:8.25pt;"><br />Мы проверяем, делаем ли все столбцы доступными и разделяем их на подгруппы.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def iterfullA(d):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return list(myiter(d))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def iterfullB(d):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return list(d.itertuples(index=False))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def itersubA(d):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return list(myiter(d, ['col3', 'col4', 'col5', 'col6', 'col7']))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def itersubB(d):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return list(d[['col3', 'col4', 'col5', 'col6', 'col7']].itertuples(index=False))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">res = pd.DataFrame(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    index=[10, 30, 100, 300, 1000, 3000, 10000, 30000],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    columns='iterfullA iterfullB itersubA itersubB'.split(),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    dtype=float</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in res.index:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    d = pd.DataFrame(np.random.randint(10, size=(i, 10))).add_prefix('col')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    for j in res.columns:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        stmt = '{}(d)'.format(j)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        setp = 'from __main__ import d, {}'.format(j)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        res.at[i, j] = timeit(stmt, setp, number=100)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">res.groupby(res.columns.str[4:-1], axis=1).plot(loglog=True);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814f3m30z9oyd.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814ujf96bzms2.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/47149876"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/47149876/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-47149876"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/47149876/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 7 нояб. 2017 в 4:29</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 7 ноября 2017 в 4:15</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118146umywussxk.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/2336654/pirsquared"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">piRSquared</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">292 тыс.6262 золотых значка496496 серебряных знаков636636 бронзовых знаков</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-47149876"></a>5</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Для людей, которые не хотят читать код: синяя линия — это </span><span style=" font-family:'Courier New'; font-size:8.25pt;">intertuples</span><span style=" font-size:8.25pt;">, оранжевая линия — это список итераторов через блок доходности. </span><span style=" font-family:'Courier New'; font-size:8.25pt;">interrows</span><span style=" font-size:8.25pt;">не сравнивается. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4180797/james-l"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Джеймс Л.</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment82152350_47149876"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">1 дек 2017 в 16:06</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-47149876"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-42741552"></a><span style=" font-size:8.25pt;">2</span><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Чтобы зациклить все строки в </span><span style=" font-family:'Courier New'; font-size:8.25pt;">dataframe</span><span style=" font-size:8.25pt;">вы можете использовать:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for x in range(len(date_example.index)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print date_example['Date'].iloc[x]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/42741552"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/42741552/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-42741552"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/42741552/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">изменено 4 апр. 2017 в 20:46</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 11 марта 2017 в 22:44</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814niwa87fp2v.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/797495/pedro-lobito"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Педро Лобито</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">97,3 тыс.3232 золотых значка266266 серебряных знаков274274 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comments-42741552"></a><span style=" font-size:8.25pt;">Е</span><span style=" font-size:8.25pt;">сли вы хотите, чтобы это работало, вызовите df.columns.get_loc, чтобы получить позицию целочисленного индекса столбца даты (вне цикла), а затем используйте один вызов индексации iloc внутри. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4909087/cs95"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">cs95</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment98187416_42741552"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">19 апр. 2019 в 1:57</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-42741552"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-47073107"></a><span style=" font-size:8.25pt;">2</span><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> for ind in df.index:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">     print df['c1'][ind], df['c2'][ind]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/47073107"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/47073107/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-47073107"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/47073107/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">изменено 7 мая 2019 в 6:37</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814o1fbz2lc3n.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4909087/cs95"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">cs95</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">395 тыс.102102 золотых значка727727 серебряных знаков779779 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 2 ноября 2017 в 10:33</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118149amwf420be.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/6088984/grag2015"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Граг2015</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6611111 серебряных значков1515 бронзовых знаков</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-47073107"></a>6</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Это цепная индексация. Не используйте это! </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/4909087/cs95"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">cs95</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment98185895_47073107"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">18 апр. 2019 в 23:19</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-47073107"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-77270285"></a><span style=" font-size:8.25pt;">2</span><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Ключевые выводы:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используйте векторизацию.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Скорость профилирования</span> вашего кода! Не думайте, что что-то быстрее, потому что вы <span style=" font-style:italic;">думаете,</span> что оно быстрее; профилируйте его скорость и <span style=" font-style:italic;">докажите,</span> что он быстрее. Результаты могут Вас удивить.</li></ol>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Как перебирать Pandas </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">DataFrame</span><span style=" font-size:8.25pt; font-weight:600;">без итерации</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">После </span><span style=" font-size:8.25pt; font-style:italic;">нескольких недель</span><span style=" font-size:8.25pt;"> работы над этим ответом я пришел к следующему:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вот </span><span style=" font-size:8.25pt; font-weight:600;">13 методов перебора </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">DataFrame</span><span style=" font-size:8.25pt; font-weight:600;">Pandas</span><span style=" font-size:8.25pt;"> . Как видите, время, необходимое для этого, </span><span style=" font-size:8.25pt; font-style:italic;">сильно</span><span style=" font-size:8.25pt;"> различается . Самая быстрая техника </span><span style=" font-size:8.25pt; font-weight:600;">примерно в 1363 раза</span><span style=" font-size:8.25pt;"> быстрее самой медленной! Ключевой вывод, </span><a href="https://stackoverflow.com/a/55557758/4561887"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">как говорит здесь @cs95</span></a><span style=" font-size:8.25pt;"> , — </span><span style=" font-size:8.25pt; font-weight:600; font-style:italic;">не</span><span style=" font-size:8.25pt; font-weight:600;"> повторять! Вместо этого используйте векторизацию ( </span><a href="https://en.wikipedia.org/wiki/Array_programming"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">«программирование массивов»</span></a><span style=" font-size:8.25pt; font-weight:600;"> ).</span><span style=" font-size:8.25pt;"> На самом деле все это означает, что вам следует использовать массивы непосредственно в математических формулах, а не пытаться вручную перебирать массивы. Базовые объекты, конечно, должны это поддерживать, но и Numpy, и Pandas </span><span style=" font-size:8.25pt; font-style:italic;">это поддерживают</span><span style=" font-size:8.25pt;"> .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Есть много способов использовать векторизацию в Pandas, которые вы можете увидеть на графике и в моем примере кода ниже. При непосредственном использовании массивов базовый цикл по-прежнему имеет место, но (я думаю) в очень оптимизированном базовом коде C, а не в чистом Python.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Полученные результаты</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Было протестировано 13 техник, пронумерованных от 1 до 13. Номер и название техники указаны под каждой полосой. Общее время расчета указано над каждым баром. Ниже находится множитель, показывающий, насколько дольше это заняло, чем самый быстрый метод, показанный справа:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; vertical-align:sub;">Из </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world/blob/master/python/pandas_dataframe_iteration_vs_vectorization_vs_list_comprehension_speed_tests.svg"><span style=" font-family:'Courier New'; font-size:8.25pt; text-decoration: underline; color:#0000ff; vertical-align:sub;">pandas_dataframe_iteration_vs_vectorization_vs_list_comprehension_speed_tests.svg</span></a><span style=" font-size:8.25pt; vertical-align:sub;">моего репозитория </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff; vertical-align:sub;">eRCaGuy_hello_world</span></a><span style=" font-size:8.25pt; vertical-align:sub;"> (созданного с помощью </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world/blob/master/python/pandas_dataframe_iteration_vs_vectorization_vs_list_comprehension_speed_tests.py"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff; vertical-align:sub;">этого кода</span></a><span style=" font-size:8.25pt; vertical-align:sub;"> ).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814rvx6i82qpr.png" /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Краткое содержание</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Понимание списков</span><span style=" font-size:8.25pt;"> и </span><span style=" font-size:8.25pt; font-weight:600;">векторизация</span><span style=" font-size:8.25pt;"> (возможно, с </span><span style=" font-size:8.25pt; font-weight:600;">логической индексацией</span><span style=" font-size:8.25pt;"> ) — это все, что вам действительно нужно.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Используйте </span><span style=" font-size:8.25pt; font-weight:600;">понимание списков</span><span style=" font-size:8.25pt;"> (хорошо) и </span><span style=" font-size:8.25pt; font-weight:600;">векторизацию</span><span style=" font-size:8.25pt;"> (лучше всего). Я думаю, что чистая векторизация </span><span style=" font-size:8.25pt; font-style:italic;">всегда</span><span style=" font-size:8.25pt;"> возможна, но может потребовать дополнительной работы в сложных вычислениях. Найдите в этом ответе слова </span><span style=" font-size:8.25pt; font-weight:600;">«логическое индексирование»</span><span style=" font-size:8.25pt;"> , </span><span style=" font-size:8.25pt; font-weight:600;">«логический массив»</span><span style=" font-size:8.25pt;"> и </span><span style=" font-size:8.25pt; font-weight:600;">«логическая маска»</span><span style=" font-size:8.25pt;"> (все три — одно и то же), чтобы увидеть некоторые из более сложных случаев, когда таким образом можно использовать чистую векторизацию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Вот 13 техник, перечисленных в порядке от </span><span style=" font-size:8.25pt; font-weight:600; font-style:italic;">самого быстрого до самого медленного</span><span style=" font-size:8.25pt; font-weight:600;"> . Я рекомендую </span><span style=" font-size:8.25pt; font-weight:600; font-style:italic;">никогда не</span><span style=" font-size:8.25pt; font-weight:600;"> использовать последние (самые медленные) 3-4 техники.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 8:<span style=" font-family:'Courier New';">8_pure_vectorization__with_df.loc[]_boolean_array_indexing_for_if_statment_corner_case</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 6:<span style=" font-family:'Courier New';">6_vectorization__with_apply_for_if_statement_corner_case</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 7:<span style=" font-family:'Courier New';">7_vectorization__with_list_comprehension_for_if_statment_corner_case</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 11:<span style=" font-family:'Courier New';">11_list_comprehension_w_zip_and_direct_variable_assignment_calculated_in_place</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 10:<span style=" font-family:'Courier New';">10_list_comprehension_w_zip_and_direct_variable_assignment_passed_to_func</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 12:<span style=" font-family:'Courier New';">12_list_comprehension_w_zip_and_row_tuple_passed_to_func</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 5:<span style=" font-family:'Courier New';">5_itertuples_in_for_loop</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 13:<span style=" font-family:'Courier New';">13_list_comprehension_w__to_numpy__and_direct_variable_assignment_passed_to_func</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 9:<span style=" font-family:'Courier New';">9_apply_function_with_lambda</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 1:<span style=" font-family:'Courier New';">1_raw_for_loop_using_regular_df_indexing</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 2:<span style=" font-family:'Courier New';">2_raw_for_loop_using_df.loc[]_indexing</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 4:<span style=" font-family:'Courier New';">4_iterrows_in_for_loop</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Техника 3:<span style=" font-family:'Courier New';">3_raw_for_loop_using_df.iloc[]_indexing</span></li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Эмпирические правила:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Методы 3, 4 и 2 <span style=" font-style:italic;">никогда не</span> следует использовать. Они очень медленные и не имеют никаких преимуществ. Однако имейте в виду: не техника индексации, такая как <span style=" font-family:'Courier New';">.loc[]</span>или <span style=" font-family:'Courier New';">.iloc[]</span>, делает эти методы плохими, а, скорее, <span style=" font-style:italic;">цикл </span><span style=" font-family:'Courier New'; font-style:italic;">for</span><span style=" font-style:italic;">, в котором они находятся</span> , делает их плохими! <span style=" font-family:'Courier New';">.loc[]</span>Например, я использую самый быстрый подход (чистая векторизация)! Итак, вот 3 самых медленных метода, которые <span style=" font-style:italic;">никогда не</span> следует использовать:</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">3_raw_for_loop_using_df.iloc[]_indexing</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">4_iterrows_in_for_loop</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">2_raw_for_loop_using_df.loc[]_indexing</span></li></ol>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Технику <span style=" font-family:'Courier New';">1_raw_for_loop_using_regular_df_indexing</span>тоже никогда не следует использовать, но если вы собираетесь использовать необработанный цикл for, он будет быстрее, чем другие.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С <span style=" font-family:'Courier New'; font-weight:600;">.apply()</span>функцией ( <span style=" font-family:'Courier New';">9_apply_function_with_lambda</span>) все в порядке, но, вообще говоря, я бы ее тоже избегал. Однако Technique <span style=" font-family:'Courier New';">6_vectorization__with_apply_for_if_statement_corner_case</span>показал себя лучше <span style=" font-family:'Courier New';">7_vectorization__with_list_comprehension_for_if_statment_corner_case</span>, чем , что интересно.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Понимание списка</span> - это здорово! Это не самый быстрый, но простой в использовании и очень быстрый!</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Приятно то, что его можно использовать с <span style=" font-style:italic;">любой</span> функцией, предназначенной для работы с отдельными значениями или значениями массива. А это означает, что <span style=" font-family:'Courier New';">if</span>внутри функции могут быть действительно сложные операторы и другие вещи. Итак, компромисс здесь заключается в том, что он дает вам большую универсальность с действительно читаемым и повторно используемым кодом за счет использования внешних функций вычислений, но при этом дает вам большую скорость!</li></ol>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Векторизация</span> — самый быстрый и лучший способ, и его следует использовать всякий раз, когда уравнение простое. При желании вы можете использовать что-то вроде <span style=" font-family:'Courier New';">.apply()</span>или <span style=" font-weight:600;">понимание списка</span> только для более сложных частей уравнения, при этом легко используя векторизацию для остальных.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Чистая векторизация</span> — самый быстрый и лучший способ, и вам следует его использовать, если вы <span style=" font-style:italic;">готовы приложить усилия, чтобы заставить его работать.</span></li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В простых случаях это то, что вам следует использовать.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для сложных случаев, <span style=" font-family:'Courier New';">if</span>операторов и т. д. можно также использовать чистую векторизацию посредством <span style=" font-weight:600;">логического индексирования,</span> но это может добавить дополнительную работу и ухудшить читаемость. Таким образом, вы можете вместо этого использовать <span style=" font-weight:600;">понимание списка</span> (обычно лучше всего) или <span style=" font-weight:600;">.apply()</span> (обычно медленнее, но не всегда) только для этих крайних случаев, продолжая использовать векторизацию для остальной части вычислений. Пример: см. методы <span style=" font-family:'Courier New';">7_vectorization__with_list_comprehension_for_if_statment_corner_case</span>и <span style=" font-family:'Courier New';">6_vectorization__with_apply_for_if_statement_corner_case</span>.</li></ol>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Данные испытаний</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Предположим, у нас есть следующий DataFrame Pandas. Он имеет 2 миллиона строк с 4 столбцами ( </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A</span><span style=" font-size:8.25pt;">, </span><span style=" font-family:'Courier New'; font-size:8.25pt;">B</span><span style=" font-size:8.25pt;">, </span><span style=" font-family:'Courier New'; font-size:8.25pt;">C</span><span style=" font-size:8.25pt;">и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">D</span><span style=" font-size:8.25pt;">), каждый со случайными значениями от </span><span style=" font-family:'Courier New'; font-size:8.25pt;">-1000</span><span style=" font-size:8.25pt;">до </span><span style=" font-family:'Courier New'; font-size:8.25pt;">1000</span><span style=" font-size:8.25pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df =</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">           A    B    C    D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">0       -365  842  284 -942</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1        532  416 -102  888</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">2        397  321 -296 -616</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">3       -215  879  557  895</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">4        857  701 -157  480</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">...      ...  ...  ...  ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1999995 -101 -233 -377 -939</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1999996 -989  380  917  145</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1999997 -879  333 -372 -970</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1999998  738  982 -743  312</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">1999999 -306 -103  459  745</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я создал этот DataFrame следующим образом:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">import numpy as np</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">import pandas as pd</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Create an array (numpy list of lists) of fake data</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">MIN_VAL = -1000</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">MAX_VAL = 1000</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># NUM_ROWS = 10_000_000</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">NUM_ROWS = 2_000_000  # default for final tests</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># NUM_ROWS = 1_000_000</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># NUM_ROWS = 100_000</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># NUM_ROWS = 10_000  # default for rapid development &amp; initial tests</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">NUM_COLS = 4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">data = np.random.randint(MIN_VAL, MAX_VAL, size=(NUM_ROWS, NUM_COLS))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Now convert it to a Pandas DataFrame with columns named &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, and &quot;D&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df_original = pd.DataFrame(data, columns=[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">print(f&quot;df = \n{df_original}&quot;)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Тестовое уравнение/расчет</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я хотел продемонстрировать, что все эти методы возможны на нетривиальных функциях или уравнениях, поэтому я намеренно сделал уравнение, которое они вычисляют, требующим:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">if</span>заявления</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">данные из нескольких столбцов в DataFrame</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">данные из нескольких строк в DataFrame</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Уравнение, которое мы будем рассчитывать для каждой строки, следующее. Я составил это произвольно, но думаю, что оно содержит достаточно сложности, чтобы вы могли расширить то, что я сделал, для выполнения любого уравнения, которое вы хотите, в Pandas с полной векторизацией:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814vuvu4mu19d.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В Python приведенное выше уравнение можно записать следующим образом:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Calculate and return a new value, `val`, by performing the following equation:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">val = (</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    2 * A_i_minus_2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 3 * A_i_minus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 4 * A</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 5 * A_i_plus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # Python ternary operator; don't forget parentheses around the entire</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # ternary expression!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + ((6 * B) if B &gt; 0 else (60 * B))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 7 * C</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    - 8 * D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Альтернативно, вы можете написать это так:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Calculate and return a new value, `val`, by performing the following equation:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">if B &gt; 0:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    B_new = 6 * B</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">else:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    B_new = 60 * B</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">val = (</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    2 * A_i_minus_2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 3 * A_i_minus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 4 * A</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 5 * A_i_plus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + B_new</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 7 * C</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    - 8 * D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Любой из них можно обернуть в функцию. Бывший:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_minus_2,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_minus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_plus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        B,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        C,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        D):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    val = (</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        2 * A_i_minus_2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 3 * A_i_minus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 4 * A</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 5 * A_i_plus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # Python ternary operator; don't forget parentheses around the</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # entire ternary expression!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + ((6 * B) if B &gt; 0 else (60 * B))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 7 * C</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        - 8 * D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return val</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Методы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Полный код доступен для загрузки и запуска в моем </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world/blob/master/python/pandas_dataframe_iteration_vs_vectorization_vs_list_comprehension_speed_tests.py"><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">python/pandas_dataframe_iteration_vs_vectorization_vs_list_comprehension_speed_tests.py</span></a><span style=" font-size:8.25pt;">файле в репозитории </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">eRCaGuy_hello_world</span></a><span style=" font-size:8.25pt;"> .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Вот код для всех 13 техник:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 1:</span> <span style=" font-family:'Courier New';">1_raw_for_loop_using_regular_df_indexing</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">val = [np.NAN]*len(df)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in range(len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    if i &lt; 2 or i &gt; len(df)-2:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        continue</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    val[i] = calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;][i-2],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;][i-1],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;][i],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;][i+1],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;B&quot;][i],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;C&quot;][i],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;D&quot;][i],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = val  # put this column back into the dataframe</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 2:</span> <span style=" font-family:'Courier New';">2_raw_for_loop_using_df.loc[]_indexing</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">val = [np.NAN]*len(df)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in range(len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    if i &lt; 2 or i &gt; len(df)-2:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        continue</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    val[i] = calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.loc[i-2, &quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.loc[i-1, &quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.loc[i,   &quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.loc[i+1, &quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.loc[i,   &quot;B&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.loc[i,   &quot;C&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.loc[i,   &quot;D&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = val  # put this column back into the dataframe</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 3:</span> <span style=" font-family:'Courier New';">3_raw_for_loop_using_df.iloc[]_indexing</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># column indices</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">i_A = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">i_B = 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">i_C = 2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">i_D = 3</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">val = [np.NAN]*len(df)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in range(len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    if i &lt; 2 or i &gt; len(df)-2:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        continue</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    val[i] = calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.iloc[i-2, i_A],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.iloc[i-1, i_A],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.iloc[i,   i_A],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.iloc[i+1, i_A],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.iloc[i,   i_B],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.iloc[i,   i_C],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df.iloc[i,   i_D],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = val  # put this column back into the dataframe</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 4:</span> <span style=" font-family:'Courier New';">4_iterrows_in_for_loop</span></li></ol>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">val = [np.NAN]*len(df)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for index, row in df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    if index &lt; 2 or index &gt; len(df)-2:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        continue</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    val[index] = calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;][index-2],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;][index-1],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;][index+1],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;B&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;C&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;D&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = val  # put this column back into the dataframe</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для всех следующих примеров мы должны сначала подготовить фрейм данных, добавив столбцы с предыдущими и следующими значениями: </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A_(i-2)</span><span style=" font-size:8.25pt;">, </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A_(i-1)</span><span style=" font-size:8.25pt;">и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A_(i+1)</span><span style=" font-size:8.25pt;">. Эти столбцы в DataFrame будут называться </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A_i_minus_2</span><span style=" font-size:8.25pt;">, </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A_i_minus_1</span><span style=" font-size:8.25pt;">и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">A_i_plus_1</span><span style=" font-size:8.25pt;">, соответственно:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df_original[&quot;A_i_minus_2&quot;] = df_original[&quot;A&quot;].shift(2)  # val at index i-2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df_original[&quot;A_i_minus_1&quot;] = df_original[&quot;A&quot;].shift(1)  # val at index i-1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df_original[&quot;A_i_plus_1&quot;] = df_original[&quot;A&quot;].shift(-1)  # val at index i+1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Note: to ensure that no partial calculations are ever done with rows which</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># have NaN values due to the shifting, we can either drop such rows with</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># `.dropna()`, or set all values in these rows to NaN. I'll choose the latter</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># so that the stats that will be generated with the techniques below will end</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># up matching the stats which were produced by the prior techniques above. ie:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># the number of rows will be identical to before.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># df_original = df_original.dropna()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df_original.iloc[:2, :] = np.NAN   # slicing operators: first two rows,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">                                   # all columns</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df_original.iloc[-1:, :] = np.NAN  # slicing operators: last row, all columns</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Запуск векторизованного кода, приведенного выше, для создания этих трех новых столбцов занял в общей сложности </span><span style=" font-size:8.25pt; font-weight:600;">0,044961 секунды</span><span style=" font-size:8.25pt;"> .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Теперь перейдем к остальным техникам:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 5:</span> <span style=" font-family:'Courier New';">5_itertuples_in_for_loop</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">val = [np.NAN]*len(df)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.itertuples():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    val[row.Index] = calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row.A_i_minus_2,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row.A_i_minus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row.A,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row.A_i_plus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row.B,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row.C,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row.D,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = val  # put this column back into the dataframe</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 6:</span> <span style=" font-family:'Courier New';">6_vectorization__with_apply_for_if_statement_corner_case</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def calculate_new_column_b_value(b_value):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # Python ternary operator</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    b_value_new = (6 * b_value) if b_value &gt; 0 else (60 * b_value)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return b_value_new</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># In this particular example, since we have an embedded `if-else` statement</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># for the `B` column, pure vectorization is less intuitive. So, first we'll</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># calculate a new `B` column using</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># **`apply()`**, then we'll use vectorization for the rest.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;B_new&quot;] = df[&quot;B&quot;].apply(calculate_new_column_b_value)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># OR (same thing, but with a lambda function instead)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># df[&quot;B_new&quot;] = df[&quot;B&quot;].apply(lambda x: (6 * x) if x &gt; 0 else (60 * x))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Now we can use vectorization for the rest. &quot;Vectorization&quot; in this case</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># means to simply use the column series variables in equations directly,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># without manually iterating over them. Pandas DataFrames will handle the</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># underlying iteration automatically for you. You just focus on the math.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = (</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    2 * df[&quot;A_i_minus_2&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 3 * df[&quot;A_i_minus_1&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 4 * df[&quot;A&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 5 * df[&quot;A_i_plus_1&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + df[&quot;B_new&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 7 * df[&quot;C&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    - 8 * df[&quot;D&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 7:</span> <span style=" font-family:'Courier New';">7_vectorization__with_list_comprehension_for_if_statment_corner_case</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># In this particular example, since we have an embedded `if-else` statement</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># for the `B` column, pure vectorization is less intuitive. So, first we'll</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># calculate a new `B` column using **list comprehension**, then we'll use</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># vectorization for the rest.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;B_new&quot;] = [</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    calculate_new_column_b_value(b_value) for b_value in df[&quot;B&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Now we can use vectorization for the rest. &quot;Vectorization&quot; in this case</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># means to simply use the column series variables in equations directly,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># without manually iterating over them. Pandas DataFrames will handle the</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># underlying iteration automatically for you. You just focus on the math.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = (</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    2 * df[&quot;A_i_minus_2&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 3 * df[&quot;A_i_minus_1&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 4 * df[&quot;A&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 5 * df[&quot;A_i_plus_1&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + df[&quot;B_new&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 7 * df[&quot;C&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    - 8 * df[&quot;D&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 8:</span> <span style=" font-family:'Courier New';">8_pure_vectorization__with_df.loc[]_boolean_array_indexing_for_if_statment_corner_case</span></li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">При этом используется </span><span style=" font-size:8.25pt; font-weight:600;">логическое индексирование</span><span style=" font-size:8.25pt;"> , также известное как </span><span style=" font-size:8.25pt; font-weight:600;">логическая маска</span><span style=" font-size:8.25pt;"> , для выполнения эквивалента утверждения </span><span style=" font-family:'Courier New'; font-size:8.25pt;">if</span><span style=" font-size:8.25pt;">в уравнении. Таким образом, для всего уравнения можно использовать чистую векторизацию, тем самым максимизируя производительность и скорость.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># If statement to evaluate:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#     if B &gt; 0:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#         B_new = 6 * B</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#     else:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#         B_new = 60 * B</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># In this particular example, since we have an embedded `if-else` statement</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># for the `B` column, we can use some boolean array indexing through</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># `df.loc[]` for some pure vectorization magic.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Explanation:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Long:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># The format is: `df.loc[rows, columns]`, except in this case, the rows are</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># specified by a &quot;boolean array&quot; (AKA: a boolean expression, list of</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># booleans, or &quot;boolean mask&quot;), specifying all rows where `B` is &gt; 0. Then,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># only in that `B` column for those rows, set the value accordingly. After</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># we do this for where `B` is &gt; 0, we do the same thing for where `B`</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># is &lt;= 0, except with the other equation.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Short:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># For all rows where the boolean expression applies, set the column value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># accordingly.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># GitHub CoPilot first showed me this `.loc[]` technique.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># See also the official documentation:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># ===========================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># 1st: handle the &gt; 0 case</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># ===========================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;B_new&quot;] = df.loc[df[&quot;B&quot;] &gt; 0, &quot;B&quot;] * 6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># ===========================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># 2nd: handle the &lt;= 0 case, merging the results into the</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># previously-created &quot;B_new&quot; column</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># ===========================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># - NB: this does NOT work; it overwrites and replaces the whole &quot;B_new&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#   column instead:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#       df[&quot;B_new&quot;] = df.loc[df[&quot;B&quot;] &lt;= 0, &quot;B&quot;] * 60</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># This works:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df.loc[df[&quot;B&quot;] &lt;= 0, &quot;B_new&quot;] = df.loc[df[&quot;B&quot;] &lt;= 0, &quot;B&quot;] * 60</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Now use normal vectorization for the rest.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = (</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    2 * df[&quot;A_i_minus_2&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 3 * df[&quot;A_i_minus_1&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 4 * df[&quot;A&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 5 * df[&quot;A_i_plus_1&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + df[&quot;B_new&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 7 * df[&quot;C&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    - 8 * df[&quot;D&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 9:</span> <span style=" font-family:'Courier New';">9_apply_function_with_lambda</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = df.apply(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    lambda row: calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;A_i_minus_2&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;A_i_minus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;A_i_plus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;B&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;C&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[&quot;D&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    ),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    axis='columns' # same as `axis=1`: &quot;apply function to each row&quot;,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">                   # rather than to each column</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 10:</span> <span style=" font-family:'Courier New';">10_list_comprehension_w_zip_and_direct_variable_assignment_passed_to_func</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = [</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # Note: you *could* do the calculations directly here instead of using a</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # function call, so long as you don't have indented code blocks such as</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # sub-routines or multi-line if statements.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    #</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # I'm using a function call.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_minus_2,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_minus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_plus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        B,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        C,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    ) for A_i_minus_2, A_i_minus_1, A, A_i_plus_1, B, C, D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    in zip(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_minus_2&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_minus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_plus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;B&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;C&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;D&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 11:</span> <span style=" font-family:'Courier New';">11_list_comprehension_w_zip_and_direct_variable_assignment_calculated_in_place</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = [</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    2 * A_i_minus_2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 3 * A_i_minus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 4 * A</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 5 * A_i_plus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # Python ternary operator; don't forget parentheses around the entire</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # ternary expression!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + ((6 * B) if B &gt; 0 else (60 * B))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    + 7 * C</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    - 8 * D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    for A_i_minus_2, A_i_minus_1, A, A_i_plus_1, B, C, D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    in zip(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_minus_2&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_minus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_plus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;B&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;C&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;D&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 12:</span> <span style=" font-family:'Courier New';">12_list_comprehension_w_zip_and_row_tuple_passed_to_func</span></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = [</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[0],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[1],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[2],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[3],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[4],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[5],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        row[6],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    ) for row</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    in zip(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_minus_2&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_minus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;A_i_plus_1&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;B&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;C&quot;],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df[&quot;D&quot;]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Техника 13:</span> <span style=" font-family:'Courier New';">13_list_comprehension_w__to_numpy__and_direct_variable_assignment_passed_to_func</span></li></ol>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df[&quot;val&quot;] = [</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # Note: you *could* do the calculations directly here instead of using a</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # function call, so long as you don't have indented code blocks such as</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # sub-routines or multi-line if statements.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    #</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # I'm using a function call.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    calculate_val(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_minus_2,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_minus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        A_i_plus_1,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        B,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        C,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    ) for A_i_minus_2, A_i_minus_1, A, A_i_plus_1, B, C, D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # Note: this `[[...]]` double-bracket indexing is used to select a</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # subset of columns from the dataframe. The inner `[]` brackets</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # create a list from the column names within them, and the outer</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # `[]` brackets accept this list to index into the dataframe and</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # select just this list of columns, in that order.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # - See the official documentation on it here:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        #   https://pandas.pydata.org/docs/user_guide/indexing.html#basics</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        #   - Search for the phrase &quot;You can pass a list of columns to [] to</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        #     select columns in that order.&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        #   - I learned this from this comment here:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        #     https://stackoverflow.com/questions/16476924/how-to-iterate-over-rows-in-a-dataframe-in-pandas/55557758#comment136020567_55557758</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # - One of the **list comprehension** examples in this answer here</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        #   uses `.to_numpy()` like this:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        #   https://stackoverflow.com/a/55557758/4561887</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    in df[[</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        &quot;A_i_minus_2&quot;,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        &quot;A_i_minus_1&quot;,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        &quot;A&quot;,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        &quot;A_i_plus_1&quot;,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        &quot;B&quot;,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        &quot;C&quot;,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        &quot;D&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    ]].to_numpy()  # NB: `.values` works here too, but is deprecated. See:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">                   # https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.values.html</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вот еще раз результаты:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814rvx6i82qpr.png" /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">for</span><span style=" font-size:8.25pt; font-weight:600;">Также используя предварительно сдвинутые ряды в технике 4- х петель.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я хотел посмотреть, даст ли удаление этой </span><span style=" font-family:'Courier New'; font-size:8.25pt;">if</span><span style=" font-size:8.25pt;">проверки и использование предварительно сдвинутых строк в </span><span style=" font-family:'Courier New'; font-size:8.25pt;">for</span><span style=" font-size:8.25pt;">методах с четырьмя циклами большой эффект:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">if i &lt; 2 or i &gt; len(df)-2:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    continue</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">...поэтому я создал этот файл со следующими изменениями: </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world/blob/master/python/pandas_dataframe_iteration_vs_vectorization_vs_list_comprehension_speed_tests_mod.py"><span style=" font-family:'Courier New'; font-size:8.25pt; text-decoration: underline; color:#0000ff;">pandas_dataframe_iteration_vs_vectorization_vs_list_comprehension_speed_tests_mod.py</span></a><span style=" font-size:8.25pt;">. Найдите в файле «MOD:», чтобы найти 4 новых модифицированных метода.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Было лишь небольшое улучшение. Вот результаты применения этих 17 техник, причём 4 новых имеют слово </span><span style=" font-family:'Courier New'; font-size:8.25pt;">_MOD_</span><span style=" font-size:8.25pt;">в начале названия, сразу после номера. На этот раз это более 500 тысяч строк, а не 2 миллиона:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118140m1m2pwer6.png" /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Еще</span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">.iterrtuples()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">На самом деле нюансов при использовании больше </span><span style=" font-family:'Courier New'; font-size:8.25pt;">.itertuples()</span><span style=" font-size:8.25pt;">. Чтобы углубиться в некоторые из них, прочитайте </span><a href="https://stackoverflow.com/a/59413206/4561887"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">этот ответ @Romain Capron</span></a><span style=" font-size:8.25pt;"> . Вот гистограмма, которую я построил на основе его результатов:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118149x1fj2rzsk.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Мой код построения графиков его результатов находится </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world/blob/master/python/pandas_plot_bar_chart_better_GREAT_AUTOLABEL_DATA.py"><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">python/pandas_plot_bar_chart_better_GREAT_AUTOLABEL_DATA.py</span></a><span style=" font-size:8.25pt;">в моем репозитории </span><a href="https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">eRCaGuy_hello_world</span></a><span style=" font-size:8.25pt;"> .</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Будущая работа</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Использование Cython (Python, скомпилированный в код C) или просто необработанные функции C, вызываемые Python, потенциально может быть быстрее, но я не собираюсь делать это для этих тестов. Я бы рассматривал и тестировал эти варианты только для большой оптимизации.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В настоящее время я не знаю Cython и не чувствую необходимости его изучать. Как вы можете видеть выше, простое правильное использование чистой векторизации уже работает невероятно быстро, обрабатывая 2 </span><span style=" font-size:8.25pt; font-style:italic;">миллиона</span><span style=" font-size:8.25pt;"> строк всего за 0,1 секунды, или 20 миллионов строк в секунду.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Рекомендации</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Куча официальной документации Pandas, особенно <span style=" font-family:'Courier New';">DataFrame</span>документация здесь: <a href="https://pandas.pydata.org/pandas-docs/stable/reference/frame.html"><span style=" text-decoration: underline; color:#0000ff;">https://pandas.pydata.org/pandas-docs/stable/reference/frame.html</span></a> .</li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/55557758/4561887"><span style=" text-decoration: underline; color:#0000ff;">Этот отличный ответ от @cs95</span></a> — именно здесь я, в частности, научился использовать понимание списка для перебора DataFrame.</li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/59413206/4561887"><span style=" text-decoration: underline; color:#0000ff;">Этот ответ </span></a><a href="https://stackoverflow.com/a/59413206/4561887"><span style=" font-family:'Courier New'; text-decoration: underline; color:#0000ff;">itertuples()</span></a><a href="https://stackoverflow.com/a/59413206/4561887"><span style=" text-decoration: underline; color:#0000ff;">@Romain Capron</span></a> о , я внимательно изучил его и отредактировал/отформатировал.</li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Все это мой собственный код, но я хочу отметить, что у меня были десятки чатов с GitHub Copilot (в основном), Bing AI и ChatGPT, чтобы разобраться во многих из этих методов и отладить свой код по ходу работы.</li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Bing Chat выдал мне красивое уравнение LaTeX со следующей подсказкой. Конечно, я проверил вывод:</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Преобразуйте этот код Python в красивое уравнение, которое я могу вставить в Stack Overflow:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    val = (</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        2 * A_i_minus_2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 3 * A_i_minus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 4 * A</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 5 * A_i_plus_1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        # Python ternary operator; don't forget parentheses around the entire ternary expression!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + ((6 * B) if B &gt; 0 else (60 * B))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        + 7 * C</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        - 8 * D</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Смотрите также</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Этот ответ также размещен на моем личном сайте здесь: <a href="https://gabrielstaples.com/python_iterate_over_pandas_dataframe/"><span style=" text-decoration: underline; color:#0000ff;">https://gabrielstaples.com/python_iterate_over_pandas_dataframe/</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://en.wikipedia.org/wiki/Array_programming"><span style=" text-decoration: underline; color:#0000ff;">https://en.wikipedia.org/wiki/Array_programming</span></a> — программирование массивов, или «векторизация»:</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">В информатике программирование массивов относится к решениям, которые позволяют применять операции ко всему набору значений одновременно. Такие решения обычно используются в научных и инженерных целях.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">Современные языки программирования, поддерживающие программирование массивов (также известные как векторные или многомерные языки), были разработаны специально для обобщения операций над скалярами для прозрачного применения к векторам, матрицам и многомерным массивам. К ним относятся APL, J, Fortran, MATLAB, Analytica, Octave, R, Cilk Plus, Julia, Perl Data Language (PDL). В этих языках операцию, которая работает с целыми массивами, можно назвать векторизованной операцией </span><a href="https://i.sstatic.net/5biMy.png"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">1</span></a><span style=" font-size:8.25pt;"> независимо от того, выполняется ли она на векторном процессоре, реализующем векторные инструкции.</span></p>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/q/54028199/4561887"><span style=" text-decoration: underline; color:#0000ff;">Действительно ли циклы for в пандах плохи? Когда мне следует беспокоиться?</span></a></li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/77270403/4561887"><span style=" text-decoration: underline; color:#0000ff;">мой ответ</span></a></li></ol>
<li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/q/24870953/4561887"><span style=" text-decoration: underline; color:#0000ff;">Есть ли у pandas iterrows проблемы с производительностью?</span></a></li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/24871316/4561887"><span style=" text-decoration: underline; color:#0000ff;">Этот ответ</span></a></li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/24870953/does-pandas-iterrows-have-performance-issues#comment136223122_24871316"><span style=" text-decoration: underline; color:#0000ff;">Мой комментарий под ним</span></a> :</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:3; text-indent:0px;"><span style=" font-size:8.25pt;">...Основываясь на моих результатах, я бы сказал, что это лучшие подходы в следующем порядке: лучшие в первую очередь:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 4;"><li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">векторизация,</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">понимание списка,</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">.itertuples()</span>,</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">.apply()</span>,</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">необработанный <span style=" font-family:'Courier New';">for</span>цикл,</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">.iterrows().</span></li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:3; text-indent:0px;"><span style=" font-size:8.25pt;">Я не тестировал Cython.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/77270285"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/77270285/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-77270285"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/77270285/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 13 мар в 7:23</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 11 окт. 2023 в 4:54</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814eible07xkd.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4561887/gabriel-staples"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Габриэль Стейплс</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">46,2 тыс.2121 золотой значок242242 серебряных знака324324 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-77270285"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-51069586"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Иногда полезным шаблоном является:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># Borrowing @KutalmisB df example</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'col1': [1, 2], 'col2': [0.1, 0.2]}, index=['a', 'b'])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># The to_dict call results in a list of dicts</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"># where each row_dict is a dictionary with k:v pairs of columns:value for that row</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row_dict in df.to_dict(orient='records'):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row_dict)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Что приводит к:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">{'col1':1.0, 'col2':0.1}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">{'col1':2.0, 'col2':0.2}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/51069586"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/51069586/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-51069586"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/51069586/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">изменено 13 апр. 2019 в 23:06</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814o1fbz2lc3n.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4909087/cs95"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">cs95</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">395 тыс.102102 золотых значка727727 серебряных знаков779779 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 27 июн 2018 в 18:48</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814c3hcovrup4.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/6951902/zach"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Зак</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">114388 серебряных значков1111 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-51069586"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-60836700"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Обновление</span><span style=" font-size:8.25pt;"> : cs95 обновил </span><a href="https://stackoverflow.com/questions/16476924/how-to-iterate-over-rows-in-a-dataframe-in-pandas/55557758#55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">свой ответ</span></a><span style=" font-size:8.25pt;"> , включив в него простую векторизацию numpy. Вы можете просто сослаться на его ответ.</span></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/16476924/how-to-iterate-over-rows-in-a-dataframe-in-pandas/55557758#55557758"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">cs95 показывает</span></a><span style=" font-size:8.25pt;"> , что векторизация Pandas намного превосходит другие методы Pandas для вычислений с использованием кадров данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я хотел добавить, что если вы сначала преобразуете фрейм данных в массив NumPy, а затем используете векторизацию, это будет даже быстрее, чем векторизация фрейма данных Pandas (включая время, чтобы превратить его обратно в серию фреймов данных).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если вы добавите следующие функции в тестовый код cs95, это станет совершенно очевидным:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def np_vectorization(df):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    np_arr = df.to_numpy()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return pd.Series(np_arr[:,0] + np_arr[:,1], index=df.index)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def just_np_vectorization(df):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    np_arr = df.to_numpy()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return np_arr[:,0] + np_arr[:,1]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118147oazwg6eeq.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/60836700"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/60836700/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-60836700"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/60836700/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 27 авг. 2021 в 5:47</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответил 24 марта 2020 в 17:57</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814nmddx5kyfc.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/10801098/bug-spray"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">спрей от жуков</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">148822 золотых значка1010 серебряных значков2323 бронзовых знака</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-60836700"></a>2</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a href="https://gist.github.com/Coldsp33d/948f96b384ca5bdf6e8ce203ac97c9a0/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">код тестирования cs95, для справки</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/10801098/bug-spray"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">спрей от жуков</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment121960481_60836700"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">1 сен 2021 в 2:40</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-60836700"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-49984074"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Чтобы зациклить все строки в a </span><span style=" font-family:'Courier New'; font-size:8.25pt;">dataframe</span><span style=" font-size:8.25pt;">и </span><span style=" font-size:8.25pt; font-weight:600;">удобно использовать</span><span style=" font-size:8.25pt;"> значения каждой строки , их можно преобразовать в s. Например:</span><span style=" font-family:'Courier New'; font-size:8.25pt;">namedtuplesndarray</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'col1': [1, 2], 'col2': [0.1, 0.2]}, index=['a', 'b'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Перебирая строки:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.itertuples(index=False, name='Pandas'):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print np.asarray(row)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">приводит к:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">[ 1.   0.1]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">[ 2.   0.2]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Обратите внимание, что если </span><span style=" font-family:'Courier New'; font-size:8.25pt;">index=True</span><span style=" font-size:8.25pt;">, </span><span style=" font-size:8.25pt; font-weight:600;">то индекс добавляется как первый элемент кортежа</span><span style=" font-size:8.25pt;"> , что может быть нежелательно для некоторых приложений.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/49984074"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/49984074/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-49984074"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/49984074/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 24 апр. 2018 в 8:48</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 23 апр 2018 в 14:53</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814eud4ivn2zr.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/3393574/herpes-free-engineer"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Свободный инженер по герпесу</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">256533 золотых значка2828 серебряных знаков3737 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-49984074"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-58436037"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Существует способ перебирать строки, получая взамен DataFrame, а не Series. Я не вижу, чтобы кто-нибудь упоминал, что вы можете передать индекс в виде списка для строки, которая будет возвращена как DataFrame:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in range(len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    row = df.iloc[[i]]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Обратите внимание на использование двойных скобок. Это возвращает DataFrame с одной строкой.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/58436037"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/58436037/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-58436037"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 17 окт. 2019 в 15:26</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118145lm5fjk4nm.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/1871385/zeitgeist"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Дух времени</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">146222 золотых значка1818 серебряных знаков2727 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-58436037"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-62136475"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Суммируя</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если возможно, используйте векторизацию.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если операцию невозможно векторизовать — используйте понимание списков.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вам нужен один объект, представляющий всю строку, используйте itertuples.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вышеописанное работает слишком медленно – попробуйте <span style=" font-style:italic;">Swifter.apply</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если это все еще слишком медленно, попробуйте программу <a href="https://en.wikipedia.org/wiki/Cython"><span style=" text-decoration: underline; color:#0000ff;">Cython .</span></a></li></ul>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Контрольный показатель</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image171801181429wkqndput.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/62136475"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/62136475/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-62136475"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/62136475/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 21 апр 2021 в 16:42</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответил 1 июн 2020 в 16:22</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814ntcsw6y9h2.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/2131864/artoby"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Артоби</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">18421717 серебряных знаков1313 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="comments-62136475"></a><span style=" font-size:8.25pt;">C</span><span style=" font-size:8.25pt;">ython, конечно, поможет, но numpy/numba, вероятно, более доступен для большинства людей. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-size:8.25pt;">– </span><a href="https://stackoverflow.com/users/3877338/johne"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">ДжонЭ</span></a><span style=" font-size:8.25pt;"> </span><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#comment132511413_62136475"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">11 янв. 2023 в 23:14</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-62136475"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-75516239"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Я рекомендую использовать </span><span style=" font-family:'Courier New'; font-size:8.25pt;">df.at[row, column]</span><span style=" font-size:8.25pt;">( </span><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.at.html"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">source</span></a><span style=" font-size:8.25pt;"> ) для перебора всех ячеек pandas.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Например:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in range(len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  print(df.at[row, 'c1'], df.at[row, 'c2'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Результатом будет:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">10 100</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">11 110</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">12 120</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Бонус</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы также можете изменить значение ячеек с помощью </span><span style=" font-family:'Courier New'; font-size:8.25pt;">df.at[row, column] = newValue</span><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in range(len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  df.at[row, 'c1'] = 'data-' + str(df.at[row, 'c1'])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  print(df.at[row, 'c1'], df.at[row, 'c2']) </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Результатом будет:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">data-10 100</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">data-11 110</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">data-12 120</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/75516239"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/75516239/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-75516239"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/75516239/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 13 мар в 7:25</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 21 фев 2023 в 4:13</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118147hgs2zhrp2.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/12715723/jordy"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Джорди</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">182222 золотых значка99 серебряных значков3232 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-75516239"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-65396738"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Иногда циклы действительно лучше, чем векторизованный код</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Как правильно указывают многие ответы здесь, ваш план по умолчанию в Pandas должен заключаться в написании векторизованного кода (с его неявными циклами), а не в попытке создать явный цикл самостоятельно. Но остается вопрос, следует ли вам </span><span style=" font-size:8.25pt; font-style:italic;">когда-либо</span><span style=" font-size:8.25pt;"> писать циклы в Pandas, и если да, то как лучше всего использовать циклы в таких ситуациях.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Я считаю, что существует по крайней мере одна общая ситуация, когда циклы уместны: когда вам нужно вычислить некоторую функцию, которая зависит от значений в </span><span style=" font-size:8.25pt; font-weight:600; font-style:italic;">других</span><span style=" font-size:8.25pt; font-weight:600;"> строках довольно сложным образом. В этом случае код цикла зачастую проще, читабельнее и менее подвержен ошибкам, чем векторизованный код.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Код с циклами может быть даже быстрее</span><span style=" font-size:8.25pt;"> , как вы увидите ниже, поэтому циклы могут иметь смысл в тех случаях, когда скорость имеет первостепенное значение. Но на самом деле это всего лишь подмножество случаев, когда вам, вероятно, следовало бы с самого начала работать в numpy/numba (а не в Pandas), потому что оптимизированный numpy/numba почти всегда будет быстрее, чем Pandas.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Покажем это на примере. Предположим, вы хотите получить совокупную сумму столбца, но сбрасывать ее всякий раз, когда какой-либо другой столбец равен нулю:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">import pandas as pd</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">import numpy as np</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame( { 'x':[1,2,3,4,5,6], 'y':[1,1,1,0,1,1]  } )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#   x  y  desired_result</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#0  1  1               1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#1  2  1               3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#2  3  1               6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#3  4  0               4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#4  5  1               9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#5  6  1              15</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Это хороший пример, когда вы, безусловно, можете написать одну строку Pandas для достижения этой цели, хотя она не особенно читабельна, особенно если вы еще не имеете достаточного опыта работы с Pandas:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df.groupby( (df.y==0).cumsum() )['x'].cumsum()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Этого будет достаточно быстро для большинства ситуаций, хотя вы также можете написать более быстрый код, избегая </span><span style=" font-family:'Courier New'; font-size:8.25pt;">groupby</span><span style=" font-size:8.25pt;">, но, скорее всего, он будет еще менее читабельным.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Альтернативно, что, если мы напишем это как цикл? С NumPy вы можете сделать что-то вроде следующего:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">import numba as nb</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">@nb.jit(nopython=True)  # Optional</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def custom_sum(x,y):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    x_sum = x.copy()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    for i in range(1,len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        if y[i] &gt; 0: x_sum[i] = x_sum[i-1] + x[i]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    return x_sum</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df['desired_result'] = custom_sum( df.x.to_numpy(), df.y.to_numpy() )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Следует признать, что для преобразования столбцов DataFrame в массивы NumPy требуются некоторые накладные расходы, но основной фрагмент кода — это всего лишь одна строка кода, которую вы можете прочитать, даже если ничего не знаете о Pandas или NumPy:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">if y[i] &gt; 0: x_sum[i] = x_sum[i-1] + x[i]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">И этот код на самом деле </span><span style=" font-size:8.25pt; font-style:italic;">быстрее</span><span style=" font-size:8.25pt;"> , чем векторизованный код. В некоторых быстрых тестах со 100 000 строк описанный выше подход примерно в 10 раз быстрее, чем подход </span><span style=" font-size:8.25pt; font-style:italic;">с группировкой</span><span style=" font-size:8.25pt;"> . Обратите внимание, что одной из клавиш скорости является цифра, которая не является обязательной. Без строки «@nb.jit» код цикла фактически примерно в 10 раз медленнее, чем подход </span><span style=" font-size:8.25pt; font-style:italic;">с группировкой</span><span style=" font-size:8.25pt;"> .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Очевидно, что этот пример достаточно прост, и вы, вероятно, предпочтете одну строку pandas написанию цикла с соответствующими накладными расходами. Однако существуют более сложные версии этой проблемы, для которых, вероятно, имеет смысл читаемость или скорость подхода NumPy/numba-цикла.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/65396738"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/65396738/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-65396738"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/65396738/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 12 дек. 2022 в 16:54</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 21 дек 2020 в 16:48</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118142r1s1gfmj8.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/3877338/johne"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">ДжонЭ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">30,1 тыс.99 золотых значков8080 серебряных знаков111111 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-65396738"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-54896256"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Как для просмотра, так и для изменения значений я бы использовал </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows()</span><span style=" font-size:8.25pt;">. В цикле for и с помощью распаковки кортежа (см. пример: </span><span style=" font-family:'Courier New'; font-size:8.25pt;">i, row</span><span style=" font-size:8.25pt;">) я использую </span><span style=" font-family:'Courier New'; font-size:8.25pt;">row</span><span style=" font-size:8.25pt;">только для просмотра значения и использую его </span><span style=" font-family:'Courier New'; font-size:8.25pt;">i</span><span style=" font-size:8.25pt;">с </span><span style=" font-family:'Courier New'; font-size:8.25pt;">loc</span><span style=" font-size:8.25pt;">методом, когда хочу изменить значения. Как говорилось в предыдущих ответах, здесь вам не следует изменять то, что вы повторяете.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i, row in df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    df_column_A = df.loc[i, 'A']</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    if df_column_A == 'Old_Value':</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        df_column_A = 'New_value'  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Здесь </span><span style=" font-family:'Courier New'; font-size:8.25pt;">row</span><span style=" font-size:8.25pt;">в цикле находится копия этой строки, а не ее представление. Поэтому НЕ следует писать что-то вроде </span><span style=" font-family:'Courier New'; font-size:8.25pt;">row['A'] = 'New_Value'</span><span style=" font-size:8.25pt;">, это не изменит DataFrame. Однако вы можете использовать </span><span style=" font-family:'Courier New'; font-size:8.25pt;">i</span><span style=" font-size:8.25pt;">и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">loc</span><span style=" font-size:8.25pt;">указать DataFrame для выполнения этой работы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/54896256"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/54896256/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-54896256"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/54896256/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 28 фев 2020 в 17:51</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 27 фев 2019 в 0:29</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814ih1xgz9ryy.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/10951905/hossein-kalbasi"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Хоссейн Калбаси</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">176122 золотых значка1515 серебряных значков2626 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-54896256"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-54264778"></a><span style=" font-size:8.25pt;">1</span><span style=" font-size:8.25pt;">0</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Существует очень много способов перебора строк в кадре данных Pandas. Один очень простой и интуитивно понятный способ:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'A':[1, 2, 3], 'B':[4, 5, 6], 'C':[7, 8, 9]})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">print(df)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in range(df.shape[0]):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # For printing the second column</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(df.iloc[i, 1])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # For printing more than one columns</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(df.iloc[i, [0, 2]])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/54264778"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/54264778/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-54264778"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/54264778/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 11 июн 2020 в 13:38</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 19 янв. 2019 в 6:53</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814vjwypdful9.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/8244390/shubham-ranjan"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Шубхам Ранджан</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">49744 серебряных значка99 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-54264778"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-64653674"></a><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Самый простой способ — использовать </span><span style=" font-family:'Courier New'; font-size:8.25pt;">apply</span><span style=" font-size:8.25pt;">функцию</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">def print_row(row):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">   print row['c1'], row['c2']</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df.apply(lambda row: print_row(row), axis=1)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/64653674"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/64653674/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-64653674"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 2 ноя 2020 в 21:35</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image171801181491kc6hup1s.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/12566550/fran%c3%a7ois-b"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Франсуа Б.</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">114499 серебряных значков2020 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-64653674"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-68562557"></a><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вероятно, самое элегантное решение (но, конечно, не самое эффективное):</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.values:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    c2 = row[1]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # ...</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for c1, c2 in df.values:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    # ...</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Обратите внимание, что:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.values.html"><span style=" text-decoration: underline; color:#0000ff;">документация</span></a> явно рекомендует использовать <span style=" font-family:'Courier New';">.to_numpy()</span>вместо этого</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">созданный массив NumPy будет иметь тип dtype, который соответствует всем столбцам, в худшем случае<span style=" font-family:'Courier New';">object</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">есть <a href="https://stackoverflow.com/a/55557758/4248897"><span style=" text-decoration: underline; color:#0000ff;">веские причины</span></a> вообще не использовать цикл</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Тем не менее, я считаю, что этот вариант сюда следует включить, как простое решение (надо подумать) тривиальной проблемы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/68562557"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/68562557/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-68562557"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/68562557/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 4 сен 2022 в 23:08</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 28 июля 2021 в 14:47</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814oeb9pd15yq.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4248897/ernesto-els%c3%a4%c3%9fer"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Эрнесто Эльсэссер</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11171212 серебряных значков1212 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-68562557"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-47598852"></a><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы также можете выполнить индексацию NumPy для еще большего ускорения. На самом деле это не итерация, но для некоторых приложений работает намного лучше, чем итерация.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">subset = row['c1'][0:5]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">all = row['c1'][:]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы также можете преобразовать его в массив. Предполагается, что эти индексы/выборы уже действуют как массивы NumPy, но я столкнулся с проблемами, и мне нужно было выполнить приведение</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">np.asarray(all)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">imgs[:] = cv2.resize(imgs[:], (224,224) ) # Resize every image in an hdf5 file</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/47598852"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/47598852/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-47598852"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/47598852/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 11 июн 2020 в 13:37</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответил 1 дек 2017 в 17:49</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814wekeowmsuy.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/4180797/james-l"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Джеймс Л.</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">13,9 тыс.55 золотых значков5252 серебряных значка6262 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-47598852"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-75989939"></a><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">1. Повторите </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">df.index</span><span style=" font-size:8.25pt; font-weight:600;">и получите доступ через</span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">at[]</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вполне читаемый метод — перебор индекса (как предложено </span><a href="https://stackoverflow.com/a/47073107/19123103"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">@Grag2015</span></a><span style=" font-size:8.25pt;"> ). Однако вместо используемой там цепной индексации используйте </span><span style=" font-family:'Courier New'; font-size:8.25pt;">at</span><span style=" font-size:8.25pt;">для эффективности:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for ind in df.index:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(df.at[ind, 'col A'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Преимущество этого метода </span><span style=" font-family:'Courier New'; font-size:8.25pt;">for i in range(len(df))</span><span style=" font-size:8.25pt;">в том, что он работает, даже если индекс не равен </span><span style=" font-family:'Courier New'; font-size:8.25pt;">RangeIndex</span><span style=" font-size:8.25pt;">. См. следующий пример:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'col A': list('ABCDE'), 'col B': range(5)}, index=list('abcde'))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for ind in df.index:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(df.at[ind, 'col A'], df.at[ind, 'col B'])    # &lt;---- OK</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    df.at[ind, 'col C'] = df.at[ind, 'col B'] * 2      # &lt;---- can assign values</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for ind in range(len(df)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(df.at[ind, 'col A'], df.at[ind, 'col B'])    # &lt;---- KeyError</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если требуется целочисленное расположение строки (например, для получения значений предыдущей строки), оберните ее </span><span style=" font-family:'Courier New'; font-size:8.25pt;">enumerate()</span><span style=" font-size:8.25pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for i, ind in enumerate(df.index):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    prev_row_ind = df.index[i-1] if i &gt; 0 else df.index[i]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    df.at[ind, 'col C'] = df.at[prev_row_ind, 'col B'] * 2</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">2. Используйте </span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">get_loc</span><span style=" font-size:8.25pt; font-weight:600;">с</span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">itertuples()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Несмотря на то, что он намного быстрее, чем </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows()</span><span style=" font-size:8.25pt;">, его основным недостатком </span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples()</span><span style=" font-size:8.25pt;">является то, что он искажает метки столбцов, если они содержат пробел (например, </span><span style=" font-family:'Courier New'; font-size:8.25pt;">'col C'</span><span style=" font-size:8.25pt;">становится </span><span style=" font-family:'Courier New'; font-size:8.25pt;">_1</span><span style=" font-size:8.25pt;">и т. д.), что затрудняет доступ к значениям в итерации.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вы можете использовать его </span><span style=" font-family:'Courier New'; font-size:8.25pt;">df.columns.get_loc()</span><span style=" font-size:8.25pt;">для получения целочисленного местоположения метки столбца и использовать его для индексации именованных кортежей. Обратите внимание, что первым элементом каждого именованного кортежа является метка индекса, поэтому для правильного доступа к столбцу по целочисленной позиции вам нужно либо добавить 1 к тому, что возвращается, </span><span style=" font-family:'Courier New'; font-size:8.25pt;">get_loc</span><span style=" font-size:8.25pt;">либо распаковать кортеж в начале.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'col A': list('ABCDE'), 'col B': range(5)}, index=list('abcde'))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.itertuples(name=None):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    pos = df.columns.get_loc('col B') + 1              # &lt;---- add 1 here</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row[pos])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for ind, *row in df.itertuples(name=None):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#   ^^^^^^^^^    &lt;---- unpacked here</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    pos = df.columns.get_loc('col B')                  # &lt;---- already unpacked</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    df.at[ind, 'col C'] = row[pos] * 2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row[pos])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">3. Преобразование в словарь и повторение</span><span style=" font-family:'Courier New'; font-size:8.25pt; font-weight:600;">dict_items</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Другой способ перебрать фрейм данных в цикле — преобразовать его в словарь </span><span style=" font-family:'Courier New'; font-size:8.25pt;">orient='index'</span><span style=" font-size:8.25pt;">и перебрать его </span><span style=" font-family:'Courier New'; font-size:8.25pt;">dict_items</span><span style=" font-size:8.25pt;">или </span><span style=" font-family:'Courier New'; font-size:8.25pt;">dict_values</span><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df = pd.DataFrame({'col A': list('ABCDE'), 'col B': range(5)})</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for row in df.to_dict('index').values():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#                             ^^^^^^^^^         &lt;--- iterate over dict_values</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    print(row['col A'], row['col B'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for index, row in df.to_dict('index').items():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">#                                    ^^^^^^^^   &lt;--- iterate over dict_items</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    df.at[index, 'col A'] = row['col A'] + str(row['col B'])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Это не искажает dtypes, например </span><span style=" font-family:'Courier New'; font-size:8.25pt;">iterrows</span><span style=" font-size:8.25pt;">, не искажает метки столбцов, например, </span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples</span><span style=" font-size:8.25pt;">и не зависит от количества столбцов ( </span><span style=" font-family:'Courier New'; font-size:8.25pt;">zip(df['col A'], df['col B'], ...)</span><span style=" font-size:8.25pt;">это быстро станет громоздким, если столбцов много).</span></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Наконец, как уже упоминалось </span><a href="https://stackoverflow.com/a/55557758/19123103"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">в @cs95</span></a><span style=" font-size:8.25pt;"> , избегайте циклов, насколько это возможно. Особенно если ваши данные числовые, если вы немного покопаетесь, в библиотеке найдется оптимизированный метод для вашей задачи.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Тем не менее, в некоторых случаях итерация более эффективна, чем векторизованные операции. Одной из распространенных таких задач является сохранение кадра данных pandas во вложенный json. По крайней мере, начиная с версии pandas 1.5.3, в этом случае </span><span style=" font-family:'Courier New'; font-size:8.25pt;">itertuples()</span><span style=" font-size:8.25pt;">цикл выполняется намного быстрее, чем любая векторизованная операция, включающая метод.</span><span style=" font-family:'Courier New'; font-size:8.25pt;">groupby.apply</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/75989939"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/75989939/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-75989939"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 11 апр 2023 в 20:34</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814uoir4drdmc.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/19123103/cottontail"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">хвостик</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">18,8 тыс.2222 золотых значка107107 серебряных знаков9494 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-75989939"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-68233908"></a><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">df.iterrows()</span><span style=" font-size:8.25pt;">возвращает </span><span style=" font-family:'Courier New'; font-size:8.25pt;">tuple(a, b)</span><span style=" font-size:8.25pt;">, где </span><span style=" font-family:'Courier New'; font-size:8.25pt;">a</span><span style=" font-size:8.25pt;">находится </span><span style=" font-family:'Courier New'; font-size:8.25pt;">index</span><span style=" font-size:8.25pt;">и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">b</span><span style=" font-size:8.25pt;">является </span><span style=" font-family:'Courier New'; font-size:8.25pt;">row</span><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/68233908"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/68233908/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-68233908"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/68233908/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 31 марта 2022 в 7:36</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814mybxx26c18.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/9534390/pythonic833"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">pythonic833</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">314411 золотой значок1515 серебряных значков2929 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 3 июля 2021 в 6:58</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118144cthlmlcc2.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/13674657/ashvani-jaiswal"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Ашвани Джайсвал</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10022 серебряных значка55 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-68233908"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-55202153"></a><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В этом примере iloc используется для изоляции каждой цифры во фрейме данных.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">import pandas as pd</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> a = [1, 2, 3, 4]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> b = [5, 6, 7, 8]</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> mjr = pd.DataFrame({'a':a, 'b':b})</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> size = mjr.shape</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;"> for i in range(size[0]):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">     for j in range(size[1]):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">         print(mjr.iloc[i, j])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/55202153"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/55202153/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-55202153"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 16 марта 2019 в 22:33</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118145e1xemr3fw.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/8042986/mjr2000"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">мджр2000</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">13055 бронзовых знаков</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-55202153"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answer-71234113"></a><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Отказ от ответственности:</span><span style=" font-size:8.25pt;"> хотя здесь так много ответов, которые рекомендуют </span><span style=" font-size:8.25pt; font-weight:600;">не</span><span style=" font-size:8.25pt;"> использовать итеративный (циклический) подход (и я в основном согласен), я все равно считаю его разумным подходом для следующей ситуации:</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Расширьте фрейм данных данными из API</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Допустим, у вас есть большой фрейм данных, который содержит неполные пользовательские данные. Теперь вам придется расширить эти данные дополнительными столбцами, например, пользователя </span><span style=" font-family:'Courier New'; font-size:8.25pt;">age</span><span style=" font-size:8.25pt;">и </span><span style=" font-family:'Courier New'; font-size:8.25pt;">gender</span><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Оба значения должны быть получены из внутреннего API. Я предполагаю, что API не предоставляет «пакетную» конечную точку (которая могла бы принимать несколько идентификаторов пользователей одновременно). В противном случае вам следует вызывать API только один раз.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Затраты (время ожидания) сетевого запроса намного превосходят итерацию кадра данных. Мы говорим о времени прохождения по сети в сотни миллисекунд по сравнению с пренебрежимо малым выигрышем от использования альтернативных подходов к итерациям.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Один дорогостоящий сетевой запрос для каждой строки</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Поэтому в данном случае я бы предпочёл использовать итеративный подход. Хотя сетевой запрос является дорогостоящим, он гарантированно запускается только один раз для каждой строки в кадре данных. Вот пример использования </span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iterrows.html#pandas-dataframe-iterrows"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">DataFrame.iterrows</span></a><span style=" font-size:8.25pt;"> :</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Пример</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">for index, row in users_df.iterrows():</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  user_id = row['user_id']</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  # Trigger expensive network request once for each row</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  response_dict = backend_api.get(f'/api/user-data/{user_id}')</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  # Extend dataframe with multiple data from response</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  users_df.at[index, 'age'] = response_dict.get('age')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">  users_df.at[index, 'gender'] = response_dict.get('gender')</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/a/71234113"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Делиться</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/71234113/edit"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Улучшите этот ответ</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="btnFollowPost-71234113"></a><span style=" font-size:8.25pt;">С</span><span style=" font-size:8.25pt;">ледовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/posts/71234113/revisions"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">отредактировано 4 сен 2022 в 23:04</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1718011814l4tnd1njgp.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/63550/peter-mortensen"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Питер Мортенсен</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ответ дан 23 фев 2022 в 9:10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17180118141ncw63rghu.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/users/2472398/gru"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">грю</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">276977 золотых значков2626 серебряных знаков4343 бронзовых знака</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="comments-link-71234113"></a><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=1&amp;tab=scoredesc#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">обавить комментарий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/16476924/how-can-i-iterate-over-rows-in-a-pandas-dataframe?page=2&amp;tab=scoredesc#tab-top"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">2Следующий</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/help/privileges/protect-questions"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">Очень активный вопрос</span></a><span style=" font-size:8.25pt;"> . Заработайте 10 репутации (не считая</span><a href="https://meta.stackexchange.com/questions/141648/what-is-the-association-bonus-and-how-does-it-work"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;"> бонуса ассоциации</span></a><span style=" font-size:8.25pt;"> ), чтобы ответить на этот вопрос. Требование к репутации помогает защитить этот вопрос от спама и отсутствия ответа.</span></p>
<p style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Не тот ответ, который вы ищете? Просмотреть другие вопросы с тегами</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt; font-weight:600;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/tagged/python"><span style=" font-size:x-large; text-decoration: underline; color:#0000ff;">питон</span></a></li>
<li style=" font-size:8.25pt; font-weight:600;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/tagged/pandas"><span style=" font-size:x-large; text-decoration: underline; color:#0000ff;">панды</span></a></li>
<li style=" font-size:8.25pt; font-weight:600;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/tagged/dataframe"><span style=" font-size:x-large; text-decoration: underline; color:#0000ff;">фрейм данных</span></a></li>
<li style=" font-size:8.25pt; font-weight:600;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://stackoverflow.com/questions/tagged/loops"><span style=" font-size:x-large; text-decoration: underline; color:#0000ff;">петли</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">или </span><a href="https://stackoverflow.com/questions/ask"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">задайте свой вопрос</span></a><span style=" font-size:8.25pt; font-weight:600;"> .</span></p></body></html>