<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; font-weight:600;">VBA Excel. Автоподбор высоты объединенной ячейки</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Автоподбор высоты объединенной ячейки с помощью кода VBA Excel, когда метод AutoFit не работает. Обработка ячеек по списку адресов из массива.</span></p>
<p style=" margin-top:32px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-weight:600; color:#333333;">Содержание</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/avtopodbor-vysoty-obyedinennoy-yacheyki/#Avtopodbor_vysoty_acejki"><span style=" text-decoration: underline; color:#0000ff;">1. Автоподбор высоты ячейки</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/avtopodbor-vysoty-obyedinennoy-yacheyki/#Obrabotka_spiska_aceek"><span style=" text-decoration: underline; color:#0000ff;">2. Обработка списка ячеек</span></a></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Avtopodbor_vysoty_acejki"></a><span style=" font-size:x-large; font-weight:600;">А</span><span style=" font-size:x-large; font-weight:600;">втоподбор высоты ячейки</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">К сожалению, в объединенных ячейках метод VBA Excel <span style=" font-weight:600;">AutoFit</span> не работает. Но есть возможность подогнать <a href="https://vremya-ne-zhdet.ru/vba-excel/avtopodbor-shiriny-obyedinennoy-yacheyki/"><span style=" text-decoration: underline; color:#0000ff;">ширину</span></a> или высоту такой ячейки под длину текста с помощью макроса.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Здесь мы рассмотрим макрос для автоподбора высоты ячейки, объединенной с другими по горизонтали в одной строке, которые обычно используются в заголовках электронных таблиц Excel. Для объединенной ячейки должен быть задан перенос текста по словам: <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Формат ячеек &gt;&gt; Выравнивание &gt;&gt; переносить текст</span>.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_1_host"></a>Высота ячейки будет такой, чтобы уместились все строки, на которые будет разбит контент в зависимости от ширины объединенной ячейки.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для решения задачи по автоподбору высоты необходимо с помощью кода VBA определить:</p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" background-color:#c8fbc8;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Длину текста (количество символов) в объединенной ячейке.</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ширину объединенной ячейки. Длина одного символа текста со шрифтом и его размером по умолчанию приблизительно соответствует длине символа, в котором измеряется ширина ячейки.</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Размер шрифта, чтобы рассчитать коэффициент, увеличивающий или уменьшающий высоту ячейки в зависимости от его (шрифта) размера.</li></ol>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_2_host"></a>Макрос VBA Excel для автоподбора высоты ячейки с учетом размера используемого шрифта:</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Verdana,Arial,sans'; font-size:12px; font-weight:496; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-1"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">PodborVysoty</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-2"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">D</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">im</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">myCell </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">Range</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">myLen </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">Integer</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#000000;">_</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-3"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">m</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">yWidth </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">Single</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#000000;">k</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">Single</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#000000;">n</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">Single</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-4"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">With</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#000000;">Selection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-5"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#ff8000;">'Задаем объединенной ячейке перенос текста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-6"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">WrapText</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-7"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#ff8000;">'Задаем объединенной ячейке такую высоту строки,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-8"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#ff8000;">'чтобы умещалась одна строка текста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-9"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">RowHeight</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">ActiveCell</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">Font</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">Size</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> * </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#ce0000;">1.3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-10"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">End</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-11"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">m</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">yLen</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">Len</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">CStr</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">ActiveCell</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-12"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">For</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">Each</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">myCell </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">In</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">Selection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-13"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">       </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">myWidth</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">myWidth</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> + </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">ColumnWidth</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-14"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">   </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-15"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">n</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#ce0000;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-16"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">k</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">ActiveCell</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">Font</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">Size</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> / </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#000000;">n</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-17"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">S</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">election</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">RowHeight</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">Selection</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">RowHeight</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> * </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#000000;">_</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-18"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">W</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">orksheetFunction</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#004ed0;">RoundUp</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">myLen</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> * </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">k</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> / </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#002d7a;">myWidth</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#ce0000;">0</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9cf5303702765-19"></a><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:14pt; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переменные:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" background-color:#e6e6fa;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">myCell</span> — отдельная ячейка в объединенной;</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">myLen</span> — длина текста в активной ячейке;</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">myWidth</span> — ширина объединенной ячейки;</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">k</span> — коэффициент, вносящий поправку в зависимости от размера шрифта;</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">n</span> — размер шрифта по умолчанию.*</li></ul>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">* <span style=" font-style:italic;">Это не точное значение: у меня по умолчанию установлен шрифт </span><span style=" font-weight:600; font-style:italic;">Calibri</span><span style=" font-style:italic;"> размером </span><span style=" font-weight:600; font-style:italic;">11</span><span style=" font-style:italic;">, но точнее код работает с </span><span style=" font-weight:600; font-style:italic;">n = 10</span><span style=" font-style:italic;">. Значение переменной </span><span style=" font-weight:600; font-style:italic;">n</span><span style=" font-style:italic;"> подбирается опытным путем, так как длина текста зависит от процентного соотношения широких и узких символов, если шрифт не моноширинный. Переменной </span><span style=" font-weight:600; font-style:italic;">n</span><span style=" font-style:italic;"> можно присваивать и дробные значения для более точного автоподбора высоты.</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_4_host"></a>Максимальная высота строки — 409,5. Если расчетная высота объединенной ячейки окажется больше, будет сгенерирована ошибка.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Данный код VBA Excel работает с выделенной ячейкой. Вы можете задать список адресов объединенных ячеек и пройтись макросом по каждой из них.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Obrabotka_spiska_aceek"></a><span style=" font-size:x-large; font-weight:600;">О</span><span style=" font-size:x-large; font-weight:600;">бработка списка ячеек</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Укажите список объединенных ячеек в качестве аргументов функции <span style=" font-weight:600;">Array</span>. Для списка используйте адреса только первых ячеек из состава объединенных.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Verdana,Arial,sans'; font-size:12px; font-weight:496; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">9</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-1"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">ObkhodYacheyek1</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-2"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">ObkhodYacheyek</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-3"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">D</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">im</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">()</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Variant</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myElem </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-4"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">m</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">yCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Array</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;A1&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;A3&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;A5&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-5"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">For</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Each</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myElem </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">In</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myCell</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-6"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">       Range</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myElem</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">).</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Select</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-7"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Call</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">PodborVysoty</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-8"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">   </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d0c292273487-9"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переменные:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:30px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">myCell</span> — массив со списком адресов объединенных ячеек;</li>
<li style=" margin-top:10px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">myElem</span> — используется как элемент массива myCell.</li></ul>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Макрос ObkhodYacheyek по адресам из списка обращается к каждой ячейке по очереди, выделяет ее и запускает код автоподбора высоты PodborVysoty.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если выделить диапазон объединенных ячеек по одной, удерживая клавишу Ctrl, то запустить код автоподбора высоты можно с помощью следующего макроса:</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px; font-family:'Verdana,Arial,sans'; font-size:12px; font-weight:496; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_5_host"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">1</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">2</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">3</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">4</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">5</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">6</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">7</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#c8e1fa;"><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#317cc5; background-color:#c8e1fa;">8</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-1"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">ObkhodYacheyek2</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-2"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">D</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">im</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">()</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">String</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myElem </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Variant</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-3"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">m</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">yCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Split</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Selection</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Address</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;,&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-4"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">For</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Each</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myElem </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">In</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myCell</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-5"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">       Range</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myElem</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">).</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Select</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-6"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Call</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">PodborVysoty</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-7"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">   </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-64fa2e02d9d12240018643-8"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Sub</span></p></td></tr></table></body></html>