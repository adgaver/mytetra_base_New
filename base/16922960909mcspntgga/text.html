<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p align="center" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:33pt; color:#222222;">Объединить файлы Excel – Как объединить несколько файлов Excel</span> </p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">Написано </span><a href="https://analystcave.com/author/analystcave/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">Томом (AnalystCave)</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;">  в29 марта 2016 г. в </span><a href="https://analystcave.com/category/ms-office/ms-office-excel/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">экселе</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#999999;"> , </span><a href="https://analystcave.com/category/ms-office/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#363940;">МС офис</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Ваши данные распределены по нескольким файлам Excel? Хотите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">объединить файлы Excel в одну книгу Excel</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> ? Сегодня мы собираемся изучить именно это — как объединить несколько электронных таблиц Excel в одну рабочую книгу. Очевидным инструментом для этой задачи является Visual Basic для приложений, так что давайте сразу приступим.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f2f2f2;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic; color:#444444;">Хотите вместо этого объединить рабочие листы или файлы CSV?:</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f2f2f2;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;"> </span><a href="https://analystcave.com/excel-merging-worksheets-tables/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; text-decoration: underline; color:#008000;">Объединение листов или таблиц Excel</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f2f2f2;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;"> </span><a href="https://analystcave.com/merge-csv-files-or-txt-files-in-a-folder/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic; text-decoration: underline; color:#008000;">Объединение CSV или текстовых файлов</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНИТЬ ФАЙЛЫ EXCEL ВРУЧНУЮ</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#96dcdc;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Откройте рабочую книгу назначения</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Откройте целевую книгу Excel</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> (в нашем примере Destination.xlsx), в которую вы хотите скопировать рабочие листы оставшихся книг (в нашем примере Source.xlsx).</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Дальнейшие шаги необходимо повторить для каждой книги Excel, которую вы хотите скопировать в целевую книгу.</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#96dcdc;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Откройте (каждую) рабочую книгу, которую вы хотите объединить, и скопируйте рабочие листы.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Откройте каждую книгу Excel, которую вы хотите объединить с целевой книгой.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Затем щелкните правой кнопкой мыши каждый рабочий лист, который хотите скопировать, и нажмите </span><span style=" font-family:'Courier New'; color:#323232;">Move or Copy...</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">. В окне </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">«Переместить или скопировать»</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> выберите рабочую книгу назначения (в нашем случае Destination.xlsx). Следующий:</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Если вы хотите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">переместить (вырезать и вставить) рабочий лист</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> — просто нажмите </span><span style=" font-family:'Courier New'; color:#323232;">OK</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">кнопку, чтобы продолжить.</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Если вы хотите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">скопировать (копировать и вставить) рабочий лист</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> – установите </span><span style=" font-family:'Courier New'; color:#323232;">Create a Copy</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">флажок и нажмите </span><span style=" font-family:'Courier New'; color:#323232;">OK</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">кнопку</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"><br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">Повторите шаг 2 для каждой книги, которую вы хотите скопировать</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> в целевую книгу.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНЕНИЕ ФАЙЛОВ EXCEL С ПОМОЩЬЮ VBA</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Предположим, у нас есть несколько файлов, перечисленных в нашем каталоге (в моем примере это File1 и File2.xlsx). Что мы хотим сделать, так это создать новую рабочую книгу Excel и скопировать рабочие листы в эту новую рабочую книгу. Однако я хотел учесть 2 типичных сценария:</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Скопируйте ВСЕ рабочие листы</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Wingdings'; font-size:10pt; color:#444444;">§</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#444444;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Скопируйте только один рабочий лист — с определенным именем</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Приведенный ниже код поддерживает оба этих сценария.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:18pt; font-weight:600; color:#222222;">Объединить код файлов Excel</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://analystcave.com/vba-function-vs-vba-sub-procedures/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">Используйте подпроцедуру</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> MergeExcelFiles ниже, чтобы объединить любое количество книг:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="1294" cellspacing="0" cellpadding="0">
<tr>
<td width="0" style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td width="1249" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> MergeExcelFiles(fileNames() </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> worksheetName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> = vbNullString, </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Optional</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> mergedFileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;merged.xlsx&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Variant</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, wb </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Workbook, ws </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Worksheet, destWb </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Workbook, excelApp </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Application</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> excelApp = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">New</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> Application</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> destWb = excelApp.Workbooks.Add</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Each</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">In</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> wb = excelApp.Workbooks.Open(fileName, </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">ReadOnly</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">True</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">For</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Each</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">In</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> wb.Sheets</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> worksheetName &lt;&gt; vbNullString </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Then</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">               </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">If</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws.Name = worksheetName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Then</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws.Copy After:=destWb.Sheets(destWb.Sheets.Count)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Else</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">               </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws.Copy After:=destWb.Sheets(destWb.Sheets.Count)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">           </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">If</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Next</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> ws</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> wb.Close SaveChanges:=</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Next</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> destWb.SaveAs ThisWorkbook.Path &amp; &quot;\&quot; &amp; mergedFileName</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> destWb.Close SaveChanges:=</span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">False</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> excelApp.Quit</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> destWb = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Nothing</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Set</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> excelApp = </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Nothing</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> MsgBox </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;Merge completed!&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Как использовать описанную выше процедуру? Ниже я создаю простую тестовую процедуру, которая перечисляет файлы Excel в каталоге Workbook и объединяет Workbooks.</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="898" cellspacing="0" cellpadding="0">
<tr>
<td width="0" style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td width="853" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestMerge()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(0 </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">To</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> 1) </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(0) = ThisWorkbook.Path &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;\File1.xlsx&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(1) = ThisWorkbook.Path &amp; </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;\File2.xlsx&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'...</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Merge all worksheets in listed files</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e0e0e0;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> MergeExcelFiles fileNames</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; color:#008200;">'Merge only worksheets named &quot;SomeWs&quot; in listed files and save the merged file as &quot;test.xlsx&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e0e0e0;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> MergeExcelFiles fileNames, </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;SomeWs&quot;</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:10pt; color:#0000ff;">&quot;test.xlsx&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:12pt; color:#000000;"> </span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Довольно просто, верно?</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНИТЬ ФАЙЛЫ EXCEL В КАТАЛОГЕ</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Приведенный выше сценарий работает очень хорошо для ситуаций, когда мы хотим явно перечислить файлы, которые мы хотим объединить в одну книгу Excel. Как насчет того, когда у нас есть тонны файлов? Или, чтобы упростить, </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#444444;">если мы хотим объединить все файлы в ОДНОМ каталоге</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> . Поскольку это также типичный сценарий, я изменил описанную выше процедуру тестирования, чтобы учесть это:</span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="828" cellspacing="0" cellpadding="0">
<tr>
<td width="0" style=" vertical-align:bottom; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td width="783" bgcolor="#ffffff" style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> TestMergeDirectory()</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Dim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames() </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, currIndex </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Long</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, fileName </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;">, directory </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> directory = ThisWorkbook.Path &amp; &quot;\SomeDir\&quot;</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">ReDim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(0 </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">To</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> 0) </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName = Dir(directory)</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(0) = directory &amp; fileName</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Do</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Until</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName = vbNullString</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> currIndex = currIndex + 1</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">ReDim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Preserve</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(0 </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">To</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> currIndex) </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileName = Dir</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">       </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(currIndex) = directory &amp; fileName</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Loop</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">ReDim</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Preserve</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> fileNames(0 </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">To</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> currIndex - 1) </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">As</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">String</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; color:#c7254e;">   </span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> MergeExcelFiles fileNames</span><span style=" vertical-align:bottom;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">End</span><span style=" font-family:'Consolas'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:10pt; font-weight:600; color:#006699;">Sub</span><span style=" vertical-align:bottom;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Что происходит, так это то, что мы используем </span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/vba-dir-function/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">функцию VBA Dir</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> для перебора всех файлов в выбранном каталоге. По мере продвижения мы модифицируем наш </span><a href="https://analystcave.com/vba-vba-array/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">массив VBA</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> , переопределяя его размер и добавляя дополнительные элементы.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://analystcave.com/vba-dead-whats-future-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#2980b9; background-color:#ecf0f1; vertical-align:middle;">См. также </span></a><a href="https://analystcave.com/vba-dead-whats-future-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#008000; background-color:#ecf0f1; vertical-align:middle;">  </span></a><a href="https://analystcave.com/vba-dead-whats-future-vba/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#000000; background-color:#ecf0f1; vertical-align:middle;">VBA мертв? Каково будущее VBA?</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">СКАЧАТЬ КОД</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Хотите скачать приведенный выше код и пример?<br /></span><a href="https://analystcave.com/wp-content/uploads/2016/03/Merge-Excel-files.zip"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">Скачать</span></a> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:22.5pt; font-weight:600; color:#222222; text-transform:uppercase;">ОБЪЕДИНИТЬ ФАЙЛЫ EXCEL В ЦЕЛУЮ СТРУКТУРУ КАТАЛОГОВ</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;">Последний сценарий, который пришел на ум, — это когда у нас есть целая структура каталогов (каталоги внутри других каталогов), содержащая файлы, которые нужно объединить. Поскольку </span><a href="https://analystcave.com/vba-reference-functions/vba-file-functions/vba-dir-function/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">функция VBA Dir</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> работает только для одного каталога и не пересекает какие-либо каталоги внутри, нам потребуется дополнительно изменить приведенный выше код. При необходимости я рекомендую прочитать мой пост о том, </span><a href="https://analystcave.com/vba-dir-function-how-to-traverse-directories/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; text-decoration: underline; color:#008000;">как перемещаться по каталогам с помощью функции VBA Dir</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#444444;"> .</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>