<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Помогите пожалуйста со скриптом VB, который <br />1. перебирает почтовые сообщения (по Subject, имени Excel документа в скрепке) <br />2. найдя нужные параметры читает данные из оперделенной ячейки Excel документа (который в скрепке)<br />3. складывает эти данные в другой документ Excel </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">net_Alex_tut,<br /><br />Разобрался <br />Написал скрипт<br />Все работает :<br />Ищутся непрочтенные письма по теме и типу приложения выбираются аттач и читаются данные<br />после прочтения данных сообщение помечается как прочитанное <br /><br />два но:<br />1) при небольшом количестве непрочтенных сообщений - 6-15 при общем колве в инбох около 300-400 работает норм<br />если же количество непрочтенных 30-60 начинаются глюки- перескакивает через пачку сообщений в результате куски сообщений нерочтенные <br />приходится по нескольку раз запускать чтобы все сообщения перебрались <br />в чем тут дело ?<br />2) для чтения из эксель файла - аттачмента его нужно открыть что занимет время особенно если док эксель большой<br />можно ли без открытия эксель файла из него читать данные ?<br /><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Const</span><span style=" font-family:'Courier New';"> olFolderInbox </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Integer</span><span style=" font-family:'Courier New';"> = 6</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#008000;">'~~&gt; Path for the attachment</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Const</span><span style=" font-family:'Courier New';"> AttachmentPath </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">String</span><span style=" font-family:'Courier New';"> = </span><span style=" font-family:'Courier New'; color:#008080;">&quot;e:\temp\&quot;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#008080;"><br /></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#008080;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span><span style=" font-family:'Courier New';"> DORscan_1()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> oOlAp </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Object</span><span style=" font-family:'Courier New';">, oOlns </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Object</span><span style=" font-family:'Courier New';">, oOlInb </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Object</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> oOlItm </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Object</span><span style=" font-family:'Courier New';">, oOlAtch </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Object</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> wb </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> Workbook</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> i </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    i = 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> value </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> value1 </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> value2 </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> value3 </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> value4 </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> value5 </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> v_date </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#008000;">'~~&gt; New File Name for the attachment</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Dim</span><span style=" font-family:'Courier New';"> NewFileName </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#6f002f;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    NewFileName = AttachmentPath &amp; </span><span style=" font-family:'Courier New'; color:#008080;">&quot;test1.xls&quot;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#008080;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#008000;">'~~&gt; Get Outlook instance</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Set</span><span style=" font-family:'Courier New';"> oOlAp = GetObject(, </span><span style=" font-family:'Courier New'; color:#008080;">&quot;Outlook.application&quot;</span><span style=" font-family:'Courier New';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Set</span><span style=" font-family:'Courier New';"> oOlns = oOlAp.GetNamespace(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;MAPI&quot;</span><span style=" font-family:'Courier New';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Set</span><span style=" font-family:'Courier New';"> oOlInb = oOlns.GetDefaultFolder(olFolderInbox)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#008000;">'~~&gt; Check if there are any actual unread emails</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New';"> oOlInb.Items.Restrict(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;[UnRead] = True&quot;</span><span style=" font-family:'Courier New';">).Count = 0 </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        MsgBox </span><span style=" font-family:'Courier New'; color:#008080;">&quot;NO Unread Email In Inbox&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span><span style=" font-family:'Courier New'; color:#0000ff;">Exit</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#008000;">'~~&gt; Extract the attachment from the 1st unread email</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">For</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Each</span><span style=" font-family:'Courier New';"> oOlItm </span><span style=" font-family:'Courier New'; color:#0000ff;">In</span><span style=" font-family:'Courier New';"> oOlInb.Items.Restrict(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;[UnRead] = True&quot;</span><span style=" font-family:'Courier New';">)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span><span style=" font-family:'Courier New'; color:#008000;">'~~&gt; Check if the email actually has an attachment</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        sSubj = oOlItm.Subject</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New';"> Left(sSubj, 9) = </span><span style=" font-family:'Courier New'; color:#008080;">&quot;WD/CD DOR&quot;</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">            </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New';"> oOlItm.Attachments.Count &lt;&gt; 0 </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                </span><span style=" font-family:'Courier New'; color:#0000ff;">For</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Each</span><span style=" font-family:'Courier New';"> oOlAtch </span><span style=" font-family:'Courier New'; color:#0000ff;">In</span><span style=" font-family:'Courier New';"> oOlItm.Attachments</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                           </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                        </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New';"> Left(Right(oOlAtch.Filename, 5), 4) = </span><span style=" font-family:'Courier New'; color:#008080;">&quot;.xls&quot;</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#8515ea;">And</span><span style=" font-family:'Courier New';"> Left(oOlAtch.Filename, 2) = </span><span style=" font-family:'Courier New'; color:#008080;">&quot;WD&quot;</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span><span style=" font-family:'Courier New'; color:#008000;">'~~&gt; Download the attachment</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            oOlAtch.SaveAsFile NewFileName</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span><span style=" font-family:'Courier New'; color:#0000ff;">Set</span><span style=" font-family:'Courier New';"> wb = Workbooks.Open(NewFileName, UpdateLinks:=0)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            i = i + 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Sheets(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;WDDP-A Daily Highlight&quot;</span><span style=" font-family:'Courier New';">).</span><span style=" font-family:'Courier New'; color:#0000ff;">Select</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            v_date = Range(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;L4&quot;</span><span style=" font-family:'Courier New';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            value = Range(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;E33&quot;</span><span style=" font-family:'Courier New';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            value1 = Range(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;E34&quot;</span><span style=" font-family:'Courier New';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Windows(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;WD DOR.xlsm&quot;</span><span style=" font-family:'Courier New';">).Activate</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Sheets(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;list1&quot;</span><span style=" font-family:'Courier New';">).</span><span style=" font-family:'Courier New'; color:#0000ff;">Select</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Cells(i, 1).value = v_date</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Cells(i, 2).value = value</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Cells(i, 3).value = value1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New';"> i = 30 </span><span style=" font-family:'Courier New'; color:#8515ea;">Or</span><span style=" font-family:'Courier New';"> i = 100 </span><span style=" font-family:'Courier New'; color:#8515ea;">Or</span><span style=" font-family:'Courier New';"> i = 200 </span><span style=" font-family:'Courier New'; color:#8515ea;">Or</span><span style=" font-family:'Courier New';"> i = 300 </span><span style=" font-family:'Courier New'; color:#8515ea;">Or</span><span style=" font-family:'Courier New';"> i = 400 </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                                ActiveWorkbook.Save</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span><span style=" font-family:'Courier New'; color:#0000ff;">Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Application.DisplayAlerts = </span><span style=" font-family:'Courier New'; color:#0000ff;">False</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            Workbooks(</span><span style=" font-family:'Courier New'; color:#008080;">&quot;test1.xls&quot;</span><span style=" font-family:'Courier New';">).Close SaveChanges:=</span><span style=" font-family:'Courier New'; color:#0000ff;">False</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                            </span><span style=" font-family:'Courier New'; color:#0000ff;">Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                           </span><span style=" font-family:'Courier New'; color:#008000;">' MsgBox &quot;attachment is not excel&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                        </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                        </span><span style=" font-family:'Courier New'; color:#008000;">'Exit For</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                 </span><span style=" font-family:'Courier New'; color:#0000ff;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">            </span><span style=" font-family:'Courier New'; color:#0000ff;">Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">                </span><span style=" font-family:'Courier New'; color:#008000;">'MsgBox &quot;The First item doesn't have an attachment&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">            </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span><span style=" font-family:'Courier New'; color:#0000ff;">Else</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        oOlItm.UnRead = </span><span style=" font-family:'Courier New'; color:#0000ff;">False</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span><span style=" font-family:'Courier New'; color:#008000;">'DoEvents</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">        </span><span style=" font-family:'Courier New'; color:#008000;">'oOlItm.Save</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">    </span><span style=" font-family:'Courier New'; color:#0000ff;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">         </span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New';"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Sub</span></pre></body></html>