<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td width="100%">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Способы интеграции MS ACCESS и MS Outlook			                                </span></p></td>
<td width="100%"></td>
<td width="100%"></td></tr></table>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Автор osmor</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p></td></tr>
<tr>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">18.09.2006 г.		</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr>
<tr>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Данной статьей автор не ставит перед собой задачу рассказать о всех возможных способах взаимодействия MS Access и MS Outlook или сравнить между собой несколько способов.<br />   Задача данной статьи помочь начинающим программистам получить начальную информацию о путях интеграции MS Access и  MS Outlook и дать ссылки на справочные материалы. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Вся информация, приведенная в данной статье взята из HELP и с сайта </span><a href="http://msdn.microsoft.com"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">msdn.microsoft.com</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#0000ff;">1. Связывание таблиц</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Самый простой способ это использовать связанные таблицы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Access позволяет прилинковать таблицы MSOutlook. Достаточно просто вызвать контекстное меню на закладке &quot;Таблицы&quot; и в окне выбора файла в качестве типа файлов указать &quot;Outlook&quot;. Далее нужно выбрать какие данные вы ходите прилинковать папку &quot;входящие&quot; , &quot;адресную книгу&quot; или задачи. И вот уже в окне Aсcess появилась связанная таблица с соответствующими данными. Данные в прилинкованных таблицах Outlook доступны только для чтения.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Есть только маленький нюанс, для того что бы это стало возможным, нужно установить Microsoft Office Outlook в качестве почтовой программы по умолчанию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#0000ff;">2. Использование  MS Outlook View Control.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">MS Outlook View Control представляет собой ActiveX который легко встраивается в вашу программу (не обязательно  Access), и предоставляет методы и свойства для работы с Outlook. Это фактически Outlook c миниатюре, внешний вид представления данных ничем не отличается от представления этих данных в Outlook. Минимального программирования достаточно для обеспечения пользователю доступа ко всем основным функциям Outlook. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Как использовать  MS Outlook View Control в своей программе можно посмотреть в моем примере  : </span><a href="http://hiprog.com/index.php?option=com_content&amp;task=view&amp;id=251661547&amp;Itemid=35%27"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://hiprog.com/index.php?option=com_content&amp;task=view&amp;id=251661547&amp;Itemid=35</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">MS Outlook View Control для версий начиная с Outlook2000 доступен для загрузки на сайте MS. И конечно там есть вся необходимая документация по работе с ним. Вот несколько полезных ссылок:<br />   </span><a href="http://support.microsoft.com/kb/281618/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://support.microsoft.com/kb/281618/</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=831F957F-3190-48DA-A099-2BDBC7397623"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=831F957F-3190-48DA-A099-2BDBC7397623</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /> </span><a href="http://support.microsoft.com/kb/q303835/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://support.microsoft.com/kb/q303835/</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /> </span><a href="http://support.microsoft.com/kb/291407/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://support.microsoft.com/kb/291407/</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#0000ff;">3. Использование технологии COM.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Outlook как и другие продукты входящие в состав MSOffice поддерживают технологию COM, т.е. доступ к его объектной модели возможен из других программ. Для работы нужно только одно, знать эту объектную модель.<br /> Информацию о объектах, методах, свойствах и событиях Outlook можно почерпнуть в справочном файле, он обычно расположен в папке с офисом, и называется VBAOLХХ.CHM (где ХХ - версия офиса).<br /> Так же этот файл доступен на сайте MS:<br /></span><a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A1CEAD80-23E2-456F-8618-4DA50CC2C38C&amp;displaylang=en"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;"> http://www.microsoft.com/downloads/details.aspx?FamilyId=A1CEAD80-23E2-456F-8618-4DA50CC2C38C&amp;displaylang=en</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Там же можно найти множество примеров: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://msdn.microsoft.com/office/download/codesample/default.aspx?pull=/library/en-us/dno2k3ta/html/odc_ac_olauto.asp"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Using Automation in Microsoft Office Access 2003 to Work with Microsoft Office Outlook 2003 </span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /> </span><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;161088"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Using Automation to Send a Microsoft Outlook Message</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /> </span><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;161012"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">How to Create a New Contact Item in Outlook with Automation</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /> </span><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;162371"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Using Automation to Add a Task/Reminder to MS Outlook</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /> </span><a href="http://support.microsoft.com/kb/291120/en-us"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">How to automate Outlook 2002 from another program</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Ниже приведены несколько функций демонстрирующих возможности данного способа доступу к данным Outlook:<br />   </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">(Замечание, предполагается что в программе установлена ссылка на MS Outlook)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">   </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="center" width="98%" cellspacing="2" cellpadding="0" bgcolor="#ffffff">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:11pt;"> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Function</span><span style=" font-family:'Courier New'; font-size:11pt;"> ListOLTasks()<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'список задач</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.Application<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.NameSpace<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask As Outlook.MAPIFolder<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemTask As Outlook.TaskItem<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> RecipientTask As Recipient<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем объект Outlook</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App = CreateObject(&quot;Outlook.Application&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем Namespace</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace = OL_App.GetNamespace(&quot;MAPI&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем ссылку на папку задач</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask = OL_NameSpace.GetDefaultFolder(olFolderTasks)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' перебираем все задачи в папке</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemTask  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask.Items<br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;"> With </span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemTask<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">    'для задачи выводим тему, описание, дату начала, срок исполнения, дату выполнения и исполнителей</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Tema: &quot; &amp; .Subject<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Описание: &quot; &amp; .Body<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Начало: &quot; &amp; .StartDate<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Срок: &quot; &amp; .DueDate<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Выполнена: &quot; &amp; .DateCompleted<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Исполнители: &quot; &amp; .Owner<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">       'если коллекция получателей не пустая, то выводим список получателей задачи</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">If</span><span style=" font-family:'Courier New'; font-size:11pt;"> .Recipients.Count &gt; 0 </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Then</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />       </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Адреса получателей: &quot;;<br />           </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> RecipientTask  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:11pt;"> .Recipients<br />              </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> RecipientTask.Address;<br />           </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End  If</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End  With </span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;_______________________________________________&quot;<br />  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End Function</span></p>
<hr />
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:11pt;"><br />  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Function</span><span style=" font-family:'Courier New'; font-size:11pt;"> ListOLContacts()<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'спиcок Контактов</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.Application<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.NameSpace<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderContsct </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.MAPIFolder<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemContact </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.ContactItem<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_Attachment </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.AddressEntry<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем объект Outlook</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App = CreateObject(&quot;Outlook.Application&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем Namespace</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace = OL_App.GetNamespace(&quot;MAPI&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем ссылку на папку &quot;Контакты&quot;</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderContsct = OL_NameSpace.GetDefaultFolder(olFolderContacts)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' перебираем все контакты в папке</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemContact  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderContsct.Items<br />          </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">With </span><span style=" font-family:'Courier New'; font-size:11pt;">  OL_ItemContact<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">    'выводим имя, 3 возможных E-mail, домашний и моблиный телефоны</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Имя: &quot; &amp; .Subject<br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;E-mai №1: &quot; &amp; .Email1Address<br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;E-mai №2: &quot; &amp; .Email2Address<br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;E-mai №3: &quot; &amp; .Email3Address<br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Домашний телефон: &quot; &amp; .HomeTelephoneNumber<br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Мобильный телефон: &quot; &amp; .MobileTelephoneNumber<br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End    With </span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;_______________________________________________&quot;<br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End Function</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Function</span><span style=" font-family:'Courier New'; font-size:11pt;"> ListOLMeeting()<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'список встреч назначенных на следующую неделю</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.Application<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.NameSpace<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderCalendar </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.MAPIFolder<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_CalendarItems </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.Items<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_MeetingItem </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Object<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_Attendee </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Recipient<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем объект Outlook</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App = CreateObject(&quot;Outlook.Application&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем Namespace</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace = OL_App.GetNamespace(&quot;MAPI&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем ссылку на папку календарь</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderCalendar = OL_NameSpace.GetDefaultFolder(olFolderCalendar)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'используя метод Restrict отбираем только те записи</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'у которых свойство start &gt; больше  сегодняшней даты и меньше чем сегодня плюс 7 дней</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' т.е.  те которые назначены на след неделю</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_CalendarItems = OL_FolderCalendar.Items.Restrict(&quot;[start]&gt; '&quot; &amp; Date &amp; &quot;' </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">And</span><span style=" font-family:'Courier New'; font-size:11pt;"> [start] &lt;= '&quot; &amp; Date + 7 &amp; &quot;'&quot;)<br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_MeetingItem In OL_CalendarItems </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' перебираем все отобранне записи</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />          </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">With </span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_MeetingItem<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">    ' если  найденная запись - встреча то выводит информацию о</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">If</span><span style=" font-family:'Courier New'; font-size:11pt;"> .Class = olAppointment </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Then</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Tema: &quot; &amp; .Subject<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Описание: &quot; &amp; .Body<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Начало: &quot; &amp; .Start<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Продолжительность: &quot; &amp; .Duration &amp; &quot; мин.&quot;<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Место встречи: &quot; &amp; .Location<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">     'если коллекция участников получателей не пустая, то выводим список участников</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">If</span><span style=" font-family:'Courier New'; font-size:11pt;"> .Recipients.Count &gt; 0 </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Then</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />       </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Приглашены: &quot;,<br />           </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_Attendee  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:11pt;"> .Recipients<br />                </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_Attendee.Name; &quot;; &quot;;<br />           </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End If</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End If</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End  With </span><span style=" font-family:'Courier New'; font-size:11pt;"> <br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;_______________________________________________&quot;<br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End Function</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:11pt;"><br /> <br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Function</span><span style=" font-family:'Courier New'; font-size:11pt;"> OpenExistOLContacts(strNameContact </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">AsString</span><span style=" font-family:'Courier New'; font-size:11pt;">)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'Открывает существующий контакт в имени которых содержится переданное значение</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.Application<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.NameSpace<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderContsct </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.MAPIFolder<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemContact </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.ContactItem<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_Attachment </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.AddressEntry<br /> <br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App = CreateObject(&quot;Outlook.Application&quot;) </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем объект Outlook</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace = OL_App.GetNamespace(&quot;MAPI&quot;) </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем Namespace</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем ссылку на папку &quot;Контакты&quot;</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderContsct = OL_NameSpace.GetDefaultFolder(olFolderContacts)<br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemContact  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderContsct.Items </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' перебираем все контакты в папке<br /> ' если заголовок контакта содержит искомую строку, то открываем его</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">If</span><span style=" font-family:'Courier New'; font-size:11pt;"> InStr(1, OL_ItemContact.Subject, strNameContact) </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Then</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemContact.Display<br />  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End Function</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:11pt;"><br /> <br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Function</span><span style=" font-family:'Courier New'; font-size:11pt;"> OpenExistOLTasks()<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'Открывает все не закрытые задачи</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.Application<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.NameSpace<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask As Outlook.MAPIFolder<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemTask As Outlook.TaskItem<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> RecipientTask As Recipient<br /> <br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App = CreateObject(&quot;Outlook.Application&quot;) </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем объект Outlook</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace = OL_App.GetNamespace(&quot;MAPI&quot;) </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем Namespace</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем ссылку на папку задач</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask = OL_NameSpace.GetDefaultFolder(olFolderTasks)<br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemTask  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask.Items </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' перебираем все задачи в папке</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">If</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemTask.Status &lt;&gt; olTaskComplete </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Then</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_ItemTask.Display<br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End Function</span></p>
<hr />
<hr />
<hr />
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Function</span><span style=" font-family:'Courier New'; font-size:11pt;"> ViewOLTasks()<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'Выводит список View доступных для папки задачи и</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'открывает список задач c применением случайного доступного вида</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.Application<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> Outlook.NameSpace<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask As Outlook.MAPIFolder<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_View </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">As</span><span style=" font-family:'Courier New'; font-size:11pt;"> View<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Dim</span><span style=" font-family:'Courier New'; font-size:11pt;"> I </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">AsInteger</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем объект Outlook</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_App = CreateObject(&quot;Outlook.Application&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'получаем Namespace</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_NameSpace = OL_App.GetNamespace(&quot;MAPI&quot;)<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' получаем ссылку на папку задач</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Set</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask = OL_NameSpace.GetDefaultFolder(olFolderTasks)<br />     </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">With </span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_FolderTask<br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">' перебираем все доступные для папки виды (Views)</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Доступные виды:&quot;<br />   </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">For Each</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_View  </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:11pt;"> .Views<br />      </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> OL_View.Name<br />    </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Next</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">   ' поучаем случаное число</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    Randomize<br />    I = Int(.Views.Count * Rnd()) + 1<br />    OL_FolderTask.Views(I).Apply </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'применяем выбранный вид</span><span style=" font-family:'Courier New'; font-size:11pt;"><br />    .Display </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'открываем окно в папкой &quot;Задачи&quot;</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End    With </span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#008000;">'для примера получим значение CurrenView через объект Explorer</span><span style=" font-family:'Courier New'; font-size:11pt;"><br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Debug</span><span style=" font-family:'Courier New'; font-size:11pt;">.</span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">Print</span><span style=" font-family:'Courier New'; font-size:11pt;"> &quot;Установлен вид - &quot; &amp; OL_App.ActiveExplorer.CurrentView<br /> <br /> </span><span style=" font-family:'Courier New'; font-size:11pt; color:#000080;">End Function</span></p>
<hr />
<hr /></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br /> Не берусь судить какой из перечисленных выше способов лучше... все зависит от поставленной задачи. </span></p></td></tr></table></body></html>