<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; color:#000000; background-color:#ffffff;">Pandas добавляет столбец в DataFrame: 7 способов добавить столбцы в Pandas DataFrame</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:xx-large; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">df[&quot;hypertext&quot;] = '&lt;a href=&quot;' + df.link + '&quot;&gt;' + df.name + '&lt;/a&gt;'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">df</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">[</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">&quot;</span><span style=" font-family:'Courier New';">name</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">&quot;</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">] </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">=</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'&lt;a href=&quot;'</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#d4d4d4;">+</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">df</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">[</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'</span><span style=" font-family:'Courier New';">link</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">] </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">+</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'&quot;&gt;'</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">+</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#9cdcfe;">df</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">[</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'</span><span style=" font-family:'Courier New';">name</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;">] </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#dcdcaa;">+</span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#cccccc;"> </span><span style=" font-family:'Consolas,Courier New,monospace'; font-size:14px; color:#ce9178;">'&lt;/a&gt;'</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:xx-large; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:xx-large; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%; background-color:#ffffff;"><a name="pandas-add-column-to-dataframe"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">P</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">andas добавляет столбец в DataFrame</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ezoic-pub-ad-placeholder-113"></a><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">У</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> вас есть 7 вариантов, если вы хотите добавить столбец в </span><a href="https://betterdatascience.com/what-is-pandas-dataframe"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-weight:496; text-decoration: underline; color:#000000; background-color:transparent;">DataFrame</span></a><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> , и это с помощью списков Python, словарей, Pandas </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">insert()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">assign()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">loc[]</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, и </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">методов. Ну, на самом деле есть два способа добавить столбцы в DataFrame в Pandas с помощью </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, и вы узнаете оба сегодня.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Добавление столбцов в Pandas DataFrame — это операция, которую должен знать любой аналитик данных, поскольку она постоянно используется при предварительной обработке данных для машинного обучения, извлечении информации из нескольких признаков, объединении нескольких атрибутов и т. д. В общем, </span><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-weight:600; color:#000000;">лучше изучить ее раньше, чем позже</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:24px; color:#000000;">Хотите добавить строки в Pandas DataFrames? Вот 3 способа сделать это.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Что касается импорта библиотек, вам понадобится только Pandas, поэтому добавьте эту строку в начало вашего скрипта Python или блокнота:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">import</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pandas </span><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">as</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">А для данных мы будем использовать созданный Pandas DataFrame из четырех сотрудников, описанных тремя признаками — именем, фамилией и адресом электронной почты:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот как выглядит DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 1 — Начальный набор данных (изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Давайте начнем с первого способа добавления столбца в Pandas DataFrame, а именно с простых списков Python.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f2f2f2;"><span style=" font-family:'ibm plex sans,times new roman,serif'; font-size:20px; font-weight:696; color:#000000;">Оглавление:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#pandas-add-column-to-dataframe"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">Pandas добавляет столбец в DataFrame</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#1-pandas-dataframe-add-column-from-python-list"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">1. Pandas DataFrame Добавить столбец из списка Python</span></a></li>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:32px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#add-column-to-pandas-dataframe-with-default-value"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">Добавить столбец в Pandas DataFrame со значением по умолчанию</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:32px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#add-column-to-dataframe-from-python-list"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">Добавить столбец в DataFrame из списка Python</span></a></li></ul>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#2-add-column-to-pandas-dataframe-from-python-dictionary"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">2. Добавить столбец в Pandas DataFrame из словаря Python</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#3-how-to-add-column-to-a-dataframe-in-python-with-the-insert-method"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">3. Как добавить столбец в DataFrame в Python с помощью метода insert()</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#4-add-column-to-dataframe-with-the-assign-method"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">4. Добавьте столбец в DataFrame с помощью метода assign()</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#5-pandas-add-column-with-the-loc-indexer"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">5. Pandas добавляет столбец с индексатором loc[]</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#6-pandas-add-column-value-based-on-condition-with-apply"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">6. Pandas добавляет значение столбца на основе условия с помощью apply()</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#7-pandas-create-new-column-from-existing-columns-with-apply"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">7. Pandas создает новый столбец из существующих столбцов с помощью apply()</span></a></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:32px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#summing-up-pandas-add-column-to-dataframe"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">Подводя итоги Pandas: добавление столбца в DataFrame</span></a></li></ul>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:32px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://betterdatascience.com/pandas-add-column-to-dataframe/#recommended-reads"><span style=" font-size:20px; font-weight:496; text-decoration: underline; color:#0000ff; background-color:transparent;">Рекомендуемые к прочтению материалы</span></a></li></ul>
<hr />
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="1-pandas-dataframe-add-column-from-python-list"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">1</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">. Pandas DataFrame Добавить столбец из списка Python</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Первый и, вероятно, самый простой способ добавить столбец в Pandas DataFrame — использовать списки Python. Вы можете либо задать новый столбец с постоянным значением, либо указать значение для каждой строки.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">В этом разделе мы рассмотрим оба варианта.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="add-column-to-pandas-dataframe-with-default-value"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:large; font-weight:696; color:#000000;">Д</span><span style=" font-family:'ibm plex,sans-serif'; font-size:large; font-weight:696; color:#000000;">обавить столбец в Pandas DataFrame со значением по умолчанию</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Значение по умолчанию или постоянное значение в столбце Pandas означает, что во всем объекте есть только одно уникальное значение. Это полезный подход, если вы знаете, что вам понадобится столбец, но не знаете фактических значений на данный момент.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">5th Street</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Для демонстрации мы назначим новому столбцу значение по умолчанию </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">Office Address</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">. Реализация в Pandas максимально проста:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Office Address&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;5th Street&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот как выглядит полученный DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 2 — Pandas добавляет столбец как константу (Изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Наша новая функция здесь, но она не самая интересная и не несет никакой информации. Давайте посмотрим, как решить эту проблему, назначив целый список столбцу Pandas.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="add-column-to-dataframe-from-python-list"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:large; font-weight:696; color:#000000;">Д</span><span style=" font-family:'ibm plex,sans-serif'; font-size:large; font-weight:696; color:#000000;">обавить столбец в DataFrame из списка Python</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Теперь мы объявим список возрастов сотрудников и назначим его новому объекту - </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">age</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">. Сначала DataFrame восстанавливается до исходного вида, чтобы избежать путаницы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:24px; color:#000000;">Да, вы можете создавать целые DataFrames из списков Python — вот 5 примеров.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот код:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> [</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">33</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">27</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">31</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">44</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Age&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> ages</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">А вот и получившийся Pandas DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 3 — Добавление столбца в Pandas из списка Python (изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Новый столбец привносит новую информацию в набор данных, поскольку он не просто хранит константу или значение по умолчанию.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот как можно добавить новый столбец в Pandas DataFrame с помощью списков Python. Далее рассмотрим словари.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="2-add-column-to-pandas-dataframe-from-python-dictionary"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">2</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">. Добавить столбец в Pandas DataFrame из словаря Python</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ezoic-pub-ad-placeholder-135"></a><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">С</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">ловарь используется для представления данных в парах ключ-значение. Например, ключом словаря может быть адрес электронной почты пользователя, а соответствующее значение может представлять более подробную информацию о пользователе, например, имя, фамилию, адрес, номер телефона и т. д.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:24px; color:#000000;">Словарь Python в Pandas DataFrame? Вот 5 способов сделать преобразование.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Как оказалось, вы также можете преобразовать словарь в новый столбец в Pandas DataFrame. Нотация немного запутанная и может быть слишком подробной для некоторых пользователей, так что имейте это в виду.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-weight:600; color:#000000;">Ключи словаря должны быть значениями нового столбца, а значения словаря должны быть возможными значениями столбца, который уже присутствует в наборе данных.</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> Это немного запутанно, конечно, но пример ниже объяснит.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">В приведенном ниже фрагменте кода мы назначаем возраст как ключи словаря, а адреса электронной почты как значения словаря. Адреса электронной почты уже существуют в наборе данных, поэтому это столбец, который будет автоматически сопоставлен:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">33</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">27</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">31</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">44</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Age&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> ages</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот полученный DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 4 — Добавление столбца в Pandas из словаря Python (изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Он идентичен тому, что у нас был со списками, но с гораздо менее удобным синтаксисом кода. Используйте этот подход для добавления новых столбцов в Pandas DataFrame, если вам это необходимо, но мы не рекомендуем этого.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="3-how-to-add-column-to-a-dataframe-in-python-with-the-insert-method"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">3</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">. Как добавить столбец в DataFrame в Python с помощью метода insert()</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Метод </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">insert()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">из Pandas, вероятно, самый универсальный из тех, что вы увидите в этой статье, особенно когда дело доходит до вставки новых столбцов в существующий DataFrame. Он ожидает несколько аргументов:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace,monospace'; font-size:20px;">loc</span><span style=" font-size:20px;">- целое число, представляет индекс, по которому будет вставлен столбец</span></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:10px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace,monospace'; font-size:20px;">column</span><span style=" font-size:20px;">- строка, имя нового столбца</span></li>
<li style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;" style=" margin-top:0px; margin-bottom:32px; margin-left:16px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace,monospace'; font-size:20px;">value</span><span style=" font-size:20px;">- скаляр или список, просто значение для нового столбца</span></li></ul>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Давайте посмотрим, как можно использовать </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">insert()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">метод для добавления нового столбца возраста сотрудников перед всеми остальными атрибутами ( </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">loc=0</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> [</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">33</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">27</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">31</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">44</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">insert(loc</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">0</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, column</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Age&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, value</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот как выглядит полученный DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 5 — Добавление столбца в Pandas с помощью метода insert() (Изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Короче говоря, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">insert()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">метод позволяет нам изменить положение нового столбца. </span><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-weight:600; color:#000000;">Но что, если вы хотите вставить новый столбец в конец Pandas DataFrame?</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> Вы можете использовать </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">shape</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">для определения количества столбцов, которые уже есть в DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> [</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">33</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">27</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">31</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">44</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">insert(loc</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">shape[</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">1</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">], column</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Age&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, value</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Полученный DataFrame — тот, который вы уже привыкли видеть:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 6 — Добавление столбца в DataFrame в определенном месте с помощью метода insert() (изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Подводя итог, можно сказать, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">insert()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">что это простое в использовании и универсальное приложение, и мы настоятельно рекомендуем вам использовать его всегда.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="4-add-column-to-dataframe-with-the-assign-method"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">4</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">. Добавьте столбец в DataFrame с помощью метода assign()</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Метод </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">assign()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">полезен, когда вы хотите добавить новый столбец в Pandas DataFrame, но использует немного странный синтаксис. Он может принимать столько аргументов, сколько столбцов вы хотите добавить за раз, но вы не можете указывать имена столбцов как строки.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Взгляните на следующий пример:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> [</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">33</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">27</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">31</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">44</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> data</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">assign(Age</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Полученный DataFrame идентичен тем, что были у нас ранее:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 7 — Добавление столбца в Pandas с помощью метода assign() (Изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Синтаксис этого метода странный, потому что вы вынуждены использовать однословные имена столбцов или разделять слова подчеркиванием. Это небольшой недостаток дизайна, но, к счастью, есть и другие способы добавления столбцов в DataFrame.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="5-pandas-add-column-with-the-loc-indexer"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">5</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">. Pandas добавляет столбец с индексатором loc[]</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Индексатор </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">loc[]</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">в Pandas используется для доступа к строке, группе строк или столбцов или булевскому массиву. Это означает, что вы можете использовать его для доступа к определенным строкам и столбцам и их комбинациям, а в нашем случае - </span><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-weight:600; color:#000000;">для добавления одного или нескольких столбцов в Dataframe</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> .</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Теперь, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">loc[]</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">использует фигурные скобки, которые ожидают номер строки и имя столбца, разделенные запятой. Чтобы добавить новый столбец с </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">loc[]</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, вы можете написать </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">:</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, чтобы повлиять на все строки, а затем имя вашего столбца.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот пример:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">ages </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> [</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">33</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">27</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">31</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">44</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">loc[:, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Age&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> ages</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ezoic-pub-ad-placeholder-124"></a><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Е</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">ще раз напоминаем, что вы уже достаточно хорошо знакомы с этим набором данных:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 8 — Добавление столбца в Pandas с помощью индексатора loc[] (Изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ezoic-pub-ad-placeholder-125"></a><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">В</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> целом, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">loc[]</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">обеспечивает аккуратный способ добавления нового столбца в Pandas DataFrame. Является ли он более интуитивным </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">insert()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">или даже простым, чем списки Python? Вряд ли, но судить вам.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="6-pandas-add-column-value-based-on-condition-with-apply"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">6</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">. Pandas добавляет значение столбца на основе условия с помощью apply()</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Если вам интересно, как добавить столбец в Pandas DataFrame на основе другого столбца или как добавить столбец в Dataframe на основе функции в Pandas, не ищите дальше этого метода </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">. Он сам по себе заслуживает серии статей, но мы будем кратки и сосредоточимся только на вставке новых столбцов.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Например, вы можете использовать его </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">для создания нового столбца, основанного на функции Python, примененной к существующему столбцу.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">В приведенном ниже фрагменте кода объявляется функция Python, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">is_short_first_name()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">которая возвращает 1, если переданная строка содержит 5 или менее символов, и 0 в противном случае. Затем мы можем </span><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">применить</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;"> эту функцию к существующему столбцу - </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">First Name</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">- для создания нового:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">def</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:20px; color:#a6e22e;">is_short_first_name</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">(first_name: str) </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">-&gt;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> int:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">if</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> len(first_name) </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">&lt;=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">5</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">        </span><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">return</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">return</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Has Short First Name?&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> data[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">apply(is_short_first_name)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот полученный DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 9 — Добавление столбца в Pandas на основе пользовательской функции (Изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Метод </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">настолько мощный, что вы можете использовать его даже на нескольких столбцах одновременно. Давайте посмотрим, как дальше.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="7-pandas-create-new-column-from-existing-columns-with-apply"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">7</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">. Pandas создает новый столбец из существующих столбцов с помощью apply()</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Этот </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">метод часто используется с </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">lambda</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">функциями, которые являются ничем иным, как анонимными функциями. Как оказалось, мы можем комбинировать как пользовательские функции Python, так и </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">lambda</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">функции, чтобы создать новый столбец в Pandas DataFrame, основанный на нескольких существующих столбцах.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Для демонстрации мы создадим новую функцию Python под названием </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">get_full_email()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">. Она берет имя и фамилию сотрудника, которые затем переводятся в нижний регистр, соединяются точкой между ними и объединяются с </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">@company.com</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Теперь нам нужен доступ к обоим атрибутам </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">First Name</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">и </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">Last Name</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, так как мы можем это сделать? Ну, мы можем вызвать </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">весь DataFrame, а затем передать интересующие нас столбцы, </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">get_full_email()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">находясь внутри </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">lambda</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">функции.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Понятно, если вы запутались, давайте рассмотрим пример кода:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">def</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:20px; color:#a6e22e;">get_full_email</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">(first_name: str, last_name: str) </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">-&gt;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> str:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">return</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">f&quot;{</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">first_name</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">lower()</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">}.{</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">last_name</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">lower()</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">}@company.com&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> pd</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">DataFrame({</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Bob&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Mark&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Jane&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Patrick&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Doe&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Markson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Swift&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Johnson&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">],</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">    </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;bdoe@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;mmarkson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;jswift@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;pjohnson@company.com&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">})</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Full Email&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> data</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">.</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">apply(</span><span style=" font-family:'Consolas'; font-size:20px; color:#66d9ef;">lambda</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;"> x: get_full_email(x[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;First Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">], x[</span><span style=" font-family:'Consolas'; font-size:20px; color:#e6db74;">&quot;Last Name&quot;</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">]), axis</span><span style=" font-family:'Consolas'; font-size:20px; color:#f92672;">=</span><span style=" font-family:'Consolas'; font-size:20px; color:#ae81ff;">1</span><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:20px; color:#000000;">data</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Consolas'; font-size:20px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'poppins,sans-serif'; font-size:10px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Вот как выглядит полученный DataFrame:</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; font-style:italic; color:#000000;">Изображение 10 — Добавление столбца в Pandas на основе пользовательской функции (2) (Изображение автора)</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Теперь у нас есть вторая версия электронного письма, которая представляет собой динамическую комбинацию соответствующих атрибутов </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">First Name</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">и </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">Last Name</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">. Здорово!</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.3%;"><a name="summing-up-pandas-add-column-to-dataframe"></a><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">П</span><span style=" font-family:'ibm plex,sans-serif'; font-size:x-large; font-weight:696; color:#000000;">одводя итоги Pandas: добавление столбца в DataFrame</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">Подводя итог, есть больше способов добавить столбец в DataFrame, чем вам когда-либо понадобится. Мы рекомендуем вам придерживаться списков Python или метода </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">insert()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">, так как эти варианты просты в использовании и при этом обеспечивают достаточную универсальность.</span></p>
<p style=" margin-top:0px; margin-bottom:32px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">С другой стороны, эта </span><span style=" font-family:'monospace,monospace'; font-size:20px; color:#000000;">apply()</span><span style=" font-family:'poppins,sans-serif'; font-size:20px; color:#000000;">функция — все, что вам нужно для 100% настройки и расширенных вариантов использования. Мы рассмотрим эту функцию гораздо более подробно в ближайшее время, так что следите за Practical Pandas, чтобы узнать больше.</span></p></body></html>