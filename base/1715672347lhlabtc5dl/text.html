<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; color:#000000; background-color:#171717;">Методы очистки данных в Pandas</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#000000;">Простой</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#000000;">5 мин8.8K</span></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/companies/otus/articles/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#000000; background-color:transparent;">Блог компании OTUS</span></a><a href="https://habr.com/ru/hubs/python/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#000000; background-color:transparent;">Python</span></a><a href="https://habr.com/ru/hubs/python/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#000000; background-color:transparent;">*</span></a><a href="https://habr.com/ru/hubs/data_visualization/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#000000; background-color:transparent;">Визуализация данных</span></a><a href="https://habr.com/ru/hubs/data_visualization/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:496; color:#000000; background-color:transparent;">*</span></a></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Обзор</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#171717;"><a name="post-content-body"></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">П</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">ривет, Хабр!</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Аналитики данных часто сталкиваются с </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">грязными данными,</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> которые могут существенно замедлить процесс анализа. Грязны данные – это </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">пропущенные значения</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">, </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">дубликаты</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">, </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">неконсистентные данные</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">. Пропущенные значения заставляют нас гадать, что же было замыслено нашим коллегой; дубликаты вводят в заблуждение, умножая одно и то же на количество их копий, а неконсистентные данные заставляют нас сомневаться в каждой цифре.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Очищать грязные данные можно c </span><a href="https://pandas.pydata.org/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000; background-color:transparent;">Pandas</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">. </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">Рассмотрим основные методы.</span></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:medium; font-weight:496; color:#000000;">Пропущенные значения</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Пропущенные значения могут возникать по разным причинам. Вне зависимости от причины, </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">сначала их нужно обнаружить.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">isnull()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> в Pandas возвращает DataFrame или Series с булевыми значениями, где </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">True</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> указывает на пропущенное значение. Аналогично, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">notnull()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> возвращает </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">True</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> для элементов, где значение присутствует:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем строки, где есть хотя бы одно пропущенное значение</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">cleaned_df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">dropna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">()<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># заполняем все пропущенные значения нулями</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">filled_df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">0</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">&quot;Очищенный DataFrame:\n&quot;</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">cleaned_df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">prit</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">&quot;DataFrame с заполненными пропусками:\n&quot;</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">filled_df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Код выведет таблицу, где </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">True</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> обозначает пропущенные значения.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">- Что с ними делать дальше?</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> Один из подходов – </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">удаление строк или столбцов</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> с пропусками, но это может привести к потере какой-то информации. Другой подход – </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">заполнение пропусков.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Для заполнения пропусков используем метод </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">fillna()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># заполняем пропуски средним значением по столбцам</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">mean</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(), </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">inplace</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">&quot;df с заполненными пропусками средним:\n&quot;</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Для категориальных данных может быть разумно заполнить пропуски наиболее часто встречающимся значением:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># заполнение пропусков в зависимости от условий</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">value</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">mean</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(), </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">inplace</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">value</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">median</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(), </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">inplace</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># кастомная функция для заполнения</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">def</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">custom_fill</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">series</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">):<br />    </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">return</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">series</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">series</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">mean</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">())<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">apply</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">custom_fill</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:medium; font-weight:496; color:#000000;">Удаление с помощью dropna()</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">По умолчанию </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">dropna()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> удаляет строки, которые содержат хотя бы одно пропущенное значение:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">import</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pandas</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">as</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">import</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">numpy</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">as</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">DataFrame</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">({<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Name'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'ivan'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'artem'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'diana'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'eva'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">],<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Age'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">25</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">27</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">28</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">],<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'City'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'New York'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Los Angeles'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Chicago'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Miami'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]<br />})<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем строки с пропущенными значениями</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">dropna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">()<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">dropna()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> удаляет все строки, где есть хотя бы одно </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">NaN</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Чтобы удалить столбцы, содержащие пропущенные значения можно юзать параметр </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">axis=1</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_columns</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">dropna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">axis</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_columns</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Можно удалить строки, где все значения пропущены с помощью параметра </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">how='all'</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># добавляем строку, полностью состоящую из NaN</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">loc</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">5</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> [</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем строки, где все значения являются NaN</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_all</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">dropna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">how</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'all'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_all</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Можно указать столбцы, для которых должна быть применена проверка на </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">NaN</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">, используя параметр </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">subset</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем строки, где пропущены значения в определенных столбцах</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_subset</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">dropna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">subset</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Name'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'City'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">])<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_subset</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">В этом случае будут удалены только те строки, в которых отсутствуют значения в столбцах </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">Name</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> или </span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-style:italic; color:#000000;">City</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">thresh</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> позволяет указать минимальное количество непропущенных значений, при котором строка или столбец сохраняется:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем строки, где менее двух непропущенных значений</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_thresh</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">dropna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">thresh</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">2</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_cleaned_thresh</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:medium; font-weight:496; color:#000000;">Кастомные варианты</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Часто юзаются для числовых данных, чтобы минимизировать влияние пропусков на распределение данных.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">Ср. значение:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">import</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pandas</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">as</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">import</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">numpy</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">as</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">DataFrame</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">({<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">2</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">4</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">5</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">],<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">2</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">3</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">5</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">],<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'C'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">2</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">3</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">4</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">np</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">nan</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]<br />})<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># заполняем пропущенные значения в столбце A средним значением по этому столбцу</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">mean</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(), </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">inplace</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">Медиана</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Медиана может быть предпочтительнее среднего значения в случаях, когда данные содержат выбросы, которые могут исказить среднее:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># фулим пропущенные значения в столбце B медианой</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">median</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(), </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">inplace</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:600; color:#000000;">Мода</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Для категориальных данных или данных с дискретными значениями можно использовать моду:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># C - категориальный столбец, заполняем пропущенные значения модой</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'C'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'C'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">mode</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">()[</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">0</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">], </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">inplace</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Можно применять произвольные функции для более сложных заполнений. Например, можно заполнить пропуски значениями, основанными на других столбцах данных:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># Заполняем пропущенные значения в столбце A, используя кастомную логику</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">apply</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">lambda</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">row</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">row</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">if</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">isnull</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">row</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]) </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">else</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">row</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">], </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">axis</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">), </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">inplace</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Когда заполнение должно учитывать группировку по какому-либо признаку, можно использовать </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">apply()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> или </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">transform()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> совместно с </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">groupby()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># допустим, есть столбец группы, и мы хотим заполнить пропуски средним значением внутри каждой группы</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'group'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> [</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'X'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'X'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Y'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Y'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Z'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">groupby</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'group'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">transform</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">lambda</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">x</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">x</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">fillna</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">x</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">mean</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">()))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:medium; font-weight:496; color:#000000;">А что насчет дупликатов?</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Дубликаты могут могут быть как полностью идентичными записями, так и частичными дубликатами, когда совпадают только некоторые поля. В любом случае, дубликаты вносят шум в данные, увеличивают их объем и могут привести к неверным аналитическим выводам.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">drop_duplicates()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> позволяет не только удалять полные дубликаты строк, но и предоставляет настройки для работы с частичными дубликатами, удалим полные дупликаты:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">import</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pandas</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">as</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">DataFrame</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">({<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">1</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">2</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">2</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">3</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">3</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">3</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">],<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'a'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'b'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'b'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'c'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'c'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'c'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">],<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'C'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">100</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">200</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">200</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">300</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">300</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#f5871f;">300</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]<br />})<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем дубликаты</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_unique</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">drop_duplicates</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">()<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_unique</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Код удалит все полные дубликаты строк, оставив уникальные комбинации значений по всем столбцам.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Часто нужно удалять дубликаты, основываясь не на всех столбцах, а только на некоторых. Для этого в </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">drop_duplicates()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> есть параметр </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">subset</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем дубликаты, основываясь только на столбцах 'A' и 'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_unique_subset</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">drop_duplicates</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">subset</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'A'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">])<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_unique_subset</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">keep</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> позволяет контролировать, какие дубликаты будут удалены: первый, последний или все:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># Удаляем все дубликаты, кроме последнего вхождения</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_keep_last</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">drop_duplicates</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">keep</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'last'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_keep_last</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Можно использовать комбинацию методов Pandas для предварительной обработки данных перед удалением дубликатов. Например, можно привести все строки к нижнему регистру, удалить пробелы, преобразовать даты в единый формат и т.д:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># преобразуем все строки в нижний регистр и удаляем пробелы</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'B'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">str</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">lower</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">().</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">str</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">replace</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">' '</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">''</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># теперь удаляем дубликаты</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_preprocessed</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">drop_duplicates</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">()<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_preprocessed</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Fira Sans,sans-serif'; font-size:medium; font-weight:496; color:#000000;">Категориальные данные</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">get_dummies()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> используется для преобразования категориальных переменных в фиктивные/индикаторные переменные, кстати в ml юзается довольно часто:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">import</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pandas</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">as</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">DataFrame</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">({<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Color'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Red'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Green'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Blue'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Green'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]<br />})<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># преобразуем категориальные данные в индикаторные переменные</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">dummies</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">get_dummies</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Color'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">])<br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">dummies</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">В результате каждое уникальное значение в столбце </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">Color</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> превращается в отдельный столбец с индикаторными переменными (0 или 1), указывающими на присутствие или отсутствие данной категории в каждой строке.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">factorize()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> используется для получения числового представления категориальных данных, присваивая каждой уникальной категории целочисленный идентификатор:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># получаем числовое представление категориальных данных</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">codes</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">uniques</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">factorize</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Color'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">])<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">codes</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)  </span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># массив кодов</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">uniques</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)  </span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># массив уникальных значений</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">str</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">-методы позволяют выполнять такие операции, как преобразование регистра, поиск и замена подстрок, разбиение строк и т.п:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_text</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">pd</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">DataFrame</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">({<br />    </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Text'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: [</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'This is a test.'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Hello, World!'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Otus!'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">]<br />})<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># преобразуем все тексты в нижний регистр</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_text</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Text_lower'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_text</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Text'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">str</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">lower</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">()<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># удаляем знаки пунктуации</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_text</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Text_clean'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_text</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Text'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">str</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">.</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">replace</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'[^\w\s]'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">''</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">regex</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">True</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df_text</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<p style=" margin-top:32px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Иногда можно использовать </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">str.replace()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">, </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">str.findall().</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Преобразование текстовых данных в числовые часто требуется для аналитических и ml моделей. Например, после использования </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">factorize()</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> для категориальных данных можно обратно преобразовать числовые коды в текстовые категории, используя массив </span><span style=" font-family:'Menlo,Monaco,Consolas,Courier New,Courier,monospace'; font-size:medium; color:#000000;">uniques</span><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:medium; color:#8e908c;"># преобразование кодов обратно в текстовые категории</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Color_restored'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">codes</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Color_restored'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">] </span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">=</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#718c00;">'Color_restored'</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">].</span><span style=" font-family:'Consolas'; font-size:medium; color:#4d4d4c;">map</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; font-weight:600; color:#8959a8;">lambda</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;"> </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">x</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">: </span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">uniques</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">[</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">x</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">])<br /><br /></span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">print</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">(</span><span style=" font-family:'Consolas'; font-size:medium; color:#4271ae;">df</span><span style=" font-family:'Consolas'; font-size:medium; color:#000000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"><br /></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">Какие методы очистки знаете вы?</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">В преддверии старта курса </span><a href="https://otus.pw/LViZ4/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000; background-color:transparent;">Аналитик данных</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;"> хочу пригласить вас на бесплатные вебинары про </span><a href="https://otus.pw/jmD0W/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000; background-color:transparent;">подготовку данных в Pandas</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">, а также про </span><a href="https://otus.pw/8QZY/"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000; background-color:transparent;">SQL в реалиях начинающего дата-аналитика</span></a><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;">.</span></p>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:28.8px; background-color:#171717;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#000000;">Теги:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=[pandas]"><span style=" font-size:medium; font-weight:496; background-color:transparent;">pandas</span></a></li>
<li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=[python]"><span style=" font-size:medium; font-weight:496; background-color:transparent;">python</span></a></li></ul>
<p style=" margin-top:24px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; font-weight:696; color:#000000;">Хабы:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/companies/otus/articles/"><span style=" font-size:medium; font-weight:496; background-color:transparent;">Блог компании OTUS</span></a></li>
<li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/hubs/python/"><span style=" font-size:medium; font-weight:496; background-color:transparent;">Python</span></a></li>
<li style=" font-family:'-apple-system,BlinkMacSystemFont,Arial,sans-serif'; font-size:medium; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habr.com/ru/hubs/data_visualization/"><span style=" font-size:medium; font-weight:496; background-color:transparent;">Визуализация данных</span></a></li></ul></body></html>