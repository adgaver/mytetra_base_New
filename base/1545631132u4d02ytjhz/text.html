<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="spaddlinkedserver-transact-sql"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">s</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">p_addlinkedserver (Transact-SQL)</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">ОБЛАСТЬ ПРИМЕНЕНИЯ:</span><span style=" font-family:'MS Shell Dlg 2';"> </span><img src="image16236.png" /><span style=" font-family:'MS Shell Dlg 2';">SQL Server (начиная с версии 2008) </span><img src="image21079.png" /><span style=" font-family:'MS Shell Dlg 2';">База данных SQL Azure </span><img src="image21079.png" /><span style=" font-family:'MS Shell Dlg 2';">Хранилище данных SQL Azure</span><img src="image21079.png" /><span style=" font-family:'MS Shell Dlg 2';">Parallel Data Warehouse </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Создает связанный сервер. Связанные серверы позволяют выполнять распределенные разнородные запросы к источникам данных OLE DB. После создания связанного сервера с помощью </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">sp_addlinkedserver</span><span style=" font-family:'MS Shell Dlg 2';">распределенные запросы могут выполняться на этом сервере. Если связанный сервер определен в качестве экземпляра SQL Server, на нем могут выполняться удаленные хранимые процедуры. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="syntax"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">С</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">интаксис</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">sp_addlinkedserver [ @server= ] 'server' [ , [ @srvproduct= ] 'product_name' ]   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">     [ , [ @provider= ] 'provider_name' ]  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">     [ , [ @datasrc= ] 'data_source' ]   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">     [ , [ @location= ] 'location' ]   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">     [ , [ @provstr= ] 'provider_string' ]   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">     [ , [ @catalog= ] 'catalog' ]   </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="arguments"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">А</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">ргументы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">[ </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@server=</span><span style=" font-family:'MS Shell Dlg 2';"> ] </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">'</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">server</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">'</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Имя создаваемого связанного сервера. Аргумент<span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">server</span><span style=" font-family:'MS Shell Dlg 2';"> имеет тип </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">sysname</span><span style=" font-family:'MS Shell Dlg 2';">и не имеет значения по умолчанию. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">[ </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@srvproduct=</span><span style=" font-family:'MS Shell Dlg 2';"> ] </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">product_name</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Введите название продукта для источника данных OLE DB, который добавляется в качестве связанного сервера. <span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">product_name</span><span style=" font-family:'MS Shell Dlg 2';"> — </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">nvarchar (</span><span style=" font-family:'MS Shell Dlg 2';"> 128 </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">)</span><span style=" font-family:'MS Shell Dlg 2';">, значение по умолчанию NULL. Если </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">SQL Server</span><span style=" font-family:'MS Shell Dlg 2';">, </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_name</span><span style=" font-family:'MS Shell Dlg 2';">, </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">источник_данных</span><span style=" font-family:'MS Shell Dlg 2';">, </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">расположение</span><span style=" font-family:'MS Shell Dlg 2';">, </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_string</span><span style=" font-family:'MS Shell Dlg 2';">, и </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">каталога</span><span style=" font-family:'MS Shell Dlg 2';"> не должны быть указаны. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">[ </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@provider=</span><span style=" font-family:'MS Shell Dlg 2';"> ] </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_name</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Введите уникальный программный идентификатор (PROGID) поставщика OLE DB, соответствующий этому источнику данных. <span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_name</span><span style=" font-family:'MS Shell Dlg 2';"> должно быть уникальным для указанного поставщика OLE DB, который установлен на текущем компьютере. </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_name</span><span style=" font-family:'MS Shell Dlg 2';"> — </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">nvarchar (</span><span style=" font-family:'MS Shell Dlg 2';"> 128 </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">)</span><span style=" font-family:'MS Shell Dlg 2';">, значение по умолчанию NULL; тем не менее, если </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_name</span><span style=" font-family:'MS Shell Dlg 2';"> — этот параметр опущен, используется значение SQLNCLI. (При использовании SQLNCLI SQL Server будет использовать последнюю версию поставщика OLE DB для собственного клиента SQL Server.) Предполагается, что поставщик OLE DB будет зарегистрирован в реестре с указанным идентификатором PROGID. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">[ </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@datasrc=</span><span style=" font-family:'MS Shell Dlg 2';"> ] </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">источник_данных</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Имя источника данных, как оно интерпретируется поставщиком OLE DB. <span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">источник_данных</span><span style=" font-family:'MS Shell Dlg 2';"> — </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">nvarchar (</span><span style=" font-family:'MS Shell Dlg 2';"> 4000 </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">)</span><span style=" font-family:'MS Shell Dlg 2';">. </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">источник_данных</span><span style=" font-family:'MS Shell Dlg 2';"> передается как свойство DBPROP_INIT_DATASOURCE для инициализации поставщика OLE DB. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">[ </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@location=</span><span style=" font-family:'MS Shell Dlg 2';"> ] </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">расположение</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Введите местонахождение базы данных, понятное поставщику OLE DB. <span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">расположение</span><span style=" font-family:'MS Shell Dlg 2';"> — </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">nvarchar (</span><span style=" font-family:'MS Shell Dlg 2';"> 4000 </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">)</span><span style=" font-family:'MS Shell Dlg 2';">, значение по умолчанию NULL. </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">расположение</span><span style=" font-family:'MS Shell Dlg 2';"> передается как свойство DBPROP_INIT_LOCATION для инициализации поставщика OLE DB. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">[ </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@provstr=</span><span style=" font-family:'MS Shell Dlg 2';"> ] </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_string</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Строка подключения для конкретного поставщика OLE DB, указывающая уникальный источник данных. <span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_string</span><span style=" font-family:'MS Shell Dlg 2';"> — </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">nvarchar (</span><span style=" font-family:'MS Shell Dlg 2';"> 4000 </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">)</span><span style=" font-family:'MS Shell Dlg 2';">, значение по умолчанию NULL. </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provstr</span><span style=" font-family:'MS Shell Dlg 2';"> передается IDataInitialize или задается как свойство DBPROP_INIT_PROVIDERSTRING для инициализации поставщика OLE DB. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">При создании связанного сервера с SQL Server поставщика OLE DB для собственного клиента, используя ключевое слово SERVER в качестве сервера можно задать экземпляра =</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">servername</span><span style=" font-family:'MS Shell Dlg 2';">\</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">instancename</span><span style=" font-family:'MS Shell Dlg 2';">для указания определенного экземпляра SQL Server. </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">ServerName</span><span style=" font-family:'MS Shell Dlg 2';"> — имя компьютера, на котором SQL Server работает, и </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">instancename</span><span style=" font-family:'MS Shell Dlg 2';"> имя конкретного экземпляра SQL Server к которой будет подключен пользователь. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Примечание</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Чтобы получить доступ к зеркальной базе данных, строка соединения должна содержать имя базы данных. Это имя необходимо, чтобы предоставить поставщику доступа к данным возможность пытаться отработать отказ. Базы данных может быть указано в </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@provstr</span><span style=" font-family:'MS Shell Dlg 2';"> или </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@catalog</span><span style=" font-family:'MS Shell Dlg 2';"> параметра. Кроме того, строка соединения может содержать имя партнера по обеспечению отработки отказа. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">[ </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">@catalog=</span><span style=" font-family:'MS Shell Dlg 2';"> ] </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">каталога</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Каталог, который должен использоваться при подключении к поставщику OLE DB. <span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">каталог</span><span style=" font-family:'MS Shell Dlg 2';"> — </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">sysname</span><span style=" font-family:'MS Shell Dlg 2';">, значение по умолчанию NULL. </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">каталог</span><span style=" font-family:'MS Shell Dlg 2';"> передается как свойство DBPROP_INIT_CATALOG для инициализации поставщика OLE DB. Если связанный сервер определен для экземпляра SQL Server, то каталог ссылается на базу данных по умолчанию, с которой сопоставлен связанный сервер. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="return-code-values"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">З</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">начения кода возврата</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">0 (успешное завершение) или 1 (неуспешное завершение) </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="result-sets"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Р</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">езультирующие наборы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Нет. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="remarks"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">П</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">римечания</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В следующей таблице показаны способы настройки связанного сервера для источников данных, доступных через поставщик OLE DB. Связанный сервер может быть настроен несколькими способами для конкретного источника данных; для одного типа источника данных возможны несколько строк. В этой таблице также показаны </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">sp_addlinkedserver</span><span style=" font-family:'MS Shell Dlg 2';"> значения параметров для настройки связанного сервера. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="1" style=" border-style:solid; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="center" width="95%" cellspacing="-1" cellpadding="0" bgcolor="#ffffff"><thead>
<tr>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Удаленный источник данных OLE DB</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Поставщик OLE DB</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">product_name</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">provider_name</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">data_source</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">location</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">provider_string</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">catalog</span></p></td></tr></thead>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">SQL Server</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Microsoft SQL Server Поставщик OLE DB для собственного клиента</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">SQL Server </span><span style=" font-family:'MS Shell Dlg 2'; vertical-align:super;">1</span><span style=" font-family:'MS Shell Dlg 2';"> (по умолчанию)</span></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">SQL Server</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Microsoft SQL Server Поставщик OLE DB для собственного клиента</span></p></td>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">SQLNCLI</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Сетевое имя SQL Server (для экземпляра по умолчанию)</span></p></td>
<td></td>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Имя базы данных (необязательно)</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">SQL Server</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Microsoft SQL Server Поставщик OLE DB для собственного клиента</span></p></td>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">SQLNCLI</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">ServerName</span><span style=" font-family:'MS Shell Dlg 2';">\</span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">instancename</span><span style=" font-family:'MS Shell Dlg 2';"> (для конкретного экземпляра)</span></p></td>
<td></td>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Имя базы данных (необязательно)</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Oracle, версия 8 или более поздняя</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Oracle для OLE DB</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Любой</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">(Oraoledb.Oracle)</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Псевдоним для базы данных Oracle</span></p></td>
<td></td>
<td></td>
<td></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Access/Jet</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик OLE DB для Jet (Майкрософт)</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Любой</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Microsoft.Jet.OLEDB.4.0</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Полный путь к файлу базы данных Jet</span></p></td>
<td></td>
<td></td>
<td></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Источник данных ODBC</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Microsoft OLE DB для ODBC</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Любой</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">MSDASQL</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Системный DSN источника данных ODBC</span></p></td>
<td></td>
<td></td>
<td></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Источник данных ODBC</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Microsoft OLE DB для ODBC</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Любой</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">MSDASQL</span></p></td>
<td></td>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Строка подключения ODBC</span></p></td>
<td></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Файловая система</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Microsoft OLE DB для службы индексирования</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Любой</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">MSIDXS</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Имя каталога службы индексирования</span></p></td>
<td></td>
<td></td>
<td></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Электронная таблица Microsoft Excel</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Microsoft OLE DB для Jet</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Любой</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Microsoft.Jet.OLEDB.4.0</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Полный путь к файлу Excel</span></p></td>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Excel 5.0</span></p></td>
<td></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">База данных IBM DB2</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Microsoft OLE DB для DB2</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Любой</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">DB2OLEDB</span></p></td>
<td></td>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">См. в разделе Microsoft поставщик OLE DB для документации DB2.</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Имя каталога базы данных DB2</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; vertical-align:super;">1</span><span style=" font-family:'MS Shell Dlg 2';"> этом способе настройки связанного сервера приводит имя связанного сервера, чтобы совпадал сетевое имя удаленного экземпляра SQL Server. Используйте </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">источник_данных</span><span style=" font-family:'MS Shell Dlg 2';"> для указания этого сервера. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; vertical-align:super;">2</span><span style=" font-family:'MS Shell Dlg 2';"> «Любой» указывает, что имя продукта может быть любым. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Microsoft SQL Server Поставщика OLE DB для собственного клиента является поставщиком, который используется с SQL Server Если имя поставщика не указано или если SQL Server указывается как имя продукта. Даже если указано имя предыдущего поставщика (SQLOLEDB), оно все равно будет изменено на SQLNCLI при сохранении в каталог. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">Источник_данных</span><span style=" font-family:'MS Shell Dlg 2';">, </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">расположение</span><span style=" font-family:'MS Shell Dlg 2';">, </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">provider_string</span><span style=" font-family:'MS Shell Dlg 2';">, и </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">каталога</span><span style=" font-family:'MS Shell Dlg 2';"> параметры определяют базы данных, связанные Указывает сервер. Если значение одного из этих аргументов равно NULL, то соответствующее свойство инициализации поставщика OLE DB не установлено. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В кластеризованной среде при указании имен файлов для указания источников данных OLE DB используйте формат UNC или общие диски для указания расположения. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">sp_addlinkedserver</span><span style=" font-family:'MS Shell Dlg 2';"> не может выполняться внутри пользовательской транзакции. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Важно!</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">При создании связанного сервера с помощью </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">sp_addlinkedserver</span><span style=" font-family:'MS Shell Dlg 2';">, для всех локальных имен входа добавляется Самосопоставление по умолчанию. Поставщики, отличные от SQL Server, для которых выполнена проверка подлинности SQL Server, могут получить доступ к поставщику под учетной записью службы SQL Server. Администраторам нужно рассмотреть применение процедуры </span><span style=" font-family:'Courier New';">sp_droplinkedsrvlogin &lt;linkedserver_name&gt;, NULL</span><span style=" font-family:'MS Shell Dlg 2';"> для удаления глобального сопоставления. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="permissions"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Р</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">азрешения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">sp_addlinkedserver</span><span style=" font-family:'MS Shell Dlg 2';"> Инструкция требует </span><span style=" font-family:'Courier New';">ALTER ANY LINKED SERVER</span><span style=" font-family:'MS Shell Dlg 2';"> разрешение. (SSMS </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">создать связанный сервер</span><span style=" font-family:'MS Shell Dlg 2';"> диалоговое окно реализуется в виде, требуется членство в </span><span style=" font-family:'Courier New';">sysadmin</span><span style=" font-family:'MS Shell Dlg 2';"> предопределенной роли сервера.) </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="examples"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">П</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">римеры</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="a-using-the-microsoft-sql-server-native-client-ole-db-provider"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">A</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">. Использование поставщика OLE DB для собственного клиента Microsoft SQL Server</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В следующем примере показано создание связанного сервера с именем </span><span style=" font-family:'Courier New';">SEATTLESales</span><span style=" font-family:'MS Shell Dlg 2';">. Название продукта — </span><span style=" font-family:'Courier New';">SQL Server</span><span style=" font-family:'MS Shell Dlg 2';">, имя поставщика не используется. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">USE master;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   N'SEATTLESales',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   N'SQL Server';  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В следующем примере создается связанный сервер </span><span style=" font-family:'Courier New';">S1_instance1</span><span style=" font-family:'MS Shell Dlg 2';"> экземпляра SQL Server с помощью SQL Server поставщика OLE DB для собственного клиента. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver     </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @server=N'S1_instance1',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @srvproduct=N'',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @provider=N'SQLNCLI',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @datasrc=N'S1\instance1';  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="b-using-the-microsoft-ole-db-provider-for-microsoft-access"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Б</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">. Использование поставщика Microsoft OLE DB для Microsoft Access</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Microsoft.Jet.OLEDB.4.0 соединяется с базами данных Microsoft Access в формате 2002–2003. В следующем примере показано создание связанного сервера с именем </span><span style=" font-family:'Courier New';">SEATTLE Mktg</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Примечание</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В этом примере предполагается, что оба Microsoft Access и образец </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Northwind</span><span style=" font-family:'MS Shell Dlg 2';"> устанавливаются базы данных и что </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Northwind</span><span style=" font-family:'MS Shell Dlg 2';"> база данных находится в C:\Msoffice\Access\Samples. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @server = N'SEATTLE Mktg',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @provider = N'Microsoft.Jet.OLEDB.4.0',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @srvproduct = N'OLE DB Provider for Jet',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @datasrc = N'C:\MSOffice\Access\Samples\Northwind.mdb';  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Поставщик Microsoft.ACE.OLEDB.12.0 соединяется с базами данных Microsoft Access в формате 2007. В следующем примере показано создание связанного сервера с именем </span><span style=" font-family:'Courier New';">SEATTLE Mktg</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Примечание</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В этом примере предполагается, что оба Microsoft Access и образец </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Northwind</span><span style=" font-family:'MS Shell Dlg 2';"> устанавливаются базы данных и что </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Northwind</span><span style=" font-family:'MS Shell Dlg 2';"> база данных находится в C:\Msoffice\Access\Samples. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @server = N'SEATTLE Mktg',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @provider = N'Microsoft.ACE.OLEDB.12.0',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @srvproduct = N'OLE DB Provider for ACE',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @datasrc = N'C:\MSOffice\Access\Samples\Northwind.accdb';  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="c-using-the-microsoft-ole-db-provider-for-odbc-with-the-datasource-parameter"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">В</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">. Использование поставщика Microsoft OLE DB для ODBC с аргументом источника данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В следующем примере создается связанный сервер с именем </span><span style=" font-family:'Courier New';">SEATTLE Payroll</span><span style=" font-family:'MS Shell Dlg 2';"> , использующий Microsoft поставщик OLE DB для ODBC (</span><span style=" font-family:'Courier New';">MSDASQL</span><span style=" font-family:'MS Shell Dlg 2';">) и </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">источник_данных</span><span style=" font-family:'MS Shell Dlg 2';"> параметра. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Примечание</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Указанный источник данных ODBC должен быть определен как системный DSN на сервере до того, как будет использоваться связанный сервер. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @server = N'SEATTLE Payroll',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @srvproduct = N'',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @provider = N'MSDASQL',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @datasrc = N'LocalServer';  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="d-using-the-microsoft-ole-db-provider-for-excel-spreadsheet"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Г</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">. Использование поставщика Microsoft OLE DB для электронных таблиц Excel</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Чтобы создать определение связанного сервера с помощью Microsoft поставщик OLE DB для Jet для доступа к электронной таблице Excel в формате 1997-2003, сначала создайте именованный диапазон в Excel, указав столбцы и строки в таблице Excel для выбора. Затем на имя диапазона можно будет ссылаться в распределенном запросе как на имя таблицы. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver 'ExcelSource',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   'Jet 4.0',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   'Microsoft.Jet.OLEDB.4.0',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   'c:\MyData\DistExcl.xls',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   NULL,  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   'Excel 5.0';  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Для доступа к данным в электронной таблице Excel требуется указать имя для диапазона ячеек. Следующий запрос используется для получения доступа к указанному диапазону ячеек </span><span style=" font-family:'Courier New';">SalesData</span><span style=" font-family:'MS Shell Dlg 2';"> как к таблице с помощью предварительно настроенного связанного сервера. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">SELECT *  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   FROM ExcelSource...SalesData;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Если SQL Server выполняется под учетной записью домена, имеющего доступ к удаленной общей папке, то вместо сопоставленного диска может использоваться путь в формате UNC. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver 'ExcelShare',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   'Jet 4.0',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   'Microsoft.Jet.OLEDB.4.0',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   '\\MyServer\MyShare\Spreadsheets\DistExcl.xls',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   NULL,  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   'Excel 5.0';  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Чтобы подключиться к электронной таблице Excel в формате Excel 2007, используйте поставщик ACE. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver @server = N'ExcelDataSource',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@srvproduct=N'ExcelData', @provider=N'Microsoft.ACE.OLEDB.12.0',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@datasrc=N'C:\DataFolder\People.xlsx',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@provstr=N'EXCEL 12.0' ;  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="e-using-the-microsoft-ole-db-provider-for-jet-to-access-a-text-file"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Д</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">. Использование поставщика Microsoft OLE DB для Jet для доступа к текстовым файлам</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Данный пример показывает, как создать связанный сервер для прямого доступа к текстовым файлам без соединения с ними как с таблицами MDB-файла СУБД Access. Поставщик </span><span style=" font-family:'Courier New';">Microsoft.Jet.OLEDB.4.0</span><span style=" font-family:'MS Shell Dlg 2';"> и строка поставщика </span><span style=" font-family:'Courier New';">Text</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Источник данных — это полный путь к каталогу, который содержит тестовые файлы. Файл schema.ini, который описывает структуру текстовых файлов, должен находиться в том же каталоге, что и текстовые файлы. Дополнительные сведения о том, как создать файл Schema.ini, см. в документации по ядру СУБД Jet. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">--Create a linked server.  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver txtsrv, N'Jet 4.0',   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   N'Microsoft.Jet.OLEDB.4.0',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   N'c:\data\distqry',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   NULL,  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   N'Text';  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">--Set up login mappings.  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedsrvlogin txtsrv, FALSE, Admin, NULL;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">--List the tables in the linked server.  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_tables_ex txtsrv;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">GO  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">--Query one of the tables: file1#txt  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">--using a four-part name.   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">SELECT *   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">FROM txtsrv...[file1#txt];  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="f-using-the-microsoft-ole-db-provider-for-db2"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Е</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">. Использование поставщика данных Microsoft OLE DB для DB2</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">В следующем примере показано создание связанного сервера с именем </span><span style=" font-family:'Courier New';">DB2</span><span style=" font-family:'MS Shell Dlg 2';">, который использует </span><span style=" font-family:'Courier New';">Microsoft OLE DB Provider for DB2</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @server=N'DB2',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @srvproduct=N'Microsoft OLE DB Provider for DB2',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @catalog=N'DB2',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @provider=N'DB2OLEDB',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">   @provstr=N'Initial Catalog=PUBS;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">       Data Source=DB2;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">       HostCCSID=1252;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">       Network Address=XYZ;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">       Network Port=50000;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">       Package Collection=admin;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">       Default Schema=admin;';  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="g-add-a-includesssdsfullincludessssdsfull-mdmd-as-a-linked-server-for-use-with-distributed-queries-on-cloud-and-on-premise-databases"></a><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Ж</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">. Добавление База данных SQL Azure как связанный сервер для использования с распределенными запросами на облачных и локальных баз данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Вы можете добавить База данных SQL Azure как связанный сервер и затем его с помощью распределенных запросов, разделенные между локальной средой и облаком баз данных. Это компонент для гибридных решений базы данных, объединив локальных корпоративных сетях и облаке Windows Azure. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">SQL Server Готового продукта содержит функцию распределенного запроса, которая позволяет разработчикам писать запросы для объединения данных из локальных источников данных и данных из удаленных источников (включая данные, отличными от SQL Server источников данных) определенным как связанные серверы. Каждый База данных SQL Azure (за исключением виртуальную базу данных master) можно добавить в качестве отдельного связанного сервера, а затем использовать непосредственно в приложениях базы данных как и любые другие базы данных. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Преимущества использования База данных SQL Azure включают управляемость, высокий уровень доступности, масштабируемости, работа с знакомую модель разработки и реляционную модель данных. Определить требования приложения базы данных, как его использовать База данных SQL Azure в облаке. Можно переместить все данные за один раз до База данных SQL Azure, или постепенно переместить часть своих данных, сохранив остальные данные локально. Для таких гибридное приложение базы данных База данных SQL Azure теперь можно добавлять как связанные серверы и базы данных приложения выполнять распределенные запросы для объединения данных из База данных SQL Azure и локальные источники данных. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Ниже приведен простой пример, объясняя, как подключиться к База данных SQL Azure с помощью распределенных запросов: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">------ Configure the linked server  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">-- Add one Windows Azure SQL DB as Linked Server  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedserver  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@server='myLinkedServer', -- here you can specify the name of the linked server  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@srvproduct='',       </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@provider='sqlncli', -- using SQL Server Native Client  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@datasrc='myServer.database.windows.net',   -- add here your server name  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@location='',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@provstr='',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@catalog='myDatabase'  -- add here your database name as initial catalog (you cannot connect to the master database)  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">-- Add credentials and options to this linked server  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_addlinkedsrvlogin  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@rmtsrvname = 'myLinkedServer',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@useself = 'false',  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@rmtuser = 'myLogin',             -- add here your login on Azure DB  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">@rmtpassword = 'myPassword' -- add here your password on Azure DB  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">EXEC sp_serveroption 'myLinkedServer', 'rpc out', true;  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">------ Now you can use the linked server to execute 4-part queries  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">-- You can create a new table in the Azure DB  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">exec ('CREATE TABLE t1tutut2(col1 int not null CONSTRAINT PK_col1 PRIMARY KEY CLUSTERED (col1) )') at myLinkedServer  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">-- Insert data from your local SQL Server  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">exec ('INSERT INTO t1tutut2 VALUES(1),(2),(3)') at myLinkedServer  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">-- Query the data using 4-part names  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">select * from myLinkedServer.myDatabase.dbo.myTable  </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>