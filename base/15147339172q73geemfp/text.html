<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Если вы работаете с книгами Excel древних форматов (таких, например, как Excel 4),</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">то в Excel 2010 вы можете столкнуться с проблемой, что редактирование этих файлов по-умолчанию запрещено.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В настройках Excel 2010 для этого предусмотрены специальные опции</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Мало того, что Excel блокирует редактирование этих устаревших файлов,</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">так ещё и макросы начинают вести себя очень странно</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">(например, если активен файл Excel4, простейший макрос чтения пути текущего файла не запускается)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Избежать проблем при работе с такими файлами (а проблемы возможны, если вы обрабатываете макросом множество файлов, полученных от разных организаций), можно, если при открытии надстройки (файла с макросами) выполнить следующий код:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt;"> DeleteFileBlock()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">On</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Error</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Resume</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Next</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    Key$ = </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Excel\Security\FileBlock\&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    arr = Array(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;XL2Macros&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;XL2Worksheets&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;XL3Macros&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;XL3Worksheets&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">                </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;XL4Macros&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;XL4Workbooks&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;XL4Worksheets&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">For</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Each</span><span style=" font-family:'Courier New'; font-size:10pt;"> Item </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">In</span><span style=" font-family:'Courier New'; font-size:10pt;"> arr</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">        CreateObject(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">).RegWrite Key$ &amp; Item, 0, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;REG_DWORD&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Next</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">End</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Достаточно поместить вызов этого макроса в процедуру Workbook_Open, - и ограничения будут сниматься при каждом запуске вашей надстройки.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:8.25pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<hr width="100%"/>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Аналогично можно сделать макрос, включающий опцию «Доверять доступ к объектной модели проектов VBA»: </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt;"> Enable_AccessVBOM() </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' включает программный доступ к объектной модели проекта VBA</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">On</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Error</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Resume</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Next</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    Key$ = </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;HKEY_CURRENT_USER\Software\Microsoft\Office\&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;"> &amp; Application.Version &amp; _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">           </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;\Excel\Security\AccessVBOM&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    CreateObject(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">).RegWrite Key$, 1, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;REG_DWORD&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">End</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Этот код припишет в реестре Windows (в ветке с настройками безопасности Excel) необходимые параметры, и вы макросом сможете обращаться к свойствам проекта VBA</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">(например, чтобы выгрузить код макросов в текстовый файл, изменить кодовое имя листа или программно отредактировать код макросов, программно добавить элементы управления на форму, и т.д. и т.п.)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Отключить доступ тоже можно</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> - достаточно поменять в макросе записываемое в реестр значение (с 1 на 0): </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt;"> Disable_AccessVBOM() </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' отключает программный доступ к объектной модели проекта VBA</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">On</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Error</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Resume</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Next</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    Key$ = </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;HKEY_CURRENT_USER\Software\Microsoft\Office\&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;"> &amp; Application.Version &amp; _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">           </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;\Excel\Security\AccessVBOM&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    CreateObject(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">).RegWrite Key$, 0, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;REG_DWORD&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">End</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:8.25pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<hr width="100%"/>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Многие пользователи надстроек (и других файлов Excel, содержащих макросы), при каждом запуске книги Excel во всплывающем окне жмут кнопку «Включить макросы».</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Что, в принципе, неудивительно, т.к. не все знают, </span><a href="http://excelvba.ru/articles/CommandBar#EnableMacro"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">как раз и навсегда включить макросы в разных версиях Excel</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Чтобы избавить пользователя от ежедневного уведомления об «опасных» макросах, можно использовать такой код:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt;"> Enable_AccessVBOM_and_Macro()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">On</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Error</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Resume</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Next</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    Key$ = </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;HKEY_CURRENT_USER\Software\Microsoft\Office\&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;"> &amp; Application.Version &amp; _</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">           </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;\Excel\Security\&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' включаем программный доступ к объектной модели проекта VBA</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    CreateObject(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">).RegWrite Key$ &amp; </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;AccessVBOM&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, 1, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;REG_DWORD&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' ставим низкий уровень безопасности (применится после перезапуска Excel)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    CreateObject(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">).RegWrite Key$ &amp; </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;VBAWarnings&quot;</span><span style=" font-family:'Courier New'; font-size:10pt;">, 1, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#800000;">&quot;REG_DWORD&quot;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">End</span><span style=" font-family:'Courier New'; font-size:10pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#000080;">Sub</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">После выполнения этого макроса, уровень безопасности в Excel будет изменен на «низкий» (при следующем запуске Excel), и уведомления об отключенных макросах (с предложением их включить) появляться не будут.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">PS: C одной стороны, нехорошо без уведомления пользователя изменять настройки безопасности его программ.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Но, с другой стороны, макровирусов давно нет, а я сам не пишу вредоносные программы, так что считаю использование такого макроса допустимым.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:8.25pt;"><br /></p></body></html>