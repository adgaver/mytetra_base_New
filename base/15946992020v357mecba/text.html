<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">As Power Query records the transformation steps, it includes many hardcoded values within the M code.  For example, if we filter a column to select all values greater than 50, the 50 will be a hardcoded value in the M code.  Or if we import a CSV file, the file path is hardcoded into the query. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ezoic-pub-ad-placeholder-109"></a><span style=" font-family:'MS Shell Dlg 2';">W</span><span style=" font-family:'MS Shell Dlg 2';">hat if we want to change these values or file paths?  Obviously, we could </span><a href="https://exceloffthegrid.com/power-query-edit-queries/"><span style=" font-family:'MS Shell Dlg 2'; text-decoration: underline; color:#0000ff;">edit the query each time</span></a><span style=" font-family:'MS Shell Dlg 2';">, which would be very time-consuming.  Or, we could create parameters. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The term “Parameter” may be a bit confusing.  We use the term </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">variable</span><span style=" font-family:'MS Shell Dlg 2';"> when writing VBA, or maybe the terms </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">conditions,</span><span style=" font-family:'MS Shell Dlg 2';"> criteria or </span><span style=" font-family:'MS Shell Dlg 2'; font-style:italic;">arguments</span><span style=" font-family:'MS Shell Dlg 2';"> when writing Excel formulas, these are all effectively the same thing.  Parameters, variables, conditions, criteria and arguments are all values we can change to get a different output.  Microsoft decided to use the term Parameter when designing  Power Query. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">In this post, we will be using cells values as parameters; therefore, by changing the cell value we can change the result of a query.  The parameter could be contained within a CSV file, or as a database setting.  But we’ll focus on the situation you’re most likely to encounter, which is a cell value. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">As Power Query develops, new and easier to use features are introduced.  Parameters are one of those developing features.  The method I want to show you I believe is currently the easiest and best to implement. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:x-large; font-weight:600;">Download the example files</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">It may be tempting just to read the text below, but you will retain the information much better if you work along with the examples. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Subscribers can download the files from the </span><a href="https://exceloffthegrid.com/downloads/"><span style=" font-family:'MS Shell Dlg 2'; text-decoration: underline; color:#0000ff;">Downloads section</span></a><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">All the examples in this post use </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Example 8 – Using Parameters.xlsx</span><span style=" font-family:'MS Shell Dlg 2';"> from the downloads. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The Excel workbook contains the source data only.  We will work through all the steps from start to finish.  Open the up the file and let’s get going. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:x-large; font-weight:600;">Create the query</span><a name="ezoic-pub-ad-placeholder-110"></a><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The first step is to create a query as normal.  As noted, above, all the steps will be hardcoded. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Select any cell in the source table and click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Data -&gt; From Table/Range</span><span style=" font-family:'MS Shell Dlg 2';"> from the ribbon. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The Power Query editor will open.  Make the following transformations </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Date column</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Click on the </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Date and Time</span><span style=" font-family:'MS Shell Dlg 2';"> icon next to the </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Date</span><span style=" font-family:'MS Shell Dlg 2';"> header, select </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Date</span><span style=" font-family:'MS Shell Dlg 2';"> from the menu. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Select the Date column header, then click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Transform -&gt; Date -&gt; Month -&gt; End Of Month</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Filter the Date column to only include 31 January 2019.  The date format may appear different depending on your location settings. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Ensure the Date column is still selected, then click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Home -&gt; Remove Columns</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Sold By column</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">On the Sold By column, click on the filter icon and ensure only </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">David</span><span style=" font-family:'MS Shell Dlg 2';"> is selected. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">With the Sold By column still selected, click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Home -&gt; Remove Columns</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">That’s enough transformations for now.  Click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Home -&gt; Close and Load</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The Table should look like this: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">From the source data we created a Table which shows the products sold by David in January 2019.  But what if we want the products sold by Sally in March 2019, or Mark in March 2019?  This is where the parameters come in.  In the next section, we will create some parameters to dynamically change the name and date. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:x-large; font-weight:600;">Create the parameters</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">As a simple explanation, a parameter is just a normal query, in which we drill down into the value itself and</span><a href="https://exceloffthegrid.com/power-query-close-load-options/"><span style=" font-family:'MS Shell Dlg 2'; text-decoration: underline; color:#0000ff;"> load as a connection</span></a><span style=" font-family:'MS Shell Dlg 2';">.</span><a name="ezoic-pub-ad-placeholder-112"></a><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">In this example, we will be using an Excel Table as the source, but it could equally be in named range, CSV, or any other data source we can get into Power Query. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">On the worksheet which contains the query output table, create two tables with single values in them: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">After creating each Table, I have renamed them. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The first Table I have named </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Date</span><span style=" font-family:'MS Shell Dlg 2';">, and the second </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">SoldBy</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:large; font-weight:600;">Creating a Text parameter</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">First, we will create the parameter to change the name. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Select the cell in the SoldBy table and create a query, by clicking </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Data -&gt; From Table/Range</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Pay close attention to the data type.  The Sold By column in the original query above is a text data type, and the data type in this query is also text.  We need these to be identical. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Within Power Query </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">right-click on the value</span><span style=" font-family:'MS Shell Dlg 2';"> and select </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Drill Down</span><span style=" font-family:'MS Shell Dlg 2';"> from the menu. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The window will change to a view we have not seen before, the </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Text Tools</span><span style=" font-family:'MS Shell Dlg 2';"> window: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Make a note of the query name, which is </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">SoldBy </span><span style=" font-family:'MS Shell Dlg 2';">(no space), as shown in the screenshot above. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">File -&gt; Close and Load To…</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">From the </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Import Data</span><span style=" font-family:'MS Shell Dlg 2';"> window select </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Only Create Connection</span><span style=" font-family:'MS Shell Dlg 2';">, then click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">OK</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">The Queries &amp; Connection menu will now show two queries, the original data, called Sales Data, and the text parameter called SoldBy. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:large; font-weight:600;">Creating the Date parameter</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">OK, let’s go through the same steps again, for the Date parameter.  Compared to the text parameter we created above, there is one additional step we need to make.  In the original query, the Date column had a date type at the point it was filtered, therefore we need a date type for the parameter too. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">After changing the </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Date</span><span style=" font-family:'MS Shell Dlg 2';"> column to a </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">date type</span><span style=" font-family:'MS Shell Dlg 2';">, </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">right-click</span><span style=" font-family:'MS Shell Dlg 2';"> on the value and click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Drill Down</span><span style=" font-family:'MS Shell Dlg 2';">.  Rather than Text Tools, it will be the </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">DateTime Tools</span><span style=" font-family:'MS Shell Dlg 2';"> view. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ezoic-pub-ad-placeholder-113"></a><span style=" font-family:'MS Shell Dlg 2';">M</span><span style=" font-family:'MS Shell Dlg 2';">ake a note of the query name, which is Date in this scenario. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">As before, click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Close &amp; Load To…</span><span style=" font-family:'MS Shell Dlg 2';"> then select </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Create Connection Only</span><span style=" font-family:'MS Shell Dlg 2';"> and click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">OK</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">We should now have two parameters created, SoldBy as a text type and Date as a date type. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:x-large; font-weight:600;">Insert the parameters into the query</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Having created the parameters, let’s use them.  To do this, we are going to make some basic changes to the M code.  We could use the Advanced Editor, or the Formula Bar.  To keep things simple, I’ll use the Formula Bar for this example. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:11.5pt; font-weight:600; color:#ff0000;">Important information: M code is case sensitive (SoldBy and soldby are not the same).</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Open the original query (the SalesData query in our example). </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">If the Formula Bar is not visible, click</span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;"> View -&gt; Formula Bar</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Find the step where we hardcoded the value </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">David</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Replace </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">“David”</span><span style=" font-family:'MS Shell Dlg 2';"> for the parameter </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">SoldBy</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">= Table.SelectRows(#&quot;Removed Columns&quot;, each ([Sold By] = </span><span style=" font-family:'Courier New'; font-weight:600;">&quot;David&quot;</span><span style=" font-family:'Courier New';">))</span><span style=" font-family:'DejaVu LGC Sans';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">becomes: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">= Table.SelectRows(#&quot;Removed Columns&quot;, each ([Sold By] = </span><span style=" font-family:'Courier New'; font-weight:600;">SoldBy</span><span style=" font-family:'Courier New';">))</span><span style=" font-family:'DejaVu LGC Sans';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Next, we will apply the Date parameter.  Find the step where we hardcoded 31 January 2019 as the date. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Replace </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">#date(2019, 1, 31)</span><span style=" font-family:'MS Shell Dlg 2';"> for the parameter </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Date</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">= Table.SelectRows(#&quot;Changed Type1&quot;, each ([Date] = </span><span style=" font-family:'Courier New'; font-weight:600;">#date(2019, 1, 31)</span><span style=" font-family:'Courier New';">))</span><span style=" font-family:'DejaVu LGC Sans';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">becomes </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">= Table.SelectRows(#&quot;Changed Type1&quot;, each ([Date] = </span><span style=" font-family:'Courier New'; font-weight:600;">Date</span><span style=" font-family:'Courier New';">))</span><span style=" font-family:'DejaVu LGC Sans';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">That’s all there is, we have now applied the parameters.  Click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Home -&gt; Close &amp; Load</span><span style=" font-family:'MS Shell Dlg 2';"> to load the changes into Excel. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:x-large; font-weight:600;">Using the parameter</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Now that we are back in Excel, we can change the Date and Sold By cell values, then click </span><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Data -&gt; Refresh All</span><span style=" font-family:'MS Shell Dlg 2';">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">Wow! Magic eh?  The query updates to show only the values for the parameters we have selected. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">You can now set-up any Power Query hardcoded value as a parameter.  I find the most useful things to set-up as parameters are: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">File paths to import external data files </li>
<li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Period end dates for financial reports </li>
<li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Names of business divisions or cost centers to create reports for specific areas only </li>
<li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Any settings another user is likely to need to change </li></ul>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><span style=" font-family:'MS Shell Dlg 2'; font-size:x-large; font-weight:600; background-color:#eeeeee;">Power Query Series Contents</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-introduction/"><span style=" text-decoration: underline; color:#0000ff;">Introduction</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-import-data/"><span style=" text-decoration: underline; color:#0000ff;">Import Data</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-data-refresh/"><span style=" text-decoration: underline; color:#0000ff;">Data Refresh</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-edit-queries/"><span style=" text-decoration: underline; color:#0000ff;">Edit Queries</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-close-load-options/"><span style=" text-decoration: underline; color:#0000ff;">Close &amp; Load Options</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-using-parameters/"><span style=" text-decoration: underline; color:#0000ff;">Using Parameters</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-basic-transformations/"><span style=" text-decoration: underline; color:#0000ff;">Basic Transformations</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-combine-append-queries/"><span style=" text-decoration: underline; color:#0000ff;">Combine / Append Queries</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-import-all-files-in-a-folder/"><span style=" text-decoration: underline; color:#0000ff;">Import All Files in a Folder</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-file-attributes/"><span style=" text-decoration: underline; color:#0000ff;">List All the Files in a Folder and File Attributes</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-import-data-from-the-current-workbook/"><span style=" text-decoration: underline; color:#0000ff;">Import Data from the Current Workbook</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-import-data-from-the-web/"><span style=" text-decoration: underline; color:#0000ff;">Import Data from the Web</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-unpivot-data/"><span style=" text-decoration: underline; color:#0000ff;">Unpivot Data</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-unstacking-data-in-a-column/"><span style=" text-decoration: underline; color:#0000ff;">Unstacking Data in a Column</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-lookup-values-using-merge/"><span style=" text-decoration: underline; color:#0000ff;">Lookup Values using Merge</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-source-data-location/"><span style=" text-decoration: underline; color:#0000ff;">Change the Source Data Location</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-formulas/"><span style=" text-decoration: underline; color:#0000ff;">Formulas</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-if-statements"><span style=" text-decoration: underline; color:#0000ff;">If Statements for Conditional Logic</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-group-by/"><span style=" text-decoration: underline; color:#0000ff;">Grouping and Summarizing Data</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-custom-functions/"><span style=" text-decoration: underline; color:#0000ff;">Custom Functions</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-common-errors/"><span style=" text-decoration: underline; color:#0000ff;">Common Errors &amp; How to Fix Them</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; background-color:#eeeeee;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://exceloffthegrid.com/power-query-tips-and-tricks/"><span style=" text-decoration: underline; color:#0000ff;">Tips and Tricks</span></a> </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-weight:600;">Don’t forget:</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">If you’ve found this post useful, or if you have a better approach, then please leave a comment below. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:14pt; font-weight:600;">Do you need help adapting this to your needs?</span><span style=" font-family:'MS Shell Dlg 2';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">I’m guessing the examples in this post didn’t exactly meet your situation.  We all use Excel differently, so it’s impossible to write a post that will meet everybody’s needs.  By taking the time to understand the techniques and principles in this post (and elsewhere on this site) you should be able to adapt it to your needs. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">But, if you’re still struggling you should: </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Read other blogs, or watch YouTube videos on the same topic.  You will benefit much more by discovering your own solutions. </li>
<li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ask the ‘Excel Ninja’ in your office.  It’s amazing what things other people know. </li>
<li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ask a question in a forum like <a href="https://www.mrexcel.com/forum/index.php"><span style=" text-decoration: underline; color:#0000ff;">Mr Excel</span></a>, or the <a href="https://answers.microsoft.com/"><span style=" text-decoration: underline; color:#0000ff;">Microsoft Answers Community</span></a>.  Remember, the people on these forums are generally giving their time for free.  So take care to craft your question, make sure it’s clear and concise.  List all the things you’ve tried, and provide screenshots, code segments and example workbooks. </li>
<li style=" font-family:'MS Shell Dlg 2';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Use <a href="https://exceloffthegrid.com/need-help/"><span style=" text-decoration: underline; color:#0000ff;">Excel Rescue</span></a>, who are my consultancy partner.   They help by providing solutions to smaller Excel problems. </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">What next?<br />Don’t go yet, there is plenty more to learn on Excel Off The Grid.  Check out the latest posts: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2';">  </span></p></body></html>