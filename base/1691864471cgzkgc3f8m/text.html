<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Option</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Explicit</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Константы для параметра ItemType процедуры CreateTOCShape</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Public</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Const</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_General </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Public</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Const</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_Return </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">2</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Public</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Const</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Ver </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;0.01&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Процедура CreateTOCShape создает элемент оглавления</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Параметры:</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'   parText   - текст внутри фигуры (для ItemType=1 совпадает с именем листа!)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'   parL      - позиция от левого края</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'   parT      - позиция от верхнего края</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'   parW      - ширина фигуры</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'   parH      - высота фигуры</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'   ItemType  - тип фигуры (1 - указатель на лист, 2 - указатель на оглавление)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'   AutoSize  - автоопределение ширины</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Private</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Function</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> CreateTOCShape</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">parText </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">String</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                                parL </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                                parT </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                                parW </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                                parH </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                                ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Byte</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                                AutoSize </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Boolean</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Shape</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Создаём фигуру</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ActiveSheet.Shapes.AddShape</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">msoShapeRoundedRectangle</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parL</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parT</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parW</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parH</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  shpTemp.Line.Visible </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoTrue</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' толщина линии в зависимости от ItemType</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_General </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.Line.Weight </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">3</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">ElseIf</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_Return </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.Line.Weight </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1.5</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  shpTemp.Shadow.Type </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoShadow21 </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' тень</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  shpTemp.TextFrame2.VerticalAnchor </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoAnchorMiddle</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' текст в зависимости от ItemType</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_General </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.TextFrame2.TextRange.Text </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parText</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">ElseIf</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_Return </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.TextFrame2.TextRange.Text </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;Оглавление&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' автоопределение ширины</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> AutoSize </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.TextFrame2.AutoSize </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoAutoSizeShapeToFitText</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.TextFrame2.WordWrap </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoFalse</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Else</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.TextFrame2.AutoSize </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoAutoSizeNone</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    shpTemp.TextFrame2.WordWrap </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoTrue</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' цветовая схема и размер шрифта</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">With</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp.TextFrame2.TextRange.Font</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Fill.ForeColor.ObjectThemeColor </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> msoThemeColorLight1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_General </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Size </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">16</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">ElseIf</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_Return </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Size </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">11</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">With</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Создание гиперссылки на созданной фигуре</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  ActiveSheet.Hyperlinks.Add Anchor</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">:=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">shpTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Address</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">:=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    SubAddress</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">:=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;'&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parText </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;'!A1&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> TextToDisplay</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">:=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Фигура для обратных ссылок получает имя TOC, чтобы её можно было удалить адресно</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ItemType </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_Return </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp.Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;TOC&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Возврат имени созданной фигуры</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  CreateTOCShape </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp.Name</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Function</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Удаление всех фигур на листе. Будьте очень осторожны, так как сносит ВСЁ +</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' элементы управления тоже.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Private</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ClearShapes</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">parWS </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Worksheet</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parWS.Shapes.Count </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">0</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    parWS.Shapes.SelectAll</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    Selection.ShapeRange.Delete</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Удаление фигуры с определенным именем</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Private</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> DeleteShapesWithName</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">parWS </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Worksheet</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parName </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">String</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Shape</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Each</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">In</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parWS.Shapes</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> shpTemp.Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> parName </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      shpTemp.Delete</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Exit</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Основная процедура для создания оглавления</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">'-------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Создать_оглавление</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Const</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MyHeight </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">31</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">   </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' стандартная высота фигур оглавления</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Const</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MyGap </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">10</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' стандартный промежуток между фигурами</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> strMaxLenName </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">String</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> strShape </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> intMaxLen </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> intWidth </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MaxHeight </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MaxWidth </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> TOC_Rows </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> j </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> curRow </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> curCol </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> wsTemp </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Worksheet</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> strTOC </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  ClearShapes ActiveSheet </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Очистка всех фигур на текущем листе</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Выход, если в книге лишь один лист</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets.Count </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    MsgBox </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;В книге только один лист!&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> vbInformation</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Exit</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Определение самого длинного имени листа среди имеющихся</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  intMaxLen </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">0</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  strMaxLenName </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Each</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> wsTemp </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">In</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Len</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">wsTemp.Name</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> intMaxLen </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">And</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> wsTemp.Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&lt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ActiveSheet.Name </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      intMaxLen </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Len</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">wsTemp.Name</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      strMaxLenName </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> wsTemp.Name</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Создаём для этого листа фигуру, чтобы определить её ширину и применить потом ко всем</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  strShape </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> CreateTOCShape</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">strMaxLenName</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">10</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">10</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">150</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MyHeight</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_General</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">True</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  intWidth </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ActiveSheet.Shapes</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">strShape</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Width </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' вот эта ширина</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  intWidth </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> intWidth </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> intWidth </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">\</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">10</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' небольшой запас, т.к. шрифты непропорциональные</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  ActiveSheet.Shapes</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">strShape</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Delete </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' удаляем тестовую фигуру</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' сколько элементов оглавления можно разместить по высоте</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  TOC_Rows </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ActiveWindow.UsableHeight </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">\</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">MyHeight </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MyGap</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' если полученное число меньше, чем имеется листов, то усекаем её</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets.Count </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&lt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> TOC_Rows </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> TOC_Rows </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets.Count </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' массив для имён листов, для которых надо создавать элементы оглавления</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">ReDim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> arrTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Sheets.Count </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">2</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  j </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">0</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">To</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets.Count </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' перебираем все листы</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Текущий лист пропускаем, так как на нём и будет располагаться оглавление</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ActiveSheet.Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&lt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Name </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      arrTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">j</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Name </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' запоминаем имя</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      j </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> j </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' из-за лишнего листа приходится задействовать независимый счётчик j</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' цикл по созданному массиву для формирования элементов оглавления</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> LBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">arrTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">To</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> UBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">arrTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    curRow </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Mod</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> TOC_Rows </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' номер элемента по вертикали (с нуля)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    curCol </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">\</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> TOC_Rows   </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' номер столбца элемента</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' создаём фигуру</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    strShape </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> CreateTOCShape</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                  arrTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                  curCol </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">*</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">MyGap </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> intWidth</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MyGap</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                  curRow </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">*</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">MyGap </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MyHeight</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> MyGap</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                  intWidth</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                  MyHeight</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                  dsb_TOC_General</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">                  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">False</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' Создаём на каждом листе обратные ссылки на оглавление</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  strTOC </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> ActiveSheet.Name</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">1</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">To</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets.Count</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> Sheets</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">&lt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> strTOC </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      Sheets</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Activate</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      DeleteShapesWithName ActiveSheet</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080; background-color:#ffffff;">&quot;TOC&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">      strShape </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> CreateTOCShape</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">strTOC</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">700</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">5</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">50</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000; background-color:#ffffff;">31</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> dsb_TOC_Return</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">True</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  Sheets</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">strTOC</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">Activate </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' возвращаемся на лист оглавления</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000; background-color:#ffffff;">' отключаем для красоты заголовки и сетку</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  ActiveWindow.DisplayGridlines </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">False</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;">  ActiveWindow.DisplayHeadings </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">False</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff; background-color:#ffffff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000; background-color:#ffffff;"> </span> </p></body></html>