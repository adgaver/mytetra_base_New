<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Чтение и запись в реестр Windows в произвольную ветку можно произвести при помощи функций объекта </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">WScript.Shell:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">RegRead </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">и </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">RegWrite</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Первая функция возвращает значение, считанное из реестра, вторая - записывает заданное значение в реестр.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">При попытке считать несуществующий параметр возникает ошибка,<br />обойти которую нам поможет директива </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">On Error Resume Next </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Пара функций для примера:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">(получаем настройки программы из реестра Windows)</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Function</span><span style=" font-family:'monospace'; font-size:9pt;"> DefaultMailAccount() </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' читает из реестра настройки почтового ящика,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' установленного в TheBAT! как &quot;ящик по-умолчанию&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' возвращает адрес почты, или пустую строку, если TheBAT! не настроен</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">On</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Error</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Resume</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:9pt;">: Err.Clear</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    key$ = </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;HKEY_CURRENT_USER\Software\RIT\The Bat!\Users depot\Default&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    DefaultMailAccount = CreateObject(</span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'monospace'; font-size:9pt;">).RegRead(key$)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Function</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Function</span><span style=" font-family:'monospace'; font-size:9pt;"> ПутьКФайлуПрограммыTheBAT() </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' читает из реестра путь к исполняемому файлу программы TheBAT!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' возвращает путь к файлу, или пустую строку, если TheBAT! не установлен</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">On</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Error</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Resume</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:9pt;">: Err.Clear</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    key$ = </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;HKEY_CURRENT_USER\Software\RIT\The Bat!\EXE path&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    ПутьКФайлуПрограммыTheBAT = CreateObject(</span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'monospace'; font-size:9pt;">).RegRead(key$)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Function</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:9pt;"> TheBAT_MailBoxes()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' макрос выводит список всех почтовых ящиков, настроенных в программе TheBAT!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">On</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Error</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Resume</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:9pt;">: Err.Clear</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">With</span><span style=" font-family:'monospace'; font-size:9pt;"> CreateObject(</span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'monospace'; font-size:9pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">        </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:9pt;"> i = 1 </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">To</span><span style=" font-family:'monospace'; font-size:9pt;"> 100</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            key$ = </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;HKEY_CURRENT_USER\Software\RIT\The Bat!\Users depot\User #&quot;</span><span style=" font-family:'monospace'; font-size:9pt;"> &amp; i</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            Err.Clear: mailBox$ = .RegRead(key$)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:9pt;"> Err = 0 </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:9pt;"> Debug.</span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Print</span><span style=" font-family:'monospace'; font-size:9pt;"> mailBox$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">        </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:9pt;"><br /></p></td>
<td></td></tr></table></body></html>