<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Как правильно использовать net use?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Сделал bat-файл для подключения сетевых дисков:<br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">@ECHO OFF</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">net use * /delete /yes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">net use x: \\192.168.10.6\фото-видео /user:admin admin /Persistent:Yes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">net use y: \\192.168.10.6\share /Persistent:Yes</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">net use z: \\192.168.10.6\students /Persistent:Yes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />получилось то, что на скрине: <br /><br />Отсюда несколько вопросов:<br />1. диск x: имеет название &quot;ФОТО&quot;. Откуда он его взял? Почему не &quot;фото-видео (\\192.168.10.6\)&quot;<br />2. диски y: и z: называются одинаково, но ведут в разные папки. Почему? как сделать разные названия - &quot;share&quot; и &quot;students&quot; соответственно? </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вопрос задан более года назад </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">713 просмотров </li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://qna.habr.com/#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Подписаться 2 </span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Простой </span><a href="javascript:void(0)"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Комментировать </span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="solutions"></a><span style=" font-size:8.25pt; font-weight:600;">Р</span><span style=" font-size:8.25pt; font-weight:600;">ешения вопроса 2 </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://qna.habr.com/user/Moskus"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Moskus</span></a><span style=" font-size:8.25pt;"> @Moskus </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Ответ очень простой.<br />Потому что название диска никак не связано с тем, какой до него путь. Оно связано с тем, какое имя вы дали этому общему ресурсу, когда вы его создавали на том хосте, где он расположен. Скриншот их WinXP, но принципиальной разницы нет.<br /><br />Вот если вы там вместо share (по умолчанию) напишете что-то другое, оно будет отображаться иначе, чем сейчас. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Ответ написан </span><a href="https://qna.habr.com/answer?answer_id=1276784#answers_list_answer"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">более года назад </span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:void(0);"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Нравится </span></a><a name="reply_answer_comment_link_1276784"></a><a href="https://qna.habr.com/answer?answer_id=1276784#comments_list_1276784"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">3</span></a><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;"> </span><a href="https://qna.habr.com/answer?answer_id=1276784#comments_list_1276784"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">комментария </span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://qna.habr.com/user/drsmoll"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Serg New</span></a><span style=" font-size:8.25pt;"> @drsmoll </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Это Я. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Можно так:<br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">Dim oShell, objFSO, WshNetwork</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">Set oShell = CreateObject(&quot;Shell.Application&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">Set WshNetwork = CreateObject(&quot;WScript.Network&quot;) </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">MapDrv &quot;Z:&quot;, &quot;\\server\share&quot;,&quot;Share description&quot;, &quot;username&quot;, &quot;password&quot; 'Буква диска, путь с шаре, описание</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">Function MapDrv(DrvLet, UNCPath, DrvName, Uname, Upass)  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    If objFSO.DriveExists(DrvLet) Then  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">        WshNetwork.RemoveNetworkDrive DrvLet, true, true</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    Wscript.Sleep 1000</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    WshNetwork.MapNetworkDrive DrvLet, UNCPath, false, Uname, Upass</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">    oShell.NameSpace(DrvLet).Self.Name = DrvName</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:8.25pt;">End Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />UPD: Если ничего не напутал<br />Syntax <br />objNetwork.MapNetworkDrive(strLocalDrive, strRemoteShare, [persistent], [strUser], [strPassword]) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Ответ написан </span><a href="https://qna.habr.com/answer?answer_id=1276825#answers_list_answer"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">более года назад </span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:void(0);"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Нравится </span></a><a name="reply_answer_comment_link_1276825"></a><a href="https://qna.habr.com/answer?answer_id=1276825#comments_list_1276825"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">5</span></a><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;"> </span><a href="https://qna.habr.com/answer?answer_id=1276825#comments_list_1276825"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">комментариев </span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="solutions"></a><a href="https://qna.habr.com/#"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">П</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">ригласить эксперта </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="answers"></a><span style=" font-size:8.25pt; font-weight:600;">О</span><span style=" font-size:8.25pt; font-weight:600;">тветы на вопрос 1 </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://qna.habr.com/user/Francyz"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Sergey Ryzhkin</span></a><span style=" font-size:8.25pt;"> @Francyz </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Photographer &amp; SysAdmin </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">net use - не может давать псевдонимы подключаемым дискам. У вас просто прописывается сетевой пусть и назначается буква. Чтобы отображалось другое имя, его нужно указывать в свойствах шары.<br />Либо подключать диски через GPO там есть возможность указывать как будет отображаться данная папка/диск/ярлык. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Ответ написан </span><a href="https://qna.habr.com/answer?answer_id=1276790#answers_list_answer"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">более года назад</span></a><span style=" font-size:8.25pt; color:#000000;"> </span></p></body></html>