<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Определение страны по IP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">адресу        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">При сборе статистики посещения web</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">страниц часто собирается информация о количестве посетителей из разных стран</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Как правило</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> страну определяют по домену первого уровня</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Но такая информация не всегда соответствует действительности</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> особенное учитывая нынешнюю тендецию использовать национальные домены co</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> tv не по назначению</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Кроме того</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> как быть с доменами общего пользования net</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> org</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> com и др</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.?</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> С IP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">адресами</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> для которых нет записей в реверсной зоне</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">?</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Ну и</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> наконец</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> определение доменного имени отнимает заметное количество времени</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Приведенный в статье код распространяется под лицензией в стиле Python</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> то есть может быть использован для любых </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">в том числе коммерческих целей</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> при условии сохранения замечания об авторском праве Copyright © </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">2002</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Denis S</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Otkidach </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&lt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ods</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">@</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ods</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">pp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ru</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Данные о регистрации диаппазонов IP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">адресов хранятся в базах данных whois</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Чтобы предоставить возможность общественности анализировать трафик</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> RIPE NCC</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> ARIN и APNIC не реже</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> чем раз в месяц</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> делают сокращенные </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;снимки&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> своих баз данных</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Именно из этих данных мы и составим локальную базу</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Но сначала нужно эффективно оргазовать хранение данных для диаппазонов IP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">адресов</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> чтобы обеспечить к ним быстрый доступ</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> За основу возмем BTree базу BerkleyDB</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> доступ к которой обеспечивает функция btopen</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> из стандартного модуля bsddb</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> В качестве ключей будем использовать начало диаппазона IP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">адресов</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> а в качестве значений — его конец и дополнительную информацию</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Ключи и значения в bsddb должны быть строками</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Кроме того</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> необходимо обеспечить упорядоченность ключей</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Для этого очень хорошо подходит функции inet_aton и inet_ntoa из модуля socket</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">from</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> bsddb </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">import</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> btopen</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">from</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> socket </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">import</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_aton</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_ntoa</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">class</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">IPRangeDB</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">__init__</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> filename</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> mode</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'r'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">__db </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> btopen</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">filename</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> mode</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">close</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">__db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">close</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">_locate</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">__db</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">try</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">set_location</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">except</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">KeyError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">try</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">except</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">KeyError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">raise</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">KeyError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">inet_ntoa</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">else</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">if</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">!=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">previous</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">assert</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&lt;=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">return</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">__getitem__</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> ip_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> ip </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_aton</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">_locate</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">4</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">assert</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">first</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">if</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&lt;=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">return</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">unpack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">record</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">4</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">else</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">raise</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">KeyError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">add</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> info</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_aton</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">first_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_aton</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">last_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">try</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db_first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">_locate</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">except</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">KeyError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">pass</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">else</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db_last </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> record</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">4</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">if</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&lt;=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">db_last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">raise</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">ValueError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'Range %s-%s intersects '</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">%</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">first_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">+</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'with existing entry %s-%s'</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">%</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">inet_ntoa</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">db_first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_ntoa</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">db_last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">__db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">pack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">info</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">pack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> info</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">return</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> info</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">unpack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> info</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">return</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> info</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Метод _locate</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> ищет запись с максимальной нижней границей</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> меньшей или равной IP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">адресу</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> переданному в качестве аргумента</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Метод __getitem__</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> позволяет использовать экземпляры класса IPRangeDB аналогично словарям</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> вернет информацию о диаппазоне</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> в который входит адрес ip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Использовать интерфейс словаря для записи врядли будет хорошей идеей</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> так как запись создается одна для всего диаппазона</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Чтобы избежать путаницы</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> добавление записей реализовано через метод add</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">().</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> И</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> наконец</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> пара методов pack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> и unpack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> определены</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> чтобы производный класс можно было легко адоптировать для хранения произвольной информации</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> метод pack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> должен преобразовывать объект в строку</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> IPRangeDB</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'test.db'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'c'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">add</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'10.0.0.0'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'10.255.255.255'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'Наша локальная сеть'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">print</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'10.1.2.3'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Наша локальная сеть</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">print</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'123.45.67.89'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Traceback </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">most recent call last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> File </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;&lt;stdin&gt;&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> line </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">in</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> File </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;ip2cc.py&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> line </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">38</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">in</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> __getitem__</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">raise</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">KeyError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">ip_str</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">KeyError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">123.45.67.89</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#ff0000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Осталось дело за малым</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> определить методы для наполнения базы данных</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">from</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> urllib </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">import</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> urlopen</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">from</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> xreadlines </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">import</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> xreadlines</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">from</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> time </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">import</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> strptime</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">import</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> struct</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">class</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">CountryByIP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">IPRangeDB</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> sources </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'arin'</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'ftp://ftp.arin.net/pub/stats/arin/'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'arin.%Y%m%d'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'ripencc'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'ftp://ftp.ripe.net/ripe/stats/'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'ripencc.%Y%m%d'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">),</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'apnic'</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'ftp://ftp.apnic.net/pub/stats/apnic/'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'apnic-%Y-%m-%d'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">fetch</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">for</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">in</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">sources</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> fp </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">__openRecent</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">name</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">for</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> line </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">in</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> xreadlines</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">fp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> parts </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> line</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">strip</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">().</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">split</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'|'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">if</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">len</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">parts</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)==</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">7</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">and</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> parts</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">2</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]==</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'ipv4'</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">and</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> parts</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">6</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">in</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'allocated'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'assigned'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">and</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> name</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">==</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">parts</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> parts</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">3</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first_int </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> struct</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">unpack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'!i'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_aton</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">))[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last_int </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> first_int</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">+</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">int</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">parts</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">4</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">])-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> inet_ntoa</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">struct</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">pack</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'!i'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last_int</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">try</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">add</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">first</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> last</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> parts</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">].</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">upper</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">except</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">ValueError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">pass</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">def</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff00ff;">__openRecent</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> name</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> uri</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">format</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> self</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">sources</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">name</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> files </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">for</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> line </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">in</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> xreadlines</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">urlopen</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">uri</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)):</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> file </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> line</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">split</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()[-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">try</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dt </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> strptime</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">file</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">format</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">except</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#880088;">ValueError</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">pass</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">else</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> files</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">append</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">((</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">dt</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> file</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> files</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">sort</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">return</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> urlopen</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">uri</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">files</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">][</span><span style=" font-family:'Courier New'; font-size:10pt; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Метод __openRecent находит самый свежий </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;снимок&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> и возвращает файловый объект</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Дата </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;снимка&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> определяется по имени файла по шаблону из словаря источников sources</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Метод fetch анализирует данные</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> выбирает необходимое и добавляет в базу</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Использование модуля xreadlines позволяет анализировать данные по мере поступления</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Теперь можно наполнить базу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> CountryByIP</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'test.db'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'n'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">fetch</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">и использовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">from</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> socket </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#0000ff;">import</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> gethostbyname</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">&gt;&gt;&gt;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> db</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">[</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">gethostbyname</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'python.org'</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">)]</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">'NL'</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#808080;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Преобразование кода A2 в название страны по таблице ISO3166 пусть останется вам в качестве упражнения</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000080;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span></p></body></html>