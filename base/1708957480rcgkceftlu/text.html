<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Raleway,sans-serif'; font-size:xx-large; font-weight:600; color:#313131; text-transform:uppercase;">POWER QUERY. ПОЛУЧИТЬ КОД ИЗ ТЕКСТА</span></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.8%;"><span style=" font-family:'PT Serif,serif'; font-size:15px; color:#313131;">Ссылки:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'PT Serif,serif'; font-size:15px; color:#313131;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://comrade-xl.ru/power-query-vars/"><span style=" text-decoration: underline; color:#0000ff;">Страница курса</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.youtube.com/playlist?list=PLdHSST5L9mqax3asMUU-STjopi8EPtghZ"><span style=" text-decoration: underline; color:#0000ff;">Плейлист YouTube</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vk.com/video/playlist/-185123800_10"><span style=" text-decoration: underline; color:#0000ff;">Плейлист ВК</span></a></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Raleway,sans-serif'; font-size:medium; font-weight:600; color:#313131;">Описание</span></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.8%;"><span style=" font-family:'PT Serif,serif'; font-size:15px; color:#313131;">Есть текстовый файл, в котором находится М-код, например, какой-то функции. Нужно подключиться к этому файлу и выполнить этот код.</span></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.8%;"><span style=" font-family:'PT Serif,serif'; font-size:15px; color:#313131;">Код может не обязательно должен находиться на вашем компьютере. Он может быть опубликован на какой-то веб-странице.</span></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Raleway,sans-serif'; font-size:medium; font-weight:600; color:#313131;">Решение</span></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.8%;"><span style=" font-family:'PT Serif,serif'; font-size:15px; color:#313131;">После подключения к текстовому файлу нужно убрать разбивку на столбцы и прочитать весь текст едиными куском.</span></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.8%;"><span style=" font-family:'PT Serif,serif'; font-size:15px; color:#313131;">Далее нужно воспользоваться функцией Expression.Evaluate. В качестве первого параметра передается сам текст, а в качестве второго «#shared».</span></p>
<p style=" margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Raleway,sans-serif'; font-size:medium; font-weight:600; color:#313131;">Код</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Первый способ подключения к текстовому файлу:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#c678dd;">let</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#313131; background-color:#eff0f1;">    Источник </span><span style=" font-family:'Consolas'; font-size:15px; color:#56b6c2;">=</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#313131; background-color:#eff0f1;">      </span><span style=" font-family:'Consolas'; font-size:15px; color:#61afef;">Text.FromBinary</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">(</span><span style=" font-family:'Consolas'; font-size:15px; color:#61afef;">File.Contents</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">(</span><span style=" font-family:'Consolas'; font-size:15px; color:#98c379;">&quot;Путь к файлу\Файл.txt&quot;</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#c678dd;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#313131; background-color:#eff0f1;">    Источник</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'PT Serif,serif'; font-size:10px; color:#313131;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Второй способ подключения к текстовому файлу:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#c678dd;">let</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#313131; background-color:#eff0f1;">    Источник </span><span style=" font-family:'Consolas'; font-size:15px; color:#56b6c2;">=</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#313131; background-color:#eff0f1;">      </span><span style=" font-family:'Consolas'; font-size:15px; color:#61afef;">Text.Combine</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">({</span><span style=" font-family:'Consolas'; font-size:15px; color:#61afef;">Lines.FromBinary</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">(</span><span style=" font-family:'Consolas'; font-size:15px; color:#61afef;">File.Contents</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">(</span><span style=" font-family:'Consolas'; font-size:15px; color:#98c379;">&quot;Путь к файлу\Файл.txt&quot;</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">))}{</span><span style=" font-family:'Consolas'; font-size:15px; color:#d19a66;">0</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">},</span><span style=" font-family:'Consolas'; font-size:15px; color:#313131;"> </span><span style=" font-family:'Consolas'; font-size:15px; color:#98c379;">&quot;#(lf)&quot;</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#c678dd;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#313131; background-color:#eff0f1;">    Источник</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'PT Serif,serif'; font-size:10px; color:#313131;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'PT Serif,serif'; font-size:10px; color:#313131;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запрос с подключением я назвал «txt». Теперь из этого текста получаем М-код.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:15px; color:#56b6c2;">=</span><span style=" font-family:'Consolas'; font-size:15px; color:#313131;"> </span><span style=" font-family:'Consolas'; font-size:15px; color:#61afef;">Expression.Evaluate</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">(</span><span style=" font-family:'Consolas'; font-size:15px; color:#313131;">txt</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">,</span><span style=" font-family:'Consolas'; font-size:15px; color:#313131;"> </span><span style=" font-family:'Consolas'; font-size:15px; color:#c678dd;">#shared</span><span style=" font-family:'Consolas'; font-size:15px; color:#abb2bf;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'PT Serif,serif'; font-size:10px; color:#313131;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:17px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Raleway,sans-serif'; font-size:medium; font-weight:600; color:#313131;"><br /></p></body></html>