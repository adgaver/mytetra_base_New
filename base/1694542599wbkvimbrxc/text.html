<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; font-weight:600;">VBA Excel. Метод FindNext объекта Range</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Метод Range.FindNext предназначен в VBA Excel для продолжения поиска ячеек в диапазоне по заданному условию, начатого методом Find. Пример использования.</span></p>
<p style=" margin-top:32px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-weight:600; color:#333333;">Содержание</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Metod_RangeFindNext"><span style=" text-decoration: underline; color:#0000ff;">1. Метод Range.FindNext</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Opisanie"><span style=" text-decoration: underline; color:#0000ff;">1.1. Описание</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Sintaksis"><span style=" text-decoration: underline; color:#0000ff;">1.2. Синтаксис</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Primer_ispolzovania"><span style=" text-decoration: underline; color:#0000ff;">2. Пример использования</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Uslovie"><span style=" text-decoration: underline; color:#0000ff;">2.1. Условие</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Resenie"><span style=" text-decoration: underline; color:#0000ff;">2.2. Решение</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Rezultat"><span style=" text-decoration: underline; color:#0000ff;">2.3. Результат</span></a></p>
<p style=" margin-top:2px; margin-bottom:0px; margin-left:14px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-findnext/#Rassifrovka"><span style=" text-decoration: underline; color:#0000ff;">2.4. Расшифровка</span></a></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Metod_RangeFindNext"></a><span style=" font-size:x-large; font-weight:600;">М</span><span style=" font-size:x-large; font-weight:600;">етод Range.FindNext</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Opisanie"></a><span style=" font-size:large; font-weight:600;">О</span><span style=" font-size:large; font-weight:600;">писание</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Метод <a href="https://vremya-ne-zhdet.ru/vba-excel/metod-range-find/"><span style=" text-decoration: underline; color:#0000ff;">Range.Find</span></a> находит первую ячейку в заданном диапазоне по точному или частичному совпадению условия поиска с ее значением, формулой или примечанием. На этом работа метода <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Find</span> заканчивается. При новом запуске он найдет ту же ячейку.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Что делать, если в диапазоне есть еще ячейки, соответствующие условию поиска, и их тоже необходимо найти?</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_1_host"></a>Для этих целей предназначен метод <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Range.FindNext</span>. Он продолжает в диапазоне поиск следующей ячейки, соответствующей условию, заданному в предыдущей строке с методом <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Find</span>. Для того, чтобы найти все такие ячейки, метод <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">FindNext</span> повторяется с помощью одного из <a href="https://vremya-ne-zhdet.ru/vba-excel/tsikly/"><span style=" text-decoration: underline; color:#0000ff;">циклов</span></a> VBA Excel.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Sintaksis"></a><span style=" font-size:large; font-weight:600;">С</span><span style=" font-size:large; font-weight:600;">интаксис</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,Arial,sans'; font-size:12px; font-weight:496; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d86293434986"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#5499de;">1</span></p></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d86293434986-1"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">E</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">xpression</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">FindNext</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">After</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span></p></td></tr></table>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" background-color:#c8fbc8;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Expression</span> – выражение (переменная), возвращающее объект Range, в котором осуществляется поиск.</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">After</span> – необязательный аргумент, представляющий из себя единственную ячейку диапазона, после которой начнется поиск. Если аргумент не указан, поиск начнется после левой верхней ячейки диапазона. В обоих случаях, ячейка по умолчанию (левая верхняя) или ячейка, заданная параметром After, в поиске не участвует.</li></ul>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Primer_ispolzovania"></a><span style=" font-size:x-large; font-weight:600;">П</span><span style=" font-size:x-large; font-weight:600;">ример использования</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Uslovie"></a><span style=" font-size:large; font-weight:600;">У</span><span style=" font-size:large; font-weight:600;">словие</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В таблице с названиями басен необходимо выбрать басни, в названия которых входит слово Лев:</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Resenie"></a><span style=" font-size:large; font-weight:600;">Р</span><span style=" font-size:large; font-weight:600;">ешение</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,Arial,sans'; font-size:12px; font-weight:496; background-color:#fdfdfd;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#dfefff" style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;"></td>
<td style=" vertical-align:top; padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-1"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">S</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">ub</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Primer</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-2"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">D</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">im</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myCell </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Range</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">adr </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">String</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">str </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">As</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-3"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">   </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">With</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Range</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;A1:C9&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-4"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Set</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Find</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Л?в&quot;</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">,</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">MatchCase</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">:=</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#ce0000;">1</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-5"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">           </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">If</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Not</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">myCell </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Is</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Nothing</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-6"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">               </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">str</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-7"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">               </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">adr</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Address</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-8"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">           </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-9"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">               </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#000000;">MsgBox</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#008000;">&quot;Ничего не найдено&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-10"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">               </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Exit</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-11"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">           </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">End</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-12"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-13"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">           </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Set</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">FindNext</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">(</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-14"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">               </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">If</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Not</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Address</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">adr </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-15"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">                   </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">str</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">str</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> &amp; </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">vbNewLine</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> &amp; </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-16"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">               </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">End</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-17"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;">       </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Loop</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Until</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">myCell</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#333333;">.</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#002d7a;">Address</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> = </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">adr</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-18"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">   </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">End</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-19"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">M</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">sgBox </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#004ed0;">str</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f7f7f7;"><a name="urvanov-syntax-highlighter-6500a3a3d2d96580914918-20"></a><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">E</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">nd</span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#006fe0;"> </span><span style=" font-family:'inherit'; font-size:12px; font-weight:496; color:#800080;">Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Rezultat"></a><span style=" font-size:large; font-weight:600;">Р</span><span style=" font-size:large; font-weight:600;">езультат</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Rassifrovka"></a><span style=" font-size:large; font-weight:600;">Р</span><span style=" font-size:large; font-weight:600;">асшифровка</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Объявляем переменные:<br /><span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Dim myCell As Range, adr As String, str As String</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" background-color:#e6e6fa;" style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">myCell</span> – объектная переменная, которой присваивается ссылка на ячейку, найденную методами <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Find</span> и <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">FindNext</span>;</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">adr</span> – адрес первой найденной ячейки, который нужен для остановки цикла после однократного прохождения по ячейкам указанного диапазона;</li>
<li style=" margin-top:10px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">str</span> – в эту переменную записывается содержимое найденных ячеек.</li></ul>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_2_host"></a>2. Ищем первую ячейку со словом Лев в диапазоне <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Range(&quot;A1:C9&quot;)</span> и присваиваем ссылку на нее переменной <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">myCell</span>:<br /><span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Set myCell = .Find(&quot;Л?в&quot;, MatchCase:=1)</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В искомой строке («Л?в») используем подстановочный знак (?), который заменяет любую букву, чтобы найти слова с корнями «Лев» и «Льв».</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как животные в названиях басен пишутся с заглавной буквы, в искомой строке тоже используем заглавную букву и поиск с учетом регистра (<span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">MatchCase:=1</span>), чтобы не были найдены ячейки со словами «п<span style=" font-weight:600;">лов</span>«, «к<span style=" font-weight:600;">лав</span>иатура» и т.д. Хотя ячейки со словами «<span style=" font-weight:600;">Лев</span>ша», «<span style=" font-weight:600;">Лав</span>ка» и подобные, начинающиеся с большой буквы, будут найдены.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3. Если переменная <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">myCell</span> не содержит <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Nothing</span>, значит первая ячейка с искомой строкой найдена. Присваиваем ее значение переменной <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">str</span>, а ее адрес – переменной <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">adr</span>.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_3_host"></a>Если переменная <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">myCell</span> содержит <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Nothing</span>, выводим сообщение «Ничего не найдено» и завершаем процедуру (<span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Exit Sub</span>).</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_4_host"></a>4. С помощью цикла <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Do...Loop Until...</span> и метода <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">FindNext</span> находим в диапазоне все остальные ячейки, соответствующие критерию поиска, заданному в строке с методом <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Find</span>. Добавляем содержимое найденных ячеек в переменную <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">str</span>.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переменная <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">myCell</span> используется повторно в течение всей работы цикла: <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">Set myCell = .FindNext(myCell)</span>.</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Цикл и добавление значений в переменную <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">str</span> завершаются при возврате в первоначально найденную ячейку, адрес которой мы записали (используем условие <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">myCell.Address = adr</span>).</p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">5. По окончании работы цикла выводим содержимое переменной <span style=" font-family:'Courier New'; color:#333333; background-color:#d0effb;">str</span> в информационном окне <a href="https://vremya-ne-zhdet.ru/vba-excel/funktsiya-msgbox-parametry/"><span style=" text-decoration: underline; color:#0000ff;">MsgBox</span></a>.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#e6e6fa;"><a href="https://vremya-ne-zhdet.ru/vba-excel/soderzhaniye-rubriki/"><span style=" text-decoration: underline; color:#0000ff;">Содержание рубрики VBA Excel</span></a> по тематическим разделам со ссылками на все статьи.</p></body></html>