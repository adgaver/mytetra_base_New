<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Как средствами VBA переименовать/переместить/скопировать файл </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">В этой статье я хотел бы рассказать как средствами VBA переименовать, переместить или скопировать файл. В принципе методы переименования, перемещения и копирования, так сказать, встроены в VBA. Это значит что можно без вызова сторонних объектов переименовать, переместить или копировать любой файл. Все это делается при помощи всего двух команд: </span><a name="crayon-5a4ce6e51afb3522415049"></a><span style=" font-size:9pt;">F</span><span style=" font-size:9pt;">ileCopy и Name [Исходный файл] As [Новый файл]</span><span style=" font-size:9pt;">. Притом команда FileCopy выполняет только копирование, а </span><a name="crayon-5a4ce6e51afc5878922953"></a><span style=" font-size:9pt;">N</span><span style=" font-size:9pt;">ame [Исходный файл] As [Новый файл]</span><span style=" font-size:9pt;"> - как переименование, так и перемещение. Разница лишь в том, что при переименовании мы указываем только новое имя файла, а при перемещении - другую директорию(папку), в которую следует переместить файл. И в дополнение я приведу пример удаления файла. Теперь можно рассмотреть несложные примеры использования этих команд:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Копирование: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51afd1225592417"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Copy_File() Dim sFileName As String, sNewFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя файла для копирования sNewFileName = &quot;D:\WWW.xls&quot; 'имя копируемого файла. Директория(в данном случае диск D) должна существовать If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub FileCopy sFileName, sNewFileName 'копируем файл MsgBox &quot;Файл скопирован&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Copy_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String, sNewFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя файла для копирования</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sNewFileName = &quot;D:\WWW.xls&quot;    'имя копируемого файла. Директория(в данном случае диск D) должна существовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    FileCopy sFileName, sNewFileName 'копируем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл скопирован&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td>
<td></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Перемещение: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51afdd161022017"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Move_File() Dim sFileName As String, sNewFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя исходного файла sNewFileName = &quot;D:\WWW.xls&quot; 'имя файла для перемещения. Директория(в данном случае диск D) должна существовать If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub Name sFileName As sNewFileName 'перемещаем файл MsgBox &quot;Файл перемещен&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Move_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String, sNewFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя исходного файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sNewFileName = &quot;D:\WWW.xls&quot;    'имя файла для перемещения. Директория(в данном случае диск D) должна существовать</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Name sFileName As sNewFileName 'перемещаем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл перемещен&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Переименование: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51afe8625784622"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Rename_File() Dim sFileName As String, sNewFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя исходного файла sNewFileName = &quot;C:\WWW1.xls&quot; 'имя файла для переименования If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub Name sFileName As sNewFileName 'переименовываем файл MsgBox &quot;Файл переименован&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Rename_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String, sNewFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя исходного файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sNewFileName = &quot;C:\WWW1.xls&quot;    'имя файла для переименования</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Name sFileName As sNewFileName 'переименовываем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл переименован&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Удаление файла: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51aff3154569577"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Delete_File() Dim sFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя файла для удаления If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub Kill sFileName 'удаляем файл MsgBox &quot;Файл удален&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Delete_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя файла для удаления</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Kill sFileName 'удаляем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл удален&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Вот так. Вроде ничего сложного. </span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Так же я хотел бы описать как можно проделать те же операции с файлами при помощи объекта FileSystemObject. Строк кода несколько больше и выполняться операции будут медленнее(хотя вряд ли это будет заметно на примере одного файла). Но раз начал разбирать эту тему - решил показать и эти методы. Прежде всего следует, я думаю, пояснить что за зверь такой - FileSystemObject.<br />FileSystemObject (FSO) - содержится в библиотеке типов Scripting, расположенной в файле библиотеки scrrun.dll. Объектная модель FSO дает возможность создавать, изменять, перемещать и удалять папки и файлы, собирать о них различную информацию: имена, атрибуты, даты создания или изменения и т.д. Чтобы работать с FSO необходимо создать переменную со ссылкой на объект библиотеки. Сделать это можно двумя способами: через ранее связывание и позднее. Я не буду сейчас вдаваться в подробности этих методов - тема довольно обширная и я опишу её в другой статье.<br />Ранее связывание: для начала необходимо подключить библиотеку Microsoft Scripting Runtime. Делается это в редакторе VBA: References-находите там Microsoft Scripting Runtime и подключаете. Объявлять переменную FSO при раннем связывании следует так: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51b000614365852"></a><span style=" font-size:9pt;">D</span><span style=" font-size:9pt;">im objFSO As New FileSystemObject </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:9pt;">1 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51b000614365852-1"></a><span style=" font-size:9pt;">D</span><span style=" font-size:9pt;">im objFSO As New FileSystemObject</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;"><br />Плюсы раннего связывания: с помощью Object Browser можно просмотреть список объектов, свойств, методов, событий и констант, включенных в FSO. Но есть значительный минус: если планируется использовать программу на нескольких компьютерах, то есть большая вероятность получить ошибку</span><span style=" font-size:9pt; font-style:italic;">(</span><a href="http://www.excel-vba.ru/chto-umeet-excel/oshibka-cant-find-project-or-library/"><span style=" font-size:9pt; font-style:italic; text-decoration: underline; color:#0000ff;">читать подробнее</span></a><span style=" font-size:9pt; font-style:italic;">)</span><span style=" font-size:9pt;">.<br />Позднее связывание: ничего нигде не надо подключать, а просто используем метод CreateObject</span><span style=" font-size:9pt; font-style:italic;">(именно этот способ используется мной в примерах ниже)</span><span style=" font-size:9pt;">. Методы таким образом просмотреть не получится, но зато работать будет без проблем на любых компьютерах без дополнительных действий.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Копирование: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51b00b279843725"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Copy_File() Dim objFSO As Object, objFile As Object Dim sFileName As String, sNewFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя исходного файла sNewFileName = &quot;D:\WWW.xls&quot; 'имя файла для переименования If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub 'копируем файл Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set objFile = objFSO.GetFile(sFileName) objFile.Copy sNewFileName MsgBox &quot;Файл скопирован&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Copy_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim objFSO As Object, objFile As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String, sNewFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя исходного файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sNewFileName = &quot;D:\WWW.xls&quot;    'имя файла для переименования</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    'копируем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFile = objFSO.GetFile(sFileName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    objFile.Copy sNewFileName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл скопирован&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Перемещение: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51b017222028034"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Move_File() Dim objFSO As Object, objFile As Object Dim sFileName As String, sNewFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя исходного файла sNewFileName = &quot;D:\WWW.xls&quot; 'имя файла для переименования If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub 'перемещаем файл Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set objFile = objFSO.GetFile(sFileName) objFile.Move sNewFileName MsgBox &quot;Файл перемещен&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Move_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim objFSO As Object, objFile As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String, sNewFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя исходного файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sNewFileName = &quot;D:\WWW.xls&quot;    'имя файла для переименования</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    'перемещаем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFile = objFSO.GetFile(sFileName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    objFile.Move sNewFileName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл перемещен&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td>
<td></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Переименование: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51b021898536059"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Rename_File() Dim objFSO As Object, objFile As Object Dim sFileName As String, sNewFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя исходного файла sNewFileName = &quot;WWW1.xls&quot; 'имя файла для переименования If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub 'переименовываем файл Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set objFile = objFSO.GetFile(sFileName) objFile.Name = sNewFileName MsgBox &quot;Файл переименован&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Rename_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim objFSO As Object, objFile As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String, sNewFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя исходного файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sNewFileName = &quot;WWW1.xls&quot;    'имя файла для переименования</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    'переименовываем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFile = objFSO.GetFile(sFileName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    objFile.Name = sNewFileName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл переименован&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td>
<td></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Хочу обратить внимание, что при переименовании файла через FileSystemObject необходимо указать только имя нового файла - путь указывать не надо. Иначе получите ошибку.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Удаление файла: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce6e51b02d045639663"></a><span style=" font-size:9pt;">S</span><span style=" font-size:9pt;">ub Delete_File() Dim objFSO As Object, objFile As Object Dim sFileName As String sFileName = &quot;C:\WWW.xls&quot; 'имя файла для удаления If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub 'удаляем файл Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set objFile = objFSO.GetFile(sFileName) objFile.Delete MsgBox &quot;Файл удален&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">Sub Delete_File()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim objFSO As Object, objFile As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Dim sFileName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    sFileName = &quot;C:\WWW.xls&quot;    'имя файла для удаления</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    If Dir(sFileName, 16) = &quot;&quot; Then MsgBox &quot;Нет такого файла&quot;, vbCritical, &quot;Ошибка&quot;: Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    'удаляем файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    Set objFile = objFSO.GetFile(sFileName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    objFile.Delete</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">    MsgBox &quot;Файл удален&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:11pt; color:#0000ff;">End Sub</span></p></td>
<td></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Вот теперь вроде бы все.</span></p></body></html>