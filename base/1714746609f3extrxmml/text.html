<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%; background-color:#ffffff;"><a name="ctl00_ArticleTitle"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:xx-large; color:#333333;">З</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:xx-large; color:#333333;">агрузка файлов с помощью VBScript</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ctl00_avatarWrap"></a><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7447470"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#808080;">Э</span></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#808080;">дуардо Моцарт де Оливейра</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:7px; margin-right:2px; -qt-block-indent:0; text-indent:0px; line-height:25px;"><a name="ctl00_RateArticle_RatingTable"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:14px; font-weight:600; color:#808080;">О</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:14px; font-weight:600; color:#808080;">цени меня:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:12px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:25px;"><a name="ctl00_RateArticle_RatingHistWrap"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:14px; color:#111111;">4</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:14px; color:#111111;">.00/5 (1 голос)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ctl00_LastUpdated"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">1</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">2 декабря 2012 г.</span><a name="ctl00_LicenseLink"></a><a href="http://www.codeproject.com/info/cpol10.aspx"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#005782;">К</span></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#005782;">ПОЛ</span><a name="ctl00_ReadingTime"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">7</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;"> минут чтения</span><a name="ctl00_HorizontalStats"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">1</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">14,4К</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;"> </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">  </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">2 </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">  </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">14</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#666666;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ctl00_DescriptionSpot"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#808080;">К</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#808080;">ак загружать файлы с помощью VBScript с помощью COM (WinHTTP и MSXML) или WGET</span></p>
<p style=" margin-top:20px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%; background-color:#ffffff;"><a name="contentdiv"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">В</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">ведение</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">В этой статье мы хотим показать вам, как загружать файлы в VBScript с доступом через COM (WinHTTP, MSXML.XMLHTTP) и с помощью командной строки (WGET). Вы можете выбрать, какой вариант будет для вас более полезным, и этот пост призван прояснить его.</span></p>
<p style=" margin-top:20px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">Фон</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Загрузка файлов сегодня является чем-то действительно простым, потому что очень трудно найти человека, у которого нет доступа в Интернет. Возможно, вы захотите выполнить автоматическое обновление вашей программы или загрузить файл только в том случае, если пользователю нужна определенная функция вашего кода, что уменьшит загрузку вашего скрипта.</span></p>
<p style=" margin-top:20px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">Доступные варианты  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Технология COM позволяет другой программе получить доступ к ресурсам из другой программы. Это технология Microsoft, и она действительно полезна. С его помощью мы можем получить доступ к Active Directory и добавлять пользователей и группы, не открывая консоль управления. Мы можем загружать и устанавливать обновления автоматически с помощью API Центра обновления Windows, не заходя на сайт Центра обновления Microsoft. Мы можем написать и сохранить документ в Microsoft Word в командной строке.  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">И что самое приятное: не имеет значения, какой язык программирования я использую. Я могу сделать это с помощью PHP, VBScript, Javascript, C#... Язык программирования должен поддерживать только доступ через COM и работу в среде Windows.  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Некоторые функции COM встроены в Microsoft Windows, другие необходимо загрузить и установить. COM-функции лучше, потому что, как правило, нам не нужно распространять какой-либо сторонний код, поскольку он уже есть в Windows.      </span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0" bgcolor="transparent"><thead>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#111111;"> </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#111111;">WinHTTP </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#111111;">MSXML.XMLHTTP </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#111111;">РГЕТ</span></p></td></tr></thead>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">COM-доступ  </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> Да </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет </span></p></td></tr>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Минимальные требования </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Windows 2000 (с пакетом обновления 3)  </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Windows 95 и Internet Explorer 4.0. </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Windows 95 и Internet Explorer 4.0. </span></p></td></tr>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Получить заголовок без скачивания </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет  </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет* </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да </span></p></td></tr>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Может показывать прогресс загрузки в режиме реального времени    </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет* </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет* </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да** </span></p></td></tr>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Проверьте локальную версию файла и загрузите новый файл только при необходимости.    </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет  </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да   </span></p></td></tr>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Поддержка HTTPS.    </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет  </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да   </span></p></td></tr>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Поддержка FTP.    </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Нет  </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да   </span></p></td></tr>
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Поддержка аутентификации (пользователь/пароль).    </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да    </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да   </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Да   </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> <br /></span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">* Он доступен, но мы не можем получить к нему доступ из VBScript (вместо этого нам нужно использовать .NET).  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">** VBScript останавливается, если мы пытаемся выполнить асинхронное чтение командной строки с помощью WGET. Нам нужно отобразить приглашение командной строки, чтобы показать прогресс (его нельзя просмотреть в том же окне из сценария).    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"><br /></span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Я надеюсь, что приведенная ниже таблица поможет вам выбрать метод, который вы будете использовать для загрузки файлов. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">WinHTTP и MSXML не требуют, чтобы вы что-либо распространяли вместе с вашим кодом, но вы потеряли некоторые интересные функции из WGET для Win32 (у него гораздо больше функций, чем у него! Прочтите документацию WGET!). Если вам нужно прочитать заголовок страницы или вам может пригодиться «Проверить локальную версию файла [...]», выберите его. WGET изначально поддерживает эту функцию, но мы можем реализовать ее в .NET, читая заголовок, получая Content-Length и сравнивая его с локальным файлом.   </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Если WGET отброшен, вы можете выбрать WinHTTP или MSXML.    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Если вам не нужна поддержка Windows 9x, выберите 1-ю. Это связано с тем, что MSXML для загрузки интернет-файлов в версиях Windows Server для Windows требует ручного изменения зоны безопасности Internet Explorer, позволяя локальным программам получать доступ к внешним ресурсам ( </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#111111;">Безопасность &gt; Надежные сайты &gt; Доступ к источникам данных между доменами</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> ). Если мы этого не сделаем, наш скрипт вернет «Доступ запрещен». и будет закрыт.   </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Я действительно рекомендую WinHTTP, только если вас не волнует, что ваш сценарий не будет работать в версиях Windows Server без запроса пользователя изменить настройки безопасности, что сделает сервер менее безопасным.   </span></p>
<p style=" margin-top:20px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">Использование WGET </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">У WGET нет доступа COM, но мы можем вызвать командную строку из нашего скрипта и использовать ее. </span></p>
<p style=" margin-top:5px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fbedbb;"><a name="premain23223"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">V</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">BScript</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="preShrink23223"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">С</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">жать ▲</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strScriptFile = Wscript.ScriptFullName </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' C:\download.vbs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Scripting.FileSystemObject&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFile = objFSO.GetFile(strScriptFile)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strFolder = objFSO.GetParentFolderName(objFile) </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' C:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objShell = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;WScript.Shell&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strLink = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Use strFolder to save on the same location of this script.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strSaveTo = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;C:\&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' WGet saves file always on the actual folder. So, change the actual folder for C:\, where we want to save file</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objShell.CurrentDirectory = strSaveTo</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' &quot;C:\wget.exe&quot; &quot;http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab&quot; -N</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objShell.Run Quotes(strFolder &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;\wget.exe&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot; &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; Quotes(strLink) &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot; -N&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' -N: Continue download only if the local version is outdated.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objShell.CurrentDirectory = strFolder</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Add Quotes to string</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' http://stackoverflow.com/questions/2942554/vbscript-adding-quotes-to-a-string</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Function</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> Quotes(strQuotes)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	Quotes = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">chr</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">34</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) &amp; strQuotes &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">chr</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">34</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:10px; color:#111111;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">В первых 4 строках мы получаем папку, в которой сохранен наш скрипт (и находится wget.exe).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Затем мы определяем две строки: </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">strLink</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">, это ссылка, которую мы будем скачивать, и </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">strSaveTo</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">, где файл будет сохранен.  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">После этого мы меняем фактическую папку на папку, в которой мы хотим сохранить файл. WGet сохраняет файл в той папке, которую мы используем, а затем сохраняет файл там.  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Мы вызвали WGet с помощью </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">objShell.Run</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">  . У него есть 3 аргумента:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">1. Команда для выполнения.   </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">2. Оконный режим. Используйте </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">0</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">, чтобы скрыть </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">1</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">или показать (в другом окне). Дополнительные параметры: </span><a href="http://ss64.com/vb/run.html"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#005782;">http://ss64.com/vb/run.html.</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">3. Дождитесь завершения. Используйте </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">True</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">для ожидания и продолжения обработки нашего сценария только после завершения загрузки, </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">False</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">чтобы продолжить обработку сценария во время загрузки.   </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Мы отправили аргументы для WGet:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">-N </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> Скачивайте файл только в том случае, если локальная версия устарела. </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"><br />  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">С нашим кодом откроется второе окно, показывающее ход загрузки. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Но в некоторых случаях мы не можем открыть второе приглашение. (тихий сценарий). У нас есть альтернатива: скрыть подсказку и показать прогресс в том же окне. Есть проблема: мы теряем просмотр нашей загрузки в реальном времени. Нам нужно дождаться завершения загрузки, чтобы отобразить выходные данные.    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Для этого случая нам нужно использовать приведенный ниже код. </span></p>
<p style=" margin-top:5px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fbedbb;"><a name="premain105912"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">V</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">BScript</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="preShrink105912"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">С</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">жать ▲</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strScriptFile = Wscript.ScriptFullName </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' C:\download.vbs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Scripting.FileSystemObject&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFile = objFSO.GetFile(strScriptFile) </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Get file information from our Script.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strFolder = objFSO.GetParentFolderName(objFile) </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Get only folder from our script (C:)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objShell = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;WScript.Shell&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Expand variables from command prompt</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">systemroot = objShell.ExpandEnvironmentStrings(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;%systemroot%&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strLink = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strSaveTo = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;C:\&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Use strFolder to save on the same location of this script</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' WGet saves file always on the actual folder. So, change the actual folder for C:\, where we want to save file</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objShell.CurrentDirectory = strSaveTo</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' &quot;C:\wget.exe&quot; &quot;http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab&quot; -N -o C:\Windows\Temp\output.txt</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objShell.Run Quotes(strFolder &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;\wget.exe&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot; &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; Quotes(strLink) &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot; -N -o &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; systemroot &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;\temp\output.txt&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">0</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' -N: Continue download only if the local version is outdated.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objShell.CurrentDirectory = strFolder</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFile = objFSO.OpenTextFile(systemroot &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;\temp\output.txt&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">			</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	line = objFile.ReadLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	WScript.Echo line			</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Loop</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">While</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> Not objFile.AtEndOfStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objFile.Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' http://stackoverflow.com/questions/2942554/vbscript-adding-quotes-to-a-string</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Function</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> Quotes(strQuotes)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	Quotes = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">chr</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">34</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) &amp; strQuotes &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">chr</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">34</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Function</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:10px; color:#111111;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Мы будем комментировать только то, что нового в этом коде.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Мы вызвали </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">objShell</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">расширение </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">%systemroot%</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">переменной из приглашения. Мы будем использовать его для вызова командной строки в следующих строках.   </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Мы вызвали WGet </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">objShell.Run</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">  с двумя аргументами: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">-N </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> Скачивайте файл только в том случае, если локальная версия устарела. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">-o</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">   Отправлять все сообщения из WGet на</span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">%systemroot%\temp\output.txt </span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Мы вернулись на </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">strFolder</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">место и </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">objFSO</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">прочитали файл </span><span style=" font-family:'Consolas,monospace,mono'; font-size:15px; color:#990000;">%systemroot%\temp\output.txt</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">. Он прочитает все строки файла до конца, а затем выйдет из файла.  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Если вы хотите прочитать заголовок, вам нужно заменить objShell.Run на: </span></p>
<p style=" margin-top:5px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fbedbb;"><a name="premain862901"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">V</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">BScript</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><a name="copycode862901"></a><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">o</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">bjShell.Run Quotes(strFolder &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;\wget.exe&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot; --server-response --spider &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; Quotes(strLink) &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot; -o &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; systemroot &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;\temp\output.txt&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">0</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">True</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:10px; color:#111111;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Вам необходимо заменить содержимое внутри Do Loop на: </span></p>
<p style=" margin-top:5px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fbedbb;"><a name="premain485450"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">V</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#999999;">BScript</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><a name="copycode485450"></a><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">D</span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">o</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	line = objFile.ReadLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	WScript.Echo line</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">			</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">	</span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">InStr</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(line,</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Content-Length&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">		strContentLength = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Mid</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(line,</span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">19</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">,</span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Len</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(line))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">		</span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' WScript.Echo strContentLength</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">        </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">			</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Loop</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">While</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> Not objFile.AtEndOfStream</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:10px; color:#111111;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Объяснение: мы используем InStrфункцию, чтобы проверить, есть ли в строке текст. Если фактическая строка имеет «Content-Length», она получит значение.     </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Мы используем Midдля чтения строки от символа 19 до конца строки, удаляя «Content-Length» и сохраняя только размер. Мы можем использовать его, например, для сравнения размера фактического файла с размером сервера. (Используйте -N, чтобы позволить WGet сделать это автоматически). Используя этот метод, вы можете прочитать другую информацию из данных заголовка, просто используйте правильные значения в Mid.   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Если вам нужно использовать аутентификацию, добавьте в WGet вызов --user=username --password='password'objShell.Run  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Использование WinHTTP  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">WinHTTP имеет доступ через COM и является собственным компонентом Windows 2000 с SP3 и выше. Это означает, что вам не нужно ничего распространять вместе с вашим кодом, если вы просто хотите скачать небольшой файл. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">VBScript</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="preShrink837025"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">С</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">жать ▲</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strLink = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Get file name from URL.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab -&gt; wsusscn2.cab</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    strSaveName = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Mid</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(strLink, InStrRev(strLink,</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;/&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) + </span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">, </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Len</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(strLink))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    strSaveTo = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;C:\&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strSaveName</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;HTTPDownload&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;-------------&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Download: &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strLink</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Save to:  &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strSaveTo</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Create an HTTP object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objHTTP = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">( </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;WinHttp.WinHttpRequest.5.1&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> )</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Download the specified URL</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    objHTTP.Open </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;GET&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">, strLink, </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Use HTTPREQUEST_SETCREDENTIALS_FOR_PROXY if user and password is for proxy, not for download the file.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' objHTTP.SetCredentials &quot;User&quot;, &quot;Password&quot;, HTTPREQUEST_SETCREDENTIALS_FOR_SERVER</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    objHTTP.Send</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">         </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Scripting.FileSystemObject&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">     </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO.FileExists(strSaveTo) </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">       objFSO.DeleteFile(strSaveTo)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">     </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">     </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objHTTP.Status = </span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">200</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">       </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Dim</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">       </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objStream = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;ADODB.Stream&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">       With objStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">           .Type = </span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">'adTypeBinary</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">           .Open</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">           .Write objHTTP.ResponseBody</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">           .SaveToFile strSaveTo</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">           .Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">       </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">       </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objStream = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">     </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">     </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO.FileExists(strSaveTo) </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">       WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Download `&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strSaveName &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;` completed successfuly.&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">     </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:10px; color:#111111;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Я не думаю, что здесь есть что объяснять. Вам нужно указать URL-адрес загрузки, затем мы получаем имя файла из URL-адреса (с Mid это необходимо для вызова ADODB ( .SaveToFile)), вызываем WinHTTP, загружаем файл и сохраняем его с помощью objStream.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Использование MSXML.XMLHTTP  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">MSXML имеет две основные версии: 3.0 и 6.0.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Версия 6.0 является самой последней и встроена в Windows Vista+ и Server 2008+. Он совместим с Windows XP и Server 2003, но требует ручной установки в этой ОС. Вы можете распространить исполняемый файл и установить его (рекомендуется). Если вы этого не сделаете, будет использоваться версия 3.0, встроенная в IE6.   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Версия 3.0 будет использоваться для клиентов с Windows 2000 и 98 с установленным IE6.  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Версия 2.x будет использоваться для клиентов с Windows 95 или 98 с установленным IE ниже 6. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">Не забудьте предупредить пользователей Windows Server о том, что им необходимо изменить зону безопасности Интернета, чтобы сценарии могли иметь доступ к Интернету! (Это снижает безопасность, если выполняется вредоносный скрипт!)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px; color:#000000;">VBScript</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="preShrink231922"></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">С</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">жать ▲</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:13px; color:#999999;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strLink = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Get file name from URL.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' http://download.windowsupdate.com/microsoftupdate/v6/wsusscan/wsusscn2.cab -&gt; wsusscn2.cab</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strSaveName = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Mid</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(strLink, InStrRev(strLink,</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;/&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">) + </span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">, </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Len</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(strLink))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">strSaveTo = </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;C:\&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strSaveName</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;HTTPDownload&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;-------------&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Download: &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strLink</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Save to:  &quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strSaveTo</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Create an HTTP object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objHTTP = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;MSXML2.XMLHTTP&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">' Download the specified URL</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">'xmlhttp.Open &quot;GET&quot;, strURL, false, &quot;User&quot;, &quot;Password&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objHTTP.open </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;GET&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">, strLink, </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">objHTTP.send</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Scripting.FileSystemObject&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO.FileExists(strSaveTo) </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">  objFSO.DeleteFile(strSaveTo)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objHTTP.Status = </span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">200</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Dim</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objStream = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">CreateObject</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">(</span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;ADODB.Stream&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">  With objStream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    .Type = </span><span style=" font-family:'Consolas'; font-size:16px; color:#000080;">1</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; font-style:italic; color:#008000;">'adTypeBinary</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    .Open</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    .Write objHTTP.responseBody</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    .SaveToFile strSaveTo</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">    .Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">  </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">set</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objStream = </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> objFSO.FileExists(strSaveTo) </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#111111; background-color:#eff0f1;">  WScript.Echo </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;Download `&quot;</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> &amp; strSaveName &amp; </span><span style=" font-family:'Consolas'; font-size:16px; color:#800080;">&quot;` completed successfuly.&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">End</span><span style=" font-family:'Consolas'; font-size:16px; color:#111111;"> </span><span style=" font-family:'Consolas'; font-size:16px; color:#0000ff;">If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Segoe UI,Arial,sans-serif'; font-size:10px; color:#111111;"><br /></p>
<p style=" margin-top:20px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">Точки интереса</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Используя эту альтернативу, вы можете загрузить файл с помощью VBScript. Рекомендую использовать WGet для больших файлов, тогда пользователь не подумает, что программа остановилась. Если вы можете выбрать WinHTTP или MSXML, я рекомендую первый, поскольку он более совместим (даже без поддержки Windows 9x не требует внимания в редакции Windows Server).  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Вы можете использовать </span><a href="http://www.robvanderwoude.com/vbstech_internet_download.php"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#005782;">X-HTTP</span></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> , Curl или API Internet Explorer для загрузки файлов, но тогда я не проверял. </span></p>
<p style=" margin-top:20px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">Рекомендации</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;">Я не владею всеми знаниями о мире, и эта статья была написана только потому, что я хочу помочь другим людям, как это делают люди, представленные ниже. Я действительно рекомендую вам прочитать эти ссылки: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><a href="http://www.robvanderwoude.com/vbstech_internet_download.php"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#005782;">Методы написания сценариев VBScript: загрузка файлов</span></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> Роба ван дер Вуда </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><a href="http://www.frank4dd.com/howto/various/microsoft-vbs-http-download.htm"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#005782;">HTTP-загрузка-vbs</span></a><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> от Frank4DD </span></p>
<p style=" margin-top:20px; margin-bottom:11px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:x-large; color:#ff9900;">История</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%;"><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; font-weight:600; color:#111111;">12 декабря 2012 г.</span><span style=" font-family:'Segoe UI,Arial,sans-serif'; font-size:16px; color:#111111;"> Опубликован совет.</span></p></body></html>