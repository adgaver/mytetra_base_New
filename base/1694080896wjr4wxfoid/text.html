<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">User Defined Type. Что это и как его использовать</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> часть </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">2</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#ff0000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Итак</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> в первой части мы затронули применение UDT в обычном модуле</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> и в комментариях справедливо заметили</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> что UDT сильно проигрывает классам. И да</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> действительно</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> если использовать класс как DTO </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">Data Transfer </span><span style=" font-family:'Courier New'; color:#0000ff;">Object</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">),</span><span style=" font-family:'Courier New'; color:#000000;"> он более функционален</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> чем UDT.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">В этой заключительной части</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> я хотел бы рассказать о применении UDT в классах</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> кто такой Mathieu Guindon и причем тут резиновая уточка.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Ключевое слово this</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Ну</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> на самом деле я слегка лукавлю</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> такого кейворда в VBA нет</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> но обо всем по порядку.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Обозначим задачу</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Мы разобрали</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> как использовать UDT в качестве структуры письма </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">см. первую часть</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#000000;"> Это вполне себе рабочая схема</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> но иной раз не совсем удобная.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">В чем же минусы</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">?</span><span style=" font-family:'Courier New'; color:#000000;"> Сходу я вижу как минимум два</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Нет возможности встроить проверку передаваемых значений.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Чтобы собрать несколько UDT в один контейнер</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> в качестве этого самого контейнера можно использовать только массив. Это не то</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> чтобы критично</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> но часто неудобно.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">А по сему</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> попробуем сделать реализацию структуры TLetter в виде класса.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Создаем новый класс</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;">модуль и называем его Letter. Сразу пропишем необходимые поля</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Option</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Explicit</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> AddressTo </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> AddressCC </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> Subject   </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Так как это класс</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> надо бы пользоваться его функционалом.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Добавим проверку передаваемых значений</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> например email</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;">адресов. Усложнять не будем</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> просто проверяем наличие символа </span><span style=" font-family:'Courier New'; color:#808080;">&quot;@&quot;</span><span style=" font-family:'Courier New'; color:#000000;"> и бросаем ошибку</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> если его нет</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Option</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Explicit</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> AddressTo1 </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> AddressCC1 </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> Subject1   </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Get</span><span style=" font-family:'Courier New'; color:#000000;"> AddressTo</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressTo </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> AddressTo1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Let</span><span style=" font-family:'Courier New'; color:#000000;"> AddressTo</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> RHS </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Not</span><span style=" font-family:'Courier New'; color:#000000;"> ValidateEmail</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">RHS</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span><span style=" font-family:'Courier New'; color:#000000;"> Err.Raise </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> TypeName</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">Me</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressTo1 </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Get</span><span style=" font-family:'Courier New'; color:#000000;"> AddressCC</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressCC </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> AddressCC1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Let</span><span style=" font-family:'Courier New'; color:#000000;"> AddressCC</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> RHS </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Not</span><span style=" font-family:'Courier New'; color:#000000;"> ValidateEmail</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">RHS</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span><span style=" font-family:'Courier New'; color:#000000;"> Err.Raise </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> TypeName</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">Me</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressCC1 </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Get</span><span style=" font-family:'Courier New'; color:#000000;"> Subject</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    Subject </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> Subject1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Let</span><span style=" font-family:'Courier New'; color:#000000;"> Subject</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> RHS </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    Subject1 </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Function</span><span style=" font-family:'Courier New'; color:#000000;"> ValidateEmail</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> Email </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    ValidateEmail </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> InStr</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#808080;">&quot;@&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">&gt;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Что мы видим</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">?</span><span style=" font-family:'Courier New'; color:#000000;"> Добавились свойства. У полей изменился модификатор доступа на </span><span style=" font-family:'Courier New'; color:#0000ff;">private</span><span style=" font-family:'Courier New'; color:#000000;"> и к каждому имени добавилась цифра </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#ff0000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Проблема в том</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> что VBA не чувствителен к регистру имен переменных</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> поэтому addressTo и AddressTo для него одно и тоже</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> а соответственно свойства и поля называть одинаково мы не можем.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">И вот тут как нельзя кстати будет UDT</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Объявляем новый тип TLetter</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> помещаем в него все наши поля </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">с нормальными названиями</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> без цифр</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; color:#000000;"> Далее объявляем приватное поле this с типом TLetter.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Теперь переданное в свойство значение помещается в переменную вида this.AddressTo</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> что выглядит куда лучше и понятнее</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Option</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Explicit</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Type</span><span style=" font-family:'Courier New'; color:#000000;"> TLetter</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressTo </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressCC </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    Subject   </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Type</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> this </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> TLetter</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Get</span><span style=" font-family:'Courier New'; color:#000000;"> AddressTo</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressTo </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> this.AddressTo</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Let</span><span style=" font-family:'Courier New'; color:#000000;"> AddressTo</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> RHS </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Not</span><span style=" font-family:'Courier New'; color:#000000;"> ValidateEmail</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">RHS</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span><span style=" font-family:'Courier New'; color:#000000;"> Err.Raise </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> TypeName</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">Me</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    this.AddressTo </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Get</span><span style=" font-family:'Courier New'; color:#000000;"> AddressCC</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    AddressCC </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> this.AddressCC</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Let</span><span style=" font-family:'Courier New'; color:#000000;"> AddressCC</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> RHS </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    </span><span style=" font-family:'Courier New'; color:#0000ff;">If</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Not</span><span style=" font-family:'Courier New'; color:#000000;"> ValidateEmail</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">RHS</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Then</span><span style=" font-family:'Courier New'; color:#000000;"> Err.Raise </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> TypeName</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">Me</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    this.AddressCC </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Get</span><span style=" font-family:'Courier New'; color:#000000;"> Subject</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">()</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    Subject </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> this.Subject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Public</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Let</span><span style=" font-family:'Courier New'; color:#000000;"> Subject</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> RHS </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    this.Subject </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Property</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Function</span><span style=" font-family:'Courier New'; color:#000000;"> ValidateEmail</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; color:#000000;"> Email </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">String</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">    ValidateEmail </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; color:#000000;"> InStr</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> RHS</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#808080;">&quot;@&quot;</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">&gt;</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; font-weight:600; color:#ff0000;">0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#0000ff;">End</span><span style=" font-family:'Courier New'; color:#000000;"> </span><span style=" font-family:'Courier New'; color:#0000ff;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Mathieu Guindon и Rubberduck</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Я думаю</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> вы наверняка уже видели подобное такое решение в моей первой статье на Хабре. По сути такой подход </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;"> есть ни что иное как паттерн. Автор этого паттерна господин Mathieu Guindon</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> он же автор достаточно известного дополнения для VBE </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;"> Rubberduck </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">резиновая уточка</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Так как в этой статье мы все таки разбираем UDT и способ его применения</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> а не то почему так правильнее делать</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> я бы хотел передать слово самому Mathieu</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> а именно его статье </span><span style=" font-family:'Courier New'; color:#0000ff;">Private</span><span style=" font-family:'Courier New'; color:#000000;"> this </span><span style=" font-family:'Courier New'; color:#0000ff;">As</span><span style=" font-family:'Courier New'; color:#000000;"> TSomething. В ней он достаточно подробно разбирает почему это удобно и чем плоха Венгерская нотация </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; color:#000000;">а именно</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> добавление в название поля m </span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; color:#000000;"> mAddressTo</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-weight:600; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Короче...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Эта часть вышла более компактной</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> т.к. цель данной статьи не переписывать слова автора паттерна</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> а скорее обратить внимание на такой подход.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Надеюсь</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> что тем не менее было полезно.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Спасибо</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> что прочитали до конца.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Стали бы применять подобный паттерн</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">?</span><span style=" font-family:'Courier New'; color:#000000;"> Пишите в комментариях!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">А также</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; color:#000000;"> подписывайтесь на мой телеграмм.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Теги</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span><span style=" font-family:'Courier New'; color:#000000;"> User Defined TypeTypeVBARubberduck</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#000000;">Хабы</span><span style=" font-family:'Courier New'; font-weight:600; color:#000000;">:</span><span style=" font-family:'Courier New'; color:#000000;"> ПрограммированиеVisual Basic </span><span style=" font-family:'Courier New'; color:#0000ff;">for</span><span style=" font-family:'Courier New'; color:#000000;"> Applications</span></p></body></html>