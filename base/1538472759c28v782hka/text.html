<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>www.ПЕРВЫЕ ШАГИ.ru :: Шаг 11 - Метод OpenDatabase</title><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;" bgcolor="#ffffff">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:x-large; font-weight:600;">Шаг 11 - Метод OpenDatabase</span><span style=" font-family:'DejaVu Sans';">&lt;div style=&quot;position:absolute;left:-10000px;&quot;&gt;&lt; img src=&quot;5.png&quot; style=&quot;border:0;&quot; height=&quot;1&quot; width=&quot;1&quot; alt=&quot;top@Mail.ru&quot;/&gt;&lt; /div&gt;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'arial'; font-size:12px; color:#000000; background-color:#ffffff;">Описание</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Открывает указанную базу данных в объекте </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Workspace</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> и возвращает ссылку на объект </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Database</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, представляющий эту базу данных.<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:39px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff; background-color:#ffffff;">Set базаДанных = рабочаяОбласть.OpenDatabase (имяБД, параметры, толькоЧтение, подключение)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'arial'; font-size:12px; color:#000000; background-color:#ffffff;">Параметры</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br /></span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">базаДанных</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Объектная переменная, представляющая открываемый объект </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Database</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">.<br /></span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">рабочаяОбласть</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Необязательный. Объектная переменная, представляющая существующий объект </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Workspace</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, который будет содержать базу данных. Если аргумент рабочаяОбласть не задан, метод </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">OpenDatabase</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> использует стандартную рабочую область.<br /></span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">имяБД</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Выражение или переменная типа </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">String</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, задающая имя существующего файла базы данных с ядром </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Microsoft Jet</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> или имя источника данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">. Дополнительные сведения о значениях данного аргумента см. в разделе справки для свойства </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Name</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">.<br /></span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">параметры</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Необязательный. Выражение или переменная типа </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Variant</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, задающая параметры базы данных.<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'arial'; font-size:12px; color:#000000; background-color:#ffffff;">Для рабочей области ядра Microsoft Jet:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'arial'; font-size:12px; color:#000000;" style=" margin-top:12px; margin-bottom:0px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; font-weight:600;">True</span><span style=" font-size:12px;"> - Открытие базы данных для монопольного доступа.</span></li>
<li style=" font-family:'arial'; font-size:12px; color:#000000;" style=" margin-top:0px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; font-weight:600;">False</span><span style=" font-size:12px;"> - (По умолчанию). Открытие базы данных для общего доступа.</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'arial'; font-size:12px; color:#000000; background-color:#ffffff;">Для рабочей области ODBCDirect:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'arial'; font-size:12px; color:#000000;" style=" margin-top:12px; margin-bottom:0px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; font-weight:600;">dbDriverNoPrompt</span><span style=" font-size:12px;"> - Диспетчер драйвера ODBC использует строку подключения, определяемую аргументами имяБД и подключение. Если этих данных недостаточно, возникает ошибка выполнения.</span></li>
<li style=" font-family:'arial'; font-size:12px; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; font-weight:600;">dbDriverPrompt</span><span style=" font-size:12px;"> - Диспетчер драйвера ODBC открывает диалоговое окно ODBC Data Sources, в котором отображаются данные, определяемые аргументами имяБД и подключение. Строка подключения образуется из имени источника данных, которое пользователь выбирает в диалоговых окнах, или, если имя источника данных не задано пользователем, используется стандартный источник данных.</span></li>
<li style=" font-family:'arial'; font-size:12px; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; font-weight:600;">dbDriverComplete</span><span style=" font-size:12px;"> - (По умолчанию). Если в аргументах подключение и имяБД заданы все необходимые для подключения сведения, диспетчер драйвера ODBC использует строку из аргумента подключение. В противном случае выполняются действия, аналогичные задаваемым константой dbDriverPrompt.</span></li>
<li style=" font-family:'arial'; font-size:12px; color:#000000;" style=" margin-top:0px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; font-weight:600;">dbDriverCompleteRequired</span><span style=" font-size:12px;"> - Выполняются действия, аналогичные задаваемым константой dbDriverComplete, с тем лишь исключением, что драйвер ODBC отключает вывод приглашений на ввод сведений, не являющихся необходимыми для подключения.</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">толькоЧтение</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Необязательный. Значение типа </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Variant</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> (подтип </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Boolean</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">), имеющее значение </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">True</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, если база данных открывается только для чтения, и значение </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">False</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> (по умолчанию) при открытии базы данных с доступом для чтения и записи.<br /></span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">подключение</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Необязательный. Выражение или переменная типа </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Variant</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> (подтип </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">String</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">), содержащая сведения о подключении, в том числе пароли.<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'arial'; font-size:12px; color:#000000; background-color:#ffffff;">Замечания</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />При открытии базы данных она автоматически добавляется в семейство </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Databases</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">. Кроме того, в рабочей области </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBCDirect</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> создается объект </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Connection</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, соответствующий новому объекту </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Database</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">. Этот объект </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Connection</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> добавляется в семейство </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Connections</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> того же объекта </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Workspace</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">.<br />При указании аргумента имяБД необходимо иметь в виду следующее:<br />1. Если задается имя базы данных, уже открытой для монопольного доступа другим пользователем, возникает ошибка.<br />2. Если аргумент не задает имя существующей базы данных или допустимого источника данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, возникает ошибка.<br />3. Если значением аргумента является пустая строка (&quot;&quot;), а аргумент подключение имеет значение </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">&quot;ODBC;&quot;</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, открывается диалоговое окно со списком имен всех зарегистрированных источников данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, в котором пользователь может выбрать нужную базу данных. 4. При открытии базы данных в рабочей области </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBCDirect</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> с указанием имени источника данных в аргументе подключение пользователь имеет возможность задать в аргументе имяБД произвольную строку, которая в дальнейшем может использоваться в программах для ссылки на базу данных. Значение аргумента подключение образую два компонента: тип базы данных, за которым после точки с запятой (;) следуют необязательные аргументы. Указание типа базы данных, например, &quot;</span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">;&quot; или &quot;</span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">FoxPro 2.5</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">;&quot; является обязательным. Необязательные аргументы, следующие в произвольном порядке, также разделяются символом точки с запятой. Одним из параметров может быть пароль (если пароль определен). Например:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:39px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; color:#0000ff; background-color:#ffffff;">&quot;FoxPro 2.5; pwd=МойПароль&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'arial'; font-size:12px; color:#000000; background-color:#ffffff;">Вызов метода</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">NewPassword</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> для объекта </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Database</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, не являющегося базой данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBCDirect</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, позволяет изменить параметр пароля, который задается в виде &quot;;pwd=...&quot;. При указании строки источника необходимо определить аргументы параметры и толькоЧтение. Дополнительные сведения о синтаксисе см. в разделе справки для свойства </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Connect</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">.<br />Для закрытия базы данных и удаления объекта </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Database</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> из семейства </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Databases</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> следует применить к этому объекту метод </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Close</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">.<br />При подключении ядра </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Microsoft Jet</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> к источнику данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> пользователь имеет возможность повысить быстродействие приложения, открывая объект </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Database</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, подключенный к источнику данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, вместо присоединения отдельных объектов </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">TableDef</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> к конкретным таблицам в источнике данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">.<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:15px; margin-right:15px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'arial'; font-size:12px; color:#000000; background-color:#ffffff;">Пример</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"><br />Следующая программа использует метод </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">OpenDatabase</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> для открытия одной базы данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Microsoft Jet</span><span style=" font-family:'arial'; font-size:12px; color:#000000;"> и двух баз данных </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">ODBC</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">, подключенных к ядру </span><span style=" font-family:'arial'; font-size:12px; font-weight:600; color:#000000;">Microsoft Jet</span><span style=" font-family:'arial'; font-size:12px; color:#000000;">.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:39px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> OpenDatabaseX</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> wrkJet </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Workspace</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsNorthwind </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Database</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsPubs </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Database</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsPubs2 </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Database</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsLoop </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Database</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> prpLoop </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Property</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' Создает объект Workspace Microsoft Jet.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> wrkJet </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> CreateWorkspace</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;admin&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbUseJet</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' Открывает для монопольного доступа аргумент Database, </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' представляющий сохраненную базу данных Microsoft Jet.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    MsgBox </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Открытие базы данных 'Борей'...&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsNorthwind </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> wrkJet.OpenDatabase</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Борей.mdb&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">True</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' Открывает только для чтения объект Database,</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' используя строку подключения.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    MsgBox </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Открытие базы данных 'Publishers'...&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsPubs </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> wrkJet.OpenDatabase</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Publishers&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbDriverNoPrompt</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">True</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' Открывает только для чтения объект Database с вводом</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' недостающих данных в диалоговое окно диспетчера </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' драйвера ODBC.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    MsgBox </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Открытие копии базы данных 'Publishers'...&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsPubs2 </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> wrkJet.OpenDatabase</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Publishers&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbDriverCompleteRequired</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">True</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;ODBC;DATABASE=pubs;DSN=Publishers;&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' Отображает семейство Databases.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Each</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsLoop </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">In</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> wrkJet.Databases</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        Debug.Print </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Свойства объекта Database &quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsLoop.Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;:&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">On</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Error</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Resume</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' Отображает семейство Properties каждого </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' объекта Database.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Each</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> prpLoop </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">In</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsLoop.Properties</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> prpLoop.Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;Connection&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' Свойство фактически возвращает объект Connection.</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                Debug.Print </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;    Connection[.Name] = &quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsLoop.Connection.Name</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Else</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                Debug.Print </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;    &quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> prpLoop.Name </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot; = &quot;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">&amp;</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> prpLoop</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Next</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> prpLoop</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">On</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Error</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">GoTo</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">0</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Next</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dbsLoop</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    dbsNorthwind.Close</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    dbsPubs.Close</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    dbsPubs2.Close</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    wrkJet.Close</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>