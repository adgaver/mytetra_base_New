<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>www.ПЕРВЫЕ ШАГИ.ru :: Шаг 11 - Метод OpenDatabase</title><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;" bgcolor="#ffffff">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Шаг 11 - Метод OpenDatabase</span>&lt;div style=&quot;position:absolute;left:-10000px;&quot;&gt;&lt; img src=&quot;5.png&quot; style=&quot;border:0;&quot; height=&quot;1&quot; width=&quot;1&quot; alt=&quot;top@Mail.ru&quot;/&gt;&lt; /div&gt;</p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Описание<br /> Открывает указанную базу данных в объекте <span style=" font-weight:600;">Workspace</span> и возвращает ссылку на объект <span style=" font-weight:600;">Database</span>, представляющий эту базу данных.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Set базаДанных = рабочаяОбласть.OpenDatabase (имяБД, параметры, толькоЧтение, подключение)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Параметры<br /><span style=" font-weight:600;">базаДанных</span><br /> Объектная переменная, представляющая открываемый объект <span style=" font-weight:600;">Database</span>.<br /><span style=" font-weight:600;">рабочаяОбласть</span><br /> Необязательный.  Объектная переменная, представляющая существующий объект <span style=" font-weight:600;">Workspace</span>, который будет содержать базу данных.  Если аргумент рабочаяОбласть не задан, метод <span style=" font-weight:600;">OpenDatabase</span> использует стандартную рабочую область.<br /><span style=" font-weight:600;">имяБД</span><br /> Выражение или переменная типа <span style=" font-weight:600;">String</span>, задающая имя существующего файла базы данных с ядром <span style=" font-weight:600;">Microsoft Jet</span> или имя источника данных <span style=" font-weight:600;">ODBC</span>. Дополнительные сведения о значениях данного аргумента см. в разделе справки для свойства <span style=" font-weight:600;">Name</span>.<br /><span style=" font-weight:600;">параметры</span><br /> Необязательный.  Выражение или переменная типа <span style=" font-weight:600;">Variant</span>, задающая параметры базы данных.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Для рабочей области ядра Microsoft Jet: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">True</span> - Открытие базы данных для монопольного доступа. </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">False</span> - (По умолчанию). Открытие базы данных для общего доступа. </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Для рабочей области ODBCDirect: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">dbDriverNoPrompt</span> - Диспетчер драйвера ODBC использует строку подключения, определяемую аргументами имяБД и подключение. Если этих данных недостаточно, возникает ошибка выполнения. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">dbDriverPrompt</span> - Диспетчер драйвера ODBC открывает диалоговое окно ODBC Data Sources, в котором отображаются данные, определяемые аргументами имяБД и подключение.  Строка подключения образуется из имени источника данных, которое пользователь выбирает в диалоговых окнах, или, если имя источника данных не задано пользователем, используется стандартный источник данных. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">dbDriverComplete</span> - (По умолчанию). Если в аргументах подключение и имяБД заданы все необходимые для подключения сведения, диспетчер драйвера ODBC использует строку из аргумента подключение.  В противном случае выполняются действия, аналогичные задаваемым константой dbDriverPrompt. </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">dbDriverCompleteRequired</span> - Выполняются действия, аналогичные задаваемым константой dbDriverComplete, с тем лишь исключением, что драйвер ODBC отключает вывод приглашений на ввод сведений, не являющихся необходимыми для подключения. </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">толькоЧтение</span><br /> Необязательный.  Значение типа <span style=" font-weight:600;">Variant</span> (подтип <span style=" font-weight:600;">Boolean</span>), имеющее значение <span style=" font-weight:600;">True</span>, если база данных открывается только для чтения, и значение <span style=" font-weight:600;">False</span> (по умолчанию) при открытии базы данных с доступом для чтения и записи. <br /><span style=" font-weight:600;">подключение</span><br /> Необязательный.  Выражение или переменная типа <span style=" font-weight:600;">Variant</span> (подтип <span style=" font-weight:600;">String</span>), содержащая сведения о подключении, в том числе пароли.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Замечания<br /> При открытии базы данных она автоматически добавляется в семейство <span style=" font-weight:600;">Databases</span>.  Кроме того, в рабочей области <span style=" font-weight:600;">ODBCDirect</span> создается объект <span style=" font-weight:600;">Connection</span>, соответствующий новому объекту <span style=" font-weight:600;">Database</span>.  Этот объект <span style=" font-weight:600;">Connection</span> добавляется в семейство <span style=" font-weight:600;">Connections</span> того же объекта <span style=" font-weight:600;">Workspace</span>.<br />При указании аргумента имяБД необходимо иметь в виду следующее:<br />1. Если задается имя базы данных, уже открытой для монопольного доступа другим пользователем, возникает ошибка.<br />2. Если аргумент не задает имя существующей базы данных или допустимого источника данных <span style=" font-weight:600;">ODBC</span>, возникает ошибка.<br />3. Если значением аргумента является пустая строка (&quot;&quot;), а аргумент подключение имеет значение <span style=" font-weight:600;">&quot;ODBC;&quot;</span>, открывается диалоговое окно со списком имен всех зарегистрированных источников данных <span style=" font-weight:600;">ODBC</span>, в котором пользователь может выбрать нужную базу данных. 4. При открытии базы данных в рабочей области <span style=" font-weight:600;">ODBCDirect</span> с указанием имени источника данных в аргументе подключение пользователь имеет возможность задать в аргументе имяБД произвольную строку, которая в дальнейшем может использоваться в программах для ссылки на базу данных. Значение аргумента подключение образую два компонента: тип базы данных, за которым после точки с запятой (;) следуют необязательные аргументы.  Указание типа базы данных, например, &quot;<span style=" font-weight:600;">ODBC</span>;&quot; или &quot;<span style=" font-weight:600;">FoxPro 2.5</span>;&quot; является обязательным.  Необязательные аргументы, следующие в произвольном порядке, также разделяются символом точки с запятой.  Одним из параметров может быть пароль (если пароль определен).  Например: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">&quot;FoxPro 2.5; pwd=МойПароль&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Вызов метода <span style=" font-weight:600;">NewPassword</span> для объекта <span style=" font-weight:600;">Database</span>, не являющегося базой данных <span style=" font-weight:600;">ODBCDirect</span>, позволяет изменить параметр пароля, который задается в виде &quot;;pwd=...&quot;.  При указании строки источника необходимо определить аргументы параметры и толькоЧтение.  Дополнительные сведения о синтаксисе см. в разделе справки для свойства <span style=" font-weight:600;">Connect</span>.<br />Для закрытия базы данных и удаления объекта <span style=" font-weight:600;">Database</span> из семейства <span style=" font-weight:600;">Databases</span> следует применить к этому объекту метод <span style=" font-weight:600;">Close</span>.<br />При подключении ядра <span style=" font-weight:600;">Microsoft Jet</span> к источнику данных <span style=" font-weight:600;">ODBC</span> пользователь имеет возможность повысить быстродействие приложения, открывая объект <span style=" font-weight:600;">Database</span>, подключенный к источнику данных <span style=" font-weight:600;">ODBC</span>, вместо присоединения отдельных объектов <span style=" font-weight:600;">TableDef</span> к конкретным таблицам в источнике данных <span style=" font-weight:600;">ODBC</span>.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Пример<br /> Следующая программа использует метод <span style=" font-weight:600;">OpenDatabase</span> для открытия одной базы данных <span style=" font-weight:600;">Microsoft Jet</span> и двух баз данных <span style=" font-weight:600;">ODBC</span>, подключенных к ядру <span style=" font-weight:600;">Microsoft Jet</span>.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Sub OpenDatabaseX()	Dim wrkJet As Workspace	Dim dbsNorthwind As Database	Dim dbsPubs As Database	Dim dbsPubs2 As Database	Dim dbsLoop As Database	Dim prpLoop As Property	</span><span style=" font-family:'Courier New'; font-style:italic;">' Создает объект Workspace Microsoft Jet.</span><span style=" font-family:'Courier New';">	Set wrkJet = CreateWorkspace(&quot;&quot;, &quot;admin&quot;, &quot;&quot;, dbUseJet)	</span><span style=" font-family:'Courier New'; font-style:italic;">' Открывает для монопольного доступа аргумент Database, 	' представляющий сохраненную базу данных Microsoft Jet.</span><span style=" font-family:'Courier New';">	MsgBox &quot;Открытие базы данных 'Борей'...&quot;	Set dbsNorthwind = wrkJet.OpenDatabase(&quot;Борей.mdb&quot;, True)	</span><span style=" font-family:'Courier New'; font-style:italic;">' Открывает только для чтения объект Database,	' используя строку подключения.</span><span style=" font-family:'Courier New';">	MsgBox &quot;Открытие базы данных 'Publishers'...&quot;	</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New';">Set dbsPubs = wrkJet.OpenDatabase(&quot;Publishers&quot;, dbDriverNoPrompt, True, &quot;ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers&quot;)	</span><span style=" font-family:'Courier New'; font-style:italic;">' Открывает только для чтения объект Database с вводом	' недостающих данных в диалоговое окно диспетчера 	' драйвера ODBC.</span><span style=" font-family:'Courier New';">	MsgBox &quot;Открытие копии базы данных 'Publishers'...&quot;	Set dbsPubs2 = wrkJet.OpenDatabase(&quot;Publishers&quot;, dbDriverCompleteRequired, True, &quot;ODBC;DATABASE=pubs;DSN=Publishers;&quot;)	</span><span style=" font-family:'Courier New'; font-style:italic;">' Отображает семейство Databases.</span><span style=" font-family:'Courier New';">	For Each dbsLoop In wrkJet.Databases		Debug.Print &quot;Свойства объекта Database &quot; &amp; dbsLoop.Name &amp; &quot;:&quot;		On Error Resume Next		</span><span style=" font-family:'Courier New'; font-style:italic;">' Отображает семейство Properties каждого 		' объекта Database.</span><span style=" font-family:'Courier New';">		For Each prpLoop In dbsLoop.Properties			If prpLoop.Name = &quot;Connection&quot; Then			</span><span style=" font-family:'Courier New'; font-style:italic;">' Свойство фактически возвращает объект Connection.</span><span style=" font-family:'Courier New';">				Debug.Print &quot;    Connection[.Name] = &quot; &amp; dbsLoop.Connection.Name			Else				Debug.Print &quot;    &quot; &amp; prpLoop.Name &amp; &quot; = &quot; &amp; prpLoop			End If		Next prpLoop		On Error GoTo 0	Next dbsLoop	dbsNorthwind.Close	dbsPubs.Close	dbsPubs2.Close	wrkJet.CloseEnd Sub</span></p></body></html>