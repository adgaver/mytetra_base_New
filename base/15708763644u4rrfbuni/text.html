<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Вырезано из </span><a href="https://excelpedia.ru/makrosi-v-excel/sjat-bazu-dannih-access"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">https://excelpedia.ru/makrosi-v-excel/sjat-bazu-dannih-access</span></a>  </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16pt; color:#1e4e79;">Как сжать базу данных Access из Excel </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Автор Дмитрий Якушев На чтение 3 мин. Просмотров 74  </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; font-weight:600;">Что делает макрос:</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> Во время ваших интегрированных процессов, вы можете постоянно увеличивать или уменьшать количество записей и таблиц в базе данных. С течением времени, вы можете заметить, что доступ к базе данных становится все дольше. Это происходит потому, что Access не освобождает файловое пространство. Все пространство, необходимое для данных вы переместили из вашей базы данных в файл доступа. Автоматизация делопроизводства позволяет сжать и восстановить ваши базы данных прямо из кода. </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Содержание </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><a href="https://excelpedia.ru/#kak-makros-rabotaet"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">Как макрос работает</span></a>  </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><a href="https://excelpedia.ru/#kod-makrosa"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">Код макроса</span></a>  </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><a href="https://excelpedia.ru/#kak-etot-kod-rabotaet"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">Как этот код работает</span></a>  </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><a href="https://excelpedia.ru/#kak-ispolzovat"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">Как использовать</span></a>  </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; color:#2e75b5;">Как макрос работает </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Этот макрос по существу имитирует действия для автоматического сжатия и восстановления приложения Access. <br />Обратите внимание, что для того, чтобы использовать этот код, необходимо установить ссылку на библиотеку объектов Microsoft Access.  <br />Для этого откройте VBA в Excel и выберите Tools</span><span style=" font-family:'Segoe UI Symbol,sans-serif'; font-size:12pt;">➜</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">References. Откроется диалоговое окно «References». Прокрутите вниз, пока вы <br />найдите запись Microsoft Access XX Object Library, где XX — это ваша версия Access. Выберите флажок рядом с записью.  </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; color:#2e75b5;">Код макроса </span> </p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">Sub</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">SjatBazuDannihAccess() </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">'Шаг 1: Объявляем переменные </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">Dim</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">OriginalFile As</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">String </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">Dim</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">BackupFile As</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">String </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">Dim</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">TempFile As</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">String </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">'Шаг 2: Определите пути назначения файлов базы данных назначения </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">OriginalFile = &quot;C:\Temp\MyDatabase.accdb&quot; </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">BackupFile = &quot;C:\Temp\MyDatabaseBackup.accdb&quot; </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">TempFile = &quot;C:\Temp\MyDatabaseTemporary.accdb&quot; </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">'Шаг 3: Сделайте резервную копию базы данных </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">FileCopy OriginalFile, BackupFile </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">'Шаг 4: Выполнить сжатие и восстановление </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">DBEngine.CompactDatabase OriginalFile, TempFile </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">'Шаг 5: Удалить старую базу данных </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">Kill OriginalFile </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">'Шаг 6: Переименуйте временную базу данных в старое имя базы данных </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">Name TempFile As</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">OriginalFile </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:12pt;">End</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> </span><span style=" font-family:'Consolas'; font-size:12pt;">Sub </span> </p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; color:#2e75b5;">Как этот код работает </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Шаг 1 объявляет три строковые переменные, которые держат имена файлов. </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Шаг 2 присваивает каждой из строковых переменных имя файла. Переменной </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; font-weight:600;">OriginalFile</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> присваивается путь к файлу и имя целевой базы данных. </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; font-weight:600;">BackupFile</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> присваивается путь к файлу и имя файла резервной копии. Переменной </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; font-weight:600;">TempFile</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> присваивается путь к файлу и имя временного файла. </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Шаг 3 использует функцию </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; font-weight:600;">FileCopy</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">, чтобы сделать резервную копию </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt; font-weight:600;">OriginalFile</span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;"> (цель база данных). Хотя этот шаг не является необходимым для сжатия и восстановления процедуры, как правило, это хорошая практика, чтобы сделать резервную копию базы данных перед запуском VBA. </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Шаг 4 выполняет сжатия и восстановления, указав исходную базу данных и указав путь к файлу временной базы данных. </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">5.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">На данный момент, у вас есть две копии базы данных: исходная база данных и вторая база данных, которая является копией оригинала без пустого пространства файла. Шаг 5 удаляет исходную базу данных, оставив копию. </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">6.<span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-family:'Verdana,sans-serif'; font-size:12pt;">Шаг 6 просто переименовывает временный файл, присвоив ему имя вашей исходной базы данных. У вас теперь база данных, которая является компактной и оптимизированной. </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>